-- Obfuscated wrapper generated by assistant
-- Anti-tamper: checksum 22684096, sha256 64c06fb5eaed892633470029a4c4aba433dd52e8394822190b353545dd91ed1e

local b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
local function decodeBase64(data)
    data = string.gsub(data, '[^'..b..'=]', '')
    return (data:gsub('.', function(x)
        if (x == '=') then return '' end
        local r,f='', (b:find(x)-1)
        for i=6,1,-1 do
            r = r .. ( (f % 2^i) - (f % 2^(i-1)) > 0 and '1' or '0' )
        end
        return r
    end):gsub('%d%d%d%d%d%d%d%d', function(x)
        local c=0
        for i=1,8 do c = c + (x:sub(i,i)=='1' and 2^(8-i) or 0) end
        return string.char(c)
    end))
end


-- Fake/junk code to confuse casual readers
local _MQIOFJKLEj = function(...) for i=1,math.floor((2+math.random())*1) do local _x = tostring(...); end return nil end
local _qVrxBMQZOy = function(...) for i=1,math.floor((2+math.random())*1) do local _x = tostring(...); end return nil end
local _eIbyQhOjLV = function(...) for i=1,math.floor((7+math.random())*1) do local _x = tostring(...); end return nil end
local _MxsMdoKHoT = function(...) for i=1,math.floor((4+math.random())*1) do local _x = tostring(...); end return nil end
local _QHJTJIaOtd = function(...) for i=1,math.floor((4+math.random())*1) do local _x = tostring(...); end return nil end
local _DuSHVCeOzh = function(...) for i=1,math.floor((8+math.random())*1) do local _x = tostring(...); end return nil end
local _tkDNpEnpwv = function(...) for i=1,math.floor((2+math.random())*1) do local _x = tostring(...); end return nil end
local _wZbCUpnxhu = function(...) for i=1,math.floor((5+math.random())*1) do local _x = tostring(...); end return nil end
local _tyaWIQCtLf = function(...) for i=1,math.floor((1+math.random())*1) do local _x = tostring(...); end return nil end
local _JNFsLIWSqX = function(...) for i=1,math.floor((3+math.random())*1) do local _x = tostring(...); end return nil end
local _VwdnoWmaoe = function(...) for i=1,math.floor((2+math.random())*1) do local _x = tostring(...); end return nil end
local _lbhShfRfdu = function(...) for i=1,math.floor((2+math.random())*1) do local _x = tostring(...); end return nil end

local payload_b64 = "LS1bWwoKIF8gICBfICAgIF8gICBfICAgX19fX18gICAgIF8gICAgICAgX19fICAgICBfICAgXyAgIF8gICBfICAgX19fXyAgIAp8IHwgfCB8ICB8IHwgfCB8IHxfICAgX3wgICAvIFwgICAgIC8gXyBcICAgfCB8IHwgfCB8IHwgfCB8IHwgX18gKSAgCnwgfF98IHwgIHwgfCB8IHwgICB8IHwgICAgLyBfIFwgICB8IHwgfCB8ICB8IHxffCB8IHwgfCB8IHwgfCAgXyBcICAKfCAgXyAgfCAgfCB8IHwgfCAgIHwgfCAgIC8gX19fIFwgIHwgfF98IHwgIHwgIF8gIHwgfCB8X3wgfCB8IHxfKSB8IApcX3wgfF8vICAgXF9fXy8gICAgXF8vICAvXy8gICBcX1wgIFxfX18vICAgXF98IHxfLyAgXF9fXy8gIHxfX19fLwoKICAgICAgICAgICAgICAgICAgICAgICAgSHV0YW8gSHViCl1dCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmxvY2FsIEZsdWVudCA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRGl0LU1lLVNraWQvWW91LVNraWQtRnVjay9yZWZzL2hlYWRzL21haW4vRDBSMS1VSS5sdWEiKSkoKQpsb2NhbCBTYXZlTWFuYWdlciA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGF3aWQtc2NyaXB0cy9GbHVlbnQvbWFzdGVyL0FkZG9ucy9TYXZlTWFuYWdlci5sdWEiKSkoKQpsb2NhbCBJbnRlcmZhY2VN" ..
    "YW5hZ2VyID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYXdpZC1zY3JpcHRzL0ZsdWVudC9tYXN0ZXIvQWRkb25zL0ludGVyZmFjZU1hbmFnZXIubHVhIikpKCkKCi0tIFThuqFvIGPhu61hIHPhu5UgRmx1ZW50IGNow61uaApsb2NhbCBXaW5kb3cgPSBGbHVlbnQ6Q3JlYXRlV2luZG93KHsKICAgIFRpdGxlID0gIkh1dGFvIEh1YiAoVjMpIFtGcmVlXSB8IEZvcnNha2VuIHwiLAogICAgU3ViVGl0bGUgPSAiVmVyc2lvbiA1LjQuMiIsCiAgICBTZWFyY2ggPSB0cnVlLAogICAgSWNvbiA9ICJyYnhhc3NldGlkOi8vMTExMjIxODA2NjY1MzkwIiwKICAgIFRhYldpZHRoID0gMTYwLAogICAgU2l6ZSA9IFVEaW0yLmZyb21PZmZzZXQoNDgwLCAzNjApLAogICAgQWNyeWxpYyA9IHRydWUsCiAgICBUaGVtZSA9ICJEYXJrIiwKICAgIE1pbmltaXplS2V5ID0gRW51bS5LZXlDb2RlLlJpZ2h0QWx0LAoKICAgIFVzZXJJbmZvID0gZmFsc2UsCiAgICBVc2VySW5mb1RvcCA9IGZhbHNlLAogICAgVXNlckluZm9UaXRsZSA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkRpc3BsYXlOYW1lLAogICAgVXNlckluZm9TdWJ0aXRsZSA9ICJTTEsgxJDhurlwIFRyYWkiLAogICAgVXNlckluZm9TdWJ0aXRsZUNvbG9yID0gQ29sb3IzLmZyb21SR0IoNzEsIDEyMywgMjU1KQp9KQoKLS0gVGFicwpsb2NhbCBUYWJzID0gewogICAgRGV2ID0gV2luZG93OkFk" ..
    "ZFRhYih7IFRpdGxlID0gIkFib3V0IiwgSWNvbiA9ICJpbmZvIiB9KSwKICAgIEZhcm0gPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiRmFybSIsIEljb24gPSAiYm94IiB9KSwKICAgIE1haW4gPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiTWFpbiIsIEljb24gPSAiaG9tZSIgfSksCiAgICBFdmVudCA9IFdpbmRvdzpBZGRUYWIoeyBUaXRsZSA9ICJFdmVudCIsIEljb24gPSAiYmVsbCIgfSksCiAgICBDdXN0b20gPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiQ3VzdG9tIiwgSWNvbiA9ICJicnVzaCIgfSksCiAgICBQbGF5ZXIgPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiUGxheWVyIiwgSWNvbiA9ICJ1c2VyIiB9KSwKICAgIFZpc3VhbCA9IFdpbmRvdzpBZGRUYWIoeyBUaXRsZSA9ICJWaXN1YWwiLCBJY29uID0gImV5ZSIgfSksCiAgICBNaXNjID0gV2luZG93OkFkZFRhYih7IFRpdGxlID0gIk1pc2MiLCBJY29uID0gIm1lbnUiIH0pLAogICAgU2V0dGluZ3MgPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiU2V0dGluZ3MiLCBJY29uID0gInNldHRpbmdzIiB9KSwKfQoKLS0gUGjhuqduIExvZ2ljIENow61uaAoKLS0vLyDimpnvuI8gRVNQTWFuYWdlciB2Mi43IChBdXRvLVJlc3RvcmUgKyBEZWJvdW5jZSAwLjVzKQotLS8vIFThu7EgdGjDqm0gbOG6oWkga2hpIG1vZGVsIGJp4bq/biBt4bqldC9oaeG7h24sIGNo4bq/dC9o4buTaSBzaW5oLCBHVUkvSEwgbeG6pXQsIHbhu5tpIGRlYm91bmNlIDAuNXMgxJHh" ..
    "u4MgdHLDoW5oIGxhZwoKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCmxvY2FsIENhbWVyYSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCgpsb2NhbCBFU1BNYW5hZ2VyID0gewogICAgQWN0aXZlVHlwZXMgPSB7fSwgICAgLS0gWyJQbGF5ZXIiXSA9IHRydWUKICAgIE9iamVjdHMgPSB7fSwgICAgICAgIC0tIFttb2RlbF0gPSB7IHR5cGUsIGd1aSwgaGwsIGxhYmVsLCBjb25ucyA9IHt9IH0KICAgIEZpbHRlcnMgPSB7fSwgICAgICAgIC0tIGZpbHRlckZuCiAgICBDb2xvcnMgPSB7fSwgICAgICAgICAtLSB0eXBlQ29sb3IKICAgIFdhdGNoZXJzID0ge30sICAgICAgIC0tIGNvbm5lY3Rpb24gdGFibGUKICAgIFNob3dIUCA9IHt9LCAgICAgICAgIC0tIHR5cGVOYW1lIC0+IGJvb2xlYW4KICAgIF9wZW5kaW5nQ3JlYXRlID0ge30sIC0tIFttb2RlbF0gPSB0cnVlIChkZWJvdW5jZSkKfQoKLS0gSGVscGVyOiBzYWZlIGZpbmQgcHJpbWFyeSBwYXJ0CmxvY2FsIGZ1bmN0aW9uIGdldFByaW1hcnlQYXJ0KG1vZGVsKQogICAgaWYgbm90IG1vZGVsIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgIGxvY2FsIHAgPSBtb2RlbDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIG9yIG1vZGVsOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJhc2VQYXJ0IikKICAgIHJldHVybiBwCmVuZAoKLS0g8J+nqSDEkMSDbmcga8O9IGxv4bqhaSBFU1AKZnVuY3Rpb24gRVNQTWFuYWdlcjpSZWdp" ..
    "c3RlclR5cGUobmFtZSwgY29sb3IsIGZpbHRlckZuLCBzaG93SFApCiAgICBzZWxmLkZpbHRlcnNbbmFtZV0gPSBmaWx0ZXJGbgogICAgc2VsZi5Db2xvcnNbbmFtZV0gPSBjb2xvcgogICAgc2VsZi5TaG93SFBbbmFtZV0gPSBzaG93SFAgb3IgZmFsc2UKICAgIHNlbGYuQWN0aXZlVHlwZXNbbmFtZV0gPSBmYWxzZQplbmQKCi0tIGludGVybmFsOiBkaXNjb25uZWN0IGNvbm5lY3Rpb25zIHRhYmxlCmxvY2FsIGZ1bmN0aW9uIGRpc2Nvbm5lY3RDb25ucyh0YmwpCiAgICBpZiBub3QgdGJsIHRoZW4gcmV0dXJuIGVuZAogICAgZm9yIF8sIGMgaW4gcGFpcnModGJsKSBkbwogICAgICAgIGlmIGMgYW5kIHR5cGVvZihjLkRpc2Nvbm5lY3QpID09ICJmdW5jdGlvbiIgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpIGM6RGlzY29ubmVjdCgpIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tIPCfp7EgVOG6oW8gRVNQIChraMO0bmcgZGVib3VuY2UpIC0gZ+G7jWkgYW4gdG/DoG4gYsOqbiB0cm9uZyB0YXNrLmRlbGF5IGtoaSBj4bqnbgpmdW5jdGlvbiBFU1BNYW5hZ2VyOl9DcmVhdGVJbW1lZGlhdGUobW9kZWwsIHR5cGVOYW1lKQogICAgaWYgbm90IG1vZGVsIG9yIG5vdCBtb2RlbC5QYXJlbnQgdGhlbiByZXR1cm4gZW5kCiAgICBpZiBFU1BNYW5hZ2VyLk9iamVjdHNbbW9kZWxdIHRoZW4KICAgICAgICAtLSBu4bq/dSB04buTbiB04bqhaSBuaMawbmcgYuG7iyBo4buPbmcgcGjhuqduIGd1aS9obCB0aMOs" ..
    "IGThu41uIHRyxrDhu5tjCiAgICAgICAgbG9jYWwgZXhpc3RpbmcgPSBFU1BNYW5hZ2VyLk9iamVjdHNbbW9kZWxdCiAgICAgICAgaWYgZXhpc3RpbmcuZ3VpIGFuZCBleGlzdGluZy5ndWkuUGFyZW50IGFuZCBleGlzdGluZy5obCBhbmQgZXhpc3RpbmcuaGwuUGFyZW50IHRoZW4KICAgICAgICAgICAgcmV0dXJuIC0tIMSRw6Mgb2sgcuG7k2kKICAgICAgICBlbHNlCiAgICAgICAgICAgIEVTUE1hbmFnZXI6UmVtb3ZlKG1vZGVsKQogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgY29sb3IgPSBFU1BNYW5hZ2VyLkNvbG9yc1t0eXBlTmFtZV0KICAgIGxvY2FsIHBhcnQgPSBnZXRQcmltYXJ5UGFydChtb2RlbCkKICAgIGlmIG5vdCBwYXJ0IHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tIEJpbGxib2FyZAogICAgbG9jYWwgYmlsbGJvYXJkID0gSW5zdGFuY2UubmV3KCJCaWxsYm9hcmRHdWkiKQogICAgYmlsbGJvYXJkLk5hbWUgPSAiRVNQXyIgLi4gdHlwZU5hbWUKICAgIGJpbGxib2FyZC5TaXplID0gVURpbTIubmV3KDAsIDE4MCwgMCwgMzUpCiAgICBiaWxsYm9hcmQuQWx3YXlzT25Ub3AgPSB0cnVlCiAgICBiaWxsYm9hcmQuU3R1ZHNPZmZzZXQgPSBWZWN0b3IzLm5ldygwLCAzLCAwKQogICAgYmlsbGJvYXJkLk1heERpc3RhbmNlID0gNjAwCiAgICBiaWxsYm9hcmQuUGFyZW50ID0gcGFydAoKICAgIGxvY2FsIGxhYmVsID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgbGFiZWwuU2l6ZSA9IFVEaW0yLm5l" ..
    "dygxLCAwLCAxLCAwKQogICAgbGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIGxhYmVsLlRleHRDb2xvcjMgPSBjb2xvcgogICAgbGFiZWwuVGV4dFN0cm9rZVRyYW5zcGFyZW5jeSA9IDAuMwogICAgbGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCiAgICBsYWJlbC5UZXh0U2l6ZSA9IDE2CiAgICBsYWJlbC5UZXh0ID0gbW9kZWwuTmFtZQogICAgbGFiZWwuUGFyZW50ID0gYmlsbGJvYXJkCgogICAgLS0gSGlnaGxpZ2h0CiAgICBsb2NhbCBobCA9IEluc3RhbmNlLm5ldygiSGlnaGxpZ2h0IikKICAgIGhsLkFkb3JuZWUgPSBtb2RlbAogICAgaGwuRmlsbENvbG9yID0gY29sb3IKICAgIGhsLk91dGxpbmVDb2xvciA9IGNvbG9yCiAgICBobC5GaWxsVHJhbnNwYXJlbmN5ID0gMC43CiAgICBobC5PdXRsaW5lVHJhbnNwYXJlbmN5ID0gMAogICAgaGwuRGVwdGhNb2RlID0gRW51bS5IaWdobGlnaHREZXB0aE1vZGUuQWx3YXlzT25Ub3AKICAgIGhsLkVuYWJsZWQgPSB0cnVlCiAgICBobC5QYXJlbnQgPSBtb2RlbAoKICAgIC0tIEvhur90IG7hu5FpIG1vZGVsLWxldmVsIHdhdGNoZXJzICjEkeG7gyB04buxIHBo4bulYyBo4buTaSBraGkgcGFyZW50IHRoYXkgxJHhu5VpIC8gcmVzcGF3biAvIGh1bWFub2lkIGRpZWQpCiAgICBsb2NhbCBjb25ucyA9IHt9CgogICAgLS0gbuG6v3UgbW9kZWwgYuG7iyByZXBhcmVudCAvIHJlbW92ZWQgLT4gc2NoZWR1bGUgcmVjcmVhdGUgKGRlYm91bmNlZCkKICAg" ..
    "IHRhYmxlLmluc2VydChjb25ucywgbW9kZWwuQW5jZXN0cnlDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oXywgcGFyZW50KQogICAgICAgIC0tIG7hur91IG1vZGVsIGtow7RuZyBjw7JuIHRyb25nIHdvcmtzcGFjZSwgeMOzYSBFU1AKICAgICAgICBpZiBub3QgbW9kZWw6SXNEZXNjZW5kYW50T2Yod29ya3NwYWNlKSB0aGVuCiAgICAgICAgICAgIC0tIHjDs2EgbmdheSAoa2jDtG5nIHJlY3JlYXRlIGtoaSB1c2VyIHThuq90IGxv4bqhaSkKICAgICAgICAgICAgaWYgRVNQTWFuYWdlci5PYmplY3RzW21vZGVsXSBhbmQgRVNQTWFuYWdlci5PYmplY3RzW21vZGVsXS50eXBlID09IHR5cGVOYW1lIHRoZW4KICAgICAgICAgICAgICAgIEVTUE1hbmFnZXI6UmVtb3ZlKG1vZGVsKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgLS0gbuG6v3UgdHLhu58gbOG6oWkgd29ya3NwYWNlIC0+IGRlYm91bmNlIHThuqFvIGzhuqFpCiAgICAgICAgaWYgRVNQTWFuYWdlci5BY3RpdmVUeXBlc1t0eXBlTmFtZV0gYW5kIEVTUE1hbmFnZXIuRmlsdGVyc1t0eXBlTmFtZV0obW9kZWwpIHRoZW4KICAgICAgICAgICAgRVNQTWFuYWdlcjpfU2NoZWR1bGVDcmVhdGUobW9kZWwsIHR5cGVOYW1lKQogICAgICAgIGVuZAogICAgZW5kKSkKCiAgICAtLSB3YXRjaCBodW1hbm9pZCBkZWF0aCAmIHJlc3Bhd24KICAgIGxvY2FsIGZ1bmN0aW9uIHdhdGNoSHVtYW5vaWQoaHVtKQogICAgICAgIGlmIG5v" ..
    "dCBodW0gdGhlbiByZXR1cm4gZW5kCiAgICAgICAgLS0gRGllZCAtPiByZW1vdmUsIHLhu5NpIGNo4budIGh1bWFub2lkIG3hu5tpCiAgICAgICAgdGFibGUuaW5zZXJ0KGNvbm5zLCBodW0uRGllZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgRVNQTWFuYWdlci5PYmplY3RzW21vZGVsXSBhbmQgRVNQTWFuYWdlci5PYmplY3RzW21vZGVsXS50eXBlID09IHR5cGVOYW1lIHRoZW4KICAgICAgICAgICAgICAgIEVTUE1hbmFnZXI6UmVtb3ZlKG1vZGVsKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgLS0gY2jhu50gaHVtYW5vaWQgbeG7m2kgeHXhuqV0IGhp4buHbiAoQ2hpbGRBZGRlZCkKICAgICAgICAgICAgLS0gc2NoZWR1bGVkIGNyZWF0ZSBz4bq9IGhhbmRsZSBraGkgSHVtYW5vaWQgeHXhuqV0IGhp4buHbgogICAgICAgIGVuZCkpCiAgICBlbmQKCiAgICAtLSBu4bq/dSDEkcOjIGPDsyBodW1hbm9pZCwgd2F0Y2ggbsOzCiAgICB3YXRjaEh1bWFub2lkKG1vZGVsOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSkKCiAgICAtLSBsaXN0ZW4gQ2hpbGRBZGRlZCDEkeG7gyBkZXRlY3QgaHVtYW5vaWQgcmVzcGF3bgogICAgdGFibGUuaW5zZXJ0KGNvbm5zLCBtb2RlbC5DaGlsZEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hpbGQpCiAgICAgICAgaWYgY2hpbGQgYW5kIGNoaWxkOklzQSgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgIC0tIGh1bWFub2lkIG3hu5tpIC0+IHNjaGVkdWxl" ..
    "IGNyZWF0ZQogICAgICAgICAgICB3YXRjaEh1bWFub2lkKGNoaWxkKQogICAgICAgICAgICBpZiBFU1BNYW5hZ2VyLkFjdGl2ZVR5cGVzW3R5cGVOYW1lXSBhbmQgRVNQTWFuYWdlci5GaWx0ZXJzW3R5cGVOYW1lXShtb2RlbCkgdGhlbgogICAgICAgICAgICAgICAgRVNQTWFuYWdlcjpfU2NoZWR1bGVDcmVhdGUobW9kZWwsIHR5cGVOYW1lKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICAtLSBu4bq/dSBQcmltYXJ5UGFydCB4deG6pXQgaGnhu4duIG114buZbiBjxaluZyBzY2hlZHVsZSBjcmVhdGUKICAgICAgICBpZiAoY2hpbGQ6SXNBKCJCYXNlUGFydCIpIG9yIGNoaWxkOklzQSgiTW9kZWwiKSkgYW5kIEVTUE1hbmFnZXIuQWN0aXZlVHlwZXNbdHlwZU5hbWVdIGFuZCBFU1BNYW5hZ2VyLkZpbHRlcnNbdHlwZU5hbWVdKG1vZGVsKSB0aGVuCiAgICAgICAgICAgIC0tIHByaW1hcnkgcGFydCBtYXkgYXBwZWFyIGxhdGVyCiAgICAgICAgICAgIEVTUE1hbmFnZXI6X1NjaGVkdWxlQ3JlYXRlKG1vZGVsLCB0eXBlTmFtZSkKICAgICAgICBlbmQKICAgIGVuZCkpCgogICAgRVNQTWFuYWdlci5PYmplY3RzW21vZGVsXSA9IHsKICAgICAgICB0eXBlID0gdHlwZU5hbWUsCiAgICAgICAgZ3VpID0gYmlsbGJvYXJkLAogICAgICAgIGxhYmVsID0gbGFiZWwsCiAgICAgICAgaGwgPSBobCwKICAgICAgICBjb25ucyA9IGNvbm5zLAogICAgfQplbmQKCi0tIPCfp7EgUHVibGljIENyZWF0ZSAoZGVib3VuY2VkIHdy" ..
    "YXBwZXIpCmZ1bmN0aW9uIEVTUE1hbmFnZXI6X1NjaGVkdWxlQ3JlYXRlKG1vZGVsLCB0eXBlTmFtZSkKICAgIGlmIG5vdCBtb2RlbCBvciBub3QgdHlwZU5hbWUgdGhlbiByZXR1cm4gZW5kCiAgICAtLSBu4bq/dSBsb+G6oWkgxJFhbmcgdOG6r3QgdGjDrCBraMO0bmcgc2NoZWR1bGUKICAgIGlmIG5vdCBFU1BNYW5hZ2VyLkFjdGl2ZVR5cGVzW3R5cGVOYW1lXSB0aGVuIHJldHVybiBlbmQKICAgIC0tIHRyw6FuaCBzY2hlZHVsZSBuaGnhu4F1IGzhuqduCiAgICBpZiBFU1BNYW5hZ2VyLl9wZW5kaW5nQ3JlYXRlW21vZGVsXSB0aGVuIHJldHVybiBlbmQKICAgIEVTUE1hbmFnZXIuX3BlbmRpbmdDcmVhdGVbbW9kZWxdID0gdHJ1ZQoKICAgIC0tIGTDuW5nIHRhc2suZGVsYXkgMC41IMSR4buDIGRlYm91bmNlLCB0csOhbmggc3BhbSB04bqhbyBraGkgbW9kZWwgxJFhbmcgbWlkLXVwZGF0ZQogICAgdGFzay5kZWxheSgwLjUsIGZ1bmN0aW9uKCkKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIEVTUE1hbmFnZXIuX3BlbmRpbmdDcmVhdGVbbW9kZWxdID0gbmlsCiAgICAgICAgICAgIC0tIGRvdWJsZS1jaGVjayDEkWnhu4F1IGtp4buHbgogICAgICAgICAgICBpZiBub3QgbW9kZWwgb3Igbm90IG1vZGVsLlBhcmVudCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgbG9jYWwgZmlsdGVyRm4gPSBFU1BNYW5hZ2VyLkZpbHRlcnNbdHlwZU5hbWVdCiAgICAgICAgICAgIGlmIG5vdCBmaWx0ZXJGbiBvciBu" ..
    "b3QgZmlsdGVyRm4obW9kZWwpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAtLSBjYWxsIGltbWVkaWF0ZSBjcmVhdGUgKHNhZmUpCiAgICAgICAgICAgIEVTUE1hbmFnZXI6X0NyZWF0ZUltbWVkaWF0ZShtb2RlbCwgdHlwZU5hbWUpCiAgICAgICAgZW5kKQogICAgZW5kKQplbmQKCi0tIPCfp7kgWG/DoSBFU1AKZnVuY3Rpb24gRVNQTWFuYWdlcjpSZW1vdmUobW9kZWwpCiAgICBsb2NhbCBkYXRhID0gc2VsZi5PYmplY3RzW21vZGVsXQogICAgaWYgbm90IGRhdGEgdGhlbiByZXR1cm4gZW5kCgogICAgLS0gZGlzY29ubmVjdCBtb2RlbCBjb25uZWN0aW9ucwogICAgaWYgZGF0YS5jb25ucyB0aGVuCiAgICAgICAgZGlzY29ubmVjdENvbm5zKGRhdGEuY29ubnMpCiAgICBlbmQKCiAgICBwY2FsbChmdW5jdGlvbigpIGlmIGRhdGEuZ3VpIHRoZW4gZGF0YS5ndWk6RGVzdHJveSgpIGVuZCBlbmQpCiAgICBwY2FsbChmdW5jdGlvbigpIGlmIGRhdGEuaGwgdGhlbiBkYXRhLmhsOkRlc3Ryb3koKSBlbmQgZW5kKQogICAgc2VsZi5PYmplY3RzW21vZGVsXSA9IG5pbAogICAgLS0gY2xlYXIgcGVuZGluZyBpZiBhbnkKICAgIHNlbGYuX3BlbmRpbmdDcmVhdGVbbW9kZWxdID0gbmlsCmVuZAoKLS0g4pqZ77iPIFThuqFvIHdhdGNoZXIgKHThu7EgxJHhu5luZyB0aMOqbS94w7NhIEVTUCBraGkgbW9kZWwgdGhheSDEkeG7lWkpCmZ1bmN0aW9uIEVTUE1hbmFnZXI6U3RhcnRXYXRjaGVyKHR5cGVOYW1lKQogICAgbG9jYWwgZmls" ..
    "dGVyRm4gPSBzZWxmLkZpbHRlcnNbdHlwZU5hbWVdCiAgICBpZiBub3QgZmlsdGVyRm4gdGhlbiByZXR1cm4gZW5kCiAgICBpZiBzZWxmLldhdGNoZXJzW3R5cGVOYW1lXSB0aGVuIHJldHVybiBlbmQKCiAgICAtLSB04bqhbyBFU1AgY2hvIG1vZGVsIHPhurVuIGPDsyAoZGVib3VuY2VkIHBlciBtb2RlbCkKICAgIGZvciBfLCBvYmogaW4gaXBhaXJzKHdvcmtzcGFjZTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgIGlmIGZpbHRlckZuKG9iaikgdGhlbgogICAgICAgICAgICAtLSBzY2hlZHVsZSBjcmVhdGUgd2l0aCBkZWJvdW5jZQogICAgICAgICAgICBzZWxmOl9TY2hlZHVsZUNyZWF0ZShvYmosIHR5cGVOYW1lKQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gdGhlbyBkw7VpIG1vZGVsIG3hu5tpIChEZXNjZW5kYW50QWRkZWQpIG5oxrBuZyBzY2hlZHVsZSBjcmVhdGUgY2jhu4kga2hpIGjhu6NwIGzhu4cKICAgIGxvY2FsIGFkZENvbm4gPSB3b3Jrc3BhY2UuRGVzY2VuZGFudEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ob2JqKQogICAgICAgIGlmIHNlbGYuQWN0aXZlVHlwZXNbdHlwZU5hbWVdIGFuZCBmaWx0ZXJGbihvYmopIHRoZW4KICAgICAgICAgICAgc2VsZjpfU2NoZWR1bGVDcmVhdGUob2JqLCB0eXBlTmFtZSkKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICAtLSBraGkgbW9kZWwgYuG7iyByZW1vdmUgLT4gUmVtb3ZlIEVTUCBu4bq/dSBjw7MKICAgIGxvY2FsIHJlbW92ZUNvbm4gPSB3b3Jrc3BhY2Uu" ..
    "RGVzY2VuZGFudFJlbW92aW5nOkNvbm5lY3QoZnVuY3Rpb24ob2JqKQogICAgICAgIGlmIHNlbGYuT2JqZWN0c1tvYmpdIGFuZCBzZWxmLk9iamVjdHNbb2JqXS50eXBlID09IHR5cGVOYW1lIHRoZW4KICAgICAgICAgICAgc2VsZjpSZW1vdmUob2JqKQogICAgICAgIGVuZAogICAgICAgIC0tIGNsZWFyIGFueSBwZW5kaW5nIGNyZWF0ZSB3aGVuIGRlc2NlbmRhbnQgcmVtb3ZpbmcKICAgICAgICBzZWxmLl9wZW5kaW5nQ3JlYXRlW29ial0gPSBuaWwKICAgIGVuZCkKCiAgICBzZWxmLldhdGNoZXJzW3R5cGVOYW1lXSA9IHthZGQgPSBhZGRDb25uLCByZW0gPSByZW1vdmVDb25ufQplbmQKCmZ1bmN0aW9uIEVTUE1hbmFnZXI6U3RvcFdhdGNoZXIodHlwZU5hbWUpCiAgICBsb2NhbCB3ID0gc2VsZi5XYXRjaGVyc1t0eXBlTmFtZV0KICAgIGlmIHcgdGhlbgogICAgICAgIGlmIHcuYWRkIHRoZW4gdy5hZGQ6RGlzY29ubmVjdCgpIGVuZAogICAgICAgIGlmIHcucmVtIHRoZW4gdy5yZW06RGlzY29ubmVjdCgpIGVuZAogICAgZW5kCiAgICBzZWxmLldhdGNoZXJzW3R5cGVOYW1lXSA9IG5pbAplbmQKCi0tIOKZu++4jyBD4bqtcCBuaOG6rXQgKDEgdsOybmcgZHV5IG5o4bqldCwgY+G7sWMgbmjhurkpIC0gQ0jhu4ggY+G6rXAgbmjhuq10IHRleHQgLyBraeG7g20gdHJhIG5oYW5oClJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgLS0gU+G7rSBk4bulbmcgcGFpcnMoT2JqZWN0cykgbmjhu48gKGNo" ..
    "4buJIG5o4buvbmcgbW9kZWwgY8OzIEVTUCBoaeG7h24gdOG6oWkpCiAgICBmb3IgbW9kZWwsIGRhdGEgaW4gcGFpcnMoRVNQTWFuYWdlci5PYmplY3RzKSBkbwogICAgICAgIC0tIG7hur91IG1vZGVsIGjhu49uZyAtPiBk4buNbgogICAgICAgIGlmIG5vdCBtb2RlbCBvciBub3QgbW9kZWwuUGFyZW50IHRoZW4KICAgICAgICAgICAgRVNQTWFuYWdlcjpSZW1vdmUobW9kZWwpCiAgICAgICAgZWxzZQogICAgICAgICAgICBsb2NhbCBwYXJ0ID0gZ2V0UHJpbWFyeVBhcnQobW9kZWwpCiAgICAgICAgICAgIGlmIG5vdCBwYXJ0IHRoZW4KICAgICAgICAgICAgICAgIEVTUE1hbmFnZXI6UmVtb3ZlKG1vZGVsKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAtLSBu4bq/dSBndWkvaGwgYuG7iyB4w7NhIGLhuqV0IG5n4budIC0+IHNjaGVkdWxlIHJlY3JlYXRlIChkZWJvdW5jZWQpCiAgICAgICAgICAgICAgICBsb2NhbCBuZWVkUmVjcmVhdGUgPSBmYWxzZQogICAgICAgICAgICAgICAgaWYgKG5vdCBkYXRhLmd1aSkgb3IgKG5vdCBkYXRhLmhsKSBvciAobm90IGRhdGEubGFiZWwpIHRoZW4KICAgICAgICAgICAgICAgICAgICBuZWVkUmVjcmVhdGUgPSB0cnVlCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgLS0ga2nhu4NtIHRyYSBwYXJlbnQgdMOsbmggdHLhuqFuZyAobuG6v3UgcGFyZW50IG5pbCkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgZGF0YS5ndWkuUGFyZW50IHRoZW4K" ..
    "ICAgICAgICAgICAgICAgICAgICAgICAgbmVlZFJlY3JlYXRlID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBuZWVkUmVjcmVhdGUgdGhlbgogICAgICAgICAgICAgICAgICAgIC0tIHJlbW92ZSBlbnRyeSBuZ2F5IChk4buNbikgdsOgIHNjaGVkdWxlIHThuqFvIGzhuqFpIGFuIHRvw6BuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdHlwZU5hbWUgPSBkYXRhLnR5cGUKICAgICAgICAgICAgICAgICAgICBFU1BNYW5hZ2VyOlJlbW92ZShtb2RlbCkKICAgICAgICAgICAgICAgICAgICBFU1BNYW5hZ2VyOl9TY2hlZHVsZUNyZWF0ZShtb2RlbCwgdHlwZU5hbWUpCiAgICAgICAgICAgICAgICAgICAgLS0gbmV4dCBtb2RlbAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIC0tIGPhuq1wIG5o4bqtdCB0ZXh0IChuaOG6uSkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBkaXN0ID0gKENhbWVyYS5DRnJhbWUuUG9zaXRpb24gLSBwYXJ0LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0eHQgPSBtb2RlbC5OYW1lCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2hvd0hQID0gRVNQTWFuYWdlci5TaG93SFBbZGF0YS50eXBlXQogICAgICAgICAgICAgICAgICAgIGlmIHNob3dIUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGh1bSA9IG1vZGVsOkZpbmRGaXJzdENoaWxk" ..
    "T2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBodW0gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ID0gc3RyaW5nLmZvcm1hdCgiJXMgfCBIUDolZCB8IFslLjBmbV0iLCB0eHQsIG1hdGguZmxvb3IoaHVtLkhlYWx0aCksIGRpc3QpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCA9IHN0cmluZy5mb3JtYXQoIiVzIFslLjBmbV0iLCB0eHQsIGRpc3QpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgdHh0ID0gc3RyaW5nLmZvcm1hdCgiJXMgWyUuMGZtXSIsIHR4dCwgZGlzdCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBkYXRhLmxhYmVsIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgLS0gbGFiZWwgdXBkYXRlIGlzIGNoZWFwCiAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgZGF0YS5sYWJlbC5UZXh0ID0gdHh0IGVuZCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgotLSDimqEgQuG6rXQvVOG6r3QgdOG7q25nIGxv4bqhaSBFU1AKZnVuY3Rpb24gRVNQTWFuYWdlcjpTZXRFbmFibGVkKHR5cGVOYW1lLCBzdGF0ZSkKICAgIHNlbGYuQWN0" ..
    "aXZlVHlwZXNbdHlwZU5hbWVdID0gc3RhdGUKCiAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgc2VsZjpTdGFydFdhdGNoZXIodHlwZU5hbWUpCiAgICAgICAgLS0ga2hpIGLhuq10IGzhuqFpLCBxdcOpdCBuaGFuaCB0b8OgbiBi4buZIHdvcmtzcGFjZSB2w6Agc2NoZWR1bGUgY3JlYXRlIChkZWJvdW5jZWQpCiAgICAgICAgbG9jYWwgZmlsdGVyRm4gPSBzZWxmLkZpbHRlcnNbdHlwZU5hbWVdCiAgICAgICAgaWYgZmlsdGVyRm4gdGhlbgogICAgICAgICAgICBmb3IgXywgb2JqIGluIGlwYWlycyh3b3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgIGlmIGZpbHRlckZuKG9iaikgdGhlbgogICAgICAgICAgICAgICAgICAgIHNlbGY6X1NjaGVkdWxlQ3JlYXRlKG9iaiwgdHlwZU5hbWUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbHNlCiAgICAgICAgc2VsZjpTdG9wV2F0Y2hlcih0eXBlTmFtZSkKICAgICAgICAtLSB4w7NhIHRvw6BuIGLhu5kgRVNQIGxv4bqhaSDEkcOzCiAgICAgICAgZm9yIG1vZGVsLCBkYXRhIGluIHBhaXJzKHNlbGYuT2JqZWN0cykgZG8KICAgICAgICAgICAgaWYgZGF0YS50eXBlID09IHR5cGVOYW1lIHRoZW4KICAgICAgICAgICAgICAgIHNlbGY6UmVtb3ZlKG1vZGVsKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCl9HLkVTUE1hbmFnZXIgPSBFU1BNYW5hZ2VyCgoKLS0gUGjhuqduIFTh" ..
    "uqFvIE7DunQgR3VpCgotLSDwn5+iIERSQUdHQUJMRSBVSSBCVVRUT04gV0lUSCBFTkhBTkNFRCBDTElDSyBBTkQgSE9WRVIgQU5JTUFUSU9OUwpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIikKbG9jYWwgQ29yZUd1aSA9IGdhbWU6R2V0U2VydmljZSgiQ29yZUd1aSIpCmxvY2FsIFR3ZWVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIikKCi0tIFjDs2EgbuG6v3UgY8OzIFVJIG1pbmltaXplIGPFqQpsb2NhbCBFeGlzdGluZ1VJID0gQ29yZUd1aTpGaW5kRmlyc3RDaGlsZCgiSHV0YW9IdWJNaW5pbWl6ZVVJIikKaWYgRXhpc3RpbmdVSSB0aGVuCiAgICBFeGlzdGluZ1VJOkRlc3Ryb3koKQplbmQKCi0tIENyZWF0ZSBGbG9hdGluZyBVSQpsb2NhbCBEcmFnVUkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCkRyYWdVSS5OYW1lID0gIkh1dGFvSHViTWluaW1pemVVSSIKRHJhZ1VJLlJlc2V0T25TcGF3biA9IGZhbHNlCkRyYWdVSS5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuU2libGluZwpEcmFnVUkuUGFyZW50ID0gQ29yZUd1aQoKLS0gQ3JlYXRlIENpcmN1bGFyIEJ1dHRvbgpsb2NhbCBCdXR0b24gPSBJbnN0YW5jZS5uZXcoIkltYWdlQnV0dG9uIikKQnV0dG9uLlBhcmVudCA9IERyYWdVSQpCdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLCA1MCwgMCwgNTApCkJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygw" ..
    "LCAxMCwgMSwgLTg1KQpCdXR0b24uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDMwLCAzMCwgMzApCkJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4zCkJ1dHRvbi5Cb3JkZXJTaXplUGl4ZWwgPSAwCkJ1dHRvbi5DbGlwc0Rlc2NlbmRhbnRzID0gdHJ1ZQpCdXR0b24uSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzc4OTE2MjQyNTQzMjA1IiAtLSBUaGF5IGljb24gbuG6v3UgbXXhu5FuCkJ1dHRvbi5TY2FsZVR5cGUgPSBFbnVtLlNjYWxlVHlwZS5GaXQKQnV0dG9uLkFjdGl2ZSA9IHRydWUKQnV0dG9uLlpJbmRleCA9IDEwMDAKCi0tIE1ha2UgVUkgQ2lyY3VsYXIKbG9jYWwgVUlDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKVUlDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMSwgMCkKVUlDb3JuZXIuUGFyZW50ID0gQnV0dG9uCgotLSBUd2VlbiBJbmZvIGZvciBBbmltYXRpb25zCmxvY2FsIHR3ZWVuSW5mbyA9IFR3ZWVuSW5mby5uZXcoMC4xLCBFbnVtLkVhc2luZ1N0eWxlLlF1YWQsIEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCkKCi0tIPCfn6IgVG9nZ2xlIEZsdWVudCBVSSB0cuG7sWMgdGnhur9wCmxvY2FsIGZ1bmN0aW9uIFRvZ2dsZVVJKCkKICAgIGlmIFdpbmRvdy5NaW5pbWl6ZWQgdGhlbgogICAgICAgIFdpbmRvdzpNaW5pbWl6ZShmYWxzZSkgLS0gbeG7nyBs4bqhaQogICAgZWxzZQogICAgICAgIFdpbmRvdzpNaW5pbWl6ZSh0cnVlKSAtLSB0aHUgbmjhu48KICAg" ..
    "IGVuZAplbmQKCi0tIENsaWNrIEFuaW1hdGlvbiAmIFVJIFRvZ2dsZQpsb2NhbCBpc0RyYWdnaW5nID0gZmFsc2UKbG9jYWwgZHJhZ1RocmVzaG9sZCA9IDEwCgpCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICBpZiBpc0RyYWdnaW5nIHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tIENsaWNrIGFuaW1hdGlvbgogICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShCdXR0b24sIHR3ZWVuSW5mbywgewogICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjUsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA0NSwgMCwgNDUpLAogICAgICAgIFJvdGF0aW9uID0gNQogICAgfSk6UGxheSgpCiAgICB0YXNrLndhaXQoMC4xKQogICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShCdXR0b24sIHR3ZWVuSW5mbywgewogICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjMsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA1MCwgMCwgNTApLAogICAgICAgIFJvdGF0aW9uID0gMAogICAgfSk6UGxheSgpCgogICAgVG9nZ2xlVUkoKQplbmQpCgotLSBIb3ZlciBBbmltYXRpb24KQnV0dG9uLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKEJ1dHRvbiwgdHdlZW5JbmZvLCB7U2l6ZSA9IFVEaW0yLm5ldygwLCA1NSwgMCwgNTUpfSk6UGxheSgpCmVuZCkKCkJ1dHRvbi5Nb3VzZUxlYXZlOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgVHdlZW5TZXJ2aWNl" ..
    "OkNyZWF0ZShCdXR0b24sIHR3ZWVuSW5mbywge1NpemUgPSBVRGltMi5uZXcoMCwgNTAsIDAsIDUwKX0pOlBsYXkoKQplbmQpCgotLSBEcmFnZ2luZyBMb2dpYyBmb3IgUEMgJiBNb2JpbGUKbG9jYWwgZHJhZ2dpbmcsIGRyYWdTdGFydCwgc3RhcnRQb3MKCmxvY2FsIGZ1bmN0aW9uIFN0YXJ0RHJhZyhpbnB1dCkKICAgIGlzRHJhZ2dpbmcgPSBmYWxzZQogICAgZHJhZ2dpbmcgPSB0cnVlCiAgICBkcmFnU3RhcnQgPSBpbnB1dC5Qb3NpdGlvbgogICAgc3RhcnRQb3MgPSBCdXR0b24uUG9zaXRpb24KCiAgICBpbnB1dC5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFN0YXRlID09IEVudW0uVXNlcklucHV0U3RhdGUuRW5kIHRoZW4KICAgICAgICAgICAgZHJhZ2dpbmcgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCmxvY2FsIGZ1bmN0aW9uIE9uRHJhZyhpbnB1dCkKICAgIGlmIGRyYWdnaW5nIHRoZW4KICAgICAgICBsb2NhbCBkZWx0YSA9IChpbnB1dC5Qb3NpdGlvbiAtIGRyYWdTdGFydCkuTWFnbml0dWRlCiAgICAgICAgaWYgZGVsdGEgPiBkcmFnVGhyZXNob2xkIHRoZW4KICAgICAgICAgICAgaXNEcmFnZ2luZyA9IHRydWUKICAgICAgICBlbmQKICAgICAgICBCdXR0b24uUG9zaXRpb24gPSBVRGltMi5uZXcoCiAgICAgICAgICAgIHN0YXJ0UG9zLlguU2NhbGUsCiAgICAgICAgICAgIHN0YXJ0UG9zLlguT2Zmc2V0ICsgKGlucHV0LlBvc2l0aW9uLlggLSBk" ..
    "cmFnU3RhcnQuWCksCiAgICAgICAgICAgIHN0YXJ0UG9zLlkuU2NhbGUsCiAgICAgICAgICAgIHN0YXJ0UG9zLlkuT2Zmc2V0ICsgKGlucHV0LlBvc2l0aW9uLlkgLSBkcmFnU3RhcnQuWSkKICAgICAgICApCiAgICBlbmQKZW5kCgotLSBEcmFnZ2luZyBTdXBwb3J0CkJ1dHRvbi5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgIFN0YXJ0RHJhZyhpbnB1dCkKICAgIGVuZAplbmQpCgpCdXR0b24uSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICBPbkRyYWcoaW5wdXQpCiAgICBlbmQKZW5kKSAgCgoKLS0gVGFiLkRldgoKbG9jYWwgT3B0aW9ucyA9IEZsdWVudC5PcHRpb25zCgoKICAgIFRhYnMuRGV2OkFkZFBhcmFncmFwaCh7CiAgICAgICAgVGl0bGUgPSAiTm90ZSIsCiAgICAgICAgQ29udGVudCA9ICJUaGFuayB5b3UgZm9yIHVzaW5nIHRoZSBzY3JpcHQhIgogICAgfSkKCiAgICBUYWJzLkRldjpBZGRTZWN0aW9uKCLihrMgTGlua3MiKQoKICAg" ..
    "IFRhYnMuRGV2OkFkZEJ1dHRvbih7CiAgICAgICAgVGl0bGUgPSAiRGlzY29yZCIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiQ29weSB0aGUgbGluayB0byBqb2luIHRoZSBkaXNjb3JkISIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIHNldGNsaXBib2FyZCgiaHR0cHM6Ly9kaXNjb3JkLmdnL1dFR1Q5Mnl2IikKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJOb3RpZmljYXRpb24iLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJTdWNjZXNzZnVsbHkgY29waWVkIHRvIHRoZSBjbGlwYm9hcmQiLAogICAgICAgICAgICAgICAgU3ViQ29udGVudCA9ICIiLCAtLSBPcHRpb25hbAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSAzIAogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgfSkKCgoKICAgIFRhYnMuRGV2OkFkZEJ1dHRvbih7CiAgICAgICAgVGl0bGUgPSAiWW91dHViZSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiQ29weSBsaW5rIHRvIFN1YnNjcmliZSB0byBZb3V0dWJlIGNoYW5uZWwhIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgc2V0Y2xpcGJvYXJkKCJodHRwczovL3d3dy55b3V0dWJlLmNvbS9AU0xLZ2FtaW5nU1NSIikKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJOb3RpZmljYXRpb24iLAogICAgICAgICAgICAgICAgQ29udGVudCA9" ..
    "ICJTdWNjZXNzZnVsbHkgY29waWVkIHRvIHRoZSBjbGlwYm9hcmQhIiwKICAgICAgICAgICAgICAgIFN1YkNvbnRlbnQgPSAiIiwgLS0gT3B0aW9uYWwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMyAKICAgICAgICAgICAgfSkKICAgICAgICBlbmQKICAgIH0pCgoKICAgIFRhYnMuRGV2OkFkZEJ1dHRvbih7CiAgICAgICAgVGl0bGUgPSAiRmFjZWJvb2siLAogICAgICAgIERlc2NyaXB0aW9uID0gIkNvcHkgbGluayB0byBqb2luIGZhY2Vib29rIGdyb3VwISIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIHNldGNsaXBib2FyZCgiaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL2dyb3Vwcy8xMTgwODQ1NDYzMzA3MDg3Lz9yZWY9c2hhcmUmbWliZXh0aWQ9TlNNV0JUIikKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJOb3RpZmljYXRpb24iLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJTdWNjZXNzZnVsbHkgY29waWVkIHRvIHRoZSBjbGlwYm9hcmQhIiwKICAgICAgICAgICAgICAgIFN1YkNvbnRlbnQgPSAiIiwgLS0gT3B0aW9uYWwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMyAKICAgICAgICAgICAgfSkKICAgICAgICBlbmQKICAgIH0pCgotLSBUYWJzLkZhcm0KCgoKCmRvCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRT" ..
    "ZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCiAgICBsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCiAgICBsb2NhbCBBY3RpdmUgPSBmYWxzZQogICAgbG9jYWwgbG9vcFJ1bm5pbmcgPSBmYWxzZQogICAgbG9jYWwgQ3VycmVudFRhcmdldCA9IG5pbAogICAgbG9jYWwgbGFzdEF0dGFjayA9IDAKCiAgICAtLSDwn5+lIENo4buJIGNo4bqheSBraGkgbMOgIGPDoWMgbW9kZWwgbsOgeQogICAgbG9jYWwgS2lsbGVyc0xpc3QgPSB7CiAgICAgICAgWyJTbGFzaGVyIl0gPSB0cnVlLAogICAgICAgIFsiMXgxeDF4MSJdID0gdHJ1ZSwKICAgICAgICBbImMwMGxraWRkIl0gPSB0cnVlLAogICAgICAgIFsiTm9saSJdID0gdHJ1ZSwKICAgICAgICBbIkpvaG5Eb2UiXSA9IHRydWUsCiAgICAgICAgWyJHdWVzdCA2NjYiXSA9IHRydWUsCiAgICAgICAgWyJTaXhlciJdID0gdHJ1ZSwKICAgIH0KCiAgICAtLSDwn5+iIERhbmggc8OhY2ggxrB1IHRpw6puCiAgICBsb2NhbCBQcmlvcml0eUxpc3QgPSB7CiAgICAgICAgWyIwMjA2b2N0YXZpbyJdID0gdHJ1ZQogICAgfQoKICAgIC0tIPCflKUgRGFuaCBzw6FjaCBza2lsbCAoZnVsbCwgY8OzIHRo4buDIHRow6ptL2Lhu5t0IHRob+G6o2kgbcOhaSkKICAgIGxvY2FsIFNraWxsTGlzdCA9IHsKICAgICAgICAiU2xhc2giLCAiU3RhYiIsICJQdW5jaCIsCiAgICAgICAgIlZvaWRSdXNoIiwgIk5vdmEiLAogICAgICAgICJDb3JydXB0RW5lcmd5IiwgIkJlaGVhZCIs" ..
    "ICJHYXNoaW5nV291bmQiLAogICAgICAgICJNYXNzSW5mZWN0aW9uIiwgIkNvcnJ1cHROYXR1cmUiLCAiV2Fsa3NwZWVkT3ZlcnJpZGUiLCAiUGl6emFEZWxpdmVyeSIsCiAgICAgICAgIlVuc3RhYmxlRXllIiwgIkVudGFuZ2xlbWVudCIsCiAgICAgICAgIkRpZ2l0YWxGb290cHJpbnQiLCAiNDA0RXJyb3IiLAogICAgICAgICJSYWdpbmdQYWNlIiwgIkNhcnZpbmcgU2xhc2giLCAiRGVtb25pYyBQdXJzdWl0IiwKICAgICAgICAiSW5mZXJuYWwgQ3J5IiwgIkJsb29kIFJ1c2giCiAgICB9CgogICAgLS0gPT09PT09PT09PT09PT09PT09PT09CiAgICAtLSDwn5eh77iPIFJlbW90ZUV2ZW50IEZpbmRlcgogICAgLS0gPT09PT09PT09PT09PT09PT09PT09CiAgICBsb2NhbCBTa2lsbFJlbW90ZXMgPSB7fQoKICAgIGxvY2FsIGZ1bmN0aW9uIGZpbmRTa2lsbFJlbW90ZUZyb21CdXR0b24oYnV0dG9uKQogICAgICAgIGZvciBfLCBjb25uIGluIGlwYWlycyhnZXRjb25uZWN0aW9ucyhidXR0b24uTW91c2VCdXR0b24xQ2xpY2spKSBkbwogICAgICAgICAgICBsb2NhbCBmID0gY29ubi5GdW5jdGlvbgogICAgICAgICAgICBpZiBmIGFuZCBpc2xjbG9zdXJlKGYpIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKGdldHVwdmFsdWVzKGYpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIHR5cGVvZih2KSA9PSAiSW5zdGFuY2UiIGFuZCB2OklzQSgiUmVtb3RlRXZlbnQiKSB0aGVuCiAgICAgICAgICAgICAgICAg" ..
    "ICAgICAgIHJldHVybiB2CiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIG5pbAogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gaW5pdFNraWxsQnV0dG9ucygpCiAgICAgICAgbG9jYWwgZ3VpID0gTG9jYWxQbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIlBsYXllckd1aSIpCiAgICAgICAgaWYgbm90IGd1aSB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBtYWluVUkgPSBndWk6RmluZEZpcnN0Q2hpbGQoIk1haW5VSSIpCiAgICAgICAgbG9jYWwgY29udGFpbmVyID0gbWFpblVJIGFuZCBtYWluVUk6RmluZEZpcnN0Q2hpbGQoIkFiaWxpdHlDb250YWluZXIiKQogICAgICAgIGlmIG5vdCBjb250YWluZXIgdGhlbiByZXR1cm4gZW5kCgogICAgICAgIGZvciBfLCBjaGlsZCBpbiBpcGFpcnMoY29udGFpbmVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIGNoaWxkOklzQSgiSW1hZ2VCdXR0b24iKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCByZW1vdGUgPSBmaW5kU2tpbGxSZW1vdGVGcm9tQnV0dG9uKGNoaWxkKQogICAgICAgICAgICAgICAgaWYgcmVtb3RlIHRoZW4KICAgICAgICAgICAgICAgICAgICBTa2lsbFJlbW90ZXNbY2hpbGQuTmFtZV0gPSByZW1vdGUKICAgICAgICAgICAgICAgICAgICB3YXJuKCJbU2tpbGxdIEZvdW5kIFJlbW90ZUV2ZW50IGZvcjoiLCBjaGlsZC5OYW1lLCByZW1v" ..
    "dGU6R2V0RnVsbE5hbWUoKSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGluaXRTa2lsbEJ1dHRvbnMoKQogICAgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgaW5pdFNraWxsQnV0dG9ucygpCiAgICBlbmQpCgogICAgLS0gPT09PT09PT09PT09PT09PT09PT09CiAgICAtLSDwn46vIFRhcmdldCBGaW5kZXIKICAgIC0tID09PT09PT09PT09PT09PT09PT09PQogICAgbG9jYWwgZnVuY3Rpb24gR2V0UHJpb3JpdHlUYXJnZXQoKQogICAgICAgIGxvY2FsIHN1cnZpdm9yc0ZvbGRlciA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiUGxheWVycyIpIGFuZCB3b3Jrc3BhY2UuUGxheWVyczpGaW5kRmlyc3RDaGlsZCgiU3Vydml2b3JzIikKICAgICAgICBpZiBub3Qgc3Vydml2b3JzRm9sZGVyIHRoZW4gcmV0dXJuIG5pbCBlbmQKCiAgICAgICAgZm9yIF8sIHN1cnZpdm9yIGluIGlwYWlycyhzdXJ2aXZvcnNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgc3Vydml2b3I6SXNBKCJNb2RlbCIpIGFuZCBzdXJ2aXZvcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIGlmIFByaW9yaXR5TGlzdFtzdXJ2aXZvci5OYW1lXSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBzdXJ2" ..
    "aXZvcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCBhbmQgaHVtYW5vaWQuSGVhbHRoID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXJ2aXZvcgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBuaWwKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIEdldENsb3Nlc3RTdXJ2aXZvcigpCiAgICAgICAgbG9jYWwgcHJpb3JpdHlUYXJnZXQgPSBHZXRQcmlvcml0eVRhcmdldCgpCiAgICAgICAgaWYgcHJpb3JpdHlUYXJnZXQgdGhlbiByZXR1cm4gcHJpb3JpdHlUYXJnZXQgZW5kCgogICAgICAgIGxvY2FsIGxvY2FsQ2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCAobG9jYWxDaGFyIGFuZCBsb2NhbENoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSkgdGhlbiByZXR1cm4gbmlsIGVuZAogICAgICAgIGxvY2FsIHN1cnZpdm9yc0ZvbGRlciA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiUGxheWVycyIpIGFuZCB3b3Jrc3BhY2UuUGxheWVyczpGaW5kRmlyc3RDaGlsZCgiU3Vydml2b3JzIikKICAgICAgICBpZiBub3Qgc3Vydml2b3JzRm9sZGVyIHRoZW4gcmV0dXJuIG5pbCBlbmQKCiAgICAgICAgbG9jYWwgY2xvc2VzdCwgbWluRGlzdCA9IG5pbCwgbWF0aC5odWdl" ..
    "CiAgICAgICAgZm9yIF8sIHN1cnZpdm9yIGluIGlwYWlycyhzdXJ2aXZvcnNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBzdXJ2aXZvcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgaWYgc3Vydml2b3I6SXNBKCJNb2RlbCIpIGFuZCBzdXJ2aXZvcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIGFuZCBodW1hbm9pZCBhbmQgaHVtYW5vaWQuSGVhbHRoID4gMCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBkaXN0ID0gKGxvY2FsQ2hhci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uIC0gc3Vydml2b3IuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICBpZiBkaXN0IDwgbWluRGlzdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbWluRGlzdCA9IGRpc3QKICAgICAgICAgICAgICAgICAgICBjbG9zZXN0ID0gc3Vydml2b3IKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gY2xvc2VzdAogICAgZW5kCgogICAgLS0gPT09PT09PT09PT09PT09PT09PT09CiAgICAtLSDwn5eh77iPIEtpbGwgTG9naWMgKHNwYW0gbmhhbmggKyBSZW1vdGUgKyBVSSBDbGljaykKICAgIC0tID09PT09PT09PT09PT09PT09PT09PQogICAgbG9jYWwgZnVuY3Rpb24gS2lsbFRhcmdldCh0YXJnZXQpCiAgICAgICAgcGNhbGwoZnVuY3Rp" ..
    "b24oKQogICAgICAgICAgICBpZiBub3QgdGFyZ2V0IHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCBsb2NhbENoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgaWYgbm90IChsb2NhbENoYXIgYW5kIGxvY2FsQ2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpKSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgIGxvY2FsIHJvb3QgPSBsb2NhbENoYXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICBsb2NhbCB0YXJnZXRSb290ID0gdGFyZ2V0OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgaWYgbm90IHRhcmdldFJvb3QgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICAtLSBTcGFtIHNraWxsICht4buXaSAwLjA1cykKICAgICAgICAgICAgaWYgdGljaygpIC0gbGFzdEF0dGFjayA+PSAwLjA1IHRoZW4KICAgICAgICAgICAgICAgIGxhc3RBdHRhY2sgPSB0aWNrKCkKCiAgICAgICAgICAgICAgICBmb3IgXywgc2tpbGxOYW1lIGluIGlwYWlycyhTa2lsbExpc3QpIGRvCiAgICAgICAgICAgICAgICAgICAgLS0gbHXDtG4gY+G6rXAgbmjhuq10IHbhu4sgdHLDrSBzw6F0IGzGsG5nIHRhcmdldCB0csaw4bubYyBraGkgZMO5bmcgc2tpbGwKICAgICAgICAgICAgICAgICAgICBsb2NhbCBvZmZzZXQgPSB0YXJnZXRSb290LkNGcmFtZS5Mb29rVmVjdG9yICogLTIKICAgICAgICAgICAgICAgICAgICByb290LkNGcmFtZSA9IHRh" ..
    "cmdldFJvb3QuQ0ZyYW1lICsgb2Zmc2V0CgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHJlbW90ZSA9IFNraWxsUmVtb3Rlc1tza2lsbE5hbWVdCiAgICAgICAgICAgICAgICAgICAgaWYgcmVtb3RlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgLS0gQ8OhY2ggMTogRmlyZVNlcnZlciB0cuG7sWMgdGnhur9wCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZTpGaXJlU2VydmVyKHRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAwNSkKICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlOkZpcmVTZXJ2ZXIoZmFsc2UpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAtLSBDw6FjaCAyOiBHaeG6oyBjbGljayBuw7p0IHNraWxsIHRyb25nIEdVSQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBndWkgPSBMb2NhbFBsYXllcjpGaW5kRmlyc3RDaGlsZCgiUGxheWVyR3VpIikKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbWFpblVJID0gZ3VpIGFuZCBndWk6RmluZEZpcnN0Q2hpbGQoIk1haW5VSSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvbnRhaW5lciA9IG1haW5VSSBhbmQgbWFpblVJOkZpbmRGaXJzdENoaWxkKCJBYmlsaXR5Q29udGFpbmVyIikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29udGFpbmVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGJ1dHRvbiA9IGNvbnRh" ..
    "aW5lcjpGaW5kRmlyc3RDaGlsZChza2lsbE5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBidXR0b24gYW5kIGJ1dHRvbjpJc0EoIkltYWdlQnV0dG9uIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBjb25uIGluIGlwYWlycyhnZXRjb25uZWN0aW9ucyhidXR0b24uTW91c2VCdXR0b24xQ2xpY2spKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjb25uLkZ1bmN0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGNvbm4uRnVuY3Rpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgYnV0dG9uOkFjdGl2YXRlKCkgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgLS0gZmFsbGJhY2sgY3Xhu5FpIGPDuW5nOiBSZW1vdGUgZ+G7kWMgdHJvbmcgUmVwbGljYXRlZFN0b3JhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbmV0ID0gUmVwbGljYXRlZFN0b3JhZ2U6RmluZEZpcnN0Q2hpbGQoIk1vZHVsZXMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgUmVwbGljYXRlZFN0" ..
    "b3JhZ2UuTW9kdWxlczpGaW5kRmlyc3RDaGlsZCgiTmV0d29yayIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBSZXBsaWNhdGVkU3RvcmFnZS5Nb2R1bGVzLk5ldHdvcms6RmluZEZpcnN0Q2hpbGQoIlJlbW90ZUV2ZW50IikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmV0IGFuZCB0eXBlb2YobmV0LkZpcmVTZXJ2ZXIpID09ICJmdW5jdGlvbiIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0OkZpcmVTZXJ2ZXIoIlVzZUFjdG9yQWJpbGl0eSIsIHNraWxsTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAxKSAtLSBnaeG7ryBuaOG7i3AgbmhhbmgKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKCiAgICAtLSA9PT09PT09PT09PT09PT09PT09PT0KICAgIC0tIPCflIQgTWFpbiBMb29wCiAgICAtLSA9PT09PT09PT09PT09PT09PT09PT0KICAgIGxvY2FsIGZ1bmN0aW9uIFN0YXJ0TG9vcCgpCiAgICAgICAgaWYgbG9vcFJ1bm5pbmcgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9vcFJ1bm5pbmcgPSB0cnVlCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIEFjdGl2ZSBkbwogICAgICAgICAgICAgICAgLS0g8J+bkSBO4bq/dSBraMO0bmcgcGjhuqNpIGtpbGxlciBo" ..
    "4bujcCBs4buHIHRow6wga2jDtG5nIGzDoG0gZ8OsCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBpZiBub3QgKGNoYXIgYW5kIEtpbGxlcnNMaXN0W2NoYXIuTmFtZV0pIHRoZW4KICAgICAgICAgICAgICAgICAgICBDdXJyZW50VGFyZ2V0ID0gbmlsCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgbm90IEN1cnJlbnRUYXJnZXQgCiAgICAgICAgICAgICAgICAgICBvciBub3QgQ3VycmVudFRhcmdldC5QYXJlbnQgCiAgICAgICAgICAgICAgICAgICBvciBub3QgQ3VycmVudFRhcmdldDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikgCiAgICAgICAgICAgICAgICAgICBvciBDdXJyZW50VGFyZ2V0OkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKS5IZWFsdGggPD0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgQ3VycmVudFRhcmdldCA9IEdldENsb3Nlc3RTdXJ2aXZvcigpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIEN1cnJlbnRUYXJnZXQgdGhlbgogICAgICAgICAgICAgICAgICAgIEtpbGxUYXJnZXQoQ3VycmVudFRhcmdldCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgIGVuZAogICAg" ..
    "ICAgICAgICBsb29wUnVubmluZyA9IGZhbHNlCiAgICAgICAgZW5kKQogICAgZW5kCgogICAgVGFicy5GYXJtOkFkZFRvZ2dsZSgiS2lsbGVyc0Zhcm1WMiIsIHsKICAgICAgICBUaXRsZSA9ICJLaWxsZXJzIEZhcm0gVjIiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgICAgICBBY3RpdmUgPSBWYWx1ZQogICAgICAgICAgICBpZiBBY3RpdmUgdGhlbgogICAgICAgICAgICAgICAgU3RhcnRMb29wKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQplbmQKCgoKCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBMUCA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCmxvY2FsIHNvbHZlR2VuZXJhdG9yQ29vbGRvd24gPSBmYWxzZQpsb2NhbCBnZW5EZWxheSA9IDAuNzUgLS0gZGVsYXkgbeG6t2MgxJHhu4tuaApsb2NhbCBjdXJyZW50Q2hhcmFjdGVyCmxvY2FsIFNwZWN0YXRvcnMgPSB7fQpsb2NhbCBpc0luR2FtZSwgU3Vydml2b3IgPSBmYWxzZSwgZmFsc2UKCi0tIPCfn6UgS2lsbGVyIG5ndXkgaGnhu4NtCmxvY2FsIERhbmdlcm91c0tpbGxlcnMgPSB7CiAgICBbIlNsYXNoZXIiXSA9IHRydWUsCiAgICBbIjF4MXgxeDEiXSA9IHRydWUsCiAgICBbImMwMGxraWRkIl0gPSB0cnVlLAogICAgWyJOb2xpIl0gPSB0cnVlLAogICAgWyJKb2huRG9lIl0gPSB0cnVlLAogICAgWyJHdWVzdCA2NjYiXSA9IHRy" ..
    "dWUsCiAgICBbIlNpeGVyIl0gPSB0cnVlCn0KCi0tIPCfn6IgS2nhu4NtIHRyYSBraWxsZXIgZ+G6p24gZ2VuZXJhdG9yCmxvY2FsIGZ1bmN0aW9uIGlzS2lsbGVyTmVhckdlbmVyYXRvcihnZW5lcmF0b3JQb3MsIGRpc3RhbmNlKQogICAgbG9jYWwga2lsbGVyc0ZvbGRlciA9IHdvcmtzcGFjZS5QbGF5ZXJzOkZpbmRGaXJzdENoaWxkKCJLaWxsZXJzIikKICAgIGlmIG5vdCBraWxsZXJzRm9sZGVyIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgZm9yIF8sIGtpbGxlciBpbiBpcGFpcnMoa2lsbGVyc0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIGtpbGxlcjpJc0EoIk1vZGVsIikgYW5kIGtpbGxlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgaWYgRGFuZ2Vyb3VzS2lsbGVyc1traWxsZXIuTmFtZV0gdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChraWxsZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbiAtIGdlbmVyYXRvclBvcykuTWFnbml0dWRlCiAgICAgICAgICAgICAgICBpZiBkaXN0IDw9IGRpc3RhbmNlIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKZW5kCgotLSDwn5+iIFTDrG0gZ2VuZXJhdG9yIGNoxrBhIHhvbmcgKGPhuq1wIG5o4bqtdCBnZW5EZWxheSBsdcO0bikKbG9jYWwg" ..
    "ZnVuY3Rpb24gZ2V0VW5maW5pc2hlZEdlbmVyYXRvcnMoKQogICAgbG9jYWwgbGlzdCA9IHt9CiAgICBsb2NhbCBtYXAgPSB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIk1hcCIpIAogICAgICAgIGFuZCB3b3Jrc3BhY2UuTWFwOkZpbmRGaXJzdENoaWxkKCJJbmdhbWUiKSAKICAgICAgICBhbmQgd29ya3NwYWNlLk1hcC5JbmdhbWU6RmluZEZpcnN0Q2hpbGQoIk1hcCIpCiAgICBpZiBtYXAgdGhlbgogICAgICAgIGZvciBfLCBnZW4gaW4gaXBhaXJzKG1hcDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBnZW4uTmFtZSA9PSAiR2VuZXJhdG9yIiAKICAgICAgICAgICAgICAgIGFuZCBnZW46RmluZEZpcnN0Q2hpbGQoIlByb2dyZXNzIikgCiAgICAgICAgICAgICAgICBhbmQgZ2VuLlByb2dyZXNzLlZhbHVlIDwgMTAwIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChsaXN0LCBnZW4pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0g4pqhIE7hur91IGNo4buJIGPDsm4gMSBnZW5lcmF0b3IgPT4gdMSDbmcgZGVsYXkgxJHhu4MgdHLDoW5oIGLhu4sga2ljawogICAgaWYgI2xpc3QgPT0gMSB0aGVuCiAgICAgICAgZ2VuRGVsYXkgPSAxLjUKICAgIGVsc2UKICAgICAgICBnZW5EZWxheSA9IDAuNzUKICAgIGVuZAoKICAgIHJldHVybiBsaXN0CmVuZAoKLS0g8J+foiBT4butYSAxIGzhuqduIHLhu5NpIG5o4bqjeSBzYW5nIGdlbmVyYXRvciBraMOhYwpsb2NhbCBmdW5j" ..
    "dGlvbiBmaXhPbmVHZW5lcmF0b3IoZ2VuKQogICAgaWYgc29sdmVHZW5lcmF0b3JDb29sZG93biB0aGVuIHJldHVybiBlbmQKICAgIGlmIG5vdCBjdXJyZW50Q2hhcmFjdGVyIG9yIG5vdCBjdXJyZW50Q2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgZ2VuQ0ZyYW1lID0gZ2VuOkdldFBpdm90KCkKICAgIGxvY2FsIGdvYWxQb3MgPSAoZ2VuQ0ZyYW1lICogQ0ZyYW1lLm5ldygwLCAwLCAtNykpLlBvc2l0aW9uCgogICAgaWYgaXNLaWxsZXJOZWFyR2VuZXJhdG9yKGdvYWxQb3MsIDUwKSB0aGVuCiAgICAgICAgcHJpbnQoIuKaoO+4jyBC4buPIHF1YSBnZW5lcmF0b3IgdsOsIGtpbGxlciBuZ3V5IGhp4buDbSBn4bqnbiEiKQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgLS0gVGVsZXBvcnQgdOG7m2kgZ2VuCiAgICBjdXJyZW50Q2hhcmFjdGVyOlBpdm90VG8oQ0ZyYW1lLm5ldyhnb2FsUG9zICsgVmVjdG9yMy5uZXcoMCwgMCwgMCkpKSAtLSBjaOG7iW5oIMSR4buZIGNhbywgxJHhu5kgbOG7h2NoCiAgICB0YXNrLndhaXQoMC4yNSkKCiAgICBsb2NhbCBwcm9tcHQgPSBnZW46RmluZEZpcnN0Q2hpbGQoIk1haW4iKSBhbmQgZ2VuLk1haW46RmluZEZpcnN0Q2hpbGQoIlByb21wdCIpCiAgICBpZiBwcm9tcHQgdGhlbgogICAgICAgIHByb21wdC5Ib2xkRHVyYXRpb24gPSAwCiAgICAgICAgcHJvbXB0LlJlcXVpcmVzTGluZU9mU2lnaHQgPSBm" ..
    "YWxzZQogICAgICAgIHByb21wdC5NYXhBY3RpdmF0aW9uRGlzdGFuY2UgPSA5OTk5OQoKICAgICAgICAtLSDhuqRuIMSR4buDIHPhu61hIDEgbOG6p24KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIHByb21wdDpJbnB1dEhvbGRCZWdpbigpCiAgICAgICAgICAgIHByb21wdDpJbnB1dEhvbGRFbmQoKQogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIGlmIGdlbjpGaW5kRmlyc3RDaGlsZCgiUmVtb3RlcyIpIGFuZCBnZW4uUmVtb3RlczpGaW5kRmlyc3RDaGlsZCgiUkUiKSB0aGVuCiAgICAgICAgZ2VuLlJlbW90ZXMuUkU6RmlyZVNlcnZlcigpCiAgICBlbmQKCiAgICAtLSDwn5S0IFNwYW0gdGjDqm0gdsOgaSBs4bqnbiDEkeG7gyBjaOG6r2MgY2jhuq9uIHRob8OhdCBHVUkgdHLGsOG7m2Mga2hpIMSRaSBnZW4ga2jDoWMKICAgIGlmIHByb21wdCB0aGVuCiAgICAgICAgdGFzay53YWl0KDApCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBmb3IgaSA9IDEsIDMgZG8KICAgICAgICAgICAgICAgIHByb21wdDpJbnB1dEhvbGRCZWdpbigpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMCkKICAgICAgICAgICAgICAgIHByb21wdDpJbnB1dEhvbGRFbmQoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKCiAgICAtLSBDb29sZG93bgogICAgc29sdmVHZW5lcmF0b3JDb29sZG93biA9IHRydWUKICAgIHRhc2suZGVsYXkoZ2VuRGVsYXksIGZ1bmN0aW9uKCkKICAgICAg" ..
    "ICBzb2x2ZUdlbmVyYXRvckNvb2xkb3duID0gZmFsc2UKICAgIGVuZCkKZW5kCgotLSDwn5+iIFN1cnZpdm9ycyBBdXRvIEZhcm0KVGFicy5GYXJtOkFkZFRvZ2dsZSgiU3Vydml2b3JzQXV0b0Zhcm1WMiIsIHsKICAgIFRpdGxlID0gIlN1cnZpdm9ycyBGYXJtIFYyIiwKICAgIERlZmF1bHQgPSBmYWxzZQp9KTpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpCiAgICBfRy5TdXJ2aXZvcnNGYXJtID0gVmFsdWUKCiAgICAtLSBD4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaSBpbi1nYW1lCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICB3aGlsZSBfRy5TdXJ2aXZvcnNGYXJtIGRvCiAgICAgICAgICAgIFNwZWN0YXRvcnMgPSB7fQogICAgICAgICAgICBmb3IgXywgdiBpbiBpcGFpcnMod29ya3NwYWNlOldhaXRGb3JDaGlsZCgiUGxheWVycyIpOldhaXRGb3JDaGlsZCgiU3BlY3RhdGluZyIpOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoU3BlY3RhdG9ycywgdi5OYW1lKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaXNJbkdhbWUgPSBub3QgdGFibGUuZmluZChTcGVjdGF0b3JzLCBMUC5OYW1lKQogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIC0tIEtp4buDbSB0cmEgc3Vydml2b3IKICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIF9HLlN1cnZpdm9yc0Zhcm0gZG8KICAgICAgICAgICAgaWYgd29y" ..
    "a3NwYWNlOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJzIikgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgc3Vydml2b3JzRm9sZGVyID0gd29ya3NwYWNlLlBsYXllcnM6RmluZEZpcnN0Q2hpbGQoIlN1cnZpdm9ycyIpCiAgICAgICAgICAgICAgICBTdXJ2aXZvciA9IHN1cnZpdm9yc0ZvbGRlciAKICAgICAgICAgICAgICAgICAgICBhbmQgKHN1cnZpdm9yc0ZvbGRlcjpGaW5kRmlyc3RDaGlsZChMUC5OYW1lKSAKICAgICAgICAgICAgICAgICAgICBvciB0YWJsZS5maW5kKHN1cnZpdm9yc0ZvbGRlcjpHZXRDaGlsZHJlbigpLCBMUC5DaGFyYWN0ZXIpKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICAtLSBBdXRvIHPhu61hIGdlbgogICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgc3Vydml2b3JzRm9sZGVyID0gd29ya3NwYWNlLlBsYXllcnM6V2FpdEZvckNoaWxkKCJTdXJ2aXZvcnMiKQogICAgICAgIHdoaWxlIF9HLlN1cnZpdm9yc0Zhcm0gZG8KICAgICAgICAgICAgaWYgU3Vydml2b3IgYW5kIGlzSW5HYW1lIHRoZW4KICAgICAgICAgICAgICAgIC0tIGzhuqV5IG5ow6JuIHbhuq10IGhp4buHbiB04bqhaQogICAgICAgICAgICAgICAgZm9yIF8sIHN1cnYgaW4gaXBhaXJzKHN1cnZpdm9yc0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIHN1cnY6R2V0QXR0cmlidXRlKCJVc2VybmFt" ..
    "ZSIpID09IExQLk5hbWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2hhcmFjdGVyID0gc3VydgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgLS0gdMOsbSBnZW4gY2jGsGEgeG9uZyB2w6Agc+G7rWEgMSBs4bqnbgogICAgICAgICAgICAgICAgbG9jYWwgZ2VucyA9IGdldFVuZmluaXNoZWRHZW5lcmF0b3JzKCkKICAgICAgICAgICAgICAgIGZvciBfLCBnZW4gaW4gaXBhaXJzKGdlbnMpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IF9HLlN1cnZpdm9yc0Zhcm0gdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICBmaXhPbmVHZW5lcmF0b3IoZ2VuKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdChnZW5EZWxheSkgLS0gc2F1IGtoaSBz4butYSB4b25nIHRow6wgbmjhuqN5IHF1YSBnZW4ga2jDoWMKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICBlbmQKICAgIGVuZCkKZW5kKQoKCgoKCgoKICAgIFRhYnMuRmFybTpBZGRTZWN0aW9uKCLihrMgR2VuZXJhdG9yIikKCmRvCmxvY2FsIHNvbHZlR2VuZXJhdG9yQ29vbGRvd24gPSBmYWxzZQpsb2NhbCBBdXRvRmluaXNoR2VuID0gZmFsc2UKbG9jYWwgZ2VuRGVsYXkgPSAxLjUgLS0gbeG6t2MgxJHhu4tuaCAxLjVzCgotLSBIw6BtIHTD" ..
    "rG0gZ2VuZXJhdG9yIGfhuqduIG5o4bqldApsb2NhbCBmdW5jdGlvbiBnZXRDbG9zZXN0R2VuZXJhdG9yKCkKICAgIGxvY2FsIGNoYXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBpZiBub3QgY2hhciBvciBub3QgY2hhci5QcmltYXJ5UGFydCB0aGVuIHJldHVybiBuaWwgZW5kCgogICAgbG9jYWwgcm9vdCA9IGNoYXIuUHJpbWFyeVBhcnQKICAgIGxvY2FsIGNsb3Nlc3QsIHNob3J0ZXN0RGlzdCA9IG5pbCwgbWF0aC5odWdlCgogICAgbG9jYWwgbWFwQ29udGFpbmVyID0gd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJNYXAiKQogICAgaWYgbWFwQ29udGFpbmVyIHRoZW4KICAgICAgICBsb2NhbCBpbmdhbWUgPSBtYXBDb250YWluZXI6RmluZEZpcnN0Q2hpbGQoIkluZ2FtZSIpCiAgICAgICAgaWYgaW5nYW1lIHRoZW4KICAgICAgICAgICAgbG9jYWwgbWFwID0gaW5nYW1lOkZpbmRGaXJzdENoaWxkKCJNYXAiKQogICAgICAgICAgICBpZiBtYXAgdGhlbgogICAgICAgICAgICAgICAgZm9yIF8sIG9iaiBpbiBpcGFpcnMobWFwOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgb2JqLk5hbWUgPT0gIkdlbmVyYXRvciIgYW5kIG9iajpJc0EoIk1vZGVsIikgYW5kIG9iai5QcmltYXJ5UGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAocm9vdC5Qb3NpdGlvbiAtIG9iai5QcmltYXJ5UGFydC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAg" ..
    "ICAgICAgICAgICAgICAgICAgIGlmIGRpc3QgPCBzaG9ydGVzdERpc3QgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VzdCA9IG9iagogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvcnRlc3REaXN0ID0gZGlzdAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIGNsb3Nlc3QKZW5kCgotLSBOw7p0IEZpbmlzaCBnZW5lcmF0b3IgdGjhu6cgY8O0bmcKVGFicy5GYXJtOkFkZEJ1dHRvbih7CiAgICBUaXRsZSA9ICJGaW5pc2ggR2VuZXJhdG9yIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGlmIHNvbHZlR2VuZXJhdG9yQ29vbGRvd24gdGhlbiAKICAgICAgICAgICAgcHJpbnQoIuKPsyBQbGVhc2Ugd2FpdCBiZWZvcmUgdHJ5aW5nIGFnYWluISIpIAogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICBpZiBBdXRvRmluaXNoR2VuIHRoZW4KICAgICAgICAgICAgcHJpbnQoIuKdjCBQbGVhc2UgZGlzYWJsZSBBdXRvIEZpbmlzaCBHZW5lcmF0b3IgZmlyc3QhIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGdlbiA9IGdldENsb3Nlc3RHZW5lcmF0b3IoKQogICAgICAgIGlmIGdlbiBhbmQgZ2VuOkZpbmRGaXJzdENoaWxkKCJSZW1vdGVzIikgYW5kIGdlbi5SZW1v" ..
    "dGVzOkZpbmRGaXJzdENoaWxkKCJSRSIpIHRoZW4KICAgICAgICAgICAgZ2VuLlJlbW90ZXMuUkU6RmlyZVNlcnZlcigpCiAgICAgICAgICAgIHNvbHZlR2VuZXJhdG9yQ29vbGRvd24gPSB0cnVlCiAgICAgICAgICAgIHRhc2suZGVsYXkoZ2VuRGVsYXksIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHNvbHZlR2VuZXJhdG9yQ29vbGRvd24gPSBmYWxzZQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFRvZ2dsZSBBdXRvIEZpbmlzaCBHZW5lcmF0b3IKVGFicy5GYXJtOkFkZFRvZ2dsZSgiQXV0b0ZpbmlzaEdlbiIsIHsKICAgIFRpdGxlID0gIkF1dG8gRmluaXNoIEdlbmVyYXRvciIsCiAgICBEZWZhdWx0ID0gZmFsc2UKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHN0YXRlKQogICAgQXV0b0ZpbmlzaEdlbiA9IHN0YXRlCgogICAgaWYgc3RhdGUgdGhlbgogICAgICAgIGlmIHNvbHZlR2VuZXJhdG9yQ29vbGRvd24gdGhlbgogICAgICAgICAgICBwcmludCgi4pqg77iPIFBsZWFzZSB3YWl0IGNvb2xkb3duIGJlZm9yZSBlbmFibGluZyBBdXRvIEZpbmlzaCEiKSAKICAgICAgICAgICAgRmx1ZW50Lk9wdGlvbnMuQXV0b0ZpbmlzaEdlbjpTZXRWYWx1ZShmYWxzZSkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBBdXRvRmluaXNoR2VuIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBnZW4gPSBnZXRD" ..
    "bG9zZXN0R2VuZXJhdG9yKCkKICAgICAgICAgICAgICAgIGlmIGdlbiBhbmQgZ2VuOkZpbmRGaXJzdENoaWxkKCJSZW1vdGVzIikgYW5kIGdlbi5SZW1vdGVzOkZpbmRGaXJzdENoaWxkKCJSRSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBnZW4uUmVtb3Rlcy5SRTpGaXJlU2VydmVyKCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgc29sdmVHZW5lcmF0b3JDb29sZG93biA9IHRydWUKICAgICAgICAgICAgICAgIHRhc2sud2FpdChnZW5EZWxheSkKICAgICAgICAgICAgICAgIHNvbHZlR2VuZXJhdG9yQ29vbGRvd24gPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbHNlCiAgICAgICAgc29sdmVHZW5lcmF0b3JDb29sZG93biA9IGZhbHNlCiAgICBlbmQKZW5kKQoKCi0tIMOUIG5o4bqtcCBkZWxheQpUYWJzLkZhcm06QWRkSW5wdXQoIkdlbkRlbGF5SW5wdXQiLCB7CiAgICBUaXRsZSA9ICJFbnRlciBEZWxheSIsCiAgICBEZWZhdWx0ID0gIjEuNSIsCiAgICBQbGFjZWhvbGRlciA9ICJXcml0ZSBIZXJlICgxLjUtMTApIiwKICAgIE51bWVyaWMgPSB0cnVlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBudW0gPSB0b251bWJlcih2YWx1ZSkKICAgICAgICBpZiBudW0gdGhlbgogICAgICAgICAgICAtLSBDbGFtcCBnacOhIHRy4buLIHThu6sgMS41IMSR4bq/biAxMAogICAgICAgICAgICBnZW5EZWxheSA9IG1hdGguY2xhbXAobnVtLCAx" ..
    "LjUsIDEwKQogICAgICAgICAgICBwcmludCgi4o+xIERlbGF5IHNldCB0bzoiLCBnZW5EZWxheSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHByaW50KCLimqDvuI8gTmjhuq1wIHPhu5EgaOG7o3AgbOG7hyEiKQogICAgICAgIGVuZAogICAgZW5kCn0pCmVuZAoKCmRvCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBQYXRoZmluZGluZ1NlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlBhdGhmaW5kaW5nU2VydmljZSIpCmxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIikKbG9jYWwgVXNlcklucHV0U2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVXNlcklucHV0U2VydmljZSIpCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCBMUCA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCi0tIPCflLkgQ2FuY2VsIHRva2VuIGNobyBwYXRoZmluZGluZwpsb2NhbCBoID0gMApfRy5QbGF5ZXJDb250cm9sbGVkID0gZmFsc2UKCi0tID09PT09PT09PT09PT09PT09PT09PT09PT0KLS0gIERBTkggU8OBQ0ggU1VSVklWT1JTIEjhu6JQIEzhu4YKLS0gPT09PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBBbGxvd2VkU3Vydml2b3JzID0gewogICAgWyJOb29iIl0gPSB0cnVlLCBbIkd1ZXN0MTMzNyJdID0g" ..
    "dHJ1ZSwgWyJFbGxpb3QiXSA9IHRydWUsCiAgICBbIlNoZWRsZXRza3kiXSA9IHRydWUsIFsiVHdvVGltZSJdID0gdHJ1ZSwgWyIwMDduNyJdID0gdHJ1ZSwgWyJWZWVyb25pY2EiXSA9IHRydWUsCiAgICBbIkNoYW5jZSJdID0gdHJ1ZSwgWyJCdWlsZGVybWFuIl0gPSB0cnVlLCBbIlRhcGgiXSA9IHRydWUsIFsiRHVzZWtrYXIiXSA9IHRydWUsCn0KCmxvY2FsIGZ1bmN0aW9uIGlzU3Vydml2b3JWYWxpZCgpCiAgICBsb2NhbCBjaGFyID0gTFAuQ2hhcmFjdGVyCiAgICBpZiBub3QgY2hhciB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIHJldHVybiBBbGxvd2VkU3Vydml2b3JzW2NoYXIuTmFtZV0gPT0gdHJ1ZQplbmQKCi0tID09PT09PT09PT09PT09PT09PT09PT09PT0KLS0gIFBIw4FUIEhJ4buGTiBOR8av4bucSSBDSMagSSDEkEnhu4BVIEtISeG7gk4KLS0gPT09PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBtb3ZlS2V5cyA9IHsKICAgIFtFbnVtLktleUNvZGUuV10gPSB0cnVlLCBbRW51bS5LZXlDb2RlLkFdID0gdHJ1ZSwgW0VudW0uS2V5Q29kZS5TXSA9IHRydWUsIFtFbnVtLktleUNvZGUuRF0gPSB0cnVlLAogICAgW0VudW0uS2V5Q29kZS5VcF0gPSB0cnVlLCBbRW51bS5LZXlDb2RlLkxlZnRdID0gdHJ1ZSwgW0VudW0uS2V5Q29kZS5Eb3duXSA9IHRydWUsIFtFbnVtLktleUNvZGUuUmlnaHRdID0gdHJ1ZSwKfQpsb2NhbCBhY3RpdmVJbnB1dHMsIGxhc3RNb3ZlVGljayA9IDAsIDAKbG9jYWwgSURMRV9H" ..
    "UkFDRSA9IDAuMjUKCmxvY2FsIGZ1bmN0aW9uIHNldENvbnRyb2xsZWQoZmxhZykKICAgIGlmIF9HLlBsYXllckNvbnRyb2xsZWQgfj0gZmxhZyB0aGVuCiAgICAgICAgX0cuUGxheWVyQ29udHJvbGxlZCA9IGZsYWcKICAgICAgICBpZiBmbGFnIHRoZW4gaCA9IGggKyAxIGVuZCAtLSBo4buneSBwYXRoIG5nYXkga2hpIG5nxrDhu51pIGNoxqFpIGNhbiB0aGnhu4dwCiAgICBlbmQKZW5kCgpVc2VySW5wdXRTZXJ2aWNlLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCwgZ3ApCiAgICBpZiBncCB0aGVuIHJldHVybiBlbmQKICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLktleWJvYXJkIGFuZCBtb3ZlS2V5c1tpbnB1dC5LZXlDb2RlXSB0aGVuCiAgICAgICAgYWN0aXZlSW5wdXRzICs9IDE7IHNldENvbnRyb2xsZWQodHJ1ZSkKICAgIGVsc2VpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5HYW1lcGFkMSB0aGVuCiAgICAgICAgYWN0aXZlSW5wdXRzICs9IDE7IHNldENvbnRyb2xsZWQodHJ1ZSkKICAgIGVsc2VpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgbG9jYWwgY2FtID0gd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEKICAgICAgICBpZiBjYW0gYW5kIGlucHV0LlBvc2l0aW9uLlggPCBjYW0uVmlld3BvcnRTaXplLlggKiAwLjUgdGhlbgogICAgICAgICAgICBhY3RpdmVJ" ..
    "bnB1dHMgKz0gMTsgc2V0Q29udHJvbGxlZCh0cnVlKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKClVzZXJJbnB1dFNlcnZpY2UuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuS2V5Ym9hcmQgYW5kIG1vdmVLZXlzW2lucHV0LktleUNvZGVdIHRoZW4KICAgICAgICBhY3RpdmVJbnB1dHMgPSBtYXRoLm1heCgwLCBhY3RpdmVJbnB1dHMgLSAxKQogICAgZWxzZWlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLkdhbWVwYWQxIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICBhY3RpdmVJbnB1dHMgPSBtYXRoLm1heCgwLCBhY3RpdmVJbnB1dHMgLSAxKQogICAgZW5kCiAgICBpZiBhY3RpdmVJbnB1dHMgPT0gMCB0aGVuIGxhc3RNb3ZlVGljayA9IHRpY2soKSBlbmQKZW5kKQoKUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICBsb2NhbCBodW0gPSBMUC5DaGFyYWN0ZXIgYW5kIExQLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgIGlmIG5vdCBodW0gdGhlbiByZXR1cm4gZW5kCiAgICBpZiBodW0uTW92ZURpcmVjdGlvbi5NYWduaXR1ZGUgPiAwIHRoZW4KICAgICAgICBsYXN0TW92ZVRpY2sgPSB0aWNrKCk7IHNldENvbnRyb2xsZWQodHJ1ZSkKICAgIGVsc2Vp" ..
    "ZiBhY3RpdmVJbnB1dHMgPT0gMCBhbmQgKHRpY2soKSAtIGxhc3RNb3ZlVGljaykgPj0gSURMRV9HUkFDRSB0aGVuCiAgICAgICAgc2V0Q29udHJvbGxlZChmYWxzZSkKICAgIGVuZAplbmQpCgotLSA9PT09PT09PT09PT09PT09PT09PT09PT09Ci0tICBQQVRIRklORElORwotLSA9PT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIGZ1bmN0aW9uIHBhdGhmaW5kVG8odGFyZ2V0UG9zKQogICAgbG9jYWwgaE5vdyA9IGgKICAgIGxvY2FsIGNoYXIgPSBMUC5DaGFyYWN0ZXIKICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgaHVtID0gY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgIGxvY2FsIHJvb3QgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGlmIG5vdCAoaHVtIGFuZCByb290KSB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBwYXRoID0gUGF0aGZpbmRpbmdTZXJ2aWNlOkNyZWF0ZVBhdGgoewogICAgICAgIEFnZW50UmFkaXVzID0gMiwgQWdlbnRIZWlnaHQgPSA1LAogICAgICAgIEFnZW50Q2FuSnVtcCA9IGZhbHNlLCBBZ2VudEp1bXBIZWlnaHQgPSAxMCwgQWdlbnRNYXhTbG9wZSA9IDQ1CiAgICB9KQoKICAgIGxvY2FsIG9rID0gcGNhbGwoZnVuY3Rpb24oKSBwYXRoOkNvbXB1dGVBc3luYyhyb290LlBvc2l0aW9uLCB0YXJnZXRQb3MpIGVuZCkKICAgIGlmIG5vdCBvayBvciBwYXRoLlN0YXR1cyB+PSBFbnVtLlBhdGhT" ..
    "dGF0dXMuU3VjY2VzcyB0aGVuIHJldHVybiBlbmQKCiAgICBmb3IgXywgd3AgaW4gaXBhaXJzKHBhdGg6R2V0V2F5cG9pbnRzKCkpIGRvCiAgICAgICAgaWYgaE5vdyB+PSBoIG9yIF9HLlBsYXllckNvbnRyb2xsZWQgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgaWYgbm90IChodW0gYW5kIHJvb3QgYW5kIHJvb3QuUGFyZW50KSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgaHVtOk1vdmVUbyh3cC5Qb3NpdGlvbikKICAgICAgICByZXBlYXQgdGFzay53YWl0KCkKICAgICAgICB1bnRpbCBoTm93IH49IGggb3IgX0cuUGxheWVyQ29udHJvbGxlZCBvciBub3Qgcm9vdC5QYXJlbnQKICAgICAgICAgICBvciAoKHJvb3QuUG9zaXRpb24gKiBWZWN0b3IzLm5ldygxLDAsMSkgLSB3cC5Qb3NpdGlvbiAqIFZlY3RvcjMubmV3KDEsMCwxKSkuTWFnbml0dWRlIDw9IDIpCgogICAgICAgIGlmIHdwLkFjdGlvbiA9PSBFbnVtLlBhdGhXYXlwb2ludEFjdGlvbi5KdW1wIHRoZW4gaHVtLkp1bXAgPSB0cnVlIGVuZAogICAgZW5kCmVuZAoKLS0gPT09PT09PT09PT09PT09PT09PT09PT09PQotLSAgSOG7liBUUuG7oiBLSeG7gk0gVFJBIEtJTExFUgotLSA9PT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIGZ1bmN0aW9uIGlzS2lsbGVyTmVhckdlbmVyYXRvcihnZW5lcmF0b3JQb3MsIGRpc3RhbmNlKQogICAgbG9jYWwga2lsbGVyc0ZvbGRlciA9IFdvcmtzcGFjZS5QbGF5ZXJzOkZpbmRGaXJzdENoaWxkKCJLaWxsZXJzIikKICAgIGlm" ..
    "IG5vdCBraWxsZXJzRm9sZGVyIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgZm9yIF8sIGtpbGxlciBpbiBpcGFpcnMoa2lsbGVyc0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGxvY2FsIGhycCA9IGtpbGxlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaWYgaHJwIGFuZCAoaHJwLlBvc2l0aW9uIC0gZ2VuZXJhdG9yUG9zKS5NYWduaXR1ZGUgPD0gZGlzdGFuY2UgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKZW5kCgotLSA9PT09PT09PT09PT09PT09PT09PT09PT09Ci0tICBUT0dHTEUgQVVUTyBXQUxLICYgRklYIEdFTkVSQVRPUlMKLS0gPT09PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBHZW5XYWxrVG9nZ2xlID0gVGFicy5GYXJtOkFkZFRvZ2dsZSgiR2VuV2Fsa1RvZ2dsZSIsIHsKICAgIFRpdGxlID0gIldhbGsgVG8gR2VuZXJhdG9yIiwKICAgIERlZmF1bHQgPSBmYWxzZQp9KQoKR2VuV2Fsa1RvZ2dsZTpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpCiAgICBfRy5BdXRvR2VuZXJhdG9ycyA9IFZhbHVlCiAgICBpZiBub3QgVmFsdWUgdGhlbiBoID0gaCArIDEgZW5kCgogICAgLS0gQXV0byBTcHJpbnQgKGPDsyBraeG7g20gc2/DoXQgc3RhbWluYSkKICAgIGlmIFZhbHVlIHRoZW4KICAgICAgICBfRy5hbHdheXNTcHJpbnQgPSB0cnVlCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigp" ..
    "CiAgICAgICAgICAgIGxvY2FsIG9rU3ByaW50LCBzcHJpbnQgPSBwY2FsbChmdW5jdGlvbigpIHJldHVybiByZXF1aXJlKFJlcGxpY2F0ZWRTdG9yYWdlLlN5c3RlbXMuQ2hhcmFjdGVyLkdhbWUuU3ByaW50aW5nKSBlbmQpCiAgICAgICAgICAgIGxvY2FsIG9rU3RhbSwgc3RhbWluYSA9IHBjYWxsKGZ1bmN0aW9uKCkgcmV0dXJuIHJlcXVpcmUoUmVwbGljYXRlZFN0b3JhZ2UuU3lzdGVtcy5DaGFyYWN0ZXIuR2FtZS5TdGFtaW5hSGFuZGxlcikgZW5kKQogICAgICAgICAgICBpZiBub3Qgb2tTcHJpbnQgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICBsb2NhbCBMT1csIEhJR0gsIGxhc3RSZXNldCwgZm9yY2VTdG9wID0gMTAsIDgwLCB0aWNrKCksIGZhbHNlCiAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGZpcmVTcHJpbnQoZmxhZykKICAgICAgICAgICAgICAgIHNwcmludC5Jc1NwcmludGluZyA9IGZsYWcKICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgaWYgc3ByaW50Ll9fc3ByaW50ZWRFdmVudCB0aGVuIHNwcmludC5fX3NwcmludGVkRXZlbnQ6RmlyZShmbGFnKSBlbmQgZW5kKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHdoaWxlIF9HLmFsd2F5c1NwcmludCBhbmQgX0cuQXV0b0dlbmVyYXRvcnMgYW5kIHRhc2sud2FpdCgpIGRvCiAgICAgICAgICAgICAgICAtLSDwn5SSIENo4buJIGNo4bqheSBraGkgbMOgIHN1cnZpdm9yIGjhu6NwIGzhu4c7IG7hur91IGtow7RuZyB0aMOsIHThuq90" ..
    "IHNwcmludCB2w6AgY2jhu50KICAgICAgICAgICAgICAgIGlmIG5vdCBpc1N1cnZpdm9yVmFsaWQoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgb2tTcHJpbnQgYW5kIHNwcmludC5Jc1NwcmludGluZyB0aGVuIGZpcmVTcHJpbnQoZmFsc2UpIGVuZAogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBva1N0YW0gYW5kIHR5cGUoc3RhbWluYS5WYWx1ZSkgPT0gIm51bWJlciIgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIHN0YW1pbmEuVmFsdWUgPD0gTE9XIHRoZW4gaWYgc3ByaW50LklzU3ByaW50aW5nIHRoZW4gZmlyZVNwcmludChmYWxzZSkgZW5kOyBmb3JjZVN0b3AgPSB0cnVlIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGZvcmNlU3RvcCBhbmQgc3RhbWluYS5WYWx1ZSA+PSBISUdIIHRoZW4gZmlyZVNwcmludCh0cnVlKTsgZm9yY2VTdG9wID0gZmFsc2U7IGxhc3RSZXNldCA9IHRpY2soKSBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgbm90IGZvcmNlU3RvcCBhbmQgbm90IHNwcmludC5Jc1NwcmludGluZyB0aGVuIGZpcmVTcHJpbnQodHJ1ZSk7IGxhc3RSZXNldCA9IHRpY2soKSBlbmQKICAgICAgICAgICAgICAgIGlmIG5vdCBmb3JjZVN0b3AgYW5kIHRpY2soKSAtIGxhc3RSZXNldCA+PSAzIHRoZW4KICAgICAgICAgICAgICAgICAgICBmaXJlU3ByaW50KGZhbHNlKTsgdGFzay53YWl0KDAu" ..
    "MSk7IGZpcmVTcHJpbnQodHJ1ZSk7IGxhc3RSZXNldCA9IHRpY2soKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVsc2UKICAgICAgICBfRy5hbHdheXNTcHJpbnQgPSBmYWxzZQogICAgZW5kCgogICAgLS0gQXV0byBHZW5lcmF0b3JzIGxvb3AKICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgaWYgbm90IF9HLkF1dG9HZW5lcmF0b3JzIHRoZW4gdGFzay53YWl0KDEpOyBjb250aW51ZSBlbmQKICAgICAgICAgICAgaWYgbm90IGlzU3Vydml2b3JWYWxpZCgpIHRoZW4gdGFzay53YWl0KDEpOyBjb250aW51ZSBlbmQgLS0g4pyFIGNo4buJIGNobyBwaMOpcCBzdXJ2aXZvcnMgaOG7o3AgbOG7hwoKICAgICAgICAgICAgaWYgX0cuUGxheWVyQ29udHJvbGxlZCB0aGVuIHRhc2sud2FpdCgwLjEpOyBjb250aW51ZSBlbmQKCiAgICAgICAgICAgIGxvY2FsIGhycCA9IExQLkNoYXJhY3RlciBhbmQgTFAuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgaWYgbm90IGhycCB0aGVuIHRhc2sud2FpdCgxKTsgY29udGludWUgZW5kCgogICAgICAgICAgICBsb2NhbCBtYXAgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIk1hcCIpIGFuZCBXb3Jrc3BhY2UuTWFwOkZpbmRGaXJzdENoaWxkKCJJbmdhbWUiKSBhbmQgV29ya3NwYWNlLk1hcC5JbmdhbWU6RmluZEZpcnN0Q2hp" ..
    "bGQoIk1hcCIpCiAgICAgICAgICAgIGlmIG5vdCBtYXAgdGhlbiB0YXNrLndhaXQoMik7IGNvbnRpbnVlIGVuZAoKICAgICAgICAgICAgbG9jYWwgZ2VucyA9IHt9CiAgICAgICAgICAgIGZvciBfLCBnZW4gaW4gaXBhaXJzKG1hcDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgZ2VuLk5hbWUgPT0gIkdlbmVyYXRvciIgYW5kIGdlbjpGaW5kRmlyc3RDaGlsZCgiUHJvZ3Jlc3MiKSBhbmQgZ2VuLlByb2dyZXNzLlZhbHVlIDwgMTAwIHRoZW4KICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoZ2VucywgZ2VuKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiAjZ2VucyA9PSAwIHRoZW4gdGFzay53YWl0KDMpOyBjb250aW51ZSBlbmQKCiAgICAgICAgICAgIHRhYmxlLnNvcnQoZ2VucywgZnVuY3Rpb24oYSwgYikKICAgICAgICAgICAgICAgIGxvY2FsIGNhLCBjYiA9IGEuUG9zaXRpb25zIGFuZCBhLlBvc2l0aW9uczpGaW5kRmlyc3RDaGlsZCgiQ2VudGVyIiksIGIuUG9zaXRpb25zIGFuZCBiLlBvc2l0aW9uczpGaW5kRmlyc3RDaGlsZCgiQ2VudGVyIikgLS0g4pyFIHPhu61hICd2w6AnIC0+ICdhbmQnCiAgICAgICAgICAgICAgICBpZiBjYSBhbmQgY2IgdGhlbgogICAgICAgICAgICAgICAgICAgIHJldHVybiAoaHJwLlBvc2l0aW9uIC0gY2EuUG9zaXRpb24pLk1hZ25pdHVkZSA8IChocnAuUG9zaXRpb24gLSBjYi5Qb3NpdGlvbikuTWFnbml0dWRl" ..
    "CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgICBlbmQpCgogICAgICAgICAgICBsb2NhbCB0YXJnZXRHZW4gPSBnZW5zWzFdCiAgICAgICAgICAgIGlmIHRhcmdldEdlbiBhbmQgdGFyZ2V0R2VuLlBvc2l0aW9ucyBhbmQgdGFyZ2V0R2VuLlBvc2l0aW9uczpGaW5kRmlyc3RDaGlsZCgiQ2VudGVyIikgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgY2VudGVyID0gdGFyZ2V0R2VuLlBvc2l0aW9ucy5DZW50ZXIuUG9zaXRpb24KICAgICAgICAgICAgICAgIGlmIGlzS2lsbGVyTmVhckdlbmVyYXRvcihjZW50ZXIsIDUwKSB0aGVuIHRhc2sud2FpdCgyKTsgY29udGludWUgZW5kCgogICAgICAgICAgICAgICAgaWYgbm90IF9HLlBsYXllckNvbnRyb2xsZWQgdGhlbiBwY2FsbChmdW5jdGlvbigpIHBhdGhmaW5kVG8oY2VudGVyKSBlbmQpIGVuZAogICAgICAgICAgICAgICAgcmVwZWF0IHRhc2sud2FpdCgwLjA1KQogICAgICAgICAgICAgICAgdW50aWwgbm90IF9HLkF1dG9HZW5lcmF0b3JzIG9yIF9HLlBsYXllckNvbnRyb2xsZWQgb3Igbm90IGhycC5QYXJlbnQgb3IgKGhycC5Qb3NpdGlvbiAtIGNlbnRlcikuTWFnbml0dWRlIDw9IDYKICAgICAgICAgICAgICAgIGlmIF9HLlBsYXllckNvbnRyb2xsZWQgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBwcm9tcHQgPSB0YXJnZXRHZW4uTWFpbiBhbmQgdGFyZ2V0R2VuLk1haW46RmluZEZp" ..
    "cnN0Q2hpbGQoIlByb21wdCIpCiAgICAgICAgICAgICAgICBpZiBwcm9tcHQgYW5kIChocnAuUG9zaXRpb24gLSBjZW50ZXIpLk1hZ25pdHVkZSA8PSA2IHRoZW4KICAgICAgICAgICAgICAgICAgICBwcm9tcHQuSG9sZER1cmF0aW9uLCBwcm9tcHQuUmVxdWlyZXNMaW5lT2ZTaWdodCwgcHJvbXB0Lk1heEFjdGl2YXRpb25EaXN0YW5jZSA9IDAsIGZhbHNlLCA5OTk5OQogICAgICAgICAgICAgICAgICAgIHdoaWxlIF9HLkF1dG9HZW5lcmF0b3JzIGFuZCBub3QgX0cuUGxheWVyQ29udHJvbGxlZCBhbmQgdGFyZ2V0R2VuLlBhcmVudCBhbmQgdGFyZ2V0R2VuOkZpbmRGaXJzdENoaWxkKCJQcm9ncmVzcyIpIGFuZCB0YXJnZXRHZW4uUHJvZ3Jlc3MuVmFsdWUgPCAxMDAgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhycC5Qb3NpdGlvbiAtIGNlbnRlcikuTWFnbml0dWRlID4gNiB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAtLSDwn5S5IE5o4bqlbiAxIGzhuqduIHLhu5NpIGNo4budIDMgZ2nDonkKICAgICAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0OklucHV0SG9sZEJlZ2luKCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKSAtLSBnaeG7ryBuaOG6uSDEkeG7gyBjaOG6r2MgY2jhuq9uIMSDbiBs4buHbmgKICAgICAgICAgICAgICAg" ..
    "ICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0OklucHV0SG9sZEVuZCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDMuMCkgLS0gbmdo4buJIDMgZ2nDonkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICBlbmQKICAgIGVuZCkKZW5kKQoKLS0gUmVzZXQgcGF0aCBraGkgbWFwIG3hu5tpIHNwYXduCldvcmtzcGFjZS5DaGlsZEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hpbGQpCiAgICBpZiBjaGlsZC5OYW1lID09ICJNYXAiIHRoZW4gaCA9IGggKyAxIGVuZAplbmQpCmVuZAoKCgogICAgVGFicy5GYXJtOkFkZFNlY3Rpb24oIuKGsyBJdGVtcyIpCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgTFAgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgotLSBIw6BtIG5o4bq3dCBpdGVtIGfhuqduIG5o4bqldApsb2NhbCBmdW5jdGlvbiBwaWNrVXBOZWFyZXN0KCkKICAgIGxvY2FsIG1hcCA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiTWFwIikgCiAgICAgICAgICAgICAgICBhbmQgd29ya3NwYWNlLk1hcDpGaW5kRmlyc3RDaGlsZCgiSW5nYW1lIikgCiAgICAgICAgICAgICAgICBhbmQgd29ya3NwYWNlLk1hcC5JbmdhbWU6RmluZEZpcnN0" ..
    "Q2hpbGQoIk1hcCIpCiAgICBpZiBub3QgbWFwIG9yIG5vdCBMUC5DaGFyYWN0ZXIgb3Igbm90IExQLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIG9sZENGcmFtZSA9IExQLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQogICAgZm9yIF8sIGl0ZW0gaW4gaXBhaXJzKG1hcDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIGl0ZW06SXNBKCJUb29sIikgYW5kIGl0ZW06RmluZEZpcnN0Q2hpbGQoIkl0ZW1Sb290IikgCiAgICAgICAgICAgYW5kIGl0ZW0uSXRlbVJvb3Q6RmluZEZpcnN0Q2hpbGQoIlByb3hpbWl0eVByb21wdCIpIHRoZW4KICAgICAgICAgICAgTFAuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gaXRlbS5JdGVtUm9vdC5DRnJhbWUKICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgZmlyZXByb3hpbWl0eXByb21wdChpdGVtLkl0ZW1Sb290LlByb3hpbWl0eVByb21wdCkKICAgICAgICAgICAgdGFzay53YWl0KDAuNCkKICAgICAgICAgICAgTFAuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkQ0ZyYW1lCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSBCdXR0b246IFBpY2sgVXAgSXRlbSAoMSBs4bqnbikKVGFicy5GYXJtOkFkZEJ1dHRvbih7CiAgICBUaXRsZSA9ICJQaWNrIFVwIEl0ZW0iLAogICAgQ2FsbGJhY2sg" ..
    "PSBwaWNrVXBOZWFyZXN0Cn0pCgotLSBUb2dnbGU6IEF1dG8gUGlja1VwIEl0ZW0gKGzhurdwKQpUYWJzLkZhcm06QWRkVG9nZ2xlKCJJdGVtUGljayIsIHsKICAgIFRpdGxlID0gIkF1dG8gUGlja1VwIEl0ZW0iLAogICAgRGVmYXVsdCA9IGZhbHNlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkKICAgIF9HLlBpY2t1cEl0ZW0gPSBWYWx1ZQogICAgaWYgbm90IFZhbHVlIHRoZW4gcmV0dXJuIGVuZAoKICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIF9HLlBpY2t1cEl0ZW0gZG8KICAgICAgICAgICAgcGlja1VwTmVhcmVzdCgpCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpIC0tIGRlbGF5IGdp4buvYSBt4buXaSBs4bqnbiBuaOG6t3QKICAgICAgICBlbmQKICAgIGVuZCkKZW5kKQoKCgoKLS0gVGFicy5NYWluCgpUYWJzLk1haW46QWRkUGFyYWdyYXBoKHsKICAgIFRpdGxlID0gIkhvdyB0byBVc2UgU2NyaXB0IDoiLAogICAgQ29udGVudCA9ICIxOiBNdXN0IGFkanVzdCB0aGUgc2xpZGVyIHRvIGluY3JlYXNlIG9yIGRlY3JlYXNlXG4yOiBNdXN0IG5vdCBiZSBtaW4gb3IgbWF4IGJlY2F1c2UgaXQgd2lsbCBub3Qgd29ya1xuMzogVGhlbiB0dXJuIG9uIHRoZSBidXR0b25zIHRvIHVzZSB0aG9zZSBmdW5jdGlvbnNcblxufHwgTGlrZSwgU2hhcmUgQW5kIFN1YnNjcmliZSBGb3IgU0xLIGdhbWluZyB8fCIKfSkKCgoKICAgIFRhYnMuTWFpbjpBZGRTZWN0aW9uKCLihrMgRWxpb3QiKQoKZG8K" ..
    "LS0g8J+nqSBHVUkgVG9nZ2xlICsgSW5wdXQKbG9jYWwgdG9nZ2xlT24gPSBmYWxzZQpsb2NhbCB0b2dnbGVGbGFnID0gSW5zdGFuY2UubmV3KCJCb29sVmFsdWUiKQp0b2dnbGVGbGFnLk5hbWUgPSAiRWxpb3RQaXp6YUFpbV9Ub2dnbGVGbGFnIgp0b2dnbGVGbGFnLlZhbHVlID0gZmFsc2UKClRhYnMuTWFpbjpBZGRUb2dnbGUoIk5lbVBpenphIiwgewogICAgVGl0bGUgPSAiUGl6emEgQWltYm90IiwKICAgIERlZmF1bHQgPSB0b2dnbGVPbiwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHN0YXRlKQogICAgdG9nZ2xlT24gPSBzdGF0ZQogICAgdG9nZ2xlRmxhZy5WYWx1ZSA9IHN0YXRlCmVuZCkKCi0tIGtob+G6o25nIGPDoWNoIGFpbSAoc3R1ZHMpCmxvY2FsIG1heERpc3RhbmNlID0gMTAwClRhYnMuTWFpbjpBZGRJbnB1dCgiUGl6emFBaW1EaXN0YW5jZSIsIHsKICAgIFRpdGxlID0gIkFpbSBEaXN0YW5jZSIsCiAgICBEZWZhdWx0ID0gdG9zdHJpbmcobWF4RGlzdGFuY2UpLAogICAgUGxhY2Vob2xkZXIgPSAiRW50ZXIgTnVtYmVyIiwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKQogICAgbG9jYWwgbnVtID0gdG9udW1iZXIodmFsdWUpCiAgICBpZiBudW0gdGhlbgogICAgICAgIG1heERpc3RhbmNlID0gbnVtCiAgICBlbmQKZW5kKQoKLS0g4pqZ77iPIFNlcnZpY2VzCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5T" ..
    "ZXJ2aWNlIikKbG9jYWwgbG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIHN1cnZpdm9yc0ZvbGRlciA9IHdvcmtzcGFjZTpXYWl0Rm9yQ2hpbGQoIlBsYXllcnMiKTpXYWl0Rm9yQ2hpbGQoIlN1cnZpdm9ycyIpCgotLSDwn46e77iPIEFuaW1hdGlvbiBJRHMKbG9jYWwgUGl6emFBbmltYXRpb24gPSB7CiAgICBbIjExNDE1NTAwMzc0MTE0NiJdID0gdHJ1ZSwKICAgIFsiMTA0MDMzMzQ4NDI2NTMzIl0gPSB0cnVlCn0KCi0tIPCfp6AgRWxpb3QgY2hlY2sKbG9jYWwgRWxpb3RNb2RlbHMgPSB7WyJFbGxpb3QiXSA9IHRydWV9CgotLSDwn5SWIFN0YXRlCmxvY2FsIGF1dG9Sb3RhdGVEaXNhYmxlZEJ5U2NyaXB0ID0gZmFsc2UKbG9jYWwgY3VycmVudFRhcmdldCwgaXNMb2NrZWRPbiwgd2FzUGxheWluZ0FuaW1hdGlvbiA9IG5pbCwgZmFsc2UsIGZhbHNlCmxvY2FsIGFpbU9mZnNldCA9IDIgLS0gbOG7h2NoIHBo4bqjaSAyIHN0dWRzCgotLSDimpnvuI8gVXRpbHMKbG9jYWwgZnVuY3Rpb24gaXNFbGlvdCgpCiAgICBsb2NhbCBjaGFyID0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICByZXR1cm4gY2hhciBhbmQgRWxpb3RNb2RlbHNbY2hhci5OYW1lXSBvciBmYWxzZQplbmQKCmxvY2FsIGZ1bmN0aW9uIGdldE15SHVtYW5vaWQoKQogICAgbG9jYWwgY2hhciA9IGxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgcmV0dXJuIGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQi" ..
    "KQplbmQKCmxvY2FsIGZ1bmN0aW9uIHJlc3RvcmVBdXRvUm90YXRlKCkKICAgIGxvY2FsIGh1bSA9IGdldE15SHVtYW5vaWQoKQogICAgaWYgaHVtIGFuZCBhdXRvUm90YXRlRGlzYWJsZWRCeVNjcmlwdCB0aGVuCiAgICAgICAgaHVtLkF1dG9Sb3RhdGUgPSB0cnVlCiAgICAgICAgYXV0b1JvdGF0ZURpc2FibGVkQnlTY3JpcHQgPSBmYWxzZQogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gaXNQbGF5aW5nRGFuZ2Vyb3VzQW5pbWF0aW9uKCkKICAgIGxvY2FsIGh1bWFub2lkID0gZ2V0TXlIdW1hbm9pZCgpCiAgICBpZiBub3QgaHVtYW5vaWQgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICBsb2NhbCBhbmltYXRvciA9IGh1bWFub2lkOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQW5pbWF0b3IiKQogICAgaWYgbm90IGFuaW1hdG9yIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgZm9yIF8sIHRyYWNrIGluIGlwYWlycyhhbmltYXRvcjpHZXRQbGF5aW5nQW5pbWF0aW9uVHJhY2tzKCkpIGRvCiAgICAgICAgaWYgdHJhY2sgYW5kIHRyYWNrLkFuaW1hdGlvbiBhbmQgdHJhY2suQW5pbWF0aW9uLkFuaW1hdGlvbklkIHRoZW4KICAgICAgICAgICAgbG9jYWwgYW5pbUlkID0gdG9zdHJpbmcodHJhY2suQW5pbWF0aW9uLkFuaW1hdGlvbklkKTptYXRjaCgiJWQrIikKICAgICAgICAgICAgaWYgYW5pbUlkIGFuZCBQaXp6YUFuaW1hdGlvblthbmltSWRdIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAg" ..
    "IGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKZW5kCgotLSDwn46vIEzhuqV5IHN1cnZpdm9yIHnhur91IG3DoXUgbmjhuqV0ICh0cm9uZyBmb2xkZXIgU3Vydml2b3JzKQpsb2NhbCBmdW5jdGlvbiBnZXRXZWFrZXN0U3Vydml2b3IoKQogICAgbG9jYWwgbGlzdCA9IHt9CiAgICBsb2NhbCBteUNoYXIgPSBsb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIG15SHVtID0gZ2V0TXlIdW1hbm9pZCgpCiAgICBsb2NhbCBteVJvb3QgPSBteUNoYXIgYW5kIG15Q2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBub3QgbXlSb290IG9yIG5vdCBteUh1bSBvciBub3QgbXlIdW0uTWF4SGVhbHRoIG9yIG15SHVtLk1heEhlYWx0aCA8PSAwIHRoZW4gcmV0dXJuIG5pbCBlbmQKCiAgICBsb2NhbCBteUhwUGVyY2VudCA9IG15SHVtLkhlYWx0aCAvIG15SHVtLk1heEhlYWx0aAoKICAgIGZvciBfLCBvYmogaW4gaXBhaXJzKHN1cnZpdm9yc0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIG9iajpJc0EoIk1vZGVsIikgYW5kIG9iaiB+PSBteUNoYXIgdGhlbgogICAgICAgICAgICBsb2NhbCBodW0gPSBvYmo6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQiKQogICAgICAgICAgICBsb2NhbCBocnAgPSBvYmo6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICBpZiBodW0gYW5kIGhycCBhbmQgaHVtLkhlYWx0aCA+" ..
    "IDAgYW5kIGh1bS5NYXhIZWFsdGggPiAwIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAoaHJwLlBvc2l0aW9uIC0gbXlSb290LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgIGxvY2FsIGhwUGVyY2VudCA9IGh1bS5IZWFsdGggLyBodW0uTWF4SGVhbHRoCiAgICAgICAgICAgICAgICBpZiBkaXN0IDw9IG1heERpc3RhbmNlIHRoZW4KICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQobGlzdCwge21vZGVsID0gb2JqLCBocCA9IGhwUGVyY2VudH0pCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBT4bqvcCB44bq/cCB0aGVvICUgbcOhdSB0xINuZyBk4bqnbgogICAgdGFibGUuc29ydChsaXN0LCBmdW5jdGlvbihhLCBiKQogICAgICAgIHJldHVybiBhLmhwIDwgYi5ocAogICAgZW5kKQoKICAgIGlmICNsaXN0ID09IDAgdGhlbiByZXR1cm4gbmlsIGVuZAogICAgaWYgbXlIcFBlcmNlbnQgPD0gbGlzdFsxXS5ocCBhbmQgI2xpc3QgPiAxIHRoZW4KICAgICAgICByZXR1cm4gbGlzdFsyXS5tb2RlbAogICAgZWxzZQogICAgICAgIHJldHVybiBsaXN0WzFdLm1vZGVsCiAgICBlbmQKZW5kCgotLSDwn5SBIFJlc2V0IGtoaSByZXNwYXduCmxvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgdGFzay5kZWxheSgwLjEsIGZ1bmN0aW9uKCkKICAgICAgICBhdXRvUm90YXRlRGlzYWJsZWRC" ..
    "eVNjcmlwdCA9IGZhbHNlCiAgICBlbmQpCmVuZCkKCi0tIPCflIIgTWFpbiBsb29wClJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGlmIG5vdCB0b2dnbGVGbGFnLlZhbHVlIHRoZW4KICAgICAgICByZXN0b3JlQXV0b1JvdGF0ZSgpCiAgICAgICAgY3VycmVudFRhcmdldCwgaXNMb2NrZWRPbiwgd2FzUGxheWluZ0FuaW1hdGlvbiA9IG5pbCwgZmFsc2UsIGZhbHNlCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBpZiBub3QgaXNFbGlvdCgpIHRoZW4KICAgICAgICByZXN0b3JlQXV0b1JvdGF0ZSgpCiAgICAgICAgY3VycmVudFRhcmdldCwgaXNMb2NrZWRPbiwgd2FzUGxheWluZ0FuaW1hdGlvbiA9IG5pbCwgZmFsc2UsIGZhbHNlCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBteUh1bWFub2lkID0gZ2V0TXlIdW1hbm9pZCgpCiAgICBpZiBub3QgbXlIdW1hbm9pZCB0aGVuIHJldHVybiBlbmQKICAgIGxvY2FsIG15Um9vdCA9IG15SHVtYW5vaWQuUGFyZW50IGFuZCBteUh1bWFub2lkLlBhcmVudDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBub3QgbXlSb290IHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIGlzUGxheWluZyA9IGlzUGxheWluZ0Rhbmdlcm91c0FuaW1hdGlvbigpCgogICAgLS0g8J+nsiBMb2NrIHRhcmdldCBraGkgYuG6r3QgxJHhuqd1IGFuaW1hdGlvbgogICAgaWYgaXNQbGF5aW5nIGFuZCBub3QgaXNMb2NrZWRP" ..
    "biB0aGVuCiAgICAgICAgY3VycmVudFRhcmdldCA9IGdldFdlYWtlc3RTdXJ2aXZvcigpCiAgICAgICAgaWYgY3VycmVudFRhcmdldCB0aGVuIGlzTG9ja2VkT24gPSB0cnVlIGVuZAogICAgZW5kCgogICAgLS0g4pqZ77iPIFZhbGlkYXRlIHRhcmdldAogICAgaWYgaXNMb2NrZWRPbiBhbmQgY3VycmVudFRhcmdldCB0aGVuCiAgICAgICAgbG9jYWwgdEh1bSA9IGN1cnJlbnRUYXJnZXQ6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQiKQogICAgICAgIGxvY2FsIHRIcnAgPSBjdXJyZW50VGFyZ2V0OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBpZiAobm90IHRIdW0pIG9yICh0SHVtLkhlYWx0aCA8PSAwKSBvciAobm90IHRIcnApIHRoZW4KICAgICAgICAgICAgY3VycmVudFRhcmdldCwgaXNMb2NrZWRPbiA9IG5pbCwgZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIOKPue+4jyBFbmQgYW5pbWF0aW9uIC0+IHJlc2V0CiAgICBpZiAobm90IGlzUGxheWluZykgYW5kIHdhc1BsYXlpbmdBbmltYXRpb24gdGhlbgogICAgICAgIGN1cnJlbnRUYXJnZXQsIGlzTG9ja2VkT24gPSBuaWwsIGZhbHNlCiAgICAgICAgcmVzdG9yZUF1dG9Sb3RhdGUoKQogICAgZW5kCiAgICB3YXNQbGF5aW5nQW5pbWF0aW9uID0gaXNQbGF5aW5nCgogICAgLS0g8J+OryBBaW0gbG9naWMKICAgIGlmIGlzUGxheWluZyBhbmQgaXNMb2NrZWRPbiBhbmQgY3VycmVudFRhcmdldCBhbmQgY3VycmVu" ..
    "dFRhcmdldDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBsb2NhbCBocnAgPSBjdXJyZW50VGFyZ2V0Lkh1bWFub2lkUm9vdFBhcnQKICAgICAgICBsb2NhbCB0YXJnZXRQb3MgPSBocnAuUG9zaXRpb24KICAgICAgICBpZiBub3QgYXV0b1JvdGF0ZURpc2FibGVkQnlTY3JpcHQgdGhlbgogICAgICAgICAgICBteUh1bWFub2lkLkF1dG9Sb3RhdGUgPSBmYWxzZQogICAgICAgICAgICBhdXRvUm90YXRlRGlzYWJsZWRCeVNjcmlwdCA9IHRydWUKICAgICAgICBlbmQKCiAgICAgICAgLS0gZOG7sSDEkW/DoW4gaMaw4bubbmcgZGkgY2h1eeG7g24gbmjhurkKICAgICAgICBsb2NhbCB2ZWwgPSBocnAuVmVsb2NpdHkKICAgICAgICBpZiB2ZWwgYW5kIHZlbC5NYWduaXR1ZGUgPiAyIHRoZW4KICAgICAgICAgICAgdGFyZ2V0UG9zID0gdGFyZ2V0UG9zICsgaHJwLkNGcmFtZS5Mb29rVmVjdG9yICogMwogICAgICAgIGVuZAoKICAgICAgICAtLSBs4buHY2ggcGjhuqNpCiAgICAgICAgbG9jYWwgb2Zmc2V0ID0gbXlSb290LkNGcmFtZS5SaWdodFZlY3RvciAqIGFpbU9mZnNldAogICAgICAgIGxvY2FsIGxvb2tBdCA9IFZlY3RvcjMubmV3KHRhcmdldFBvcy5YLCBteVJvb3QuUG9zaXRpb24uWSwgdGFyZ2V0UG9zLlopICsgb2Zmc2V0CgogICAgICAgIG15Um9vdC5DRnJhbWUgPSBteVJvb3QuQ0ZyYW1lOkxlcnAoQ0ZyYW1lLmxvb2tBdChteVJvb3QuUG9zaXRpb24sIGxvb2tBdCksIDAuOTkp" ..
    "CiAgICBlbmQKZW5kKQplbmQKCgoKLS0vLyDwn42VIEF1dG8gRWF0IFBpenphIEluc3RhbnRseSAoRmx1ZW50IFRvZ2dsZSBTdHlsZSkKLS0vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKZG8KICAgIC0tIPCfjI0gR2xvYmFsIFZhcnMKICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQogICAgbG9jYWwgV29ya3NwYWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKQogICAgbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgogICAgZ2V0Z2VudigpLkJsaW5rVG9QaXp6YVRvZ2dsZSA9IGZhbHNlCiAgICBnZXRnZW52KCkuSFBUaHJlc2hvbGQgPSAzMAoKICAgIC0tIPCfp6kgSGVscGVyIEZ1bmN0aW9ucwogICAgbG9jYWwgZnVuY3Rpb24gZ2V0SFJQKCkKICAgICAgICBsb2NhbCBjaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIHJldHVybiBjaGFyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRIUCgpCiAgICAgICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIGNoYXIgdGhlbgogICAgICAgICAgICBsb2NhbCBodW0gPSBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgICAgICBpZiBodW0gdGhlbiByZXR1cm4g" ..
    "aHVtLkhlYWx0aCBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gMAogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gZ2V0UGl6emFDRigpCiAgICAgICAgbG9jYWwgbWFwID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJNYXAiKQogICAgICAgIGxvY2FsIGluZ2FtZSA9IG1hcCBhbmQgbWFwOkZpbmRGaXJzdENoaWxkKCJJbmdhbWUiKQogICAgICAgIGlmIG5vdCBpbmdhbWUgdGhlbiByZXR1cm4gbmlsIGVuZAoKICAgICAgICBsb2NhbCBwaXp6YSA9IGluZ2FtZTpGaW5kRmlyc3RDaGlsZCgiUGl6emEiKQogICAgICAgIGlmIG5vdCBwaXp6YSB0aGVuIHJldHVybiBuaWwgZW5kCgogICAgICAgIGlmIHBpenphOklzQSgiQmFzZVBhcnQiKSBvciBwaXp6YTpJc0EoIk1lc2hQYXJ0Iikgb3IgcGl6emE6SXNBKCJVbmlvbk9wZXJhdGlvbiIpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHBpenphLkNGcmFtZQogICAgICAgIGVsc2VpZiBwaXp6YTpJc0EoIk1vZGVsIikgdGhlbgogICAgICAgICAgICBsb2NhbCBwcCA9IHBpenphLlByaW1hcnlQYXJ0IG9yIHBpenphOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJhc2VQYXJ0IikKICAgICAgICAgICAgaWYgcHAgdGhlbgogICAgICAgICAgICAgICAgaWYgbm90IHBpenphLlByaW1hcnlQYXJ0IHRoZW4gcGl6emEuUHJpbWFyeVBhcnQgPSBwcCBlbmQKICAgICAgICAgICAgICAgIHJldHVybiBwcC5DRnJhbWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZWlmIHBpenph" ..
    "OklzQSgiQ0ZyYW1lVmFsdWUiKSB0aGVuCiAgICAgICAgICAgIHJldHVybiBwaXp6YS5WYWx1ZQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gPz8gRmx1ZW50IFVJIFNlY3Rpb24KCiAgICAtLSDwn42VIFRvZ2dsZSB04buxIMSDbiBwaXp6YQogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiQmxpbmtQaXp6YV9Ub2dnbGUiLCB7CiAgICAgICAgVGl0bGUgPSAiQXV0byBFYXQgUGl6emEiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgICAgICBnZXRnZW52KCkuQmxpbmtUb1BpenphVG9nZ2xlID0gc3RhdGUKICAgIGVuZCkKCiAgICAtLSDinaTvuI8gSW5wdXQgSFAgVGhyZXNob2xkCiAgICBUYWJzLk1haW46QWRkSW5wdXQoIlBpenphSFBUaHJlc2hvbGQiLCB7CiAgICAgICAgVGl0bGUgPSAiSFAgVGhyZXNob2xkIiwKICAgICAgICBEZWZhdWx0ID0gdG9zdHJpbmcoZ2V0Z2VudigpLkhQVGhyZXNob2xkKSwKICAgICAgICBQbGFjZWhvbGRlciA9ICIzMCIsCiAgICB9KTpPbkNoYW5nZWQoZnVuY3Rpb24odmFsdWUpCiAgICAgICAgbG9jYWwgbnVtID0gdG9udW1iZXIodmFsdWUpCiAgICAgICAgaWYgbnVtIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLkhQVGhyZXNob2xkID0gbnVtCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgLS0g8J+UgSBBdXRvIExvb3AKICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIHRhc2sud2FpdCgwLjkp" ..
    "IGRvCiAgICAgICAgICAgIGlmIGdldGdlbnYoKS5CbGlua1RvUGl6emFUb2dnbGUgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgaHJwID0gZ2V0SFJQKCkKICAgICAgICAgICAgICAgIGxvY2FsIHBpenphQ0YgPSBnZXRQaXp6YUNGKCkKICAgICAgICAgICAgICAgIGlmIHBpenphQ0YgYW5kIGdldEhQKCkgPD0gZ2V0Z2VudigpLkhQVGhyZXNob2xkIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBvbGRDRiA9IGhycC5DRnJhbWUKICAgICAgICAgICAgICAgICAgICBocnAuQ0ZyYW1lID0gcGl6emFDRiAqIENGcmFtZS5uZXcoMCwgMSwgMCkKCiAgICAgICAgICAgICAgICAgICAgaWYgZ2V0Z2VudigpLmFjdGl2YXRlUmVtb3RlSG9vayB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5hY3RpdmF0ZVJlbW90ZUhvb2soIlVucmVsaWFibGVSZW1vdGVFdmVudCIsICJVcGRDRiIpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHRhc2suZGVsYXkoMC4yLCBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGhycC5DRnJhbWUgPSBvbGRDRgogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuZGVhY3RpdmF0ZVJlbW90ZUhvb2sgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Z2VudigpLmRlYWN0aXZhdGVSZW1vdGVIb29rKCJVbnJlbGlhYmxlUmVtb3Rl" ..
    "RXZlbnQiLCAiVXBkQ0YiKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKCiAgICBUYWJzLk1haW46QWRkU2VjdGlvbigi4oazIFNoZWRsZXRza3kiKQoKCmRvCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQogICAgbG9jYWwgbHAgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgogICAgLS0g4pqZ77iPIFZhcmlhYmxlcwogICAgbG9jYWwgZW5hYmxlZCA9IGZhbHNlCiAgICBsb2NhbCBtb2RlID0gIkFJIEFpbWJvdCIKICAgIGxvY2FsIGNvb2xkb3duID0gZmFsc2UKICAgIGxvY2FsIGxhc3RUYXJnZXQgPSBuaWwKICAgIGxvY2FsIG1heERpc3RhbmNlID0gNQogICAgbG9jYWwgc2xpZGVySW5pdGlhbGl6ZWQgPSBmYWxzZQoKICAgIGxvY2FsIFRFTEVQT1JUX0RVUkFUSU9OID0gMC44CiAgICBsb2NhbCBBSV9ERUxBWSA9IDE1IC0tIOKPsyBEZWxheSBnaeG7r2EgbeG7l2kgbOG6p24gdGVsZXBvcnQgQUkKCiAgICBsb2NhbCBraWxsZXJzRm9sZGVyID0gd29ya3NwYWNlOldhaXRGb3JDaGlsZCgiUGxheWVycyIpOldhaXRGb3JDaGlsZCgiS2lsbGVycyIpCgogICAgLS0g8J+OtSBBbmltYXRpb24gSURzCiAgICBsb2NhbCBtb25pdG9yZWRBbmlt" ..
    "YXRpb25zID0gewogICAgICAgICdyYnhhc3NldGlkOi8vMTE2NjE4MDAzNDc3MDAyJywgJ3JieGFzc2V0aWQ6Ly8xMjEyNTU4OTg2MTI0NzUnLAogICAgICAgICdyYnhhc3NldGlkOi8vOTgwMzEyODczNjQ4NjUnLCAgJ3JieGFzc2V0aWQ6Ly8xMTk0NjIzODM2NTgwNDQnLAogICAgICAgICdyYnhhc3NldGlkOi8vNzc0NDg1MjEyNzcxNDYnLCAgJ3JieGFzc2V0aWQ6Ly8xMDM3NDEzNTIzNzk4MTknLAogICAgICAgICdyYnhhc3NldGlkOi8vMTMxNjk2NjAzMDI1MjY1JywgJ3JieGFzc2V0aWQ6Ly8xMjI1MDMzMzgyNzczNTInLAogICAgICAgICdyYnhhc3NldGlkOi8vOTc2NDg1NDgzMDM2NzgnCiAgICB9CgogICAgLS0g8J+UpyBTbGFzaCBidXR0b24gKyByZW1vdGUKICAgIGxvY2FsIHNsYXNoQnV0dG9uLCBzbGFzaFJlbW90ZSwgc2xhc2hDb25uZWN0aW9ucyA9IG5pbCwgbmlsLCB7fQoKICAgIGxvY2FsIGZ1bmN0aW9uIGZpbmRTbGFzaFJlbW90ZSgpCiAgICAgICAgaWYgc2xhc2hSZW1vdGUgdGhlbiByZXR1cm4gc2xhc2hSZW1vdGUgZW5kCiAgICAgICAgaWYgbm90IHNsYXNoQnV0dG9uIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgICAgICBmb3IgXywgY29ubiBpbiBpcGFpcnMoZ2V0Y29ubmVjdGlvbnMoc2xhc2hCdXR0b24uTW91c2VCdXR0b24xQ2xpY2spKSBkbwogICAgICAgICAgICBsb2NhbCBmID0gY29ubi5GdW5jdGlvbgogICAgICAgICAgICBpZiBmIGFuZCBpc2xjbG9zdXJlKGYpIHRoZW4KICAgICAgICAgICAg" ..
    "ICAgIGZvciBfLCB2IGluIHBhaXJzKGdldHVwdmFsdWVzKGYpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIHR5cGVvZih2KSA9PSAiSW5zdGFuY2UiIGFuZCB2OklzQSgiUmVtb3RlRXZlbnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHNsYXNoUmVtb3RlID0gdgogICAgICAgICAgICAgICAgICAgICAgICB3YXJuKCJbQXV0b1NsYXNoXSBGb3VuZCBTbGFzaCBSZW1vdGU6IiwgdjpHZXRGdWxsTmFtZSgpKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2xhc2hSZW1vdGUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gbmlsCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBpbml0U2xhc2hCdXR0b24oKQogICAgICAgIGxvY2FsIGd1aSA9IGxwOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJHdWkiKQogICAgICAgIGlmIG5vdCBndWkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgbWFpblVJID0gZ3VpOkZpbmRGaXJzdENoaWxkKCJNYWluVUkiKQogICAgICAgIGxvY2FsIGNvbnRhaW5lciA9IG1haW5VSSBhbmQgbWFpblVJOkZpbmRGaXJzdENoaWxkKCJBYmlsaXR5Q29udGFpbmVyIikKICAgICAgICBzbGFzaEJ1dHRvbiA9IGNvbnRhaW5lciBhbmQgY29udGFpbmVyOkZpbmRGaXJzdENoaWxkKCJTbGFzaCIpCiAgICAgICAgaWYgc2xhc2hCdXR0b24gYW5kIHNsYXNoQnV0dG9uOklzQSgi" ..
    "SW1hZ2VCdXR0b24iKSB0aGVuCiAgICAgICAgICAgIHNsYXNoQ29ubmVjdGlvbnMgPSBnZXRjb25uZWN0aW9ucyhzbGFzaEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljaykKICAgICAgICAgICAgZmluZFNsYXNoUmVtb3RlKCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGluaXRTbGFzaEJ1dHRvbigpCiAgICBscC5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgIGluaXRTbGFzaEJ1dHRvbigpCiAgICBlbmQpCgogICAgbG9jYWwgZnVuY3Rpb24gdXNlU2xhc2goKQogICAgICAgIGlmIHNsYXNoUmVtb3RlIHRoZW4KICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgc2xhc2hSZW1vdGU6RmlyZVNlcnZlcih0cnVlKQogICAgICAgICAgICAgICAgdGFzay5kZWxheSgwLjA1LCBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgc2xhc2hSZW1vdGU6RmlyZVNlcnZlcihmYWxzZSkKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2VpZiBzbGFzaEJ1dHRvbiB0aGVuCiAgICAgICAgICAgIGZvciBfLCBjb25uIGluIGlwYWlycyhzbGFzaENvbm5lY3Rpb25zKSBkbwogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBjb25uOkZpcmUoKSBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpIHNsYXNoQnV0dG9uOkFjdGl2YXRlKCkgZW5kKQogICAgICAg" ..
    "IGVuZAogICAgZW5kCgogICAgLS0g8J+nrSBVSQogICAgbG9jYWwgTW9kZURyb3Bkb3duID0gVGFicy5NYWluOkFkZERyb3Bkb3duKCJTbGFzaE1vZGUiLCB7CiAgICAgICAgVGl0bGUgPSAiU2xhc2ggTW9kZSIsCiAgICAgICAgVmFsdWVzID0geyAiQUkgQWltYm90IiwgIlBsYXllciBBaW1ib3QiIH0sCiAgICAgICAgRGVmYXVsdCA9ICJBSSBBaW1ib3QiCiAgICB9KQogICAgTW9kZURyb3Bkb3duOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkKICAgICAgICBtb2RlID0gVmFsdWUKICAgIGVuZCkKCiAgICBsb2NhbCBTbGFzaFRvZ2dsZSA9IFRhYnMuTWFpbjpBZGRUb2dnbGUoIlNsYXNoVG9nZ2xlIiwgewogICAgICAgIFRpdGxlID0gIkF1dG8gU2xhc2giLAogICAgICAgIERlZmF1bHQgPSBmYWxzZQogICAgfSkKICAgIFNsYXNoVG9nZ2xlOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkKICAgICAgICBlbmFibGVkID0gVmFsdWUKICAgIGVuZCkKCiAgICBsb2NhbCBEaXN0YW5jZVNsaWRlciA9IFRhYnMuTWFpbjpBZGRTbGlkZXIoIkRpc3RhbmNlU2xpZGVyIiwgewogICAgICAgIFRpdGxlID0gIkRpc3RhbmNlIiwKICAgICAgICBNaW4gPSAxLCBNYXggPSA1MCwgRGVmYXVsdCA9IDUsCiAgICAgICAgUm91bmRpbmcgPSAxLCBWYWx1ZU5hbWUgPSAic3R1ZHMiCiAgICB9KQogICAgRGlzdGFuY2VTbGlkZXI6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGlmIG5vdCBzbGlkZXJJbml0aWFsaXplZCB0aGVuCiAg" ..
    "ICAgICAgICAgIHNsaWRlckluaXRpYWxpemVkID0gdHJ1ZQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICBtYXhEaXN0YW5jZSA9IFZhbHVlCiAgICBlbmQpCgogICAgLS0g4pqhIEhlbHBlcnMKICAgIGxvY2FsIGZ1bmN0aW9uIGdldFJlbGF0aXZlVGVsZXBvcnRQb3NpdGlvbihocnAsIHRhcmdldEhSUCkKICAgICAgICBsb2NhbCB0b1RhcmdldCA9IChocnAuUG9zaXRpb24gLSB0YXJnZXRIUlAuUG9zaXRpb24pLlVuaXQKICAgICAgICByZXR1cm4gdGFyZ2V0SFJQLlBvc2l0aW9uICsgKHRvVGFyZ2V0ICogMikKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIHRlbGVwb3J0QW5kU2xhc2godGFyZ2V0LCBzcGFtKQogICAgICAgIGlmIGNvb2xkb3duIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIGhycCA9IGxwLkNoYXJhY3RlciBhbmQgbHAuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBsb2NhbCBrSFJQID0gdGFyZ2V0OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBpZiBub3QgaHJwIG9yIG5vdCBrSFJQIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBjb29sZG93biA9IHRydWUKICAgICAgICBsYXN0VGFyZ2V0ID0gdGFyZ2V0CgogICAgICAgIGxvY2FsIHN0YXJ0ID0gdGljaygpCiAgICAgICAgbG9jYWwgY29ubgogICAgICAgIGNvbm4gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkK" ..
    "ICAgICAgICAgICAgaWYgbm90IChscC5DaGFyYWN0ZXIgYW5kIGxwLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIGFuZCBrSFJQIGFuZCBrSFJQLlBhcmVudCkgdGhlbgogICAgICAgICAgICAgICAgaWYgY29ubiB0aGVuIGNvbm46RGlzY29ubmVjdCgpIGVuZAogICAgICAgICAgICAgICAgY29vbGRvd24gPSBmYWxzZQogICAgICAgICAgICAgICAgbGFzdFRhcmdldCA9IG5pbAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgdGljaygpIC0gc3RhcnQgPj0gVEVMRVBPUlRfRFVSQVRJT04gdGhlbgogICAgICAgICAgICAgICAgaWYgY29ubiB0aGVuIGNvbm46RGlzY29ubmVjdCgpIGVuZAogICAgICAgICAgICAgICAgdGFzay5kZWxheSgobW9kZSA9PSAiQUkgQWltYm90IikgYW5kIEFJX0RFTEFZIG9yIFRFTEVQT1JUX0RVUkFUSU9OLCBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgY29vbGRvd24gPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIGxhc3RUYXJnZXQgPSBuaWwKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxvY2FsIG5ld1BvcyA9IGdldFJlbGF0aXZlVGVsZXBvcnRQb3NpdGlvbihocnAsIGtIUlApCiAgICAgICAgICAgIGhycC5DRnJhbWUgPSBDRnJhbWUubmV3KG5ld1Bvcywga0hSUC5Qb3NpdGlvbikKCiAgICAgICAgICAgIGlm" ..
    "IHNwYW0gdGhlbiB1c2VTbGFzaCgpIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIC0tIOKalO+4jyBBSSBBaW1ib3QgTW9kZSAoYXV0byB0w6xtIHRyb25nIEtpbGxlcnMgZm9sZGVyKQogICAgUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgbm90IGVuYWJsZWQgb3IgY29vbGRvd24gb3IgbW9kZSB+PSAiQUkgQWltYm90IiB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBjaGFyID0gbHAuQ2hhcmFjdGVyCiAgICAgICAgaWYgbm90IChjaGFyIGFuZCBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIGhycCA9IGNoYXIuSHVtYW5vaWRSb290UGFydAoKICAgICAgICBmb3IgXywga2lsbGVyIGluIGlwYWlycyhraWxsZXJzRm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIGtpbGxlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGtIUlAgPSBraWxsZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChocnAuUG9zaXRpb24gLSBrSFJQLlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgIGlmIGRpc3QgPD0gbWF4RGlzdGFuY2UgYW5kIGtpbGxlciB+PSBsYXN0VGFyZ2V0IHRoZW4KICAgICAgICAgICAgICAgICAgICB0ZWxlcG9ydEFuZFNsYXNoKGtpbGxlciwg" ..
    "dHJ1ZSkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kKQoKICAgIC0tIPCfkYHvuI8gUGxheWVyIEFpbWJvdCBNb2RlCiAgICBsb2NhbCBmdW5jdGlvbiBhdHRhY2hBbmltTW9uaXRvcihjaGFyYWN0ZXIpCiAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIsIDUpCiAgICAgICAgaWYgbm90IGh1bWFub2lkIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBodW1hbm9pZC5BbmltYXRpb25QbGF5ZWQ6Q29ubmVjdChmdW5jdGlvbihhbmltVHJhY2spCiAgICAgICAgICAgIGlmIG5vdCBlbmFibGVkIG9yIG1vZGUgfj0gIlBsYXllciBBaW1ib3QiIG9yIGNvb2xkb3duIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCBhbmltSWQgPSBhbmltVHJhY2suQW5pbWF0aW9uIGFuZCBhbmltVHJhY2suQW5pbWF0aW9uLkFuaW1hdGlvbklkCiAgICAgICAgICAgIGlmIGFuaW1JZCBhbmQgdGFibGUuZmluZChtb25pdG9yZWRBbmltYXRpb25zLCBhbmltSWQpIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCBraWxsZXIgaW4gaXBhaXJzKGtpbGxlcnNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBraWxsZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGhycExv" ..
    "Y2FsID0gbHAuQ2hhcmFjdGVyIGFuZCBscC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBrSFJQID0ga2lsbGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaHJwTG9jYWwgYW5kIGtIUlAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChrSFJQLlBvc2l0aW9uIC0gaHJwTG9jYWwuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGlzdCA8PSBtYXhEaXN0YW5jZSAqIDUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbGVwb3J0QW5kU2xhc2goa2lsbGVyLCBmYWxzZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIGlmIGxwLkNoYXJhY3RlciB0aGVuCiAgICAgICAgYXR0YWNoQW5pbU1vbml0b3IobHAuQ2hhcmFjdGVyKQogICAgZW5kCiAgICBscC5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KGF0dGFjaEFuaW1Nb25pdG9yKQplbmQKCgoKZG8KICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lOkdl" ..
    "dFNlcnZpY2UoIlBsYXllcnMiKQogICAgbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCiAgICBsb2NhbCBscCA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCiAgICAtLSBWYXJzCiAgICBsb2NhbCBoZWFsRW5hYmxlZCA9IGZhbHNlCiAgICBsb2NhbCBoZWFsSFBUaHJlc2hvbGQgPSA1MAogICAgbG9jYWwgaGVhbERpc3RhbmNlID0gNTAKCiAgICAtLSBIZWFsIGJ1dHRvbiArIHJlbW90ZQogICAgbG9jYWwgaGVhbEJ1dHRvbiwgaGVhbFJlbW90ZSwgaGVhbENvbm5lY3Rpb25zID0gbmlsLCBuaWwsIHt9CgogICAgLS0gdMOsbSBSZW1vdGVFdmVudCB04burIGJ1dHRvbiBIZWFsCiAgICBsb2NhbCBmdW5jdGlvbiBmaW5kSGVhbFJlbW90ZSgpCiAgICAgICAgaWYgaGVhbFJlbW90ZSB0aGVuIHJldHVybiBoZWFsUmVtb3RlIGVuZAogICAgICAgIGlmIG5vdCBoZWFsQnV0dG9uIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgICAgICBmb3IgXywgY29ubiBpbiBpcGFpcnMoZ2V0Y29ubmVjdGlvbnMoaGVhbEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljaykpIGRvCiAgICAgICAgICAgIGxvY2FsIGYgPSBjb25uLkZ1bmN0aW9uCiAgICAgICAgICAgIGlmIGYgYW5kIGlzbGNsb3N1cmUoZikgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgdXB2YWxzID0gZ2V0dXB2YWx1ZXMoZikKICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKHVwdmFscykgZG8KICAgICAgICAgICAgICAgICAgICBpZiB0eXBl" ..
    "b2YodikgPT0gIkluc3RhbmNlIiBhbmQgdjpJc0EoIlJlbW90ZUV2ZW50IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBoZWFsUmVtb3RlID0gdgogICAgICAgICAgICAgICAgICAgICAgICB3YXJuKCJbQXV0b0hlYWxdIEZvdW5kIEhlYWwgUmVtb3RlOiIsIHY6R2V0RnVsbE5hbWUoKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhlYWxSZW1vdGUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gbmlsCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBpbml0SGVhbEJ1dHRvbigpCiAgICAgICAgbG9jYWwgZ3VpID0gbHA6RmluZEZpcnN0Q2hpbGQoIlBsYXllckd1aSIpCiAgICAgICAgaWYgbm90IGd1aSB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBtYWluVUkgPSBndWk6RmluZEZpcnN0Q2hpbGQoIk1haW5VSSIpCiAgICAgICAgbG9jYWwgY29udGFpbmVyID0gbWFpblVJIGFuZCBtYWluVUk6RmluZEZpcnN0Q2hpbGQoIkFiaWxpdHlDb250YWluZXIiKQogICAgICAgIGhlYWxCdXR0b24gPSBjb250YWluZXIgYW5kIGNvbnRhaW5lcjpGaW5kRmlyc3RDaGlsZCgiRnJpZWRDaGlja2VuIikKICAgICAgICBpZiBoZWFsQnV0dG9uIGFuZCBoZWFsQnV0dG9uOklzQSgiSW1hZ2VCdXR0b24iKSB0aGVuCiAgICAgICAgICAgIGhlYWxDb25uZWN0aW9ucyA9IGdldGNvbm5lY3Rpb25zKGhlYWxC" ..
    "dXR0b24uTW91c2VCdXR0b24xQ2xpY2spCiAgICAgICAgICAgIGZpbmRIZWFsUmVtb3RlKCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGluaXRIZWFsQnV0dG9uKCkKICAgIGxwLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgaW5pdEhlYWxCdXR0b24oKQogICAgZW5kKQoKICAgIGxvY2FsIGZ1bmN0aW9uIHVzZUhlYWwoKQogICAgICAgIGlmIGhlYWxSZW1vdGUgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBoZWFsUmVtb3RlOkZpcmVTZXJ2ZXIodHJ1ZSkKICAgICAgICAgICAgICAgIHRhc2suZGVsYXkoMC4wNSwgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGhlYWxSZW1vdGU6RmlyZVNlcnZlcihmYWxzZSkKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2VpZiBoZWFsQnV0dG9uIHRoZW4KICAgICAgICAgICAgZm9yIF8sIGNvbm4gaW4gaXBhaXJzKGhlYWxDb25uZWN0aW9ucykgZG8KICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgY29ubjpGaXJlKCkgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBoZWFsQnV0dG9uOkFjdGl2YXRlKCkgZW5kKQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gVUkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBsb2Nh" ..
    "bCBIZWFsVG9nZ2xlID0gVGFicy5NYWluOkFkZFRvZ2dsZSgiSGVhbFRvZ2dsZSIsIHsKICAgICAgICBUaXRsZSA9ICJBdXRvIEhlYWwiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZQogICAgfSkKICAgIEhlYWxUb2dnbGU6T25DaGFuZ2VkKGZ1bmN0aW9uKHYpIGhlYWxFbmFibGVkID0gdiBlbmQpCgogICAgbG9jYWwgSGVhbEhQU2xpZGVyID0gVGFicy5NYWluOkFkZFNsaWRlcigiSGVhbEhQU2xpZGVyIiwgewogICAgICAgIFRpdGxlID0gIkhlYWwgSFAiLAogICAgICAgIE1pbiA9IDEsIE1heCA9IDEwMCwgRGVmYXVsdCA9IDUwLAogICAgICAgIFJvdW5kaW5nID0gMCwgVmFsdWVOYW1lID0gIkhQIgogICAgfSkKICAgIEhlYWxIUFNsaWRlcjpPbkNoYW5nZWQoZnVuY3Rpb24odikgaGVhbEhQVGhyZXNob2xkID0gdiBlbmQpCgogICAgbG9jYWwgSGVhbERpc3RhbmNlU2xpZGVyID0gVGFicy5NYWluOkFkZFNsaWRlcigiSGVhbERpc3RhbmNlU2xpZGVyIiwgewogICAgICAgIFRpdGxlID0gIkRpc3RhbmNlIiwKICAgICAgICBNaW4gPSAxLCBNYXggPSAxNTAsIERlZmF1bHQgPSA1MCwKICAgICAgICBSb3VuZGluZyA9IDAsIFZhbHVlTmFtZSA9ICJzdHVkcyIKICAgIH0pCiAgICBIZWFsRGlzdGFuY2VTbGlkZXI6T25DaGFuZ2VkKGZ1bmN0aW9uKHYpIGhlYWxEaXN0YW5jZSA9IHYgZW5kKQoKICAgIC0tIEhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t" ..
    "LQogICAgbG9jYWwgZnVuY3Rpb24gZ2V0UGxheWVyc0ZvbGRlcnMoKQogICAgICAgIGxvY2FsIHBmID0gd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJzIikKICAgICAgICBpZiBub3QgcGYgdGhlbiByZXR1cm4gbmlsLCBuaWwsIG5pbCBlbmQKICAgICAgICByZXR1cm4gcGYsIHBmOkZpbmRGaXJzdENoaWxkKCJLaWxsZXJzIiksIHBmOkZpbmRGaXJzdENoaWxkKCJTdXJ2aXZvcnMiKQogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gYmVsb25nc1RvTWUobSkKICAgICAgICBpZiBub3QgKG0gYW5kIG06SXNBKCJNb2RlbCIpKSB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgICBpZiBtOkdldEF0dHJpYnV0ZSgiVXNlcm5hbWUiKSA9PSBscC5OYW1lIHRoZW4gcmV0dXJuIHRydWUgZW5kCiAgICAgICAgbG9jYWwgVXNlcm5hbWVTViA9IG06RmluZEZpcnN0Q2hpbGQoIlVzZXJuYW1lIikKICAgICAgICBpZiBVc2VybmFtZVNWIGFuZCB0eXBlb2YoVXNlcm5hbWVTVi5WYWx1ZSkgPT0gInN0cmluZyIgYW5kIFVzZXJuYW1lU1YuVmFsdWUgPT0gbHAuTmFtZSB0aGVuIHJldHVybiB0cnVlIGVuZAogICAgICAgIGxvY2FsIE93bmVyID0gbTpGaW5kRmlyc3RDaGlsZCgiT3duZXIiKSBvciBtOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXIiKQogICAgICAgIGlmIE93bmVyIGFuZCBPd25lci5WYWx1ZSA9PSBscCB0aGVuIHJldHVybiB0cnVlIGVuZAogICAgICAgIGxvY2FsIHVpZEF0dHIgPSBtOkdldEF0dHJpYnV0ZSgiVXNl" ..
    "cklkIikKICAgICAgICBpZiB1aWRBdHRyIGFuZCB0b251bWJlcih1aWRBdHRyKSA9PSBscC5Vc2VySWQgdGhlbiByZXR1cm4gdHJ1ZSBlbmQKICAgICAgICBpZiBtLk5hbWUgPT0gbHAuTmFtZSB0aGVuIHJldHVybiB0cnVlIGVuZAogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gZ2V0TXlTaGVkbGV0c2t5KCkKICAgICAgICBsb2NhbCBwZiwga2lsbGVyc0ZvbGRlciwgc3Vydml2b3JzRm9sZGVyID0gZ2V0UGxheWVyc0ZvbGRlcnMoKQogICAgICAgIGxvY2FsIGNhbmRpZGF0ZXMgPSB7fQoKICAgICAgICBsb2NhbCBmdW5jdGlvbiBzY2FuKGNvbnRhaW5lcikKICAgICAgICAgICAgaWYgbm90IGNvbnRhaW5lciB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgZm9yIF8sIGQgaW4gaXBhaXJzKGNvbnRhaW5lcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgZDpJc0EoIk1vZGVsIikgYW5kIGQuTmFtZSA9PSAiU2hlZGxldHNreSIgYW5kIGQ6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgYW5kIGQ6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgYmVsb25nc1RvTWUoZCkgdGhlbiB0YWJsZS5pbnNlcnQoY2FuZGlkYXRlcywgZCkgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIHNjYW4oa2lsbGVyc0ZvbGRlcikKICAgICAgICBzY2Fu" ..
    "KHN1cnZpdm9yc0ZvbGRlcikKICAgICAgICBzY2FuKHdvcmtzcGFjZSkKCiAgICAgICAgaWYgI2NhbmRpZGF0ZXMgPT0gMCB0aGVuIHJldHVybiBuaWwsIG5pbCwgbmlsIGVuZAoKICAgICAgICBsb2NhbCBiYXNlUG9zCiAgICAgICAgaWYgbHAuQ2hhcmFjdGVyIGFuZCBscC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgIGJhc2VQb3MgPSBscC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBiZXN0LCBiZXN0RGlzdCA9IGNhbmRpZGF0ZXNbMV0sIG1hdGguaHVnZQogICAgICAgIGlmIGJhc2VQb3MgdGhlbgogICAgICAgICAgICBmb3IgXywgbSBpbiBpcGFpcnMoY2FuZGlkYXRlcykgZG8KICAgICAgICAgICAgICAgIGxvY2FsIGhycCA9IG06RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgaWYgaHJwIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkID0gKGhycC5Qb3NpdGlvbiAtIGJhc2VQb3MpLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgICAgIGlmIGQgPCBiZXN0RGlzdCB0aGVuIGJlc3QsIGJlc3REaXN0ID0gbSwgZCBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgaHVtID0gYmVzdDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICBsb2Nh" ..
    "bCBocnAgPSBiZXN0OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICByZXR1cm4gYmVzdCwgaHVtLCBocnAKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIGdldE5lYXJlc3RLaWxsZXJEaXN0KGZyb21IUlAsIG15TW9kZWwpCiAgICAgICAgbG9jYWwgXywga2lsbGVyc0ZvbGRlciA9IGdldFBsYXllcnNGb2xkZXJzKCkKICAgICAgICBpZiBub3QgKGtpbGxlcnNGb2xkZXIgYW5kIGZyb21IUlApIHRoZW4gcmV0dXJuIG1hdGguaHVnZSBlbmQKICAgICAgICBsb2NhbCBuZWFyZXN0ID0gbWF0aC5odWdlCiAgICAgICAgZm9yIF8sIGsgaW4gaXBhaXJzKGtpbGxlcnNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgayB+PSBteU1vZGVsIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGtocnAgPSBrOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgIGlmIGtocnAgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGQgPSAoZnJvbUhSUC5Qb3NpdGlvbiAtIGtocnAuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgICAgIGlmIGQgPCBuZWFyZXN0IHRoZW4gbmVhcmVzdCA9IGQgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIG5lYXJlc3QKICAgIGVuZAoKICAgIC0tIE1haW4gbG9vcCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t" ..
    "LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBpZiBub3QgaGVhbEVuYWJsZWQgdGhlbiByZXR1cm4gZW5kCgogICAgICAgIGxvY2FsIG15TW9kZWwsIG15SHVtYW5vaWQsIG15SFJQID0gZ2V0TXlTaGVkbGV0c2t5KCkKICAgICAgICBpZiBub3QgKG15TW9kZWwgYW5kIG15SHVtYW5vaWQgYW5kIG15SFJQKSB0aGVuIHJldHVybiBlbmQKICAgICAgICBpZiBteUh1bWFub2lkLkhlYWx0aCA8PSAwIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBsb2NhbCBuZWFyZXN0RGlzdCA9IGdldE5lYXJlc3RLaWxsZXJEaXN0KG15SFJQLCBteU1vZGVsKQoKICAgICAgICBpZiBteUh1bWFub2lkLkhlYWx0aCA8PSBoZWFsSFBUaHJlc2hvbGQgYW5kIG5lYXJlc3REaXN0ID49IGhlYWxEaXN0YW5jZSB0aGVuCiAgICAgICAgICAgIHVzZUhlYWwoKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCgoKICAgIFRhYnMuTWFpbjpBZGRTZWN0aW9uKCLihrMgQ2hhbmNlIikKCgoKZG8KbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCBTdGF0cyA9IGdhbWU6R2V0U2VydmljZSgiU3RhdHMiKQpsb2NhbCBSZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKQoKbG9jYWwgTG9jYWxQbGF5ZXIg" ..
    "PSBQbGF5ZXJzLkxvY2FsUGxheWVyCgpsb2NhbCBhY3RpdmUgPSBmYWxzZQpsb2NhbCB1c2VPZmZzZXQgPSB0cnVlCmxvY2FsIHByZWRpY3Rpb25Nb2RlID0gIlNwZWVkIgpsb2NhbCBhaW1Nb2RlID0gIk5vcm1hbCIKbG9jYWwgYWltRHVyYXRpb24gPSAxLjcKbG9jYWwgZmFzdGVyRHVyYXRpb24gPSAxLjUKbG9jYWwgc3BpbkR1cmF0aW9uID0gMC41CmxvY2FsIGFpbVRhcmdldHMgPSB7IlNsYXNoZXIiLCAiYzAwbGtpZGQiLCAiSm9obkRvZSIsICIxeDF4MXgxIiwgIk5vbGkiLCAiR3Vlc3QgNjY2IiwgIlNpeGVyIn0KCmxvY2FsIEh1bWFub2lkLCBIUlAgPSBuaWwsIG5pbApsb2NhbCBvcmlnaW5hbFdTLCBvcmlnaW5hbEpQLCBvcmlnaW5hbEF1dG9Sb3RhdGUgPSBuaWwsIG5pbCwgbmlsCmxvY2FsIGFpbWluZyA9IGZhbHNlCmxvY2FsIHByZXZGbGludFZpc2libGVBaW0gPSBmYWxzZQpsb2NhbCBsYXN0VHJpZ2dlclRpbWUgPSAwCgpsb2NhbCBhdXRvQ29pbmZsaXAgPSBmYWxzZQpsb2NhbCBjb2luZmxpcFRhcmdldENoYXJnZSA9IDMKbG9jYWwgY29pbmZsaXBDb29sZG93biA9IDAuMTUKbG9jYWwgbGFzdENvaW5mbGlwVGltZSA9IDAKCmxvY2FsIGJsb2NrQ29pbmZsaXBXaGVuQ2xvc2UgPSB0cnVlCmxvY2FsIGNvaW5mbGlwQmxvY2tEaXN0ID0gNTAKCmxvY2FsIFJlbW90ZUV2ZW50CnBjYWxsKGZ1bmN0aW9uKCkKICAgIFJlbW90ZUV2ZW50ID0gUmVwbGljYXRlZFN0b3JhZ2U6V2FpdEZvckNoaWxkKCJNb2R1bGVzIik6" ..
    "V2FpdEZvckNoaWxkKCJOZXR3b3JrIik6V2FpdEZvckNoaWxkKCJSZW1vdGVFdmVudCIpCmVuZCkKCi0tID09PT09PT09PT09PT09PT09IEdVSSA9PT09PT09PT09PT09PT09PQpUYWJzLk1haW46QWRkRHJvcGRvd24oIkFpbU1vZGUiLCB7CiAgICBUaXRsZSA9ICJBaW0gTW9kZSIsCiAgICBWYWx1ZXMgPSB7Ik5vcm1hbCIsICJGYXN0ZXIiLCAiUmVmbGV4In0sCiAgICBEZWZhdWx0ID0gIk5vcm1hbCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbCkgYWltTW9kZSA9IHZhbCBlbmQKfSkKClRhYnMuTWFpbjpBZGREcm9wZG93bigiUHJlZGljdGlvbk1vZGUiLCB7CiAgICBUaXRsZSA9ICJQcmVkaWN0aW9uIE1vZGUiLAogICAgVmFsdWVzID0geyJTcGVlZCIsICJQaW5nIiwgImZyb250IiwgIk5vIExhZyJ9LAogICAgRGVmYXVsdCA9ICJTcGVlZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbCkgcHJlZGljdGlvbk1vZGUgPSB2YWwgZW5kCn0pCgpUYWJzLk1haW46QWRkRHJvcGRvd24oIkNvaW5mbGlwQ2hhcmdlRHJvcGRvd24iLCB7CiAgICBUaXRsZSA9ICJTZWxlY3QgU2NvcmUiLAogICAgVmFsdWVzID0geyIxIFBvaW50IiwgIjIgUG9pbnQiLCAiMyBQb2ludCJ9LAogICAgRGVmYXVsdCA9ICIzIFBvaW50IiwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbCkKICAgIGxvY2FsIG51bSA9IHRvbnVtYmVyKHZhbCBhbmQgdmFsOm1hdGNoKCIlZCsiKSkKICAgIGlmIG51bSB0aGVuIGNvaW5mbGlwVGFyZ2V0Q2hhcmdl" ..
    "ID0gbnVtIGVuZAplbmQpCgpUYWJzLk1haW46QWRkSW5wdXQoIkNvaW5mbGlwRGlzdGFuY2UiLCB7CiAgICBUaXRsZSA9ICJEaXN0YW5jZSIsCiAgICBEZWZhdWx0ID0gIjUwIiwKICAgIFBsYWNlaG9sZGVyID0gIkVudGVyIHN0dWRzIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsKQogICAgICAgIGxvY2FsIG51bSA9IHRvbnVtYmVyKHZhbCkKICAgICAgICBpZiBudW0gYW5kIG51bSA+IDAgdGhlbgogICAgICAgICAgICBjb2luZmxpcEJsb2NrRGlzdCA9IG51bQogICAgICAgIGVuZAogICAgZW5kCn0pCgpUYWJzLk1haW46QWRkVG9nZ2xlKCJCbG9ja0NvaW5mbGlwVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiU2FmZSBNb2RlIiwKICAgIERlZmF1bHQgPSB0cnVlLAp9KTpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICBibG9ja0NvaW5mbGlwV2hlbkNsb3NlID0gc3RhdGUKZW5kKQoKVGFicy5NYWluOkFkZFRvZ2dsZSgiT2Zmc2V0VG9nZ2xlIiwgewogICAgVGl0bGUgPSAiRW5hYmxlIE9mZnNldCIsCiAgICBEZWZhdWx0ID0gdHJ1ZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpIHVzZU9mZnNldCA9IHN0YXRlIGVuZAp9KQoKVGFicy5NYWluOkFkZFRvZ2dsZSgiQWltYm90VG9nZ2xlIiwgewogICAgVGl0bGUgPSAiQXV0byBBaW0gU2hvb3QiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkgYWN0aXZlID0gc3RhdGUgZW5kCn0pCgpUYWJzLk1haW46QWRk" ..
    "VG9nZ2xlKCJBdXRvQ29pbmZsaXBUb2dnbGUiLCB7CiAgICBUaXRsZSA9ICJBdXRvIENvaW4gRmxpcCIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgIGF1dG9Db2luZmxpcCA9IHN0YXRlCmVuZCkKCi0tID09PT09PT09PT09PT09PT09IENoYXJhY3RlciBTZXR1cCA9PT09PT09PT09PT09PT09PQpsb2NhbCBmdW5jdGlvbiBzZXR1cENoYXJhY3RlcihjaGFyKQogICAgSHVtYW5vaWQgPSBjaGFyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiKQogICAgSFJQID0gY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQplbmQKaWYgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4gc2V0dXBDaGFyYWN0ZXIoTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyKSBlbmQKTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChzZXR1cENoYXJhY3RlcikKCi0tID09PT09PT09PT09PT09PT09IEhlbHBlcnMgPT09PT09PT09PT09PT09PT0KbG9jYWwgZnVuY3Rpb24gZ2V0VmFsaWRUYXJnZXQoKQogICAgLS0gUXXDqXQgdOG6pXQgY+G6oyBQbGF5ZXJzCiAgICBmb3IgXywgcGxyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICBpZiBwbHIgfj0gTG9jYWxQbGF5ZXIgYW5kIHBsci5DaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICBsb2NhbCBjaGFyID0gcGxyLkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxk" ..
    "KCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgaWYgaHJwIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCB0YXJnZXROYW1lIGluIGlwYWlycyhhaW1UYXJnZXRzKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIGNoYXIuTmFtZTpsb3dlcigpOmZpbmQodGFyZ2V0TmFtZTpsb3dlcigpKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBocnAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIG5pbAplbmQKCmxvY2FsIGZ1bmN0aW9uIGdldFBpbmdTZWNvbmRzKCkKICAgIGxvY2FsIHBpbmdTdGF0ID0gU3RhdHMuTmV0d29yay5TZXJ2ZXJTdGF0c0l0ZW1bIkRhdGEgUGluZyJdCiAgICBpZiBwaW5nU3RhdCB0aGVuIHJldHVybiBwaW5nU3RhdDpHZXRWYWx1ZSgpIC8gMTAwMCBlbmQKICAgIHJldHVybiAwLjEKZW5kCgpsb2NhbCBmdW5jdGlvbiBpc0ZsaW50bG9ja1Zpc2libGUoKQogICAgaWYgbm90IExvY2FsUGxheWVyLkNoYXJhY3RlciB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIGxvY2FsIGZsaW50ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJGbGludGxvY2siLCB0cnVlKQogICAgaWYgbm90IGZsaW50IHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgaWYgbm90IChmbGludDpJc0EoIkJhc2VQYXJ0Iikgb3IgZmxpbnQ6SXNBKCJNZXNoUGFydCIpIG9y" ..
    "IGZsaW50OklzQSgiVW5pb25PcGVyYXRpb24iKSkgdGhlbgogICAgICAgIGZsaW50ID0gZmxpbnQ6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiQmFzZVBhcnQiLCB0cnVlKQogICAgICAgIGlmIG5vdCBmbGludCB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIGVuZAogICAgcmV0dXJuIGZsaW50LlRyYW5zcGFyZW5jeSA8IDEKZW5kCgpsb2NhbCBtb3ZlbWVudFRocmVzaG9sZCA9IDAuNQpsb2NhbCBmdW5jdGlvbiBnZXRQcmVkaWN0ZWRBaW1Qb3NQaW5nKHRhcmdldEhSUCkKICAgIGxvY2FsIHBpbmcgPSBnZXRQaW5nU2Vjb25kcygpCiAgICBsb2NhbCB2ZWxvY2l0eSA9IHRhcmdldEhSUC5WZWxvY2l0eQogICAgaWYgdmVsb2NpdHkuTWFnbml0dWRlIDw9IG1vdmVtZW50VGhyZXNob2xkIHRoZW4gcmV0dXJuIHRhcmdldEhSUC5Qb3NpdGlvbiBlbmQKICAgIHJldHVybiB0YXJnZXRIUlAuUG9zaXRpb24gKyAodmVsb2NpdHkgKiBwaW5nKQplbmQKCmxvY2FsIGZ1bmN0aW9uIGdldFByZWRpY3RlZEFpbVBvc0luZnJvbnRIUlBQaW5nKHRhcmdldEhSUCkKICAgIGxvY2FsIHBpbmcgPSBnZXRQaW5nU2Vjb25kcygpCiAgICBsb2NhbCBzdHVkcyA9IHBpbmcgKiA2MAogICAgaWYgdGFyZ2V0SFJQLlZlbG9jaXR5Lk1hZ25pdHVkZSA8PSBtb3ZlbWVudFRocmVzaG9sZCB0aGVuIHJldHVybiB0YXJnZXRIUlAuUG9zaXRpb24gZW5kCiAgICByZXR1cm4gdGFyZ2V0SFJQLlBvc2l0aW9uICsgKHRhcmdldEhSUC5DRnJhbWUuTG9va1ZlY3Rv" ..
    "ciAqIHN0dWRzKQplbmQKCmxvY2FsIGZ1bmN0aW9uIGNvbXB1dGVBaW1Qb3ModGFyZ2V0SFJQKQogICAgaWYgcHJlZGljdGlvbk1vZGUgPT0gIlBpbmciIHRoZW4KICAgICAgICByZXR1cm4gZ2V0UHJlZGljdGVkQWltUG9zUGluZyh0YXJnZXRIUlApCiAgICBlbHNlaWYgcHJlZGljdGlvbk1vZGUgPT0gImZyb250IiB0aGVuCiAgICAgICAgcmV0dXJuIHRhcmdldEhSUC5Qb3NpdGlvbiArIHRhcmdldEhSUC5DRnJhbWUuTG9va1ZlY3RvciAqIDQKICAgIGVsc2VpZiBwcmVkaWN0aW9uTW9kZSA9PSAiTm8gTGFnIiB0aGVuCiAgICAgICAgcmV0dXJuIGdldFByZWRpY3RlZEFpbVBvc0luZnJvbnRIUlBQaW5nKHRhcmdldEhSUCkKICAgIGVsc2UKICAgICAgICBsb2NhbCB2ZWxvY2l0eSA9IHRhcmdldEhSUC5WZWxvY2l0eQogICAgICAgIGlmIHZlbG9jaXR5Lk1hZ25pdHVkZSA+IDAuMSB0aGVuCiAgICAgICAgICAgIGlmIHVzZU9mZnNldCBhbmQgSFJQIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIG9rLCB0b1RhcmdldCA9IHBjYWxsKGZ1bmN0aW9uKCkgcmV0dXJuICh0YXJnZXRIUlAuUG9zaXRpb24gLSBIUlAuUG9zaXRpb24pLlVuaXQgZW5kKQogICAgICAgICAgICAgICAgaWYgbm90IG9rIHRoZW4gcmV0dXJuIHRhcmdldEhSUC5Qb3NpdGlvbiBlbmQKICAgICAgICAgICAgICAgIGxvY2FsIG1vdmVEaXIgPSB2ZWxvY2l0eS5Vbml0CiAgICAgICAgICAgICAgICBsb2NhbCBkb3QgPSB0b1RhcmdldDpEb3QobW92ZURpcikK" ..
    "ICAgICAgICAgICAgICAgIGlmIG1hdGguYWJzKGRvdCkgPCAwLjg1IHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0SFJQLlBvc2l0aW9uICsgdmVsb2NpdHkgKiAoNCAvIDYwKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRIUlAuUG9zaXRpb24KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0SFJQLlBvc2l0aW9uCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIHRhcmdldEhSUC5Qb3NpdGlvbgogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gc2FmZVNldENGcmFtZShuZXdDRikKICAgIGlmIHR5cGVvZihuZXdDRikgPT0gIkNGcmFtZSIgYW5kIHRvc3RyaW5nKG5ld0NGKSB+PSAibmFuIiBhbmQgSFJQIHRoZW4KICAgICAgICBIUlAuQ0ZyYW1lID0gbmV3Q0YKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIGZhY2VJbnN0YW50KHRvUG9zKQogICAgaWYgbm90IEhSUCBvciBub3QgdG9Qb3MgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBmcm9tUG9zID0gSFJQLlBvc2l0aW9uCiAgICBpZiAodG9Qb3MgLSBmcm9tUG9zKS5NYWduaXR1ZGUgPCAwLjAxIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgbG9va0F0ID0gVmVjdG9yMy5uZXcodG9Qb3MuWCwgZnJvbVBvcy5ZLCB0b1Bvcy5aKQogICAgbG9jYWwgdGFyZ2V0Q0Yg" ..
    "PSBDRnJhbWUubmV3KGZyb21Qb3MsIGxvb2tBdCkKICAgIHNhZmVTZXRDRnJhbWUoSFJQLkNGcmFtZTpMZXJwKHRhcmdldENGLCAwLjk5KSkKZW5kCgotLSA9PT09PT09PT09PT09PT09PSBDb2luZmxpcCBoZWxwZXJzID09PT09PT09PT09PT09PT09CmxvY2FsIGZ1bmN0aW9uIGdldEFiaWxpdHlDb250YWluZXIoKQogICAgbG9jYWwgb2ssIGNvbnRhaW5lciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBndWkgPSBMb2NhbFBsYXllcjpGaW5kRmlyc3RDaGlsZCgiUGxheWVyR3VpIikKICAgICAgICBpZiBub3QgZ3VpIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgICAgICBsb2NhbCBtYWluVUkgPSBndWk6RmluZEZpcnN0Q2hpbGQoIk1haW5VSSIpCiAgICAgICAgaWYgbm90IG1haW5VSSB0aGVuIHJldHVybiBuaWwgZW5kCiAgICAgICAgcmV0dXJuIG1haW5VSTpGaW5kRmlyc3RDaGlsZCgiQWJpbGl0eUNvbnRhaW5lciIpCiAgICBlbmQpCiAgICBpZiBvayB0aGVuIHJldHVybiBjb250YWluZXIgZW5kCiAgICByZXR1cm4gbmlsCmVuZAoKbG9jYWwgZnVuY3Rpb24gdHJ5QWN0aXZhdGVCdXR0b24oYnV0dG9uKQogICAgaWYgbm90IGJ1dHRvbiB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIHBjYWxsKGZ1bmN0aW9uKCkgaWYgYnV0dG9uLkFjdGl2YXRlIHRoZW4gYnV0dG9uOkFjdGl2YXRlKCkgZW5kIGVuZCkKICAgIGxvY2FsIG9rLCBjb25ucyA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBpZiB0eXBlKGdldGNv" ..
    "bm5lY3Rpb25zKSA9PSAiZnVuY3Rpb24iIGFuZCBidXR0b24uTW91c2VCdXR0b24xQ2xpY2sgdGhlbgogICAgICAgICAgICByZXR1cm4gZ2V0Y29ubmVjdGlvbnMoYnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrKQogICAgICAgIGVuZAogICAgICAgIHJldHVybiBuaWwKICAgIGVuZCkKICAgIGlmIG9rIGFuZCBjb25ucyB0aGVuCiAgICAgICAgZm9yIF8sIGNvbm4gaW4gaXBhaXJzKGNvbm5zKSBkbwogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBjb25uLkZ1bmN0aW9uIHRoZW4gY29ubi5GdW5jdGlvbigpCiAgICAgICAgICAgICAgICBlbHNlaWYgY29ubi5mdW5jIHRoZW4gY29ubi5mdW5jKCkKICAgICAgICAgICAgICAgIGVsc2VpZiBjb25uLkZpcmUgdGhlbiBjb25uLkZpcmUoKSBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCiAgICBwY2FsbChmdW5jdGlvbigpIGlmIGJ1dHRvbi5BY3RpdmF0ZWQgdGhlbiBidXR0b24uQWN0aXZhdGVkOkZpcmUoKSBlbmQgZW5kKQogICAgcGNhbGwoZnVuY3Rpb24oKSBpZiBidXR0b24uTW91c2VCdXR0b24xQ2xpY2sgdGhlbiBidXR0b24uTW91c2VCdXR0b24xQ2xpY2s6RmlyZSgpIGVuZCBlbmQpCiAgICByZXR1cm4gdHJ1ZQplbmQKCmxvY2FsIGZ1bmN0aW9uIGZpbmRBYmlsaXR5QnV0dG9uQnlOYW1lKG5hbWUpCiAgICBsb2NhbCBjb250YWluZXIgPSBnZXRBYmlsaXR5Q29udGFpbmVyKCkKICAgIGlmIG5vdCBjb250YWlu" ..
    "ZXIgdGhlbiByZXR1cm4gbmlsIGVuZAogICAgbG9jYWwgYnRuID0gY29udGFpbmVyOkZpbmRGaXJzdENoaWxkKG5hbWUpCiAgICBpZiBidG4gdGhlbiByZXR1cm4gYnRuIGVuZAogICAgbG9jYWwgbG5hbWUgPSBuYW1lOmxvd2VyKCkKICAgIGZvciBfLCBjaGlsZCBpbiBpcGFpcnMoY29udGFpbmVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgY2hpbGQuTmFtZSBhbmQgY2hpbGQuTmFtZTpsb3dlcigpOmZpbmQobG5hbWUpIHRoZW4gcmV0dXJuIGNoaWxkIGVuZAogICAgICAgIGxvY2FsIGZvdW5kID0gY2hpbGQ6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSW1hZ2VCdXR0b24iKSBvciBjaGlsZDpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJUZXh0QnV0dG9uIikKICAgICAgICBpZiBmb3VuZCBhbmQgZm91bmQuTmFtZSBhbmQgZm91bmQuTmFtZTpsb3dlcigpOmZpbmQobG5hbWUpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIGZvdW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBuaWwKZW5kCgpsb2NhbCBmdW5jdGlvbiBjbGlja0NvaW5mbGlwQnV0dG9uKCkKICAgIGxvY2FsIHRyeU5hbWVzID0geyJDb2luRmxpcCIsICJDb2luIiwgIlJlcm9sbCJ9CiAgICBmb3IgXywgbiBpbiBpcGFpcnModHJ5TmFtZXMpIGRvCiAgICAgICAgbG9jYWwgYiA9IGZpbmRBYmlsaXR5QnV0dG9uQnlOYW1lKG4pCiAgICAgICAgaWYgYiB0aGVuCiAgICAgICAgICAgIGlmIHRyeUFjdGl2YXRlQnV0dG9uKGIpIHRoZW4gcmV0dXJu" ..
    "IHRydWUgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBmYWxzZQplbmQKCmxvY2FsIGZ1bmN0aW9uIGZpbmRSZXJvbGxDb250YWluZXIoKQogICAgbG9jYWwgY29udGFpbmVyID0gZ2V0QWJpbGl0eUNvbnRhaW5lcigpCiAgICBpZiBub3QgY29udGFpbmVyIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgIGxvY2FsIHJlcm9sbCA9IGNvbnRhaW5lcjpGaW5kRmlyc3RDaGlsZCgiUmVyb2xsIikgb3IgY29udGFpbmVyOkZpbmRGaXJzdENoaWxkKCJSZXJvbGxBYmlsaXR5Iikgb3IgbmlsCiAgICBpZiByZXJvbGwgdGhlbiByZXR1cm4gcmVyb2xsIGVuZAogICAgZm9yIF8sIGNoaWxkIGluIGlwYWlycyhjb250YWluZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBmb3IgXywgb2JqIGluIGlwYWlycyhjaGlsZDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICBpZiAob2JqOklzQSgiVGV4dExhYmVsIikgb3Igb2JqOklzQSgiVGV4dEJ1dHRvbiIpIG9yIG9iajpJc0EoIlRleHRCb3giKSkgYW5kIG9iai5UZXh0IGFuZCB0b3N0cmluZyhvYmouVGV4dCk6bWF0Y2goIiVkIikgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gbmlsCmVuZAoKbG9jYWwgZnVuY3Rpb24gZ2V0TmVhcmJ5TWF4TnVtYmVyKCkKICAgIGxvY2FsIHJlcm9sbCA9IGZpbmRSZXJvbGxDb250YWluZXIoKQogICAgaWYgbm90IHJlcm9sbCB0aGVu" ..
    "IHJldHVybiBuaWwgZW5kCiAgICBsb2NhbCBtYXhOdW0gPSBuaWwKICAgIGZvciBfLCBvYmogaW4gaXBhaXJzKHJlcm9sbDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgIGlmIChvYmo6SXNBKCJUZXh0TGFiZWwiKSBvciBvYmo6SXNBKCJUZXh0QnV0dG9uIikgb3Igb2JqOklzQSgiVGV4dEJveCIpKSBhbmQgb2JqLlRleHQgdGhlbgogICAgICAgICAgICBmb3IgbnVtIGluIHRvc3RyaW5nKG9iai5UZXh0KTpnbWF0Y2goIiVkKyIpIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBuID0gdG9udW1iZXIobnVtKQogICAgICAgICAgICAgICAgaWYgbiB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IG1heE51bSBvciBuID4gbWF4TnVtIHRoZW4gbWF4TnVtID0gbiBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIG1heE51bQplbmQKCi0tID09PT09PT09PT09PT09PT09IE1haW4gbG9vcCA9PT09PT09PT09PT09PT09PQpSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAtLSBBSU1CT1QgTE9HSUMKICAgIGlmIGFjdGl2ZSBhbmQgSHVtYW5vaWQgYW5kIEhSUCB0aGVuCiAgICAgICAgbG9jYWwgaXNWaXNpYmxlID0gaXNGbGludGxvY2tWaXNpYmxlKCkKICAgICAgICBpZiBpc1Zpc2libGUgYW5kIG5vdCBwcmV2RmxpbnRWaXNpYmxlQWltIGFuZCBub3QgYWltaW5nIHRoZW4KICAgICAgICAgICAgbGFzdFRy" ..
    "aWdnZXJUaW1lID0gdGljaygpCiAgICAgICAgICAgIGFpbWluZyA9IHRydWUKICAgICAgICBlbmQKICAgICAgICBwcmV2RmxpbnRWaXNpYmxlQWltID0gaXNWaXNpYmxlCgogICAgICAgIGlmIGFpbWluZyB0aGVuCiAgICAgICAgICAgIGxvY2FsIGVsYXBzZWQgPSB0aWNrKCkgLSBsYXN0VHJpZ2dlclRpbWUKCiAgICAgICAgICAgIGlmIGFpbU1vZGUgPT0gIlJlZmxleCIgdGhlbgogICAgICAgICAgICAgICAgaWYgZWxhcHNlZCA8PSBzcGluRHVyYXRpb24gdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNwaW5Qcm9ncmVzcyA9IGVsYXBzZWQgLyBzcGluRHVyYXRpb24KICAgICAgICAgICAgICAgICAgICBsb2NhbCBzcGluQW5nbGUgPSBtYXRoLnJhZCgzNjAgKiBzcGluUHJvZ3Jlc3MpCiAgICAgICAgICAgICAgICAgICAgc2FmZVNldENGcmFtZShDRnJhbWUubmV3KEhSUC5Qb3NpdGlvbikgKiBDRnJhbWUuQW5nbGVzKDAsIHNwaW5BbmdsZSwgMCkpCiAgICAgICAgICAgICAgICBlbHNlaWYgZWxhcHNlZCA8PSBzcGluRHVyYXRpb24gKyAwLjcgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvcmlnaW5hbFdTIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxXUywgb3JpZ2luYWxKUCwgb3JpZ2luYWxBdXRvUm90YXRlID0gSHVtYW5vaWQuV2Fsa1NwZWVkLCBIdW1hbm9pZC5KdW1wUG93ZXIsIEh1bWFub2lkLkF1dG9Sb3RhdGUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAg" ..
    "ICAgICAgICAgICBIdW1hbm9pZC5BdXRvUm90YXRlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBIUlAuQXNzZW1ibHlBbmd1bGFyVmVsb2NpdHkgPSBWZWN0b3IzLnplcm8KICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRIUlAgPSBnZXRWYWxpZFRhcmdldCgpCiAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0SFJQIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZmFjZUluc3RhbnQoY29tcHV0ZUFpbVBvcyh0YXJnZXRIUlApKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGFpbWluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgaWYgb3JpZ2luYWxXUyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIEh1bWFub2lkLldhbGtTcGVlZCwgSHVtYW5vaWQuSnVtcFBvd2VyLCBIdW1hbm9pZC5BdXRvUm90YXRlID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsV1MsIG9yaWdpbmFsSlAsIG9yaWdpbmFsQXV0b1JvdGF0ZQogICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbFdTLCBvcmlnaW5hbEpQLCBvcmlnaW5hbEF1dG9Sb3RhdGUgPSBuaWwsIG5pbCwgbmlsCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgbG9jYWwgZHVyYXRpb24gPSAoYWltTW9kZSA9PSAiRmFzdGVyIikgYW5kIGZhc3RlckR1cmF0aW9u" ..
    "IG9yIGFpbUR1cmF0aW9uCiAgICAgICAgICAgICAgICBpZiBlbGFwc2VkIDw9IGR1cmF0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb3JpZ2luYWxXUyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsV1MsIG9yaWdpbmFsSlAsIG9yaWdpbmFsQXV0b1JvdGF0ZSA9IEh1bWFub2lkLldhbGtTcGVlZCwgSHVtYW5vaWQuSnVtcFBvd2VyLCBIdW1hbm9pZC5BdXRvUm90YXRlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgSHVtYW5vaWQuQXV0b1JvdGF0ZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgSFJQLkFzc2VtYmx5QW5ndWxhclZlbG9jaXR5ID0gVmVjdG9yMy56ZXJvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0SFJQID0gZ2V0VmFsaWRUYXJnZXQoKQogICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldEhSUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGZhY2VJbnN0YW50KGNvbXB1dGVBaW1Qb3ModGFyZ2V0SFJQKSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBhaW1pbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIGlmIG9yaWdpbmFsV1MgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBIdW1hbm9pZC5XYWxrU3BlZWQsIEh1bWFub2lkLkp1bXBQb3dlciwgSHVtYW5vaWQuQXV0b1JvdGF0ZSA9CiAgICAgICAgICAgICAgICAgICAgICAg" ..
    "ICAgICBvcmlnaW5hbFdTLCBvcmlnaW5hbEpQLCBvcmlnaW5hbEF1dG9Sb3RhdGUKICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxXUywgb3JpZ2luYWxKUCwgb3JpZ2luYWxBdXRvUm90YXRlID0gbmlsLCBuaWwsIG5pbAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gQ09JTkZMSVAgTE9HSUMKICAgIGlmIGF1dG9Db2luZmxpcCB0aGVuCiAgICAgICAgbG9jYWwgdG9vQ2xvc2UgPSBmYWxzZQogICAgICAgIGlmIGJsb2NrQ29pbmZsaXBXaGVuQ2xvc2UgdGhlbgogICAgICAgICAgICBsb2NhbCB0YXJnZXRIUlAgPSBnZXRWYWxpZFRhcmdldCgpCiAgICAgICAgICAgIGlmIHRhcmdldEhSUCBhbmQgSFJQIHRoZW4KICAgICAgICAgICAgICAgIGlmICh0YXJnZXRIUlAuUG9zaXRpb24gLSBIUlAuUG9zaXRpb24pLk1hZ25pdHVkZSA8PSBjb2luZmxpcEJsb2NrRGlzdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgdG9vQ2xvc2UgPSB0cnVlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIGlmIG5vdCB0b29DbG9zZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIG1heE51bSA9IGdldE5lYXJieU1heE51bWJlcigpCiAgICAgICAgICAgIGlmIG5vdCBtYXhOdW0gb3IgbWF4TnVtIDwgY29pbmZsaXBUYXJnZXRDaGFyZ2UgdGhlbgogICAgICAgICAgICAgICAgaWYg" ..
    "dGljaygpIC0gbGFzdENvaW5mbGlwVGltZSA+PSBjb2luZmxpcENvb2xkb3duIHRoZW4KICAgICAgICAgICAgICAgICAgICBsYXN0Q29pbmZsaXBUaW1lID0gdGljaygpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgb2sgPSBjbGlja0NvaW5mbGlwQnV0dG9uKCkKICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb2sgYW5kIFJlbW90ZUV2ZW50IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVtb3RlRXZlbnQ6RmlyZVNlcnZlcigiVXNlQWN0b3JBYmlsaXR5IiwgIkNvaW5GbGlwIikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZCkKZW5kCgoKCiAgICBUYWJzLk1haW46QWRkU2VjdGlvbigi4oazIFR3byBUaW1lIikKCgotLS8vIEF1dG8gQmFja3N0YWIgVW5pZmllZCAoQUkgQWltYm90ICsgUGxheWVyIEFpbWJvdCwgdOG7sSDEkeG7mW5nIHF1w6l0IEtpbGxlcnMgRm9sZGVyKQpkbwogICAgbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCiAgICBsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKICAgIGxvY2FsIGxwID0gUGxheWVycy5Mb2NhbFBsYXllcgoKICAgIC0tIOKame+4jyBDb25maWcKICAgIGxvY2FsIE1v" ..
    "ZGUgPSAiQUkgQWltYm90IgogICAgbG9jYWwgY2hlY2tSYWRpdXMgPSAxOAogICAgbG9jYWwgYmFja3N0YWJEZWxheSA9IDAuMDEKCiAgICBsb2NhbCBraWxsZXJzRm9sZGVyID0gd29ya3NwYWNlOldhaXRGb3JDaGlsZCgiUGxheWVycyIpOldhaXRGb3JDaGlsZCgiS2lsbGVycyIpCgogICAgbG9jYWwgQU5JTV9JRFMgPSB7CiAgICAgICAgIjExNTE5NDYyNDc5MTMzOSIsCiAgICAgICAgIjg2NTQ1MTMzMjY5ODEzIiwKICAgICAgICAiODk0NDgzNTQ2Mzc0NDIiLAogICAgICAgICI3NzExOTcxMDY5MzY1NCIsCiAgICAgICAgIjEwNzY0MDA2NTk3NzY4NiIsCiAgICAgICAgIjExMjkwMjI4NDcyNDU5OCIsCiAgICB9CgogICAgLS0g8J+UmCBVSQogICAgVGFicy5NYWluOkFkZERyb3Bkb3duKCJCYWNrc3RhYk1vZGUiLCB7CiAgICAgICAgVGl0bGUgPSAiQmFja3N0YWIgTW9kZSIsCiAgICAgICAgVmFsdWVzID0geyAiQUkgQWltYm90IiwgIlBsYXllciBBaW1ib3QiIH0sCiAgICAgICAgRGVmYXVsdCA9ICJBSSBBaW1ib3QiLAogICAgfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIE1vZGUgPSB2YWx1ZQogICAgICAgIHByaW50KCLwn46vIEJhY2tzdGFiIE1vZGU6IiwgdmFsdWUpCiAgICBlbmQpCgogICAgbG9jYWwgZW5hYmxlZCA9IGZhbHNlCiAgICBUYWJzLk1haW46QWRkVG9nZ2xlKCJBdXRvQmFja3N0YWIiLCB7CiAgICAgICAgVGl0bGUgPSAiQXV0byBCYWNrc3RhYiBWMiIsCiAgICAgICAgRGVmYXVs" ..
    "dCA9IGZhbHNlCiAgICB9KTpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZW5hYmxlZCA9IHN0YXRlCiAgICAgICAgcHJpbnQoIvCflKogQXV0byBCYWNrc3RhYjoiLCBzdGF0ZSBhbmQgIk9OIiBvciAiT0ZGIikKICAgIGVuZCkKCiAgICBUYWJzLk1haW46QWRkSW5wdXQoIkJhY2tzdGFiUmFkaXVzSW5wdXQiLCB7CiAgICAgICAgVGl0bGUgPSAiQ2hlY2sgUmFkaXVzIiwKICAgICAgICBEZWZhdWx0ID0gdG9zdHJpbmcoY2hlY2tSYWRpdXMpLAogICAgICAgIFBsYWNlaG9sZGVyID0gIldyaXRlIEhlcmUgKDEgLSA1MCkiLAogICAgICAgIE51bWVyaWMgPSB0cnVlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgICAgIGxvY2FsIG51bSA9IHRvbnVtYmVyKHZhbHVlKQogICAgICAgICAgICBpZiBudW0gdGhlbgogICAgICAgICAgICAgICAgY2hlY2tSYWRpdXMgPSBtYXRoLmNsYW1wKG51bSwgMSwgNTApCiAgICAgICAgICAgICAgICBwcmludCgi8J+TjyBDaGVjayBSYWRpdXMgc2V0IHRvOiIsIGNoZWNrUmFkaXVzKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBwcmludCgi4pqg77iPIE5o4bqtcCBz4buRIGjhu6NwIGzhu4chIikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQoKICAgIC0tID09PT09PT09PT09PT09PT09PT09PQogICAgLS0g8J+Xoe+4jyBEYWdnZXIgUmVtb3RlIEZpbmRlcgogICAgLS0gPT09PT09PT09PT09PT09PT09PT09CiAg" ..
    "ICBsb2NhbCBkYWdnZXJCdXR0b24sIGRhZ2dlclJlbW90ZSwgZGFnZ2VyQ29ubmVjdGlvbnMgPSBuaWwsIG5pbCwge30KCiAgICBsb2NhbCBmdW5jdGlvbiBmaW5kRGFnZ2VyUmVtb3RlKCkKICAgICAgICBpZiBkYWdnZXJSZW1vdGUgdGhlbiByZXR1cm4gZGFnZ2VyUmVtb3RlIGVuZAogICAgICAgIGlmIG5vdCBkYWdnZXJCdXR0b24gdGhlbiByZXR1cm4gbmlsIGVuZAogICAgICAgIGZvciBfLCBjb25uIGluIGlwYWlycyhnZXRjb25uZWN0aW9ucyhkYWdnZXJCdXR0b24uTW91c2VCdXR0b24xQ2xpY2spKSBkbwogICAgICAgICAgICBsb2NhbCBmID0gY29ubi5GdW5jdGlvbgogICAgICAgICAgICBpZiBmIGFuZCBpc2xjbG9zdXJlKGYpIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKGdldHVwdmFsdWVzKGYpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIHR5cGVvZih2KSA9PSAiSW5zdGFuY2UiIGFuZCB2OklzQSgiUmVtb3RlRXZlbnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGRhZ2dlclJlbW90ZSA9IHYKICAgICAgICAgICAgICAgICAgICAgICAgd2FybigiW0JhY2tzdGFiXSBGb3VuZCBEYWdnZXIgUmVtb3RlOiIsIHY6R2V0RnVsbE5hbWUoKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhZ2dlclJlbW90ZQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBu" ..
    "aWwKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIGluaXREYWdnZXJCdXR0b24oKQogICAgICAgIGxvY2FsIGd1aSA9IGxwOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJHdWkiKQogICAgICAgIGlmIG5vdCBndWkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgbWFpblVJID0gZ3VpOkZpbmRGaXJzdENoaWxkKCJNYWluVUkiKQogICAgICAgIGxvY2FsIGNvbnRhaW5lciA9IG1haW5VSSBhbmQgbWFpblVJOkZpbmRGaXJzdENoaWxkKCJBYmlsaXR5Q29udGFpbmVyIikKICAgICAgICBkYWdnZXJCdXR0b24gPSBjb250YWluZXIgYW5kIGNvbnRhaW5lcjpGaW5kRmlyc3RDaGlsZCgiRGFnZ2VyIikKICAgICAgICBpZiBkYWdnZXJCdXR0b24gYW5kIGRhZ2dlckJ1dHRvbjpJc0EoIkltYWdlQnV0dG9uIikgdGhlbgogICAgICAgICAgICBkYWdnZXJDb25uZWN0aW9ucyA9IGdldGNvbm5lY3Rpb25zKGRhZ2dlckJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljaykKICAgICAgICAgICAgZmluZERhZ2dlclJlbW90ZSgpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBpbml0RGFnZ2VyQnV0dG9uKCkKICAgIGxwLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgaW5pdERhZ2dlckJ1dHRvbigpCiAgICBlbmQpCgogICAgbG9jYWwgZnVuY3Rpb24gdXNlRGFnZ2VyKCkKICAgICAgICBpZiBkYWdnZXJSZW1vdGUgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAg" ..
    "ICAgICAgICAgICAgICBkYWdnZXJSZW1vdGU6RmlyZVNlcnZlcih0cnVlKQogICAgICAgICAgICAgICAgdGFzay5kZWxheSgwLjA1LCBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgZGFnZ2VyUmVtb3RlOkZpcmVTZXJ2ZXIoZmFsc2UpCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlaWYgZGFnZ2VyQnV0dG9uIHRoZW4KICAgICAgICAgICAgZm9yIF8sIGNvbm4gaW4gaXBhaXJzKGRhZ2dlckNvbm5lY3Rpb25zKSBkbwogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBjb25uOkZpcmUoKSBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpIGRhZ2dlckJ1dHRvbjpBY3RpdmF0ZSgpIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tID09PT09PT09PT09PT09PT09PT09PQogICAgLS0g4pqS77iPIEhlbHBlcnMKICAgIC0tID09PT09PT09PT09PT09PT09PT09PQogICAgbG9jYWwgZnVuY3Rpb24gZ2V0Q2hhcmFjdGVyKCkKICAgICAgICBsb2NhbCBjaCA9IGxwLkNoYXJhY3RlcgogICAgICAgIGlmIGNoIGFuZCBjaC5QYXJlbnQgdGhlbgogICAgICAgICAgICBsb2NhbCBocnAgPSBjaDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gY2g6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgIHJldHVybiBjaCwgaHVtYW5vaWQs" ..
    "IGhycAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBuaWwsIG5pbCwgbmlsCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBpc1BsYXlpbmdUYXJnZXRBbmltYXRpb24oaHVtYW5vaWQpCiAgICAgICAgaWYgbm90IGh1bWFub2lkIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgIGZvciBfLCB0IGluIGlwYWlycyhodW1hbm9pZDpHZXRQbGF5aW5nQW5pbWF0aW9uVHJhY2tzKCkpIGRvCiAgICAgICAgICAgIGxvY2FsIGFuaW1JZCA9IHRvc3RyaW5nKHQuQW5pbWF0aW9uLkFuaW1hdGlvbklkIG9yICIiKQogICAgICAgICAgICBmb3IgXywgaWQgaW4gaXBhaXJzKEFOSU1fSURTKSBkbwogICAgICAgICAgICAgICAgaWYgYW5pbUlkOmZpbmQoaWQsIDEsIHRydWUpIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gdGVsZXBvcnRCZWhpbmQodGFyZ2V0SFJQLCBteUhSUCkKICAgICAgICBsb2NhbCBsb29rID0gdGFyZ2V0SFJQLkNGcmFtZS5Mb29rVmVjdG9yCiAgICAgICAgbG9jYWwgZGVzdFBvcyA9IHRhcmdldEhSUC5Qb3NpdGlvbiAtIGxvb2sgKiAyCiAgICAgICAgbXlIUlAuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhkZXN0UG9zLCBkZXN0UG9zICsgbG9vaykKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIGlzQmVoaW5kVGFyZ2V0" ..
    "KHRhcmdldEhSUCwgbXlIUlApCiAgICAgICAgbG9jYWwgbG9vayA9IHRhcmdldEhSUC5DRnJhbWUuTG9va1ZlY3RvcgogICAgICAgIGxvY2FsIGRpciA9IChteUhSUC5Qb3NpdGlvbiAtIHRhcmdldEhSUC5Qb3NpdGlvbikuVW5pdAogICAgICAgIHJldHVybiBsb29rOkRvdChkaXIpIDwgLTAuNQogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gZ2V0TmVhcmJ5S2lsbGVycyhwb3NpdGlvbikKICAgICAgICBsb2NhbCBraWxsZXJzID0ge30KICAgICAgICBmb3IgXywgcGxyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgaWYgcGxyIH49IGxwIGFuZCBwbHIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGNoYXIgPSBwbHIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0Iikgb3IgY2hhci5QcmltYXJ5UGFydAogICAgICAgICAgICAgICAgaWYgaHJwIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkaXN0ID0gKGhycC5Qb3NpdGlvbiAtIHBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICBpZiBkaXN0IDw9IGNoZWNrUmFkaXVzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KGtpbGxlcnMsIHttb2RlbCA9IGNoYXIsIGhycCA9IGhycCwgZGlzdCA9IGRpc3R9KQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAg" ..
    "ICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBraWxsZXJzCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBnZXROZWFyYnlBSUtpbGxlcnMoaHJwKQogICAgICAgIGxvY2FsIGtpbGxlcnMgPSB7fQogICAgICAgIGZvciBfLCBraWxsZXIgaW4gaXBhaXJzKGtpbGxlcnNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgbG9jYWwga0hSUCA9IGtpbGxlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgIGlmIGtIUlAgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChrSFJQLlBvc2l0aW9uIC0gaHJwLlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgIGlmIGRpc3QgPD0gY2hlY2tSYWRpdXMgdGhlbgogICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChraWxsZXJzLCB7bW9kZWwgPSBraWxsZXIsIGhycCA9IGtIUlAsIGRpc3QgPSBkaXN0fSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4ga2lsbGVycwogICAgZW5kCgogICAgLS0gPT09PT09PT09PT09PT09PT09PT09CiAgICAtLSDwn5SEIE1haW4gTG9vcAogICAgLS0gPT09PT09PT09PT09PT09PT09PT09CiAgICBsb2NhbCBjb29sZG93biA9IGZhbHNlCiAgICBsb2NhbCBsYXN0VGFyZ2V0ID0gbmlsCgogICAgUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigp" ..
    "CiAgICAgICAgaWYgbm90IGVuYWJsZWQgb3IgY29vbGRvd24gdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgY2hhciwgaHVtYW5vaWQsIG15SFJQID0gZ2V0Q2hhcmFjdGVyKCkKICAgICAgICBpZiBub3QgKGNoYXIgYW5kIGh1bWFub2lkIGFuZCBteUhSUCkgdGhlbiByZXR1cm4gZW5kCgogICAgICAgIC0tIPCfmqggQ2jhu4kgaG/huqF0IMSR4buZbmcgbuG6v3UgbW9kZWwgbMOgICJUd29UaW1lIgogICAgICAgIGlmIGNoYXIuTmFtZSB+PSAiVHdvVGltZSIgdGhlbiByZXR1cm4gZW5kCgogICAgICAgIGlmIE1vZGUgPT0gIlBsYXllciBBaW1ib3QiIHRoZW4KICAgICAgICAgICAgaWYgaXNQbGF5aW5nVGFyZ2V0QW5pbWF0aW9uKGh1bWFub2lkKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBraWxsZXJzID0gZ2V0TmVhcmJ5S2lsbGVycyhteUhSUC5Qb3NpdGlvbikKICAgICAgICAgICAgICAgIGlmICNraWxsZXJzID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgdGFibGUuc29ydChraWxsZXJzLCBmdW5jdGlvbihhLGIpIHJldHVybiBhLmRpc3QgPCBiLmRpc3QgZW5kKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldCA9IGtpbGxlcnNbMV0KICAgICAgICAgICAgICAgICAgICBjb29sZG93biA9IHRydWUKCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3RhcnQgPSB0aWNrKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBjb25uCiAgICAgICAgICAgICAgICAgICAgY29ubiA9IFJ1blNlcnZp" ..
    "Y2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgKGNoYXIgYW5kIHRhcmdldC5ocnAgYW5kIGNoYXIuUGFyZW50IGFuZCB0YXJnZXQuaHJwLlBhcmVudCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29ubiB0aGVuIGNvbm46RGlzY29ubmVjdCgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29vbGRvd24gPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiB0aWNrKCkgLSBzdGFydCA+PSAwLjcgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29ubiB0aGVuIGNvbm46RGlzY29ubmVjdCgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay5kZWxheSgxLCBmdW5jdGlvbigpIGNvb2xkb3duID0gZmFsc2UgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB0ZWxlcG9ydEJlaGluZCh0YXJnZXQuaHJwLCBteUhSUCkKICAgICAgICAgICAgICAgICAgICAgICAgdXNlRGFnZ2VyKCkKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgIGVsc2VpZiBNb2RlID09ICJBSSBBaW1ib3QiIHRoZW4K" ..
    "ICAgICAgICAgICAgbG9jYWwga2lsbGVycyA9IGdldE5lYXJieUFJS2lsbGVycyhteUhSUCkKICAgICAgICAgICAgaWYgI2tpbGxlcnMgPiAwIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLnNvcnQoa2lsbGVycywgZnVuY3Rpb24oYSxiKSByZXR1cm4gYS5kaXN0IDwgYi5kaXN0IGVuZCkKICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldCA9IGtpbGxlcnNbMV0KICAgICAgICAgICAgICAgIGlmIHRhcmdldC5tb2RlbCB+PSBsYXN0VGFyZ2V0IGFuZCBpc0JlaGluZFRhcmdldCh0YXJnZXQuaHJwLCBteUhSUCkgdGhlbgogICAgICAgICAgICAgICAgICAgIGNvb2xkb3duID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIGxhc3RUYXJnZXQgPSB0YXJnZXQubW9kZWwKCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3RhcnQgPSB0aWNrKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBjb25uCiAgICAgICAgICAgICAgICAgICAgY29ubiA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgKGNoYXIgYW5kIGNoYXIuUGFyZW50IGFuZCB0YXJnZXQuaHJwIGFuZCB0YXJnZXQuaHJwLlBhcmVudCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29ubiB0aGVuIGNvbm46RGlzY29ubmVjdCgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAg" ..
    "ICAgICAgICAgICAgICBpZiB0aWNrKCkgLSBzdGFydCA+PSAwLjcgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29ubiB0aGVuIGNvbm46RGlzY29ubmVjdCgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay5kZWxheSgxMCwgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2xkb3duID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0VGFyZ2V0ID0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHRlbGVwb3J0QmVoaW5kKHRhcmdldC5ocnAsIG15SFJQKQogICAgICAgICAgICAgICAgICAgICAgICB1c2VEYWdnZXIoKQogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICBscC5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICBwcmludCgi8J+UhCBDaGFyYWN0ZXIgcmVzcGF3bmVkL2NoYW5nZWQsIEF1dG8gQmFja3N0YWIgduG6q24gaG/huqF0IMSR4buZbmcgKG7hur91IG1vZGVsID0gJ1R3b1RpbWUnKS4iKQogICAgZW5kKQplbmQKCgoKICAgIFRhYnMuTWFpbjpBZGRTZWN0aW9uKCLi" ..
    "hrMgMDA3bjciKQoKCmRvCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKICAgIGxvY2FsIHJ1bm5pbmcgPSBmYWxzZQogICAgbG9jYWwgYW5pbVRyYWNrCiAgICBsb2NhbCBJbnZpc2libGVFbmFibGVkID0gZmFsc2UKCiAgICAtLSDwn5SNIFThu7EgxJHhu5luZyBs4bqleSBTdXJ2aXZvcnMgdHJvbmcgd29ya3NwYWNlCiAgICBsb2NhbCBzdXJ2aXZvcnNGb2xkZXIgPSB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJQbGF5ZXJzIik6V2FpdEZvckNoaWxkKCJTdXJ2aXZvcnMiKQoKICAgIGxvY2FsIGZ1bmN0aW9uIGdldEh1bWFub2lkKCkKICAgICAgICBsb2NhbCBjaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIHJldHVybiBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSwgY2hhcgogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gZ2V0QW5pbWF0b3IoaHVtYW5vaWQpCiAgICAgICAgbG9jYWwgYW5pbWF0b3IgPSBodW1hbm9pZDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkFuaW1hdG9yIikKICAgICAgICBpZiBub3QgYW5pbWF0b3IgdGhlbgogICAgICAgICAgICBhbmltYXRvciA9IEluc3RhbmNlLm5ldygiQW5pbWF0b3IiKQogICAgICAgICAgICBhbmltYXRvci5QYXJlbnQgPSBodW1hbm9pZAogICAgICAg" ..
    "IGVuZAogICAgICAgIHJldHVybiBhbmltYXRvcgogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gcGxheUludmlzaWJsZUFuaW0oaHVtYW5vaWQpCiAgICAgICAgbG9jYWwgYW5pbWF0b3IgPSBnZXRBbmltYXRvcihodW1hbm9pZCkKICAgICAgICBpZiBub3QgYW5pbVRyYWNrIG9yIG5vdCBhbmltVHJhY2suSXNQbGF5aW5nIHRoZW4KICAgICAgICAgICAgbG9jYWwgYW5pbWF0aW9uID0gSW5zdGFuY2UubmV3KCJBbmltYXRpb24iKQogICAgICAgICAgICBhbmltYXRpb24uQW5pbWF0aW9uSWQgPSAicmJ4YXNzZXRpZDovLzc1ODA0NDYyNzYwNTk2IgogICAgICAgICAgICBhbmltVHJhY2sgPSBhbmltYXRvcjpMb2FkQW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgYW5pbVRyYWNrLkxvb3BlZCA9IHRydWUKICAgICAgICAgICAgYW5pbVRyYWNrOlBsYXkoKQogICAgICAgICAgICBhbmltVHJhY2s6QWRqdXN0U3BlZWQoMCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIHN0b3BJbnZpc2libGVBbmltKCkKICAgICAgICBpZiBhbmltVHJhY2sgYW5kIGFuaW1UcmFjay5Jc1BsYXlpbmcgdGhlbgogICAgICAgICAgICBhbmltVHJhY2s6U3RvcCgpCiAgICAgICAgICAgIGFuaW1UcmFjayA9IG5pbAogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0g4pyFIEtp4buDbSB0cmEgbuG6v3UgY2hhcmFjdGVyIGzDoCBzdXJ2aXZvciAodHJvbmcgZm9sZGVyIFN1cnZpdm9ycykKICAgIGxvY2FsIGZ1bmN0" ..
    "aW9uIGlzU3Vydml2b3JNb2RlbChjaGFyKQogICAgICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgIGlmIHN1cnZpdm9yc0ZvbGRlcjpGaW5kRmlyc3RDaGlsZChjaGFyLk5hbWUpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIGhhbmRsZVRvZ2dsZShlbmFibGVkKQogICAgICAgIEludmlzaWJsZUVuYWJsZWQgPSBlbmFibGVkCiAgICAgICAgbG9jYWwgaHVtYW5vaWQsIGNoYXIgPSBnZXRIdW1hbm9pZCgpCiAgICAgICAgaWYgbm90IGh1bWFub2lkIG9yIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBpZiBlbmFibGVkIHRoZW4KICAgICAgICAgICAgcnVubmluZyA9IHRydWUKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBydW5uaW5nIGFuZCBJbnZpc2libGVFbmFibGVkIGRvCiAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWQsIGNoYXIgPSBnZXRIdW1hbm9pZCgpCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGh1bWFub2lkIG9yIG5vdCBjaGFyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgaXNTdXJ2aXZvck1vZGVsKGNoYXIp" ..
    "IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcGxheUludmlzaWJsZUFuaW0oaHVtYW5vaWQpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBzdG9wSW52aXNpYmxlQW5pbSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBydW5uaW5nID0gZmFsc2UKICAgICAgICAgICAgc3RvcEludmlzaWJsZUFuaW0oKQogICAgICAgIGVuZAogICAgZW5kCgogICAgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihjaGFyKQogICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgIGlmIEludmlzaWJsZUVuYWJsZWQgYW5kIGlzU3Vydml2b3JNb2RlbChjaGFyKSB0aGVuCiAgICAgICAgICAgIGhhbmRsZVRvZ2dsZSh0cnVlKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIC0tIPCfn6IgRmx1ZW50IFVJIFRvZ2dsZQogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiSW5zdGFudEludmlzaWJsZVYyIiwgewogICAgICAgIFRpdGxlID0gIkluc3RhbnQgSW52aXNpYmxlIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkKICAgICAgICBoYW5kbGVUb2dnbGUoVmFsdWUpCiAgICBlbmQpCmVuZAoKCgpkbwogICAgLS0gSW52aXNpYmxlIHVwb24gQ2xvbmlu" ..
    "ZyAoc2FuZGJveGVkKQogICAgbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCiAgICBsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCiAgICBsb2NhbCBydW5uaW5nID0gZmFsc2UKICAgIGxvY2FsIGFuaW1UcmFjawoKICAgIGxvY2FsIGZ1bmN0aW9uIGdldEh1bWFub2lkKCkKICAgICAgICBsb2NhbCBjaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIHJldHVybiBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSwgY2hhcgogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gZ2V0QW5pbWF0b3IoaHVtYW5vaWQpCiAgICAgICAgbG9jYWwgYW5pbWF0b3IgPSBodW1hbm9pZDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkFuaW1hdG9yIikKICAgICAgICBpZiBub3QgYW5pbWF0b3IgdGhlbgogICAgICAgICAgICBhbmltYXRvciA9IEluc3RhbmNlLm5ldygiQW5pbWF0b3IiKQogICAgICAgICAgICBhbmltYXRvci5QYXJlbnQgPSBodW1hbm9pZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBhbmltYXRvcgogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gcGxheUludmlzaWJsZUFuaW0oaHVtYW5vaWQpCiAgICAgICAgbG9jYWwgYW5pbWF0b3IgPSBnZXRBbmltYXRvcihodW1hbm9pZCkKICAgICAgICBpZiBub3QgYW5pbVRyYWNrIG9yIG5vdCBhbmltVHJhY2suSXNQbGF5aW5n" ..
    "IHRoZW4KICAgICAgICAgICAgbG9jYWwgYW5pbWF0aW9uID0gSW5zdGFuY2UubmV3KCJBbmltYXRpb24iKQogICAgICAgICAgICBhbmltYXRpb24uQW5pbWF0aW9uSWQgPSAicmJ4YXNzZXRpZDovLzc1ODA0NDYyNzYwNTk2IgogICAgICAgICAgICBhbmltVHJhY2sgPSBhbmltYXRvcjpMb2FkQW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgYW5pbVRyYWNrLkxvb3BlZCA9IHRydWUKICAgICAgICAgICAgYW5pbVRyYWNrOlBsYXkoKQogICAgICAgICAgICBhbmltVHJhY2s6QWRqdXN0U3BlZWQoMCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIHN0b3BJbnZpc2libGVBbmltKCkKICAgICAgICBpZiBhbmltVHJhY2sgYW5kIGFuaW1UcmFjay5Jc1BsYXlpbmcgdGhlbgogICAgICAgICAgICBhbmltVHJhY2s6U3RvcCgpCiAgICAgICAgICAgIGFuaW1UcmFjayA9IG5pbAogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gaGFuZGxlVG9nZ2xlKGVuYWJsZWQpCiAgICAgICAgbG9jYWwgaHVtYW5vaWQsIGNoYXIgPSBnZXRIdW1hbm9pZCgpCiAgICAgICAgaWYgbm90IGh1bWFub2lkIG9yIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBpZiBlbmFibGVkIHRoZW4KICAgICAgICAgICAgcnVubmluZyA9IHRydWUKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBydW5uaW5nIGRvCiAgICAgICAgICAgICAgICAg" ..
    "ICAgaHVtYW5vaWQsIGNoYXIgPSBnZXRIdW1hbm9pZCgpCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGh1bWFub2lkIG9yIG5vdCBjaGFyIHRoZW4gYnJlYWsgZW5kCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRvcnNvID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiVG9yc28iKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkKCJVcHBlclRvcnNvIikKICAgICAgICAgICAgICAgICAgICBsb2NhbCByb290ID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgogICAgICAgICAgICAgICAgICAgIGlmIHRvcnNvIGFuZCB0b3Jzby5UcmFuc3BhcmVuY3kgfj0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXlJbnZpc2libGVBbmltKGh1bWFub2lkKQogICAgICAgICAgICAgICAgICAgICAgICBpZiByb290IHRoZW4gcm9vdC5UcmFuc3BhcmVuY3kgPSAwLjQgZW5kCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBzdG9wSW52aXNpYmxlQW5pbSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJvb3QgdGhlbiByb290LlRyYW5zcGFyZW5jeSA9IDEgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlCiAgICAgICAgICAgIHN0b3BJbnZpc2libGVBbmlt" ..
    "KCkKICAgICAgICAgICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIGNoYXIuSHVtYW5vaWRSb290UGFydC5UcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0g4pyFIFRvZ2dsZSBk4bqhbmcgbeG7m2kgRmx1ZW50IFVJCiAgICBUYWJzLk1haW46QWRkVG9nZ2xlKCJJbnZpc2libGVDbG9uZVYyIiwgewogICAgICAgIFRpdGxlID0gIkludmlzaWJsZSBpZiBjbG9uZWQiLAogICAgICAgIERlZmF1bHQgPSBfRy5JbnZpc2libGVDbG9uZSBvciBmYWxzZQogICAgfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIF9HLkludmlzaWJsZUNsb25lID0gVmFsdWUKICAgICAgICBoYW5kbGVUb2dnbGUoVmFsdWUpCiAgICBlbmQpCmVuZAoKCiAgICBUYWJzLk1haW46QWRkU2VjdGlvbigi4oazIFZlZXJvbmljYSIpCgpUYWJzLk1haW46QWRkVG9nZ2xlKCJBdXRvVHJpY2siLCB7CiAgICBUaXRsZSA9ICJBdXRvIFRyaWNrIFYyIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKICAgICAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgICAgICBsb2NhbCBWaXJ0dWFsSW5w" ..
    "dXRNYW5hZ2VyID0gZ2FtZTpHZXRTZXJ2aWNlKCJWaXJ0dWFsSW5wdXRNYW5hZ2VyIikKCiAgICAgICAgbG9jYWwgcGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGRldmljZSA9ICJNb2JpbGUiCgogICAgICAgIC0tIPCfp6kgU2FmZSBnZXQgVUkgJiBCZWhhdmlvciBmb2xkZXIgKGNhY2hlIHPhurVuKQogICAgICAgIGxvY2FsIGZ1bmN0aW9uIGdldEJlaGF2aW9yRm9sZGVyKCkKICAgICAgICAgICAgbG9jYWwgb2ssIGZvbGRlciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHJldHVybiBSZXBsaWNhdGVkU3RvcmFnZS5Bc3NldHMuU3Vydml2b3JzLlZlZXJvbmljYS5CZWhhdmlvcgogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIHJldHVybiBvayBhbmQgZm9sZGVyCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGZ1bmN0aW9uIGdldFNwcmludGluZ0J1dHRvbigpCiAgICAgICAgICAgIGxvY2FsIGd1aSA9IHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiUGxheWVyR3VpIikKICAgICAgICAgICAgaWYgbm90IGd1aSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgbG9jYWwgbWFpbiA9IGd1aTpGaW5kRmlyc3RDaGlsZCgiTWFpblVJIikKICAgICAgICAgICAgaWYgbm90IG1haW4gdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIHJldHVybiBtYWluOkZpbmRGaXJzdENoaWxkKCJTcHJpbnRpbmdCdXR0b24iKQogICAgICAgIGVuZAoKICAgICAgICAtLSDwn6egIEtp4buDbSB0" ..
    "cmEgaGlnaGxpZ2h0IGPDsyB0YXJnZXQgbcOsbmgga2jDtG5nCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gYWRvcm5lZUlzUGxheWVyQ2hhcmFjdGVyKGgpCiAgICAgICAgICAgIGlmIG5vdCBoIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgICAgICBsb2NhbCBhZG9ybmVlID0gaC5BZG9ybmVlCiAgICAgICAgICAgIGxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIG5vdCBhZG9ybmVlIG9yIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgICAgICByZXR1cm4gYWRvcm5lZSA9PSBjaGFyIG9yIGFkb3JuZWU6SXNEZXNjZW5kYW50T2YoY2hhcikKICAgICAgICBlbmQKCiAgICAgICAgLS0g8J+nsCBIw6BtIGvDrWNoIG7DunQgU3ByaW50aW5nIChjaOG7iSBn4buNaSAxIGzhuqduKQogICAgICAgIGxvY2FsIGZ1bmN0aW9uIHRyaWdnZXJTcHJpbnQoKQogICAgICAgICAgICBpZiBkZXZpY2Ugfj0gIk1vYmlsZSIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIGJ0biA9IGdldFNwcmludGluZ0J1dHRvbigpCiAgICAgICAgICAgIGlmIG5vdCBidG4gdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIGNvbm5zID0gZ2V0Y29ubmVjdGlvbnMoYnRuLk1vdXNlQnV0dG9uMURvd24pCiAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKGNvbm5zKSBkbwogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHY6Rmly" ..
    "ZSgpCiAgICAgICAgICAgICAgICAgICAgaWYgdi5GdW5jdGlvbiB0aGVuIHY6RnVuY3Rpb24oKSBlbmQKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIC0tIPCfp7kgQ2xlYW51cCBmdW5jdGlvbgogICAgICAgIGxvY2FsIGZ1bmN0aW9uIGNsZWFudXAoKQogICAgICAgICAgICBpZiBfRy5BdXRvVHJpY2tfQ29ubmVjdGlvbnMgdGhlbgogICAgICAgICAgICAgICAgZm9yIF8sIGNvbm4gaW4gaXBhaXJzKF9HLkF1dG9Ucmlja19Db25uZWN0aW9ucykgZG8KICAgICAgICAgICAgICAgICAgICBpZiBjb25uIGFuZCBjb25uLkNvbm5lY3RlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbm46RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIF9HLkF1dG9Ucmlja19Db25uZWN0aW9ucyA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgX0cuQXV0b1RyaWNrX0xvb3AgdGhlbgogICAgICAgICAgICAgICAgdGFzay5jYW5jZWwoX0cuQXV0b1RyaWNrX0xvb3ApCiAgICAgICAgICAgICAgICBfRy5BdXRvVHJpY2tfTG9vcCA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcHJpbnQoIltBdXRvVHJpY2tdIERpc2FibGVkIikKICAgICAgICBlbmQKCiAgICAgICAgaWYgVmFsdWUgdGhlbgogICAgICAgICAgICBwcmludCgiW0F1dG9Ucmlja10gRW5hYmxlZCIpCgog" ..
    "ICAgICAgICAgICBsb2NhbCBiZWhhdmlvckZvbGRlciA9IGdldEJlaGF2aW9yRm9sZGVyKCkKICAgICAgICAgICAgaWYgbm90IGJlaGF2aW9yRm9sZGVyIHRoZW4KICAgICAgICAgICAgICAgIHdhcm4oIltBdXRvVHJpY2tdIEJlaGF2aW9yIGZvbGRlciBub3QgZm91bmQuIikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxvY2FsIGhpZ2hsaWdodHMgPSB7fQogICAgICAgICAgICBfRy5BdXRvVHJpY2tfQ29ubmVjdGlvbnMgPSB7fQoKICAgICAgICAgICAgLS0g8J+UjSBLaGkgY8OzIGhpZ2hsaWdodCBt4bubaSB0aMOqbSB2w6BvCiAgICAgICAgICAgIGxvY2FsIGFkZENvbm4gPSBiZWhhdmlvckZvbGRlci5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihjaGlsZCkKICAgICAgICAgICAgICAgIGlmIGNoaWxkOklzQSgiSGlnaGxpZ2h0IikgdGhlbgogICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodHNbY2hpbGRdID0gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgIC0tIPCflI0gS2hpIGhpZ2hsaWdodCBi4buLIHjDs2EKICAgICAgICAgICAgbG9jYWwgcmVtb3ZlQ29ubiA9IGJlaGF2aW9yRm9sZGVyLkRlc2NlbmRhbnRSZW1vdmluZzpDb25uZWN0KGZ1bmN0aW9uKGNoaWxkKQogICAgICAgICAgICAgICAgaWYgY2hpbGQ6SXNBKCJIaWdobGlnaHQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0" ..
    "c1tjaGlsZF0gPSBuaWwKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCgogICAgICAgICAgICB0YWJsZS5pbnNlcnQoX0cuQXV0b1RyaWNrX0Nvbm5lY3Rpb25zLCBhZGRDb25uKQogICAgICAgICAgICB0YWJsZS5pbnNlcnQoX0cuQXV0b1RyaWNrX0Nvbm5lY3Rpb25zLCByZW1vdmVDb25uKQoKICAgICAgICAgICAgLS0g8J+agCBWw7JuZyBraeG7g20gdHJhIMSR4buLbmgga+G7syBuaOG6uSAoMC4zcy9s4bqnbikKICAgICAgICAgICAgX0cuQXV0b1RyaWNrX0xvb3AgPSB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIHRhc2sud2FpdCgwLjMpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IFZhbHVlIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgICAgICAgICAgZm9yIGggaW4gcGFpcnMoaGlnaGxpZ2h0cykgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgYWRvcm5lZUlzUGxheWVyQ2hhcmFjdGVyKGgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyaWdnZXJTcHJpbnQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQoKICAgICAgICBlbHNlCiAgICAgICAgICAgIGNsZWFudXAoKQogICAgICAgIGVuZAogICAgZW5kCn0pCgoKICAgIFRhYnMuTWFpbjpBZGRTZWN0aW9u" ..
    "KCLihrMgRHVzZWtrYXIiKQoKCi0tLy8gRHVzayBBaW0gQXNzaXN0IChGbHVlbnQgRHJvcGRvd24gdHLDqm4gVG9nZ2xlKSAtIExvY2tlZCBUYXJnZXQgVmVyc2lvbgpkbwotLSDwn6egIFNlcnZpY2VzCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKbG9jYWwgV29ya3NwYWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKQoKLS0g8J+TjSBSZWZlcmVuY2VzCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBDYW1lcmEgPSBXb3Jrc3BhY2UuQ3VycmVudENhbWVyYQoKLS0g4pqZ77iPIENvbmZpZwpsb2NhbCBUYXJnZXRBbmltYXRpb25JRCA9ICJyYnhhc3NldGlkOi8vNzc4OTQ3NTAyNzk4OTEiCmxvY2FsIEVuYWJsZWQgPSBmYWxzZQpsb2NhbCBTbW9vdGhuZXNzID0gMC4yCgotLSBUaOG7nWkgZ2lhbiB04buRaSDEkWEga2jDs2EgdGFyZ2V0IChnacOieSkgc2F1IGtoaSBjaOG7jW4gdGFyZ2V0CmxvY2FsIExPQ0tfRFVSQVRJT04gPSAwLjcKCi0tIPCfjpvvuI8gRmx1ZW50IFVJIENvbnRyb2xzCmxvY2FsIHRvZ2dsZUZsYWcgPSBJbnN0YW5jZS5uZXcoIkJvb2xWYWx1ZSIpCnRvZ2dsZUZsYWcuTmFtZSA9ICJEdXNrQWltX1RvZ2dsZUZsYWciCnRvZ2dsZUZsYWcuVmFsdWUgPSBmYWxzZQoKLS0gRHJvcGRvd24g4bufIFRSw4pOClRhYnMuTWFpbjpBZGREcm9wZG93" ..
    "bigiRHVza1Ntb290aCIsIHsKICAgIFRpdGxlID0gIlNtb290aG5lc3MiLAogICAgVmFsdWVzID0geyJMb3ciLCAiTWVkaXVtIiwgIkhpZ2gifSwKICAgIERlZmF1bHQgPSAiTWVkaXVtIiwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKQogICAgaWYgdmFsdWUgPT0gIkxvdyIgdGhlbgogICAgICAgIFNtb290aG5lc3MgPSAwLjEKICAgIGVsc2VpZiB2YWx1ZSA9PSAiTWVkaXVtIiB0aGVuCiAgICAgICAgU21vb3RobmVzcyA9IDAuMgogICAgZWxzZWlmIHZhbHVlID09ICJIaWdoIiB0aGVuCiAgICAgICAgU21vb3RobmVzcyA9IDAuNAogICAgZW5kCmVuZCkKCi0tIFRvZ2dsZSDhu58gRMav4buaSQpUYWJzLk1haW46QWRkVG9nZ2xlKCJEdXNrQWltIiwgewogICAgVGl0bGUgPSAiRHVzayBBaW0gQXNzaXN0IiwKICAgIERlZmF1bHQgPSBmYWxzZSwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHN0YXRlKQogICAgRW5hYmxlZCA9IHN0YXRlCiAgICB0b2dnbGVGbGFnLlZhbHVlID0gc3RhdGUKICAgIC0tIHJlc2V0IGFueSBsb2NrZWQgdGFyZ2V0IHdoZW4gdG9nZ2xpbmcgb2ZmCiAgICBpZiBub3Qgc3RhdGUgdGhlbgogICAgICAgIGN1cnJlbnRUYXJnZXQgPSBuaWwKICAgICAgICBsb2NrRXhwaXJlcyA9IG5pbAogICAgZW5kCmVuZCkKCi0tIPCfjq8gRmluZCBuZWFyZXN0IHBsYXllciAocmV0dXJucyBIdW1hbm9pZFJvb3RQYXJ0IG9yIG5pbCkKbG9jYWwgZnVuY3Rpb24gZ2V0TmVhcmVzdFBsYXllclJvb3QoKQogICAgaWYg" ..
    "bm90IExvY2FsUGxheWVyLkNoYXJhY3RlciBvciBub3QgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgIHJldHVybiBuaWwKICAgIGVuZAoKICAgIGxvY2FsIG5lYXJlc3QsIGRpc3RhbmNlID0gbmlsLCBtYXRoLmh1Z2UKICAgIGxvY2FsIG15UG9zID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24KICAgIGZvciBfLCBwbGF5ZXIgaW4gcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICBsb2NhbCByb290ID0gcGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAocm9vdC5Qb3NpdGlvbiAtIG15UG9zKS5NYWduaXR1ZGUKICAgICAgICAgICAgaWYgZGlzdCA8IGRpc3RhbmNlIHRoZW4KICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gZGlzdAogICAgICAgICAgICAgICAgbmVhcmVzdCA9IHJvb3QKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBuZWFyZXN0CmVuZAoKLS0gSGVscGVyOiBjaGVjayBpZiBhIGh1bWFub2lkIGlzIGN1cnJlbnRseSBwbGF5aW5nIHRoZSB0YXJnZXQgYW5pbWF0aW9u" ..
    "CmxvY2FsIGZ1bmN0aW9uIGh1bWFub2lkSXNQbGF5aW5nVGFyZ2V0QW5pbWF0aW9uKGh1bWFub2lkKQogICAgaWYgbm90IGh1bWFub2lkIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgZm9yIF8sIHRyYWNrIGluIHBhaXJzKGh1bWFub2lkOkdldFBsYXlpbmdBbmltYXRpb25UcmFja3MoKSkgZG8KICAgICAgICBpZiB0cmFjay5BbmltYXRpb24gYW5kIHRyYWNrLkFuaW1hdGlvbi5BbmltYXRpb25JZCA9PSBUYXJnZXRBbmltYXRpb25JRCB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBmYWxzZQplbmQKCi0tIFN0YXRlIGZvciBsb2NrZWQgdGFyZ2V0CmxvY2FsIGN1cnJlbnRUYXJnZXQgPSBuaWwgICAgICAgICAgLS0gSHVtYW5vaWRSb290UGFydCAobG9ja2VkKQpsb2NhbCBjdXJyZW50VGFyZ2V0SHVtYW5vaWQgPSBuaWwgIC0tIEh1bWFub2lkIG9mIHRoZSBsb2NrZWQgdGFyZ2V0J3MgY2hhcmFjdGVyCmxvY2FsIGxvY2tFeHBpcmVzID0gbmlsICAgICAgICAgICAgLS0gdGltZXN0YW1wIHdoZW4gbG9jayBjYW4gYmUgcmVsZWFzZWQgYXQgZWFybGllc3QKCi0tIPCflKUgQWltYm90IGxvZ2ljIChSZW5kZXJTdGVwcGVkKQpSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICBpZiBub3QgRW5hYmxlZCB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICAtLSBzYWZldHk6IHJlcXVpcmUgbG9jYWwgY2hhcmFjdGVyIGFuZCBj" ..
    "YW1lcmEKICAgIGlmIG5vdCBMb2NhbFBsYXllci5DaGFyYWN0ZXIgb3Igbm90IExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIG9yIG5vdCBDYW1lcmEgdGhlbgogICAgICAgIGN1cnJlbnRUYXJnZXQgPSBuaWwKICAgICAgICBjdXJyZW50VGFyZ2V0SHVtYW5vaWQgPSBuaWwKICAgICAgICBsb2NrRXhwaXJlcyA9IG5pbAogICAgICAgIHJldHVybgogICAgZW5kCgogICAgLS0gRmlyc3Q6IGRldGVjdCBpZiBBTlkgcGxheWVyIGlzIHBsYXlpbmcgdGhlIHRhcmdldCBhbmltYXRpb24KICAgIGxvY2FsIGFueUFuaW1QbGF5aW5nID0gZmFsc2UKICAgIGZvciBfLCBwbGF5ZXIgaW4gcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgaWYgcGxheWVyLkNoYXJhY3RlciBhbmQgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgIGlmIGh1bWFub2lkSXNQbGF5aW5nVGFyZ2V0QW5pbWF0aW9uKGh1bWFub2lkKSB0aGVuCiAgICAgICAgICAgICAgICBhbnlBbmltUGxheWluZyA9IHRydWUKICAgICAgICAgICAgICAgIC0tIElmIHdlIGRvbid0IGhhdmUgYSBsb2NrZWQgdGFyZ2V0IHlldCwgbG9jayB0byB0aGUgbmVhcmVzdCBwbGF5ZXIgTk9XCiAgICAg" ..
    "ICAgICAgICAgICBpZiBub3QgY3VycmVudFRhcmdldCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2hvc2VuID0gZ2V0TmVhcmVzdFBsYXllclJvb3QoKQogICAgICAgICAgICAgICAgICAgIGlmIGNob3NlbiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQgPSBjaG9zZW4KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhcmdldEh1bWFub2lkID0gY2hvc2VuLlBhcmVudCBhbmQgY2hvc2VuLlBhcmVudDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikgb3IgbmlsCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2tFeHBpcmVzID0gdGljaygpICsgTE9DS19EVVJBVElPTgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAtLSBXZSBicmVhayBoZXJlIG9wdGlvbmFsbHkgKHdlIG9ubHkgbmVlZCB0byBrbm93IHRoYXQgYW4gYW5pbWF0aW9uIGlzIHBsYXlpbmcpLgogICAgICAgICAgICAgICAgLS0gQnV0IGRvIG5vdCBicmVhayBpZiB3ZSB3YW50IHRvIGNoZWNrIG90aGVyIHBsYXllcnMnIGFuaW1hdGlvbnMgYXMgd2VsbDsgZWl0aGVyIGlzIGZpbmUuCiAgICAgICAgICAgICAgICAtLSBXZSdsbCBub3QgYnJlYWsgc28gd2Uga2VlcCBjaGVja2luZzsgYnV0IG9uZSBkZXRlY3Rpb24gaXMgZW5vdWdoIHRvIGtlZXAgYW55QW5pbVBsYXlpbmcgPSB0cnVlLgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQK" ..
    "ICAgIGVuZAoKICAgIC0tIElmIHRoZXJlIGlzIGEgbG9ja2VkIHRhcmdldCwgYWltIGF0IGl0IHdoaWxlIGFuaW1hdGlvbihzKSBhcmUgcGxheWluZyBPUiB1bnRpbCBsb2NrRXhwaXJlcwogICAgaWYgY3VycmVudFRhcmdldCBhbmQgY3VycmVudFRhcmdldC5QYXJlbnQgYW5kIGN1cnJlbnRUYXJnZXRIdW1hbm9pZCB0aGVuCiAgICAgICAgLS0gdmFsaWRhdGUgdGFyZ2V0OiBzdGlsbCBoYXMgSHVtYW5vaWRSb290UGFydCBhbmQgaXMgYWxpdmUKICAgICAgICBpZiBub3QgY3VycmVudFRhcmdldCBvciBub3QgY3VycmVudFRhcmdldC5QYXJlbnQgb3Igbm90IGN1cnJlbnRUYXJnZXQuUGFyZW50OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAtLSBpbnZhbGlkIHRhcmdldCwgcmVsZWFzZQogICAgICAgICAgICBjdXJyZW50VGFyZ2V0ID0gbmlsCiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXRIdW1hbm9pZCA9IG5pbAogICAgICAgICAgICBsb2NrRXhwaXJlcyA9IG5pbAogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgLS0gRGV0ZXJtaW5lIHdoZXRoZXIgd2Ugc2hvdWxkIGNvbnRpbnVlIGFpbWluZzoKICAgICAgICAtLSBjb250aW51ZSBpZiBlaXRoZXIgKGEpIGFueSBwbGF5ZXIgaXMgY3VycmVudGx5IHBsYXlpbmcgdGhlIHRhcmdldCBhbmltYXRpb24gT1IKICAgICAgICAtLSAoYikgd2UgaGF2ZW4ndCByZWFjaGVkIGxvY2tFeHBpcmVzIHlldCAoZW5z" ..
    "dXJlcyBhIHNob3J0IGd1YXJhbnRlZWQgYWltaW5nIHdpbmRvdykKICAgICAgICBsb2NhbCBjb250aW51ZUFpbWluZyA9IGFueUFuaW1QbGF5aW5nIG9yIChsb2NrRXhwaXJlcyBhbmQgdGljaygpIDwgbG9ja0V4cGlyZXMpCgogICAgICAgIGlmIGNvbnRpbnVlQWltaW5nIHRoZW4KICAgICAgICAgICAgbG9jYWwgYWltUG9zID0gY3VycmVudFRhcmdldC5Qb3NpdGlvbgogICAgICAgICAgICBsb2NhbCBjYW1DRnJhbWUgPSBDYW1lcmEuQ0ZyYW1lCiAgICAgICAgICAgIC0tIGF2b2lkIHplcm8tbGVuZ3RoIGRpcmVjdGlvbgogICAgICAgICAgICBsb2NhbCBkaXJWZWMgPSBhaW1Qb3MgLSBjYW1DRnJhbWUuUG9zaXRpb24KICAgICAgICAgICAgaWYgZGlyVmVjLk1hZ25pdHVkZSA+IDAgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZGlyZWN0aW9uID0gZGlyVmVjLlVuaXQKICAgICAgICAgICAgICAgIENhbWVyYS5DRnJhbWUgPSBDYW1lcmEuQ0ZyYW1lOkxlcnAoCiAgICAgICAgICAgICAgICAgICAgQ0ZyYW1lLm5ldyhjYW1DRnJhbWUuUG9zaXRpb24sIGNhbUNGcmFtZS5Qb3NpdGlvbiArIGRpcmVjdGlvbiksCiAgICAgICAgICAgICAgICAgICAgU21vb3RobmVzcwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxzZQogICAgICAgICAgICAtLSBubyBhbmltYXRpb24gcGxheWluZyBhbmQgbG9jayBleHBpcmVkIC0+IHJlbGVhc2UgdGFyZ2V0LCBhbGxvdyBu" ..
    "ZXcgc2VsZWN0aW9uIG5leHQgZGV0ZWN0aW9uCiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQgPSBuaWwKICAgICAgICAgICAgY3VycmVudFRhcmdldEh1bWFub2lkID0gbmlsCiAgICAgICAgICAgIGxvY2tFeHBpcmVzID0gbmlsCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gSWYgd2UgZ2V0IGhlcmU6IG5vIGxvY2tlZCB0YXJnZXQsIGJ1dCBpZiBhbiBhbmltYXRpb24gaXMgcGxheWluZyB3ZSBhbHJlYWR5IHNldCBvbmUgYWJvdmUuCiAgICAtLSBOb3RoaW5nIHRvIGRvIG90aGVyd2lzZS4KZW5kKQplbmQKCgoKICAgIFRhYnMuTWFpbjpBZGRTZWN0aW9uKCLihrMgR3Vlc3QxMzM3IikKCgoKCmRvCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQogICAgbG9jYWwgbG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgogICAgbG9jYWwgS2lsbGVycyA9IHsKICAgICAgICBbIlNsYXNoZXIiXSA9IHRydWUsCiAgICAgICAgWyIxeDF4MXgxIl0gPSB0cnVlLAogICAgICAgIFsiYzAwbGtpZGQiXSA9IHRydWUsCiAgICAgICAgWyJOb2xpIl0gPSB0cnVlLAogICAgICAgIFsiSm9obkRvZSJdID0gdHJ1ZSwKICAgICAgICBbIkd1ZXN0IDY2NiJdID0gdHJ1ZSwKICAgICAgICBbIlNpeGVyIl0gPSB0cnVlCiAgICB9CgogICAgbG9jYWwgZnVuY3Rpb24gaXNL" ..
    "aWxsZXIocGxheWVyKQogICAgICAgIGxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICAgICAgcmV0dXJuIEtpbGxlcnNbY2hhci5OYW1lXSA9PSB0cnVlCiAgICBlbmQKCiAgICBsb2NhbCBhbmltYXRpb25JZHMgPSB7CiAgICAgICAgWyI4MzgyOTc4MjM1Nzg5NyJdICA9IHRydWUsIC0tIFNsYXNoLCAxeDF4MXgxCiAgICAgICAgWyIxMjY4MzAwMTQ4NDExOTgiXSA9IHRydWUsIC0tIFNsYXNoLCBKYXNvbgogICAgICAgIFsiMTI2MzU1MzI3OTUxMjE1Il0gPSB0cnVlLCAtLSBCZWhlYWQsIEphc29uCiAgICAgICAgWyIxMjEwODY3NDY1MzQyNTIiXSA9IHRydWUsIC0tIEdhc2hpbmdXb3VuZFN0YXJ0LCBKYXNvbgogICAgICAgIFsiMTA1NDU4MjcwNDYzMzc0Il0gPSB0cnVlLCAtLSBTbGFzaCwgSm9obkRvZQogICAgICAgIFsiMTg4ODU5MDk2NDUiXSAgICAgPSB0cnVlLCAtLSBBdHRhY2ssIGMwMGxraWQKICAgICAgICBbIjk0MTYyNDQ2NTEzNTg3Il0gID0gdHJ1ZSwgLS0gU2xhc2gsIEpvaG5Eb2UsIFNraW46ICFKb25lcgogICAgICAgIFsiOTMwNjk3MjEyNzQxMTAiXSAgPSB0cnVlLCAtLSBTbGFzaCwgSm9obkRvZSwgU2tpbjogQW5uaWhpbGF0aW9uSm9obkRvZQogICAgICAgIFsiOTc0MzMwNjA4NjE5NTIiXSAgPSB0cnVlLCAtLSBTbGFzaCwgSm9obkRvZSwgU2tpbjogI1NLCiAgICAgICAgWyIxMjEyOTM4ODM1ODU3MzgiXSA9IHRy" ..
    "dWUsIC0tIFNsYXNoLCAxeDF4MXgxCiAgICAgICAgWyI5MjE3MzEzOTE4Nzk3MCJdICA9IHRydWUsIC0tIFNsYXNoLCBTa2luOiBIYWNrbG9yZDF4MXgxeDEKICAgICAgICBbIjEwNjg0NzY5NTI3MDc3MyJdID0gdHJ1ZSwgLS0gR2FzaGluZ1dvdW5kU3RhcnQsIEphc29uLCBTa2luOiBTdWJqZWN0MEphc29uCiAgICAgICAgWyIxMjU0MDMzMTM3ODY2NDUiXSA9IHRydWUsIC0tIFNsYXNoLCBKYXNvbiwgU2tpbjogU3ViamVjdDBKYXNvbgogICAgICAgIFsiODE2Mzk0MzU4NTg5MDIiXSAgPSB0cnVlLCAtLSBCZWhlYWQsIEphc29uLCBTa2luOiBXaGl0ZVB1bXBraW5KYXNvbgogICAgICAgIFsiMTM3MzE0NzM3NDkyNzE1Il0gPSB0cnVlLCAtLSBHYXNoaW5nV291bmRTdGFydCwgSmFzb24sIFNraW46IFdoaXRlUHVtcGtpbkphc29uCiAgICAgICAgWyIxMjAxMTI4OTcwMjYwMTUiXSA9IHRydWUsIC0tIFNsYXNoLCBKYXNvbiwgU2tpbjogV2hpdGVQdW1wa2luSmFzb24KICAgICAgICBbIjgyMTEzNzQ0NDc4NTQ2Il0gID0gdHJ1ZSwgLS0gQmVoZWFkLCBKYXNvbiAobmhp4buBdSBza2luKQogICAgICAgIFsiMTE4Mjk4NDc1NjY5OTM1Il0gPSB0cnVlLCAtLSBTbGFzaCwgSmFzb24gKG5oaeG7gXUgc2tpbikKICAgICAgICBbIjEyNjY4MTc3Njg1OTUzOCJdID0gdHJ1ZSwgLS0gQmVoZWFkLCBKYXNvbiwgU2tpbjogUHVyc3Vlckphc29uCiAgICAgICAgWyIxMjk5NzYwODA0MDUwNzIiXSA9IHRydWUsIC0tIEdhc2hpbmdXb3Vu" ..
    "ZFN0YXJ0LCBKYXNvbiwgU2tpbjogUHVyc3Vlckphc29uCiAgICAgICAgWyIxMDk2Njc5NTk5Mzg2MTciXSA9IHRydWUsIC0tIFNsYXNoLCBKYXNvbiwgU2tpbjogUHVyc3Vlckphc29uCiAgICAgICAgWyI3NDcwNzMyODU1NDM1OCJdICA9IHRydWUsIC0tIFNsYXNoLCBKYXNvbiwgU2tpbjogI0RlYWRSYWJiaXRzSmFzb24KICAgICAgICBbIjEzMzMzNjU5NDM1NzkwMyJdID0gdHJ1ZSwgLS0gQmVoZWFkLCBKYXNvbiwgU2tpbjogI0RlYWRSYWJiaXRzSmFzb24KICAgICAgICBbIjg2MjA0MDAxMTI5OTc0Il0gID0gdHJ1ZSwgLS0gR2FzaGluZ1dvdW5kU3RhcnQsIEphc29uLCBTa2luOiAjRGVhZFJhYmJpdHNKYXNvbgogICAgICAgIFsiNzAzNzE2Njc5MTk4OTgiXSAgPSB0cnVlLCAtLSBBdHRhY2ssIGMwMGxraWRkLCBTa2luOiBNYWZpb3NvQzAwbAogICAgICAgIFsiMTMxNTQzNDYxMzIxNzA5Il0gPSB0cnVlLCAtLSBBdHRhY2ssIGMwMGxraWRkLCBTa2luOiBTYXZpb3JDMDBsCiAgICAgICAgWyIxMDY3NzYzNjQ2MjM3NDIiXSA9IHRydWUsIC0tIFdhbGtzcGVlZCBPdmVyaW5nLCBjMDBsa2lkZCAoYWxsIHNraW5zKQogICAgICAgIFsiMTM2MzIzNzI4MzU1NjEzIl0gPSB0cnVlLCAtLSBTd2luZywgTm9saQogICAgICAgIFsiMTA5MjMwMjY3NDQ4Mzk0Il0gPSB0cnVlLCAtLSBTd2luZywgTm9saSAoYWxsIHNraW5zKQogICAgICAgIFsiMTM5ODM1NTAxMDMzOTMyIl0gPSB0cnVlLCAtLSBWb2lkUnVzaCwgTm9saSAoYWxs" ..
    "IHNraW5zKQogICAgICAgIFsiMTE0MzU2MjA4MDk0NTgwIl0gPSB0cnVlLCAtLSBWb2lkUnVzaDIsIE5vbGkKICAgICAgICBbIjEwNjUzODQyNzE2Mjc5NiJdID0gdHJ1ZSwgLS0gU3RhYiwgQWxsIE5vbGkKICAgICAgICBbIjEyNjg5NjQyNjc2MDI1MyJdID0gdHJ1ZSwgLS0gVm9pZFJ1c2gsIE5vbGkKICAgICAgICBbIjEzMTQzMDQ5NzgyMTE5OCJdID0gdHJ1ZSwgLS0gTWFzc0luZmVjdGlvbiwgMXgxeDF4MQogICAgICAgIFsiMTAwNTkyOTEzMDMwMzUxIl0gPSB0cnVlLCAtLSBNYXNzSW5mZWN0aW9uLCAxeDF4MXgxIChGbGVza2hqZXJ0YS9BY2VPZlNwYWRlcy9MYW5jZXIpCiAgICAgICAgWyI3MDQ0NzYzNDg2MjkxMSJdICA9IHRydWUsIC0tIE1hc3NJbmZlY3Rpb24sIFNraW46IEhhY2tsb3JkMXgxeDF4MSBPbGQKICAgICAgICBbIjgzNjg1MzA1NTUzMzY0Il0gID0gdHJ1ZSwgLS0gTWFzc0luZmVjdGlvbiwgU2tpbjogSGFja2xvcmQxeDF4MXgxIE5ldwogICAgICAgIFsiMTI2MTcxNDg3NDAwNjE4Il0gID0gdHJ1ZSwgLS0gU2xhc2gsIFNraW46IEhhY2tsb3JkMXgxeDF4MQogICAgICAgIFsiOTcxNjcwMjc4NDk5NDYiXSAgPSB0cnVlLCAtLSBOb2xpIERhc2ggQmVsaWtlCiAgICAgICAgWyI5OTEzNTYzMzI1ODIyMyJdICA9IHRydWUsCiAgICAgICAgWyI5ODQ1NjkxODg3MzkxOCJdICA9IHRydWUsCiAgICAgICAgWyI4MzI1MTQzMzI3OTg1MiJdICA9IHRydWUsCiAgICAgICAgWyIxMjY2ODE3NzY4NTk1MzgiXSA9" ..
    "IHRydWUsCiAgICAgICAgWyIxMjk5NzYwODA0MDUwNzIiXSA9IHRydWUsCiAgICAgICAgWyIxMjI3MDk0MTYzOTE4OTEiXSA9IHRydWUsIC0tIMSQw6FuaCBUaMaw4budbmcgR3Vlc3QgNjY2CiAgICAgICAgWyI4Nzk4OTUzMzA5NTI4NSJdID0gdHJ1ZSwgLS0gVuG7kyBU4bubaSBHdWVzdCA2NjYKICAgICAgICBbIjEzOTMwOTY0NzQ3MzU1NSJdID0gdHJ1ZSwgLS0gQmF5IMSQ4bq/biBN4bulYyBUacOqdQogICAgICAgIFsiMTMzMzYzMzQ1NjYxMDMyIl0gPSB0cnVlLCAtLSBDaHXhuqluIELhu4sgQmF5IMSQ4bq/biBN4bulYyB0acOqdQogICAgICAgIFsiMTI4NDE0NzM2OTc2NTAzIl0gPSB0cnVlLCAtLSBT4bq1biBTw6BuZyBCYXkgxJDhur9uCi0tICAgICAgICBbIjEyMTgwODM3MTA1MzQ4MyJdID0gdHJ1ZSwgLS0gTGEgSMOpdCBWw6BvIE3hurd0IDopKQogICAgICAgIFsiNzczNzU4NDY0OTI0MzYiXSA9IHRydWUsIC0tIE5vbGkgQWZ1bCBSZXdvcmsKICAgICAgICBbIjkyNDQ1NjA4MDE0Mjc2Il0gPSB0cnVlLCAtLSBOQVIKICAgICAgICBbIjEwMDM1ODU4MTk0MDQ4NSJdID0gdHJ1ZSwgLS0gTkFSCiAgICAgICAgWyI5MTc1ODc2MDYyMTk1NSJdID0gdHJ1ZSwgLS0gTkFSCiAgICAgICAgWyI5NDYzNDU5NDUyOTMzNCJdID0gdHJ1ZSwgLS0gTkFSCiAgICAgICAgWyI5MDYyMDUzMTQ2ODI0MCJdID0gdHJ1ZSwgLS0gMXggc2xhc2ggbTItMyByZXdvcmsKICAgICAgICBbIjk0OTU4MDQxNjAzMzQ3Il0gPSB0cnVlLCAt" ..
    "LSBTbGFzaGVyIELDrSBuZ8O0IHRy4bqvbmcgLyBjaMOpbQogICAgICAgIFsiMTMxNjQyNDU0MjM4Mzc1Il0gPSB0cnVlLCAtLSBTbGFzaGVyIELDrSBOZ8O0IHRy4bqvbmcgLyBLaMOzYSBza2lsbAogICAgICAgIFsiMTEwNzAyODg0ODMwMDYwIl0gPSB0cnVlLCAtLSBTbGFzaGVyIELDrSBOZ8O0IFRy4bqvbmcgLyBMacOqbiBIb8OgbiBDaMOpbQogICAgICAgIFsiNzYzMTIwMjAyOTk2MjQiXSA9IHRydWUsIC0tIE5vbGkgQWRtaW4gVm9pZCBydXNoCiAgICAgICAgWyIxMjY2NTQ5NjE1NDA5NTYiXSA9IHRydWUsIC0tIE5BVlIKICAgICAgICBbIjEzOTYxMzY5OTE5MzQwMCJdID0gdHJ1ZSwgLS0gTkFWUgogICAgICAgIFsiOTE1MDkyMzQ2Mzk3NjYiXSA9IHRydWUsIC0tIE5BIMSQw6FuaCBUaMaw4budbmcKICAgICAgICBbIjEwNTQ1ODI3MDQ2MzM3NCJdID0gdHJ1ZSwgLS0gSm9obiBEb2UgTTMgdsOgIE00IMSQw6FuaCBUaMaw4budbmcKICAgIH0KCiAgICBsb2NhbCBkZWxheWVkQW5pbWF0aW9ucyA9IHt9CgogICAgbG9jYWwgdG9nZ2xlT24gPSBmYWxzZQogICAgbG9jYWwgc3RyaWN0UmFuZ2VPbiA9IGZhbHNlCiAgICBsb2NhbCBkZXRlY3Rpb25SYW5nZSA9IDE4CgogICAgbG9jYWwgYmxvY2tSZW1vdGUKICAgIGxvY2FsIGJsb2NrQnV0dG9uLCBjb25uZWN0aW9ucyA9IG5pbCwge30KCiAgICBsb2NhbCBmdW5jdGlvbiBmaW5kQmxvY2tSZW1vdGUoKQogICAgICAgIGlmIGJsb2NrUmVtb3RlIHRoZW4gcmV0dXJuIGJs" ..
    "b2NrUmVtb3RlIGVuZAogICAgICAgIGlmIG5vdCBibG9ja0J1dHRvbiB0aGVuIHJldHVybiBuaWwgZW5kCiAgICAgICAgZm9yIF8sIGNvbm4gaW4gaXBhaXJzKGdldGNvbm5lY3Rpb25zKGJsb2NrQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrKSkgZG8KICAgICAgICAgICAgbG9jYWwgZiA9IGNvbm4uRnVuY3Rpb24KICAgICAgICAgICAgaWYgZiBhbmQgaXNsY2xvc3VyZShmKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCB1cHZhbHMgPSBnZXR1cHZhbHVlcyhmKQogICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gcGFpcnModXB2YWxzKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIHR5cGVvZih2KSA9PSAiSW5zdGFuY2UiIGFuZCB2OklzQSgiUmVtb3RlRXZlbnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrUmVtb3RlID0gdgogICAgICAgICAgICAgICAgICAgICAgICB3YXJuKCJbQXV0b0Jsb2NrXSBGb3VuZCBCbG9jayBSZW1vdGU6IiwgdjpHZXRGdWxsTmFtZSgpKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmxvY2tSZW1vdGUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gbmlsCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBpbml0QmxvY2tCdXR0b24oKQogICAgICAgIGxvY2FsIGd1aSA9IGxvY2FsUGxheWVyOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJHdWkiKQogICAg" ..
    "ICAgIGlmIG5vdCBndWkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgbWFpblVJID0gZ3VpOkZpbmRGaXJzdENoaWxkKCJNYWluVUkiKQogICAgICAgIGxvY2FsIGNvbnRhaW5lciA9IG1haW5VSSBhbmQgbWFpblVJOkZpbmRGaXJzdENoaWxkKCJBYmlsaXR5Q29udGFpbmVyIikKICAgICAgICBibG9ja0J1dHRvbiA9IGNvbnRhaW5lciBhbmQgY29udGFpbmVyOkZpbmRGaXJzdENoaWxkKCJCbG9jayIpCiAgICAgICAgaWYgYmxvY2tCdXR0b24gYW5kIGJsb2NrQnV0dG9uOklzQSgiSW1hZ2VCdXR0b24iKSB0aGVuCiAgICAgICAgICAgIGNvbm5lY3Rpb25zID0gZ2V0Y29ubmVjdGlvbnMoYmxvY2tCdXR0b24uTW91c2VCdXR0b24xQ2xpY2spCiAgICAgICAgICAgIGZpbmRCbG9ja1JlbW90ZSgpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBpbml0QmxvY2tCdXR0b24oKQogICAgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgdGFzay53YWl0KDApCiAgICAgICAgaW5pdEJsb2NrQnV0dG9uKCkKICAgIGVuZCkKCiAgICBsb2NhbCBmdW5jdGlvbiBmYXN0QmxvY2soKQogICAgICAgIGlmIGJsb2NrUmVtb3RlIHRoZW4KICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgYmxvY2tSZW1vdGU6RmlyZVNlcnZlcih0cnVlKQogICAgICAgICAgICAgICAgdGFzay5kZWxheSgxZS0xMCwgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGJsb2Nr" ..
    "UmVtb3RlOkZpcmVTZXJ2ZXIoZmFsc2UpCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIG5vdCBibG9ja0J1dHRvbiBvciBub3QgYmxvY2tCdXR0b24uVmlzaWJsZSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgZm9yIF8sIGNvbm4gaW4gaXBhaXJzKGNvbm5lY3Rpb25zKSBkbwogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBjb25uOkZpcmUoKSBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpIGJsb2NrQnV0dG9uOkFjdGl2YXRlKCkgZW5kKQogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgbGFzdFRlbGVwb3J0ID0gMAogICAgbG9jYWwgZnVuY3Rpb24gdGVsZXBvcnREb2RnZShraWxsZXJDaGFyKQogICAgICAgIGxvY2FsIG5vdyA9IHRpY2soKQogICAgICAgIGlmIG5vdyAtIGxhc3RUZWxlcG9ydCA8IDUgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbGFzdFRlbGVwb3J0ID0gbm93CgogICAgICAgIGxvY2FsIG15Q2hhciA9IGxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIG15Um9vdCA9IG15Q2hhciBhbmQgbXlDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBsb2NhbCBraWxsZXJSb290ID0ga2lsbGVyQ2hhciBhbmQga2lsbGVyQ2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaWYgbm90IChteVJv" ..
    "b3QgYW5kIGtpbGxlclJvb3QpIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBsb2NhbCBvbGRDRnJhbWUgPSBteVJvb3QuQ0ZyYW1lCiAgICAgICAgbG9jYWwgZm9yd2FyZCA9IGtpbGxlclJvb3QuQ0ZyYW1lLkxvb2tWZWN0b3IKCiAgICAgICAgbXlSb290LkNGcmFtZSA9IGtpbGxlclJvb3QuQ0ZyYW1lICsgZm9yd2FyZCAqIDcuNQoKICAgICAgICB0YXNrLmRlbGF5KDAuMSwgZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBteVJvb3QgdGhlbgogICAgICAgICAgICAgICAgbXlSb290LkNGcmFtZSA9IG9sZENGcmFtZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRCb29sRmxhZyhuYW1lLCBkZWZhdWx0KQogICAgICAgIGxvY2FsIGZsYWcgPSBsb2NhbFBsYXllcjpGaW5kRmlyc3RDaGlsZChuYW1lKQogICAgICAgIGlmIG5vdCBmbGFnIHRoZW4KICAgICAgICAgICAgZmxhZyA9IEluc3RhbmNlLm5ldygiQm9vbFZhbHVlIikKICAgICAgICAgICAgZmxhZy5OYW1lID0gbmFtZQogICAgICAgICAgICBmbGFnLlZhbHVlID0gZGVmYXVsdAogICAgICAgICAgICBmbGFnLlBhcmVudCA9IGxvY2FsUGxheWVyCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIGZsYWcKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIGdldE51bWJlckZsYWcobmFtZSwgZGVmYXVsdCkKICAgICAgICBsb2NhbCBmbGFnID0gbG9jYWxQbGF5ZXI6RmluZEZpcnN0Q2hpbGQobmFtZSkKICAgICAg" ..
    "ICBpZiBub3QgZmxhZyB0aGVuCiAgICAgICAgICAgIGZsYWcgPSBJbnN0YW5jZS5uZXcoIk51bWJlclZhbHVlIikKICAgICAgICAgICAgZmxhZy5OYW1lID0gbmFtZQogICAgICAgICAgICBmbGFnLlZhbHVlID0gZGVmYXVsdAogICAgICAgICAgICBmbGFnLlBhcmVudCA9IGxvY2FsUGxheWVyCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIGZsYWcKICAgIGVuZAoKICAgIGxvY2FsIHRvZ2dsZUZsYWcgPSBnZXRCb29sRmxhZygiQXV0b0Jsb2NrVG9nZ2xlIiwgZmFsc2UpCiAgICBsb2NhbCBzdHJpY3RGbGFnID0gZ2V0Qm9vbEZsYWcoIkF1dG9CbG9ja1N0cmljdFJhbmdlIiwgZmFsc2UpCiAgICBsb2NhbCByYW5nZUZsYWcgPSBnZXROdW1iZXJGbGFnKCJBdXRvQmxvY2tSYW5nZSIsIDE4KQoKICAgIHRvZ2dsZU9uID0gdG9nZ2xlRmxhZy5WYWx1ZQogICAgc3RyaWN0UmFuZ2VPbiA9IHN0cmljdEZsYWcuVmFsdWUKICAgIGRldGVjdGlvblJhbmdlID0gcmFuZ2VGbGFnLlZhbHVlCgogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiQXV0b0Jsb2NrVjIiLCB7VGl0bGUgPSAiQXV0byBCbG9jayBWMyIsIERlZmF1bHQgPSB0b2dnbGVPbn0pCiAgICAgICAgOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgICAgICAgICAgdG9nZ2xlT24gPSBzdGF0ZQogICAgICAgICAgICB0b2dnbGVGbGFnLlZhbHVlID0gc3RhdGUKICAgICAgICBlbmQpCgogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiU3RyaWN0UmFuZ2VDaGVjayIsIHtUaXRs" ..
    "ZSA9ICJBdXRvIENoZWNrIFYzIiwgRGVmYXVsdCA9IHN0cmljdFJhbmdlT259KQogICAgICAgIDpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgICAgIHN0cmljdFJhbmdlT24gPSBzdGF0ZQogICAgICAgICAgICBzdHJpY3RGbGFnLlZhbHVlID0gc3RhdGUKICAgICAgICBlbmQpCgogICAgVGFicy5NYWluOkFkZElucHV0KCJSYW5nZUNoZWNrSW5wdXQiLCB7CiAgICAgICAgVGl0bGUgPSAiUmFuZ2UgQ2hlY2siLAogICAgICAgIERlZmF1bHQgPSB0b3N0cmluZyhkZXRlY3Rpb25SYW5nZSksCiAgICAgICAgUGxhY2Vob2xkZXIgPSAiRW50ZXIgZGV0ZWN0aW9uIHJhbmdlIgogICAgfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHR4dCkKICAgICAgICBsb2NhbCB2YWwgPSB0b251bWJlcih0eHQpCiAgICAgICAgaWYgdmFsIHRoZW4KICAgICAgICAgICAgZGV0ZWN0aW9uUmFuZ2UgPSB2YWwKICAgICAgICAgICAgcmFuZ2VGbGFnLlZhbHVlID0gdmFsCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgbG9jYWwgcGxheWVyQ29ubnMgPSB7fQogICAgbG9jYWwgcmVjZW50QmxvY2tzID0ge30KICAgIGxvY2FsIENPT0xET1dOX1pFUk8sIENPT0xET1dOX01JU1MgPSAwLCAwCgogICAgbG9jYWwgZnVuY3Rpb24gY2xlYW51cFBsYXllckNvbm5zKHApCiAgICAgICAgbG9jYWwgdGJsID0gcGxheWVyQ29ubnNbcF0KICAgICAgICBpZiB0YmwgdGhlbgogICAgICAgICAgICBmb3IgXywgYyBpbiBpcGFpcnModGJsKSBkbwogICAgICAg" ..
    "ICAgICAgICAgaWYgYyBhbmQgYy5EaXNjb25uZWN0IHRoZW4gYzpEaXNjb25uZWN0KCkgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBwbGF5ZXJDb25uc1twXSA9IG5pbAogICAgICAgIGVuZAogICAgICAgIHJlY2VudEJsb2Nrc1twLlVzZXJJZF0gPSBuaWwKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIHNob3VsZEJsb2NrTm93KHAsIGFuaW1JZCwgdHJhY2spCiAgICAgICAgcmVjZW50QmxvY2tzW3AuVXNlcklkXSA9IHJlY2VudEJsb2Nrc1twLlVzZXJJZF0gb3Ige30KICAgICAgICBsb2NhbCBsYXN0ID0gcmVjZW50QmxvY2tzW3AuVXNlcklkXVthbmltSWRdIG9yIDAKICAgICAgICBsb2NhbCBub3cgPSB0aWNrKCkKICAgICAgICBpZiB0cmFjay5UaW1lUG9zaXRpb24gPD0gMCB0aGVuCiAgICAgICAgICAgIGlmIG5vdyAtIGxhc3QgPj0gQ09PTERPV05fWkVSTyB0aGVuCiAgICAgICAgICAgICAgICByZWNlbnRCbG9ja3NbcC5Vc2VySWRdW2FuaW1JZF0gPSBub3cKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIG5vdyAtIGxhc3QgPj0gQ09PTERPV05fTUlTUyB0aGVuCiAgICAgICAgICAgICAgICByZWNlbnRCbG9ja3NbcC5Vc2VySWRdW2FuaW1JZF0gPSBub3cKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4gZmFs" ..
    "c2UKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIG1hc3NJbmZlY3Rpb25JZHMgPSB7CiAgICAgICAgWyIxMzE0MzA0OTc4MjExOTgiXSA9IHRydWUsCiAgICAgICAgWyIxMDA1OTI5MTMwMzAzNTEiXSA9IHRydWUsCiAgICAgICAgWyI3MDQ0NzYzNDg2MjkxMSJdICA9IHRydWUsCiAgICAgICAgWyI4MzY4NTMwNTU1MzM2NCJdICA9IHRydWUsCiAgICAgICAgWyIxMDExMDE0MzM2ODQwNTEiXSA9IHRydWUsCiAgICB9CgogICAgbG9jYWwgZnVuY3Rpb24gb25BbmltYXRpb25QbGF5ZWQocGxheWVyLCBjaGFyLCB0cmFjaykKICAgICAgICBpZiBub3QgdG9nZ2xlT24gdGhlbiByZXR1cm4gZW5kCiAgICAgICAgaWYgbm90ICh0cmFjayBhbmQgdHJhY2suQW5pbWF0aW9uKSB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBhbmltSWRTdHIgPSB0cmFjay5BbmltYXRpb24uQW5pbWF0aW9uSWQKICAgICAgICBsb2NhbCBpZCA9IGFuaW1JZFN0ciBhbmQgc3RyaW5nLm1hdGNoKGFuaW1JZFN0ciwgIiVkKyIpCiAgICAgICAgaWYgbm90IGlkIG9yIG5vdCBhbmltYXRpb25JZHNbaWRdIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBpZiBzdHJpY3RSYW5nZU9uIHRoZW4KICAgICAgICAgICAgbG9jYWwgbXlDaGFyID0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGxvY2FsIG15Um9vdCA9IG15Q2hhciBhbmQgbXlDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgbG9j" ..
    "YWwgcm9vdCA9IGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICBpZiBub3QgbXlSb290IG9yIG5vdCByb290IHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCBkaXN0ID0gKHJvb3QuUG9zaXRpb24gLSBteVJvb3QuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICBpZiBkaXN0ID4gZGV0ZWN0aW9uUmFuZ2UgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgZW5kCgogICAgICAgIGlmIHNob3VsZEJsb2NrTm93KHBsYXllciwgaWQsIHRyYWNrKSB0aGVuCiAgICAgICAgICAgIGlmIG1hc3NJbmZlY3Rpb25JZHNbaWRdIHRoZW4KICAgICAgICAgICAgICAgIHRhc2suZGVsYXkoMC41LCBmYXN0QmxvY2spIC0tIGRlbGF5IDAuNXMgY2hvIE1hc3NJbmZlY3Rpb24KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgZmFzdEJsb2NrKCkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBpc0tpbGxlcihwbGF5ZXIpIGFuZCBkZWxheWVkQW5pbWF0aW9uc1tpZF0gdGhlbgogICAgICAgICAgICAgICAgdGVsZXBvcnREb2RnZShjaGFyKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIG1vbml0b3JDaGFyYWN0ZXIocGxheWVyLCBjaGFyKQogICAgICAgIGlmIG5vdCBwbGF5ZXIgb3Igbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgaHVtID0gY2hhcjpGaW5kRmlyc3RDaGls" ..
    "ZE9mQ2xhc3MoIkh1bWFub2lkIikgb3IgY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIiwgNSkKICAgICAgICBpZiBub3QgaHVtIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIGNvbiA9IGh1bS5BbmltYXRpb25QbGF5ZWQ6Q29ubmVjdChmdW5jdGlvbih0cmFjaykKICAgICAgICAgICAgdGFzay5zcGF3bihvbkFuaW1hdGlvblBsYXllZCwgcGxheWVyLCBjaGFyLCB0cmFjaykKICAgICAgICBlbmQpCiAgICAgICAgcGxheWVyQ29ubnNbcGxheWVyXSA9IHBsYXllckNvbm5zW3BsYXllcl0gb3Ige30KICAgICAgICB0YWJsZS5pbnNlcnQocGxheWVyQ29ubnNbcGxheWVyXSwgY29uKQogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gb25QbGF5ZXJBZGRlZChwbGF5ZXIpCiAgICAgICAgaWYgcGxheWVyID09IGxvY2FsUGxheWVyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGlmIHBsYXllci5DaGFyYWN0ZXIgdGhlbiBtb25pdG9yQ2hhcmFjdGVyKHBsYXllciwgcGxheWVyLkNoYXJhY3RlcikgZW5kCiAgICAgICAgbG9jYWwgY29uQ2hhckFkZGVkID0gcGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcikKICAgICAgICAgICAgdGFzay53YWl0KDApCiAgICAgICAgICAgIG1vbml0b3JDaGFyYWN0ZXIocGxheWVyLCBjaGFyKQogICAgICAgIGVuZCkKICAgICAgICBwbGF5ZXJDb25uc1twbGF5ZXJdID0gcGxheWVyQ29ubnNbcGxheWVyXSBvciB7fQogICAgICAgIHRhYmxlLmluc2VydChwbGF5" ..
    "ZXJDb25uc1twbGF5ZXJdLCBjb25DaGFyQWRkZWQpCiAgICBlbmQKCiAgICBmb3IgXywgcCBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvIG9uUGxheWVyQWRkZWQocCkgZW5kCiAgICBQbGF5ZXJzLlBsYXllckFkZGVkOkNvbm5lY3Qob25QbGF5ZXJBZGRlZCkKICAgIFBsYXllcnMuUGxheWVyUmVtb3Zpbmc6Q29ubmVjdChjbGVhbnVwUGxheWVyQ29ubnMpCgogICAgbG9jYWwgY2lyY2xlcyA9IHt9CgogICAgbG9jYWwgZnVuY3Rpb24gY3JlYXRlQ2lyY2xlRm9yKHBsYXllciwgaHJwKQogICAgICAgIGlmIGNpcmNsZXNbcGxheWVyXSB0aGVuIGNpcmNsZXNbcGxheWVyXTpEZXN0cm95KCkgZW5kCiAgICAgICAgbG9jYWwgY2lyY2xlID0gSW5zdGFuY2UubmV3KCJQYXJ0IikKICAgICAgICBjaXJjbGUuQW5jaG9yZWQsIGNpcmNsZS5DYW5Db2xsaWRlID0gdHJ1ZSwgZmFsc2UKICAgICAgICBjaXJjbGUuU2hhcGUgPSBFbnVtLlBhcnRUeXBlLkN5bGluZGVyCiAgICAgICAgY2lyY2xlLlNpemUgPSBWZWN0b3IzLm5ldygwLjIsIGRldGVjdGlvblJhbmdlICogMiwgZGV0ZWN0aW9uUmFuZ2UgKiAyKQogICAgICAgIGNpcmNsZS5DRnJhbWUgPSBocnAuQ0ZyYW1lICogQ0ZyYW1lLkFuZ2xlcygwLCAwLCBtYXRoLnJhZCg5MCkpCiAgICAgICAgY2lyY2xlLk1hdGVyaWFsLCBjaXJjbGUuVHJhbnNwYXJlbmN5ID0gRW51bS5NYXRlcmlhbC5OZW9uLCAwLjUKICAgICAgICBjaXJjbGUuQ29sb3IgPSBDb2xvcjMuZnJvbVJH" ..
    "QigyNTUsIDAsIDApCiAgICAgICAgY2lyY2xlLlBhcmVudCA9IHdvcmtzcGFjZQogICAgICAgIGNpcmNsZXNbcGxheWVyXSA9IGNpcmNsZQogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gcmVtb3ZlQ2lyY2xlKHBsYXllcikKICAgICAgICBpZiBjaXJjbGVzW3BsYXllcl0gdGhlbiBjaXJjbGVzW3BsYXllcl06RGVzdHJveSgpIGNpcmNsZXNbcGxheWVyXSA9IG5pbCBlbmQKICAgIGVuZAoKICAgIFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIG5vdCBzdHJpY3RSYW5nZU9uIHRoZW4KICAgICAgICAgICAgZm9yIF8sIGNpcmNsZSBpbiBwYWlycyhjaXJjbGVzKSBkbwogICAgICAgICAgICAgICAgaWYgY2lyY2xlIHRoZW4gY2lyY2xlLlRyYW5zcGFyZW5jeSA9IDEgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICBsb2NhbCBteUNoYXIgPSBsb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBsb2NhbCBteVJvb3QgPSBteUNoYXIgYW5kIG15Q2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaWYgbm90IG15Um9vdCB0aGVuIHJldHVybiBlbmQKICAgICAgICBmb3IgXywgcGxheWVyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgaWYgcGxheWVyIH49IGxvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hh" ..
    "cmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCBocnAgPSBjaGFyIGFuZCBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgIGxvY2FsIGh1bSA9IGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICBpZiBocnAgYW5kIGh1bSBhbmQgaHVtLkhlYWx0aCA+IDAgYW5kIGlzS2lsbGVyKHBsYXllcikgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBjaXJjbGVzW3BsYXllcl0gdGhlbiBjcmVhdGVDaXJjbGVGb3IocGxheWVyLCBocnApIGVuZAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNpcmNsZSA9IGNpcmNsZXNbcGxheWVyXQogICAgICAgICAgICAgICAgICAgIGNpcmNsZS5TaXplID0gVmVjdG9yMy5uZXcoMC4yLCBkZXRlY3Rpb25SYW5nZSAqIDIsIGRldGVjdGlvblJhbmdlICogMikKICAgICAgICAgICAgICAgICAgICBjaXJjbGUuQ0ZyYW1lID0gaHJwLkNGcmFtZSAqIENGcmFtZS5BbmdsZXMoMCwgMCwgbWF0aC5yYWQoOTApKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAobXlSb290LlBvc2l0aW9uIC0gaHJwLlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICBjaXJjbGUuQ29sb3IgPSAoZGlzdCA8PSBkZXRlY3Rpb25SYW5nZSkgYW5kIENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMCkgb3IgQ29sb3IzLmZyb21SR0IoMjU1LCAwLCAwKQogICAgICAgICAgICAg" ..
    "ICAgICAgIGNpcmNsZS5UcmFuc3BhcmVuY3kgPSAwLjUKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZW1vdmVDaXJjbGUocGxheWVyKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kKQoKICAgIFBsYXllcnMuUGxheWVyUmVtb3Zpbmc6Q29ubmVjdChyZW1vdmVDaXJjbGUpCmVuZAoKCgoKCgpkbwpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCmxvY2FsIGxwID0gUGxheWVycy5Mb2NhbFBsYXllcgoKaWYgZ2V0Z2VudigpLmVtZXJnZW5jeV9zdG9wID09IG5pbCB0aGVuCiAgICBnZXRnZW52KCkuZW1lcmdlbmN5X3N0b3AgPSBmYWxzZQplbmQKCi0tIPCflKcgQ2h1eeG7g24gc3R1ZHMgdGjDoG5oIMSR4buZIHTEg25nIGvDrWNoIHRoxrDhu5tjCmxvY2FsIGZ1bmN0aW9uIFN0dWRzSW50b1NpemUoc3R1ZHMpCiAgICByZXR1cm4gc3R1ZHMgKiAwLjUKZW5kCgotLSDimpnvuI8gSMOgbSB0xINuZyBoaXRib3ggbmfGsOG7nWkga2jDoWMKbG9jYWwgZnVuY3Rpb24gRXh0ZW5kT3RoZXJzSGl0Ym94KHN0dWRzLCB0aW1lKQogICAgbG9jYWwgc2l6ZV9pbmNyZWFzZSA9IFN0dWRzSW50b1NpemUoc3R1ZHMpCiAgICBsb2NhbCBzdGFydCA9IHRpY2soKQoKICAgIGlmIGdldGdlbnYoKS5lbWVyZ2VuY3lfc3RvcCB0aGVuCiAgICAgICAg" ..
    "Z2V0Z2VudigpLmVtZXJnZW5jeV9zdG9wID0gZmFsc2UKICAgIGVuZAoKICAgIHJlcGVhdAogICAgICAgIHRhc2sud2FpdCgwLjA1KQogICAgICAgIGZvciBfLCBwbHIgaW4gcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgIGlmIHBsciB+PSBscCBhbmQgcGxyLkNoYXJhY3RlciBhbmQgcGxyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCBwYXJ0IGluIHBhaXJzKHBsci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBwYXJ0OklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIG9yaWdpbmFsU2l6ZSA9IHBhcnQuU2l6ZQogICAgICAgICAgICAgICAgICAgICAgICBwYXJ0LlNpemUgPSBWZWN0b3IzLm5ldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsU2l6ZS5YICsgc2l6ZV9pbmNyZWFzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsU2l6ZS5ZLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxTaXplLlogKyBzaXplX2luY3JlYXNlCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgcGFydC5NYXNzbGVzcyA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgcGFydC5DYW5Db2xsaWRlID0gZmFsc2UKICAgICAgICAgICAgICAg" ..
    "ICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIHVudGlsIHRpY2soKSAtIHN0YXJ0ID4gdG9udW1iZXIodGltZSkgb3IgZ2V0Z2VudigpLmVtZXJnZW5jeV9zdG9wCgogICAgLS0g8J+UhCBUcuG6oyBs4bqhaSBrw61jaCB0aMaw4bubYyBjxakKICAgIGlmIGdldGdlbnYoKS5lbWVyZ2VuY3lfc3RvcCB0aGVuCiAgICAgICAgZ2V0Z2VudigpLmVtZXJnZW5jeV9zdG9wID0gZmFsc2UKICAgIGVuZAoKICAgIGZvciBfLCBwbHIgaW4gcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgaWYgcGxyIH49IGxwIGFuZCBwbHIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgZm9yIF8sIHBhcnQgaW4gcGFpcnMocGxyLkNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgcGFydDpJc0EoIkJhc2VQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgIHBhcnQuU2l6ZSA9IFZlY3RvcjMubmV3KDIsIDIsIDEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSDwn5uRIEjDoG0gZOG7q25nCmxvY2FsIGZ1bmN0aW9uIFN0b3BFeHRlbmRpbmdIaXRib3goKQogICAgZ2V0Z2VudigpLmVtZXJnZW5jeV9zdG9wID0gdHJ1ZQplbmQKCi0tIPCfn6IgTsO6dCBi4bqtdC904bqvdCBoaXRib3ggZXh0ZW5kZXIKVGFicy5NYWluOkFkZFRvZ2dsZSgiRXh0ZW5kSGl0Ym94T3Ro" ..
    "ZXJzIiwgewogICAgVGl0bGUgPSAiQmxvY2sgSGl0Ym94IiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgaWYgVmFsdWUgdGhlbgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIFZhbHVlIGFuZCBub3QgZ2V0Z2VudigpLmVtZXJnZW5jeV9zdG9wIGRvCiAgICAgICAgICAgICAgICAgICAgRXh0ZW5kT3RoZXJzSGl0Ym94KDEuNSwgMikKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBTdG9wRXh0ZW5kaW5nSGl0Ym94KCkKICAgICAgICBlbmQKICAgIGVuZAp9KQplbmQKCgoKCgpkbwogICAgLS0gQXV0byBQdW5jaCBzZXR0aW5ncwogICAgbG9jYWwgYXV0b1B1bmNoT24sIGFpbVB1bmNoLCBmbGluZ1B1bmNoT24sIGN1c3RvbVB1bmNoRW5hYmxlZCA9IGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlCiAgICBsb2NhbCBoaWRkZW5mbGluZyA9IGZhbHNlCiAgICBsb2NhbCBmbGluZ1Bvd2VyID0gMTAwMDAKICAgIGxvY2FsIHByZWRpY3Rpb25WYWx1ZSA9IDQKICAgIGxvY2FsIGN1c3RvbVB1bmNoQW5pbUlkID0gIiIKICAgIGxvY2FsIEh1bWFub2lkCiAgICBsb2NhbCBsYXN0UHVuY2hUaW1lID0gMAogICAgbG9jYWwgcHVuY2hBbmltSWRzID0geyAiODcyNTkzOTE5MjYzMjEiIH0KICAgIGxv" ..
    "Y2FsIExQID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQogICAgbG9jYWwgUGxheWVyR3VpID0gTFA6V2FpdEZvckNoaWxkKCJQbGF5ZXJHdWkiKQoKICAgIC0tIEZ1bmN0aW9uOiBwbGF5IGN1c3RvbSBwdW5jaCBhbmltCiAgICBsb2NhbCBmdW5jdGlvbiBwbGF5Q3VzdG9tUHVuY2goYW5pbUlkKQogICAgICAgIGlmIG5vdCBIdW1hbm9pZCB0aGVuIHJldHVybiBlbmQKICAgICAgICBpZiBub3QgYW5pbUlkIG9yIGFuaW1JZCA9PSAiIiB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBub3cgPSB0aWNrKCkKICAgICAgICBpZiBub3cgLSBsYXN0UHVuY2hUaW1lIDwgMSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgZm9yIF8sIHRyYWNrIGluIGlwYWlycyhIdW1hbm9pZDpHZXRQbGF5aW5nQW5pbWF0aW9uVHJhY2tzKCkpIGRvCiAgICAgICAgICAgIGxvY2FsIGFuaW1OdW0gPSB0b3N0cmluZyh0cmFjay5BbmltYXRpb24uQW5pbWF0aW9uSWQpOm1hdGNoKCIlZCsiKQogICAgICAgICAgICBpZiB0YWJsZS5maW5kKHB1bmNoQW5pbUlkcywgYW5pbU51bSkgdGhlbgogICAgICAgICAgICAgICAgdHJhY2s6U3RvcCgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBhbmltID0gSW5zdGFuY2UubmV3KCJBbmltYXRpb24iKQogICAgICAgIGFuaW0uQW5pbWF0aW9uSWQgPSAicmJ4" ..
    "YXNzZXRpZDovLyIgLi4gYW5pbUlkCiAgICAgICAgbG9jYWwgdHJhY2sgPSBIdW1hbm9pZDpMb2FkQW5pbWF0aW9uKGFuaW0pCiAgICAgICAgdHJhY2s6UGxheSgpCiAgICAgICAgbGFzdFB1bmNoVGltZSA9IG5vdwogICAgZW5kCgogICAgLS0gSGlkZGVuIGZsaW5nIGNvcm91dGluZQogICAgY29yb3V0aW5lLndyYXAoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGhycCwgYywgdmVsLCBtb3ZlbCA9IG5pbCwgbmlsLCBuaWwsIDAuMQogICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgUnVuU2VydmljZS5IZWFydGJlYXQ6V2FpdCgpCiAgICAgICAgICAgIGlmIGhpZGRlbmZsaW5nIHRoZW4KICAgICAgICAgICAgICAgIHdoaWxlIGhpZGRlbmZsaW5nIGFuZCBub3QgKGMgYW5kIGMuUGFyZW50IGFuZCBocnAgYW5kIGhycC5QYXJlbnQpIGRvCiAgICAgICAgICAgICAgICAgICAgUnVuU2VydmljZS5IZWFydGJlYXQ6V2FpdCgpCiAgICAgICAgICAgICAgICAgICAgYyA9IExQLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGhycCA9IGMgYW5kIGM6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBoaWRkZW5mbGluZyB0aGVuCiAgICAgICAgICAgICAgICAgICAgdmVsID0gaHJwLlZlbG9jaXR5CiAgICAgICAgICAgICAgICAgICAgaHJwLlZlbG9jaXR5ID0gdmVsICogZmxpbmdQb3dlciArIFZlY3RvcjMubmV3KDAsIGZsaW5nUG93" ..
    "ZXIsIDApCiAgICAgICAgICAgICAgICAgICAgUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOldhaXQoKQogICAgICAgICAgICAgICAgICAgIGhycC5WZWxvY2l0eSA9IHZlbAogICAgICAgICAgICAgICAgICAgIFJ1blNlcnZpY2UuU3RlcHBlZDpXYWl0KCkKICAgICAgICAgICAgICAgICAgICBocnAuVmVsb2NpdHkgPSB2ZWwgKyBWZWN0b3IzLm5ldygwLCBtb3ZlbCwgMCkKICAgICAgICAgICAgICAgICAgICBtb3ZlbCA9IG1vdmVsICogLTEKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkoKQoKICAgIC0tIEF1dG8gUHVuY2ggbG9vcAogICAgUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIG15Q2hhciA9IExQLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCBteUNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgbXlSb290ID0gbXlDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBIdW1hbm9pZCA9IG15Q2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKCiAgICAgICAgaWYgYXV0b1B1bmNoT24gdGhlbgogICAgICAgICAgICBsb2NhbCBndWkgPSBQbGF5ZXJHdWk6RmluZEZpcnN0Q2hpbGQoIk1haW5VSSIpCiAgICAgICAgICAgIGxvY2FsIHB1bmNoQnRuID0gZ3VpIGFuZCBndWk6RmluZEZpcnN0Q2hpbGQoIkFiaWxpdHlDb250YWluZXIiKSBhbmQgZ3Vp" ..
    "LkFiaWxpdHlDb250YWluZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgbG9jYWwgY2hhcmdlcyA9IHB1bmNoQnRuIGFuZCBwdW5jaEJ0bjpGaW5kRmlyc3RDaGlsZCgiQ2hhcmdlcyIpCgogICAgICAgICAgICBpZiBjaGFyZ2VzIGFuZCBjaGFyZ2VzLlRleHQgPT0gIjEiIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGtpbGxlck5hbWVzID0geyJjMDBsa2lkZCIsICJTbGFzaGVyIiwgIkpvaG5Eb2UiLCAiMXgxeDF4MSIsICJOb2xpIiwgIkd1ZXN0IDY2NiIsICJTaXhlciJ9CiAgICAgICAgICAgICAgICBmb3IgXywgbmFtZSBpbiBpcGFpcnMoa2lsbGVyTmFtZXMpIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwga2lsbGVyID0gd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJzIikKICAgICAgICAgICAgICAgICAgICAgICAgYW5kIHdvcmtzcGFjZS5QbGF5ZXJzOkZpbmRGaXJzdENoaWxkKCJLaWxsZXJzIikKICAgICAgICAgICAgICAgICAgICAgICAgYW5kIHdvcmtzcGFjZS5QbGF5ZXJzLktpbGxlcnM6RmluZEZpcnN0Q2hpbGQobmFtZSkKCiAgICAgICAgICAgICAgICAgICAgaWYga2lsbGVyIGFuZCBraWxsZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHJvb3QgPSBraWxsZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICAgICAgICAgICAgICBpZiByb290IGFuZCBteVJvb3QgYW5kIChyb290" ..
    "LlBvc2l0aW9uIC0gbXlSb290LlBvc2l0aW9uKS5NYWduaXR1ZGUgPD0gMTAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLSBBaW0gUHVuY2gKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFpbVB1bmNoIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IG15Q2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGh1bWFub2lkIHRoZW4gaHVtYW5vaWQuQXV0b1JvdGF0ZSA9IGZhbHNlIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBzdGFydCA9IHRpY2soKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSB0aWNrKCkgLSBzdGFydCA8IDIgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG15Um9vdCBhbmQgcm9vdCBhbmQgcm9vdC5QYXJlbnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHByZWRpY3RlZFBvcyA9IHJvb3QuUG9zaXRpb24gKyAocm9vdC5DRnJhbWUuTG9va1ZlY3RvciAqIHByZWRpY3Rpb25WYWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg" ..
    "ICBteVJvb3QuQ0ZyYW1lID0gQ0ZyYW1lLmxvb2tBdChteVJvb3QuUG9zaXRpb24sIHByZWRpY3RlZFBvcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGh1bWFub2lkIHRoZW4gaHVtYW5vaWQuQXV0b1JvdGF0ZSA9IHRydWUgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0gQ2xpY2sgcHVuY2ggYnV0dG9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgY29ubiBpbiBpcGFpcnMoZ2V0Y29ubmVjdGlvbnMocHVuY2hCdG4uTW91c2VCdXR0b24xQ2xpY2spKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgY29ubjpGaXJlKCkgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0gRmxpbmcgUHVuY2gKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZsaW5nUHVuY2hPbiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZGVuZmxpbmcgPSB0cnVlCiAgICAgICAg" ..
    "ICAgICAgICAgICAgICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHN0YXJ0ID0gdGljaygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIHRpY2soKSAtIHN0YXJ0IDwgMSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgTFAuQ2hhcmFjdGVyIGFuZCBMUC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBhbmQgcm9vdCBhbmQgcm9vdC5QYXJlbnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGZyb250UG9zID0gcm9vdC5Qb3NpdGlvbiArIChyb290LkNGcmFtZS5Mb29rVmVjdG9yICogMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMUC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGZyb250UG9zLCByb290LlBvc2l0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZGVuZmxpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAg" ..
    "ICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIEN1c3RvbSBhbmltCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjdXN0b21QdW5jaEVuYWJsZWQgYW5kIGN1c3RvbVB1bmNoQW5pbUlkIH49ICIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5Q3VzdG9tUHVuY2goY3VzdG9tUHVuY2hBbmltSWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayAtLSBjaOG7iSDEkcOhbmggMSBraWxsZXIgbeG7l2kgdsOybmcKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgLS0gPT09IE7DunQgY2hvIFRhYnMuTWFpbiAodGjDqm0gdsOgbyBHVUkgY8OzIHPhurVuKSA9PT0KICAgIFRhYnMuTWFpbjpBZGRUb2dnbGUoIkF1dG9QdW5jaCIsIHsgVGl0bGUgPSAiQXV0byBQdW5jaCIsIERlZmF1bHQgPSBmYWxzZSB9KQogICAgICAgIDpPbkNoYW5nZWQoZnVuY3Rpb24odmFsKSBhdXRvUHVuY2hPbiA9IHZhbCBlbmQpCgogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiQWltUHVuY2giLCB7IFRpdGxlID0gIlB1bmNoIEFpbWJvdCIsIERlZmF1bHQgPSBmYWxzZSB9KQogICAgICAgIDpPbkNoYW5nZWQoZnVu" ..
    "Y3Rpb24odmFsKSBhaW1QdW5jaCA9IHZhbCBlbmQpCgogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiRmxpbmdQdW5jaCIsIHsgVGl0bGUgPSAiRmxpbmcgUHVuY2giLCBEZWZhdWx0ID0gZmFsc2UgfSkKICAgICAgICA6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbCkgZmxpbmdQdW5jaE9uID0gdmFsIGVuZCkKCiAgICBUYWJzLk1haW46QWRkU2xpZGVyKCJQcmVkaWN0aW9uIiwgewogICAgICAgIFRpdGxlID0gIkFpbSBQcmVkaWN0aW9uIiwKICAgICAgICBNaW4gPSAwLCBNYXggPSAxMCwgRGVmYXVsdCA9IDQsIFJvdW5kaW5nID0gMSwKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbih2YWwpIHByZWRpY3Rpb25WYWx1ZSA9IHZhbCBlbmQpCgogICAgVGFicy5NYWluOkFkZFNsaWRlcigiRmxpbmdQb3dlciIsIHsKICAgICAgICBUaXRsZSA9ICJGbGluZyBQb3dlciIsCiAgICAgICAgTWluID0gNTAwMCwgTWF4ID0gNTAwMDAwLCBEZWZhdWx0ID0gMTAwMDAsIFJvdW5kaW5nID0gMCwKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbih2YWwpIGZsaW5nUG93ZXIgPSB2YWwgZW5kKQoKICAgIFRhYnMuTWFpbjpBZGRJbnB1dCgiQ3VzdG9tQW5pbSIsIHsKICAgICAgICBUaXRsZSA9ICJDdXN0b20gUHVuY2giLAogICAgICAgIERlZmF1bHQgPSAiIiwKICAgICAgICBQbGFjZWhvbGRlciA9ICJFbnRlciBBbmltYXRpb24gSUQiCiAgICB9KTpPbkNoYW5nZWQoZnVuY3Rpb24odHh0KSBjdXN0b21QdW5jaEFuaW1JZCA9IHR4dCBlbmQpCgogICAg" ..
    "VGFicy5NYWluOkFkZFRvZ2dsZSgiRW5hYmxlQ3VzdG9tQW5pbSIsIHsgVGl0bGUgPSAiRW5hYmxlIEN1c3RvbSBBbmltYXRpb24iLCBEZWZhdWx0ID0gZmFsc2UgfSkKICAgICAgICA6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbCkgY3VzdG9tUHVuY2hFbmFibGVkID0gdmFsIGVuZCkKZW5kCgogICAgVGFicy5NYWluOkFkZFNlY3Rpb24oIuKGsyBjMDBsa2lkZCIpCgoKCmRvCiAgICAtLT09IOKame+4jyBCYXNlIEdsb2JhbHMgPT0tLQogICAgbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCiAgICBsb2NhbCBSZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKQogICAgbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCiAgICBsb2NhbCBXb3Jrc3BhY2UgPSBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpCiAgICBsb2NhbCBDYW1lcmEgPSBXb3Jrc3BhY2UuQ3VycmVudENhbWVyYQogICAgbG9jYWwgUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKICAgIGdldGdlbnYoKS5SZW1vdGUgPSBSZXBsaWNhdGVkU3RvcmFnZTpXYWl0Rm9yQ2hpbGQoIk1vZHVsZXMiKTpXYWl0Rm9yQ2hpbGQoIk5ldHdvcmsiKTpXYWl0Rm9yQ2hpbGQoIlJlbW90ZUV2ZW50IikKICAgIGdldGdlbnYoKS53YWxrU3BlZWQgPSAxMDAKICAgIGdldGdlbnYoKS5jb25uZWN0aW9uID0gbmlsCiAgICBnZXRnZW52KCkuYmxvY2tGb290c3Rl" ..
    "cFBsYXllZCA9IGZhbHNlCgogICAgLS09PSDwn6egIEhlbHBlcnMgPT0tLQogICAgbG9jYWwgZnVuY3Rpb24gZ2V0Q2hhcmFjdGVyKCkKICAgICAgICByZXR1cm4gUGxheWVyLkNoYXJhY3RlciBvciBQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICBlbmQKCiAgICAtLT09IPCfjq8gVGFyZ2V0IGxpc3QgPT0KICAgIC0tIFRoYXkgc3BlY2lhbFRhcmdldHMgYuG6sW5nIGZvbGRlciBTdXJ2aXZvcnMgdOG7sSDEkeG7mW5nCiAgICBsb2NhbCBzdXJ2aXZvcnNGb2xkZXIgPSB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJQbGF5ZXJzIik6V2FpdEZvckNoaWxkKCJTdXJ2aXZvcnMiKQoKICAgIGxvY2FsIGZ1bmN0aW9uIGlzU3BlY2lhbFRhcmdldChjaGFyKQogICAgICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgIGlmIHN1cnZpdm9yc0ZvbGRlcjpGaW5kRmlyc3RDaGlsZChjaGFyLk5hbWUpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbmQKICAgICAgICAtLSBt4buZdCBz4buRIG1vZGVsIGPDsyB0aOG7gyBsw6AgY2hpbGQgY+G7p2EgbW9kZWwgKGPhuqluIHRo4bqtbikKICAgICAgICBmb3IgXywgY2hpbGQgaW4gaXBhaXJzKGNoYXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgc3Vydml2b3JzRm9sZGVyOkZpbmRGaXJzdENoaWxkKGNoaWxkLk5hbWUpIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAogICAg" ..
    "ICAgIGVuZAogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgLS09PSDwn4+DIE1vdmVtZW50IExvZ2ljID09LS0KICAgIGxvY2FsIHN0b3BNb3ZlbWVudCA9IGZhbHNlCiAgICBsb2NhbCB2YWxpZFZhbHVlcyA9IHsgVGltZW91dCA9IHRydWUsIENvbGxpZGUgPSB0cnVlLCBIaXQgPSB0cnVlIH0KICAgIGxvY2FsIHN0b3BUaW1lclRhc2sgPSBuaWwKICAgIGxvY2FsIFNUT1BfVElNRU9VVCA9IDUKCiAgICBsb2NhbCBmdW5jdGlvbiBzdGFydFN0b3BUaW1lb3V0KCkKICAgICAgICBpZiBzdG9wVGltZXJUYXNrIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIHN0b3BUaW1lclRhc2sgPSB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgdGFzay53YWl0KFNUT1BfVElNRU9VVCkKICAgICAgICAgICAgc3RvcE1vdmVtZW50ID0gZmFsc2UKICAgICAgICAgICAgc3RvcFRpbWVyVGFzayA9IG5pbAogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIGNhbmNlbFN0b3BUaW1lb3V0KCkKICAgICAgICBzdG9wVGltZXJUYXNrID0gbmlsCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiB3YXRjaFJlc3VsdChyZXN1bHQpCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gY2hlY2soKQogICAgICAgICAgICBpZiB2YWxpZFZhbHVlc1tyZXN1bHQuVmFsdWVdIHRoZW4KICAgICAgICAgICAgICAgIHN0b3BNb3ZlbWVudCA9IHRydWUKICAgICAgICAgICAgICAgIHN0YXJ0U3RvcFRpbWVvdXQoKQogICAgICAg" ..
    "ICAgICBlbHNlCiAgICAgICAgICAgICAgICBzdG9wTW92ZW1lbnQgPSBmYWxzZQogICAgICAgICAgICAgICAgY2FuY2VsU3RvcFRpbWVvdXQoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBwY2FsbChjaGVjaykKICAgICAgICBsb2NhbCBjb25uCiAgICAgICAgY29ubiA9IHJlc3VsdDpHZXRQcm9wZXJ0eUNoYW5nZWRTaWduYWwoIlZhbHVlIik6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgIHBjYWxsKGNoZWNrKQogICAgICAgIGVuZCkKICAgICAgICByZXN1bHQuQW5jZXN0cnlDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oXywgcGFyZW50KQogICAgICAgICAgICBpZiBub3QgcGFyZW50IHRoZW4KICAgICAgICAgICAgICAgIHN0b3BNb3ZlbWVudCA9IGZhbHNlCiAgICAgICAgICAgICAgICBjYW5jZWxTdG9wVGltZW91dCgpCiAgICAgICAgICAgICAgICBpZiBjb25uIHRoZW4KICAgICAgICAgICAgICAgICAgICBjb25uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgICAgIGNvbm4gPSBuaWwKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBvbkNoYXJhY3RlckFkZGVkKGNoYXJhY3RlcikKICAgICAgICBsb2NhbCByZXN1bHQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlJlc3VsdCIpCiAgICAgICAgaWYgcmVzdWx0IGFuZCByZXN1bHQ6SXNBKCJTdHJpbmdWYWx1ZSIpIHRoZW4KICAgICAgICAg" ..
    "ICAgd2F0Y2hSZXN1bHQocmVzdWx0KQogICAgICAgIGVuZAogICAgICAgIGNoYXJhY3Rlci5DaGlsZEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hpbGQpCiAgICAgICAgICAgIGlmIGNoaWxkLk5hbWUgPT0gIlJlc3VsdCIgYW5kIGNoaWxkOklzQSgiU3RyaW5nVmFsdWUiKSB0aGVuCiAgICAgICAgICAgICAgICB3YXRjaFJlc3VsdChjaGlsZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgICAgIGNoYXJhY3Rlci5DaGlsZFJlbW92ZWQ6Q29ubmVjdChmdW5jdGlvbihjaGlsZCkKICAgICAgICAgICAgaWYgY2hpbGQuTmFtZSA9PSAiUmVzdWx0IiB0aGVuCiAgICAgICAgICAgICAgICBzdG9wTW92ZW1lbnQgPSBmYWxzZQogICAgICAgICAgICAgICAgY2FuY2VsU3RvcFRpbWVvdXQoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKCiAgICBQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChvbkNoYXJhY3RlckFkZGVkKQogICAgaWYgUGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgb25DaGFyYWN0ZXJBZGRlZChQbGF5ZXIuQ2hhcmFjdGVyKQogICAgZW5kCgogICAgLS09PSDwn5SOIEhlbHBlcnMgPT0tLQogICAgbG9jYWwgZnVuY3Rpb24gZ2V0SHVtUm9vdChwYXJ0T3JDaGFyKQogICAgICAgIGlmIG5vdCBwYXJ0T3JDaGFyIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgICAgICByZXR1cm4gcGFydE9yQ2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIG9yIHBhcnRP" ..
    "ckNoYXI6RmluZEZpcnN0Q2hpbGQoIlRvcnNvIikgb3IgcGFydE9yQ2hhcjpGaW5kRmlyc3RDaGlsZCgiVXBwZXJUb3JzbyIpCiAgICBlbmQKCiAgICAtLT09IPCflIQgTW92ZW1lbnQgZm9sbG93IGNhbWVyYSA9PS0tCiAgICBsb2NhbCBmdW5jdGlvbiBvbkhlYXJ0YmVhdCgpCiAgICAgICAgbG9jYWwgY2hhciA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAtLSBnaeG7ryBjaGVjayBjMDBsa2lkZCBuaMawIGfhu5FjIChjaOG7iSDDoXAgZOG7pW5nIGNobyBt4bqrdSBjMDBsa2lkZCkKICAgICAgICBpZiBub3QgY2hhciBvciBjaGFyLk5hbWUgfj0gImMwMGxraWRkIiB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCByb290ID0gZ2V0SHVtUm9vdChjaGFyKQogICAgICAgIGxvY2FsIGh1bSA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgbG9jYWwgbHYgPSByb290IGFuZCByb290OkZpbmRGaXJzdENoaWxkKCJMaW5lYXJWZWxvY2l0eSIpCiAgICAgICAgaWYgbm90IHJvb3Qgb3Igbm90IGh1bSBvciBub3QgbHYgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbHYuRW5hYmxlZCA9IGZhbHNlCiAgICAgICAgaWYgc3RvcE1vdmVtZW50IHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBsb2NhbCBsb29rID0gQ2FtZXJhIGFuZCBDYW1lcmEuQ0ZyYW1lIGFuZCBDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3Igb3IgbmlsCiAgICAgICAgaWYgbG9vayB0aGVuCiAgICAgICAgICAgIGxvY2FsIGRp" ..
    "ciA9IFZlY3RvcjMubmV3KGxvb2suWCwgMCwgbG9vay5aKQogICAgICAgICAgICBpZiBkaXIuTWFnbml0dWRlID4gMCB0aGVuCiAgICAgICAgICAgICAgICBkaXIgPSBkaXIuVW5pdAogICAgICAgICAgICAgICAgcm9vdC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KGRpci5YICogZ2V0Z2VudigpLndhbGtTcGVlZCwgcm9vdC5WZWxvY2l0eS5ZLCBkaXIuWiAqIGdldGdlbnYoKS53YWxrU3BlZWQpCiAgICAgICAgICAgICAgICByb290LkNGcmFtZSA9IENGcmFtZS5uZXcocm9vdC5Qb3NpdGlvbiwgcm9vdC5Qb3NpdGlvbiArIGRpcikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLT09IPCfp6kgSG9vayBIZWxwZXJzID09LS0KICAgIGdldGdlbnYoKS5jcmVhdGVIb29rID0gZnVuY3Rpb24ocmVtb3RlTmFtZSkKICAgICAgICBpZiBnZXRnZW52KClbIm9yaWdpbmFsXyIgLi4gcmVtb3RlTmFtZV0gdGhlbgogICAgICAgICAgICByZXR1cm4gZ2V0Z2VudigpWyJvcmlnaW5hbF8iIC4uIHJlbW90ZU5hbWVdCiAgICAgICAgZW5kCiAgICAgICAgZ2V0Z2VudigpWyJvcmlnaW5hbF8iIC4uIHJlbW90ZU5hbWVdID0gaG9va21ldGFtZXRob2QoZ2FtZSwgIl9fbmFtZWNhbGwiLCBmdW5jdGlvbihzZWxmLCAuLi4pCiAgICAgICAgICAgIGxvY2FsIG1ldGhvZCA9IGdldG5hbWVjYWxsbWV0aG9kKCkKICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsgLi4uIH0KICAgICAgICAgICAgaWYgc2VsZiA9PSBnZXRnZW52" ..
    "KCkuUmVtb3RlIGFuZCBtZXRob2QgPT0gIkZpcmVTZXJ2ZXIiIHRoZW4KICAgICAgICAgICAgICAgIGlmIGFyZ3NbMV0gPT0gUGxheWVyLk5hbWUgLi4gcmVtb3RlTmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJldHVybiBnZXRnZW52KClbIm9yaWdpbmFsXyIgLi4gcmVtb3RlTmFtZV0oc2VsZiwgLi4uKQogICAgICAgIGVuZCkKICAgICAgICByZXR1cm4gZ2V0Z2VudigpWyJvcmlnaW5hbF8iIC4uIHJlbW90ZU5hbWVdCiAgICBlbmQKCiAgICBnZXRnZW52KCkuZW5hYmxlSG9vayA9IGZ1bmN0aW9uKHJlbW90ZU5hbWUpCiAgICAgICAgaWYgbm90IGdldGdlbnYoKVsiaG9va18iIC4uIHJlbW90ZU5hbWVdIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpWyJob29rXyIgLi4gcmVtb3RlTmFtZV0gPSBnZXRnZW52KCkuY3JlYXRlSG9vayhyZW1vdGVOYW1lKQogICAgICAgIGVuZAogICAgICAgIGlmIHJlbW90ZU5hbWUgPT0gIkR1c2Vra2FyQ2FuY2VsIiBhbmQgbm90IGdldGdlbnYoKS5pc0ZpcmluZ0R1c2Vra2FyIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLmlzRmlyaW5nRHVzZWtrYXIgPSB0cnVlCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgdGFzay53YWl0KDQpCiAgICAgICAgICAgICAgICBnZXRnZW52KCkuUmVtb3RlOkZpcmVTZXJ2ZXIoeyBQbGF5ZXIuTmFtZSAu" ..
    "LiAiRHVzZWtrYXJDYW5jZWwiIH0pCiAgICAgICAgICAgICAgICBnZXRnZW52KCkuaXNGaXJpbmdEdXNla2thciA9IGZhbHNlCiAgICAgICAgICAgICAgICBzdG9wTW92ZW1lbnQgPSBmYWxzZQogICAgICAgICAgICAgICAgY2FuY2VsU3RvcFRpbWVvdXQoKQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBnZXRnZW52KCkuZGlzYWJsZUhvb2sgPSBmdW5jdGlvbihyZW1vdGVOYW1lKQogICAgICAgIGlmIGdldGdlbnYoKVsiaG9va18iIC4uIHJlbW90ZU5hbWVdIHRoZW4KICAgICAgICAgICAgaG9va21ldGFtZXRob2QoZ2FtZSwgIl9fbmFtZWNhbGwiLCBnZXRnZW52KClbImhvb2tfIiAuLiByZW1vdGVOYW1lXSkKICAgICAgICAgICAgZ2V0Z2VudigpWyJob29rXyIgLi4gcmVtb3RlTmFtZV0gPSBuaWwKICAgICAgICAgICAgZ2V0Z2VudigpWyJvcmlnaW5hbF8iIC4uIHJlbW90ZU5hbWVdID0gbmlsCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLT09IPCfkaMgRm9vdHN0ZXAgSG9vayA9PS0tCiAgICBnZXRnZW52KCkuSG9va0Zvb3RzdGVwUGxheWVkID0gZnVuY3Rpb24oZW5hYmxlKQogICAgICAgIGlmIGVuYWJsZSB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBnZXRnZW52KCkub3JpZ2luYWxGb290c3RlcEhvb2sgdGhlbgogICAgICAgICAgICAgICAgZ2V0Z2VudigpLm9yaWdpbmFsRm9vdHN0ZXBIb29rID0gaG9va21ldGFtZXRob2QoZ2FtZSwgIl9fbmFtZWNhbGwiLCBmdW5jdGlvbihzZWxm" ..
    "LCAuLi4pCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbWV0aG9kID0gZ2V0bmFtZWNhbGxtZXRob2QoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7IC4uLiB9CiAgICAgICAgICAgICAgICAgICAgaWYgbWV0aG9kID09ICJGaXJlU2VydmVyIiBhbmQgc2VsZi5OYW1lID09ICJVbnJlbGlhYmxlUmVtb3RlRXZlbnQiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgYXJnc1sxXSA9PSAiRm9vdHN0ZXBQbGF5ZWQiIGFuZCBnZXRnZW52KCkuYmxvY2tGb290c3RlcFBsYXllZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGdlbnYoKS5vcmlnaW5hbEZvb3RzdGVwSG9vayhzZWxmLCAuLi4pCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBnZXRnZW52KCkuYmxvY2tGb290c3RlcFBsYXllZCA9IHRydWUKICAgICAgICBlbHNlCiAgICAgICAgICAgIGdldGdlbnYoKS5ibG9ja0Zvb3RzdGVwUGxheWVkID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tPT0g4pqU77iPIENvbWJhdCBHVUkgKEZsdWVudCBzdHlsZSkgPT0tLQogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiV2Fsa3NwZWVkT3ZlcnJpZGUiLCB7CiAgICAgICAgVGl0bGUgPSAiV2Fsa3NwZWVkIE92ZXJyaWRlIENvbnRy" ..
    "b2xsZXIiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZQogICAgfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIGlmIHZhbHVlIHRoZW4KICAgICAgICAgICAgc3RvcE1vdmVtZW50ID0gZmFsc2UKICAgICAgICAgICAgY2FuY2VsU3RvcFRpbWVvdXQoKQogICAgICAgICAgICBpZiBub3QgZ2V0Z2VudigpLmNvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICAgICAgZ2V0Z2VudigpLmNvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KG9uSGVhcnRiZWF0KQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIGdldGdlbnYoKS5jb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgICAgIGdldGdlbnYoKS5jb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgZ2V0Z2VudigpLmNvbm5lY3Rpb24gPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiSWdub3JlQzAwbGtpZGQiLCB7CiAgICAgICAgVGl0bGUgPSAiV2Fsa3NwZWVkIE92ZXJyaWRlIElnbm9yZSBPYmplY3RhYmxlcyIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlCiAgICB9KTpPbkNoYW5nZWQoZnVuY3Rpb24odmFsdWUpCiAgICAgICAgaWYgdmFsdWUgdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuZW5hYmxlSG9vaygiQzAwbGtpZGRDb2xsaXNpb24iKQogICAgICAgIGVsc2UKICAgICAgICAgICAgZ2V0Z2VudigpLmRp" ..
    "c2FibGVIb29rKCJDMDBsa2lkZENvbGxpc2lvbiIpCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiSWdub3JlRm9vdHN0ZXAiLCB7CiAgICAgICAgVGl0bGUgPSAiQmxvY2sgRm9vdHN0ZXAgUGxheWVkIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbih2YWx1ZSkKICAgICAgICBnZXRnZW52KCkuSG9va0Zvb3RzdGVwUGxheWVkKHZhbHVlKQogICAgZW5kKQoKICAgIC0tPT0g8J+nqSBOZXcgVG9nZ2xlIGZvciBEdXNla2thciA9PQogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiRHVzZWtrYXJNb2RlIiwgewogICAgICAgIFRpdGxlID0gIkFudGkgRHVzZWthcnIgQXR0YWNrIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbih2YWx1ZSkKICAgICAgICBpZiB2YWx1ZSB0aGVuCiAgICAgICAgICAgIGdldGdlbnYoKS5lbmFibGVIb29rKCJEdXNla2thckNhbmNlbCIpCiAgICAgICAgZWxzZQogICAgICAgICAgICBnZXRnZW52KCkuZGlzYWJsZUhvb2soIkR1c2Vra2FyQ2FuY2VsIikKICAgICAgICBlbmQKICAgIGVuZCkKCmVuZAoKCgoKICAgIFRhYnMuTWFpbjpBZGRTZWN0aW9uKCLihrMgTm9saSIpCgpkbwogICAgbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIExv" ..
    "Y2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKICAgIC0tID09PT09PSBDT05GSUcgPT09PT09CiAgICBsb2NhbCB2b2lkcnVzaGNvbnRyb2wgPSBmYWxzZQogICAgbG9jYWwgREFTSF9TUEVFRCA9IDgwCiAgICBsb2NhbCBBVFRBQ0tfUkFOR0UgPSA2CiAgICBsb2NhbCBBVFRBQ0tfSU5URVJWQUwgPSAwLjIKCiAgICAtLSA9PT09PT0gRFlOQU1JQyBQUklPUklUWSA9PT09PT0KICAgIGxvY2FsIHN1cnZpdm9yc0ZvbGRlciA9IHdvcmtzcGFjZTpXYWl0Rm9yQ2hpbGQoIlBsYXllcnMiKTpXYWl0Rm9yQ2hpbGQoIlN1cnZpdm9ycyIpCgogICAgbG9jYWwgZnVuY3Rpb24gaXNQcmlvcml0eVRhcmdldChwKQogICAgICAgIGlmIG5vdCBwIG9yIG5vdCBwLkNoYXJhY3RlciB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgICByZXR1cm4gc3Vydml2b3JzRm9sZGVyOkZpbmRGaXJzdENoaWxkKHAuTmFtZSkgfj0gbmlsCiAgICBlbmQKCiAgICAtLSA9PT09PT0gU1RBVEUgPT09PT09CiAgICBsb2NhbCBpc092ZXJyaWRlQWN0aXZlID0gZmFsc2UKICAgIGxvY2FsIGNvbm5lY3Rpb24KICAgIGxvY2FsIEh1bWFub2lkLCBSb290UGFydAogICAgbG9jYWwgbGFzdFN0YXRlID0gbmlsCiAgICBsb2NhbCBhdHRhY2tpbmdMb29wID0gbmlsCgogICAgLS0gc2V0dXAgY2hhcmFjdGVyCiAgICBsb2NhbCBmdW5jdGlvbiBzZXR1cENoYXJhY3RlcihjaGFyYWN0ZXIpCiAgICAgICAgSHVtYW5vaWQgPSBjaGFyYWN0ZXI6V2FpdEZvckNo" ..
    "aWxkKCJIdW1hbm9pZCIpCiAgICAgICAgUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBIdW1hbm9pZC5EaWVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBzdG9wT3ZlcnJpZGUoKQogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIGlmIExvY2FsUGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgc2V0dXBDaGFyYWN0ZXIoTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyKQogICAgZW5kCiAgICBMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KHNldHVwQ2hhcmFjdGVyKQoKICAgIC0tIHTDrG0gbeG7pWMgdGnDqnUgaOG7o3AgbOG7hwogICAgbG9jYWwgZnVuY3Rpb24gdmFsaWRUYXJnZXQocCkKICAgICAgICBpZiBwID09IExvY2FsUGxheWVyIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgIGxvY2FsIGMgPSBwLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCBjIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgIGxvY2FsIGhycCA9IGM6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGxvY2FsIGh1bSA9IGM6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikKICAgICAgICByZXR1cm4gaHJwIGFuZCBodW0gYW5kIGh1bS5IZWFsdGggPiAwCiAgICBlbmQKCiAgICAtLSB0w6xtIHBsYXllciBn4bqnbiBuaOG6pXQgKMawdSB0acOqbiBzdXJ2aXZvcnNGb2xkZXIpCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRDbG9zZXN0" ..
    "VGFyZ2V0KCkKICAgICAgICBpZiBub3QgUm9vdFBhcnQgdGhlbiByZXR1cm4gbmlsIGVuZAoKICAgICAgICBsb2NhbCBjbG9zZXN0VywgZGlzdFcgPSBuaWwsIG1hdGguaHVnZQogICAgICAgIGxvY2FsIGNsb3Nlc3RBLCBkaXN0QSA9IG5pbCwgbWF0aC5odWdlCgogICAgICAgIGZvciBfLCBwIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgaWYgdmFsaWRUYXJnZXQocCkgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgYyA9IHAuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCBocnAgPSBjIGFuZCBjOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgIGlmIGhycCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZCA9IChocnAuUG9zaXRpb24gLSBSb290UGFydC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICAgICAgaWYgaXNQcmlvcml0eVRhcmdldChwKSBhbmQgZCA8IGRpc3RXIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZGlzdFcgPSBkCiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RXID0gcAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGQgPCBkaXN0QSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RBID0gZAogICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0QSA9IHAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAg" ..
    "ICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgcmV0dXJuIGNsb3Nlc3RXIG9yIGNsb3Nlc3RBLCBkaXN0VyA8IG1hdGguaHVnZSBhbmQgZGlzdFcgb3IgZGlzdEEKICAgIGVuZAoKICAgIC0tIGPhu5EgZ+G6r25nIHThuqVuIGPDtG5nICh0b29sOkFjdGl2YXRlKCkpCiAgICBsb2NhbCBmdW5jdGlvbiBhdHRlbXB0QXR0YWNrKCkKICAgICAgICBsb2NhbCBjaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgdG9vbCA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJUb29sIikKICAgICAgICBpZiB0b29sIGFuZCB0b29sLlBhcmVudCA9PSBjaGFyIHRoZW4KICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSB0b29sOkFjdGl2YXRlKCkgZW5kKQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gxJFp4buBdSBraGnhu4NuIFZvaWQgUnVzaAogICAgbG9jYWwgZnVuY3Rpb24gc3RhcnRPdmVycmlkZSgpCiAgICAgICAgaWYgaXNPdmVycmlkZUFjdGl2ZSBvciBub3QgSHVtYW5vaWQgb3Igbm90IFJvb3RQYXJ0IHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGlzT3ZlcnJpZGVBY3RpdmUgPSB0cnVlCgogICAgICAgIGNvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIG5vdCBIdW1hbm9pZCBvciBub3QgUm9vdFBhcnQgb3IgSHVtYW5v" ..
    "aWQuSGVhbHRoIDw9IDAgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIHRhcmdldCwgZGlzdCA9IGdldENsb3Nlc3RUYXJnZXQoKQoKICAgICAgICAgICAgaWYgdGFyZ2V0IGFuZCB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgaHJwID0gdGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgICAgICBsb2NhbCBkaXIgPSBocnAuUG9zaXRpb24gLSBSb290UGFydC5Qb3NpdGlvbgogICAgICAgICAgICAgICAgbG9jYWwgaG9yaXpvbnRhbCA9IFZlY3RvcjMubmV3KGRpci5YLCAwLCBkaXIuWikKCiAgICAgICAgICAgICAgICBpZiBob3Jpem9udGFsLk1hZ25pdHVkZSA+IDAuMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhSb290UGFydC5Qb3NpdGlvbiwgVmVjdG9yMy5uZXcoaHJwLlBvc2l0aW9uLlgsIFJvb3RQYXJ0LlBvc2l0aW9uLlksIGhycC5Qb3NpdGlvbi5aKSkKICAgICAgICAgICAgICAgICAgICBSb290UGFydC5Bc3NlbWJseUxpbmVhclZlbG9jaXR5ID0gaG9yaXpvbnRhbC5Vbml0ICogREFTSF9TUEVFRAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIFJvb3RQYXJ0LkFzc2VtYmx5TGluZWFyVmVsb2NpdHkgPSBWZWN0b3IzLnplcm8KICAgICAgICAgICAgICAgIGVu" ..
    "ZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBSb290UGFydC5Bc3NlbWJseUxpbmVhclZlbG9jaXR5ID0gVmVjdG9yMy56ZXJvCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKCiAgICAgICAgYXR0YWNraW5nTG9vcCA9IHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBpc092ZXJyaWRlQWN0aXZlIGRvCiAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXQsIGRpc3QgPSBnZXRDbG9zZXN0VGFyZ2V0KCkKICAgICAgICAgICAgICAgIGlmIHRhcmdldCBhbmQgZGlzdCBhbmQgZGlzdCA8PSBBVFRBQ0tfUkFOR0UgdGhlbgogICAgICAgICAgICAgICAgICAgIGF0dGVtcHRBdHRhY2soKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoQVRUQUNLX0lOVEVSVkFMKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKCiAgICBmdW5jdGlvbiBzdG9wT3ZlcnJpZGUoKQogICAgICAgIGlmIG5vdCBpc092ZXJyaWRlQWN0aXZlIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGlzT3ZlcnJpZGVBY3RpdmUgPSBmYWxzZQogICAgICAgIGlmIGNvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBjb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICBjb25uZWN0aW9uID0gbmlsCiAgICAgICAgZW5kCiAgICAgICAgaWYgUm9vdFBhcnQgdGhlbgogICAgICAgICAgICBSb290UGFydC5Bc3NlbWJseUxpbmVhclZlbG9jaXR5ID0gVmVjdG9yMy56ZXJv" ..
    "CiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBraeG7g20gdHJhIHRy4bqhbmcgdGjDoWkgdm9pZCBydXNoCiAgICBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgbm90IHZvaWRydXNoY29udHJvbCBvciBub3QgSHVtYW5vaWQgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgc3RhdGUgPSBIdW1hbm9pZC5QYXJlbnQgYW5kIEh1bWFub2lkLlBhcmVudDpHZXRBdHRyaWJ1dGUoIlZvaWRSdXNoU3RhdGUiKQogICAgICAgIGlmIHN0YXRlIH49IGxhc3RTdGF0ZSB0aGVuCiAgICAgICAgICAgIGxhc3RTdGF0ZSA9IHN0YXRlCiAgICAgICAgICAgIGlmIHN0YXRlID09ICJEYXNoaW5nIiB0aGVuCiAgICAgICAgICAgICAgICBzdGFydE92ZXJyaWRlKCkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgc3RvcE92ZXJyaWRlKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgLS0gdG9nZ2xlIEdVSQogICAgVGFicy5NYWluOkFkZFRvZ2dsZSgiVm9pZFJ1c2hDb250cm9sIiwgewogICAgICAgIFRpdGxlID0gIlZvaWQgUnVzaCBBaW1ib3QiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZQogICAgfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHYpCiAgICAgICAgdm9pZHJ1c2hjb250cm9sID0gdgogICAgICAgIGlmIG5vdCB2IHRoZW4gc3RvcE92ZXJyaWRlKCkgZW5kCiAgICBlbmQpCmVuZAoKCgogICAgVGFicy5NYWluOkFkZFNlY3Rpb24oIuKG" ..
    "syAxeDF4MXgxIikKCmRvCi0tIPCfp6kgR1VJIFRvZ2dsZSArIERyb3Bkb3duCmxvY2FsIHRvZ2dsZU9uID0gZmFsc2UKbG9jYWwgdG9nZ2xlRmxhZyA9IEluc3RhbmNlLm5ldygiQm9vbFZhbHVlIikKdG9nZ2xlRmxhZy5OYW1lID0gIjF4MXgxeDFBdXRvQWltX1RvZ2dsZUZsYWciCnRvZ2dsZUZsYWcuVmFsdWUgPSBmYWxzZQoKbG9jYWwgYWltTW9kZSA9ICJPbmUgUGxheWVyIgpsb2NhbCBwcmVkaWN0TW92ZW1lbnQgPSBmYWxzZQoKVGFicy5NYWluOkFkZERyb3Bkb3duKCJBaW1Nb2RlRHJvcGRvd24iLCB7CiAgICBUaXRsZSA9ICJBaW0gTW9kZSIsCiAgICBWYWx1ZXMgPSB7Ik9uZSBQbGF5ZXIiLCAiTXVsdGkgUGxheWVycyIsICJUZWxlcG9ydCJ9LAogICAgRGVmYXVsdCA9ICJPbmUgUGxheWVyIiwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKQogICAgYWltTW9kZSA9IHZhbHVlCmVuZCkKClRhYnMuTWFpbjpBZGRUb2dnbGUoIkFpbVNraWxsMXgxeDF4MSIsIHsKICAgIFRpdGxlID0gIk1hc3NJbmZlY3Rpb24gQWltYm90IiwKICAgIERlZmF1bHQgPSB0b2dnbGVPbiwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHN0YXRlKQogICAgdG9nZ2xlT24gPSBzdGF0ZQogICAgdG9nZ2xlRmxhZy5WYWx1ZSA9IHN0YXRlCmVuZCkKClRhYnMuTWFpbjpBZGRUb2dnbGUoIlByZWRpY3RNb3ZlbWVudFRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIlByZWRpY3QgTW92ZW1lbnQiLAogICAgRGVmYXVsdCA9IHByZWRpY3RNb3ZlbWVudCwK" ..
    "fSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHN0YXRlKQogICAgcHJlZGljdE1vdmVtZW50ID0gc3RhdGUKZW5kKQoKLS0g4pqZ77iPIFNldHVwCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKbG9jYWwgbG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIHdvcmtzcGFjZVBsYXllcnMgPSB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJQbGF5ZXJzIikKbG9jYWwgc3Vydml2b3JzRm9sZGVyID0gd29ya3NwYWNlUGxheWVyczpXYWl0Rm9yQ2hpbGQoIlN1cnZpdm9ycyIpCgpsb2NhbCBkYW5nZXJvdXNBbmltYXRpb25zID0gewogICAgWyIxMzE0MzA0OTc4MjExOTgiXSA9IHRydWUsCiAgICBbIjEwMDU5MjkxMzAzMDM1MSJdID0gdHJ1ZSwKICAgIFsiNzA0NDc2MzQ4NjI5MTEiXSAgPSB0cnVlLAogICAgWyI4MzY4NTMwNTU1MzM2NCJdID0gdHJ1ZQp9Cgpsb2NhbCBraWxsZXJNb2RlbHMgPSB7WyIxeDF4MXgxIl0gPSB0cnVlfQoKLS0g4pqhIFN0YXRlCmxvY2FsIGF1dG9Sb3RhdGVEaXNhYmxlZEJ5U2NyaXB0ID0gZmFsc2UKbG9jYWwgY3VycmVudFRhcmdldCwgaXNMb2NrZWRPbiwgd2FzUGxheWluZ0FuaW1hdGlvbiA9IG5pbCwgZmFsc2UsIGZhbHNlCgotLSDwn6epIFV0aWxzCmxvY2FsIGZ1bmN0aW9uIGlzS2lsbGVyKCkKICAgIGxvY2FsIGNoYXIgPSBsb2NhbFBsYXllci5DaGFyYWN0ZXIKICAg" ..
    "IHJldHVybiBjaGFyIGFuZCBraWxsZXJNb2RlbHNbY2hhci5OYW1lXSBvciBmYWxzZQplbmQKCmxvY2FsIGZ1bmN0aW9uIGdldE15SHVtYW5vaWQoKQogICAgbG9jYWwgY2hhciA9IGxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgcmV0dXJuIGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQiKQplbmQKCmxvY2FsIGZ1bmN0aW9uIHJlc3RvcmVBdXRvUm90YXRlKCkKICAgIGxvY2FsIGh1bSA9IGdldE15SHVtYW5vaWQoKQogICAgaWYgaHVtIGFuZCBhdXRvUm90YXRlRGlzYWJsZWRCeVNjcmlwdCB0aGVuCiAgICAgICAgaHVtLkF1dG9Sb3RhdGUgPSB0cnVlCiAgICAgICAgYXV0b1JvdGF0ZURpc2FibGVkQnlTY3JpcHQgPSBmYWxzZQogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gaXNQbGF5aW5nRGFuZ2Vyb3VzQW5pbWF0aW9uKCkKICAgIGxvY2FsIGh1bWFub2lkID0gZ2V0TXlIdW1hbm9pZCgpCiAgICBpZiBub3QgaHVtYW5vaWQgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICBsb2NhbCBhbmltYXRvciA9IGh1bWFub2lkOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQW5pbWF0b3IiKQogICAgaWYgbm90IGFuaW1hdG9yIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKICAgIGZvciBfLCB0cmFjayBpbiBpcGFpcnMoYW5pbWF0b3I6R2V0UGxheWluZ0FuaW1hdGlvblRyYWNrcygpKSBkbwogICAgICAgIGxvY2FsIGFuaW1JZCA9IHRvc3RyaW5nKHRyYWNrLkFuaW1hdGlvbi5BbmltYXRpb25JZCk6" ..
    "bWF0Y2goIiVkKyIpCiAgICAgICAgaWYgYW5pbUlkIGFuZCBkYW5nZXJvdXNBbmltYXRpb25zW2FuaW1JZF0gdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKZW5kCgotLSDwn6etIFTDrG0gc3Vydml2b3IgZ+G6p24gbmjhuqV0IHRyb25nIGZvbGRlciAiU3Vydml2b3JzIgpsb2NhbCBmdW5jdGlvbiBnZXRDbG9zZXN0U3Vydml2b3IoKQogICAgbG9jYWwgbXlIdW1hbm9pZCA9IGdldE15SHVtYW5vaWQoKQogICAgaWYgbm90IG15SHVtYW5vaWQgdGhlbiByZXR1cm4gbmlsIGVuZAogICAgbG9jYWwgbXlSb290ID0gbXlIdW1hbm9pZC5QYXJlbnQgYW5kIG15SHVtYW5vaWQuUGFyZW50OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGlmIG5vdCBteVJvb3QgdGhlbiByZXR1cm4gbmlsIGVuZAoKICAgIGxvY2FsIGNsb3Nlc3QsIGNsb3Nlc3REaXN0ID0gbmlsLCBtYXRoLmh1Z2UKCiAgICBmb3IgXywgb2JqIGluIGlwYWlycyhzdXJ2aXZvcnNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBvYmo6SXNBKCJNb2RlbCIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgaHJwID0gb2JqOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgbG9jYWwgaHVtID0gb2JqOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkh1bWFub2lkIikKICAgICAgICAgICAgaWYgaHJwIGFuZCBodW0gYW5kIGh1bS5IZWFs" ..
    "dGggPiAwIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAoaHJwLlBvc2l0aW9uIC0gbXlSb290LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgIGlmIGRpc3QgPCBjbG9zZXN0RGlzdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdCA9IG9iagogICAgICAgICAgICAgICAgICAgIGNsb3Nlc3REaXN0ID0gZGlzdAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gY2xvc2VzdAplbmQKCi0tIPCfjIAgUmVzZXQga2hpIHJlc3Bhd24KbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICB0YXNrLmRlbGF5KDAuMSwgZnVuY3Rpb24oKQogICAgICAgIGF1dG9Sb3RhdGVEaXNhYmxlZEJ5U2NyaXB0ID0gZmFsc2UKICAgIGVuZCkKZW5kKQoKLS0g8J+UgSBNYWluIGxvb3AKUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgaWYgbm90IHRvZ2dsZUZsYWcuVmFsdWUgdGhlbgogICAgICAgIHJlc3RvcmVBdXRvUm90YXRlKCkKICAgICAgICBjdXJyZW50VGFyZ2V0LCBpc0xvY2tlZE9uLCB3YXNQbGF5aW5nQW5pbWF0aW9uID0gbmlsLCBmYWxzZSwgZmFsc2UKICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGlmIG5vdCBpc0tpbGxlcigpIHRoZW4KICAgICAgICByZXN0b3JlQXV0b1JvdGF0ZSgpCiAgICAgICAgY3VycmVudFRhcmdldCwgaXNMb2NrZWRP" ..
    "biwgd2FzUGxheWluZ0FuaW1hdGlvbiA9IG5pbCwgZmFsc2UsIGZhbHNlCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBteUh1bWFub2lkID0gZ2V0TXlIdW1hbm9pZCgpCiAgICBpZiBub3QgbXlIdW1hbm9pZCB0aGVuIHJldHVybiBlbmQKICAgIGxvY2FsIG15Um9vdCA9IG15SHVtYW5vaWQuUGFyZW50IGFuZCBteUh1bWFub2lkLlBhcmVudDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBub3QgbXlSb290IHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIGlzUGxheWluZyA9IGlzUGxheWluZ0Rhbmdlcm91c0FuaW1hdGlvbigpCgogICAgLS0gTG9jayB0YXJnZXQgMSBs4bqnbiBraGkgYuG6r3QgxJHhuqd1IGFuaW1hdGlvbgogICAgaWYgaXNQbGF5aW5nIGFuZCBub3QgaXNMb2NrZWRPbiB0aGVuCiAgICAgICAgY3VycmVudFRhcmdldCA9IGdldENsb3Nlc3RTdXJ2aXZvcigpCiAgICAgICAgaWYgY3VycmVudFRhcmdldCB0aGVuIGlzTG9ja2VkT24gPSB0cnVlIGVuZAogICAgZW5kCgogICAgLS0gVmFsaWRhdGUgdGFyZ2V0CiAgICBpZiBpc0xvY2tlZE9uIGFuZCBjdXJyZW50VGFyZ2V0IHRoZW4KICAgICAgICBsb2NhbCB0SHVtID0gY3VycmVudFRhcmdldDpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJIdW1hbm9pZCIpCiAgICAgICAgbG9jYWwgdEhycCA9IGN1cnJlbnRUYXJnZXQ6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGlmIChub3QgdEh1" ..
    "bSkgb3IgKHRIdW0gYW5kIHRIdW0uSGVhbHRoIDw9IDApIG9yIChub3QgdEhycCkgdGhlbgogICAgICAgICAgICBjdXJyZW50VGFyZ2V0LCBpc0xvY2tlZE9uID0gbmlsLCBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gRW5kIGFuaW1hdGlvbgogICAgaWYgKG5vdCBpc1BsYXlpbmcpIGFuZCB3YXNQbGF5aW5nQW5pbWF0aW9uIHRoZW4KICAgICAgICBjdXJyZW50VGFyZ2V0LCBpc0xvY2tlZE9uID0gbmlsLCBmYWxzZQogICAgICAgIHJlc3RvcmVBdXRvUm90YXRlKCkKICAgIGVuZAogICAgd2FzUGxheWluZ0FuaW1hdGlvbiA9IGlzUGxheWluZwoKICAgIC0tIPCfjq8gQWltIC8gVGVsZXBvcnQKICAgIGlmIGlzUGxheWluZyBhbmQgaXNMb2NrZWRPbiBhbmQgY3VycmVudFRhcmdldCBhbmQgY3VycmVudFRhcmdldDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBsb2NhbCBocnAgPSBjdXJyZW50VGFyZ2V0Lkh1bWFub2lkUm9vdFBhcnQKICAgICAgICBsb2NhbCB0YXJnZXRQb3MgPSBocnAuUG9zaXRpb24KCiAgICAgICAgaWYgbm90IGF1dG9Sb3RhdGVEaXNhYmxlZEJ5U2NyaXB0IHRoZW4KICAgICAgICAgICAgbXlIdW1hbm9pZC5BdXRvUm90YXRlID0gZmFsc2UKICAgICAgICAgICAgYXV0b1JvdGF0ZURpc2FibGVkQnlTY3JpcHQgPSB0cnVlCiAgICAgICAgZW5kCgogICAgICAgIC0tIFByZWRpY3QgbW92ZW1lbnQKICAgICAgICBpZiBwcmVkaWN0TW92ZW1lbnQgdGhl" ..
    "bgogICAgICAgICAgICBsb2NhbCB2ZWwgPSBocnAuVmVsb2NpdHkKICAgICAgICAgICAgaWYgdmVsLk1hZ25pdHVkZSA+IDIgdGhlbgogICAgICAgICAgICAgICAgdGFyZ2V0UG9zID0gdGFyZ2V0UG9zICsgaHJwLkNGcmFtZS5Mb29rVmVjdG9yICogMwogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgbG9va0F0ID0gVmVjdG9yMy5uZXcodGFyZ2V0UG9zLlgsIG15Um9vdC5Qb3NpdGlvbi5ZLCB0YXJnZXRQb3MuWikKCiAgICAgICAgaWYgYWltTW9kZSA9PSAiT25lIFBsYXllciIgdGhlbgogICAgICAgICAgICBteVJvb3QuQ0ZyYW1lID0gbXlSb290LkNGcmFtZTpMZXJwKENGcmFtZS5sb29rQXQobXlSb290LlBvc2l0aW9uLCBsb29rQXQpLCAwLjk5KQoKICAgICAgICBlbHNlaWYgYWltTW9kZSA9PSAiTXVsdGkgUGxheWVycyIgdGhlbgogICAgICAgICAgICBsb2NhbCBuZXdUYXJnZXQgPSBnZXRDbG9zZXN0U3Vydml2b3IoKQogICAgICAgICAgICBpZiBuZXdUYXJnZXQgdGhlbiBjdXJyZW50VGFyZ2V0ID0gbmV3VGFyZ2V0IGVuZAogICAgICAgICAgICBteVJvb3QuQ0ZyYW1lID0gbXlSb290LkNGcmFtZTpMZXJwKENGcmFtZS5sb29rQXQobXlSb290LlBvc2l0aW9uLCBsb29rQXQpLCAwLjk5KQoKICAgICAgICBlbHNlaWYgYWltTW9kZSA9PSAiVGVsZXBvcnQiIHRoZW4KICAgICAgICAgICAgbG9jYWwgYmVoaW5kUG9zID0gaHJwLlBvc2l0aW9uIC0gaHJwLkNGcmFtZS5Mb29rVmVjdG9yICog" ..
    "MwogICAgICAgICAgICBteVJvb3QuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhiZWhpbmRQb3MsIHRhcmdldFBvcykKICAgICAgICBlbmQKICAgIGVuZAplbmQpCmVuZAoKCi0tIFRhYnMuRXZlbnQKCiAgICBUYWJzLkV2ZW50OkFkZFNlY3Rpb24oIuKGsyBIYWxsb3dlZW4iKQoKCmRvCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKICAgIC0tIPCfk6YgTsO6dCBUZWxlcG9ydCByacOqbmcKICAgIFRhYnMuRXZlbnQ6QWRkQnV0dG9uKHsKICAgICAgICBUaXRsZSA9ICJUUCB0byBTaG9wIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICJUZWxlcG9ydCDEkeG6v24ga2h1IFNob3AiLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBjaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgICAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgaWYgaHJwIHRoZW4KICAgICAgICAgICAgICAgIGhycC5DRnJhbWUgPSBDRnJhbWUubmV3KC0zNTQwLjM2LCAtMzkyLjczLCAyMzEuNTMpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCwKICAgIH0pCmVuZAoKCmxvY2FsIFRlbGVwb3J0U2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVGVsZXBvcnRT" ..
    "ZXJ2aWNlIikKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCgpUYWJzLkV2ZW50OkFkZEJ1dHRvbih7CiAgICBUaXRsZSA9ICJHZXQgU2tpbiBTaXhlciIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIFRlbGVwb3J0U2VydmljZTpUZWxlcG9ydCgxMzk1OTQzMDAxMzgwNjksIFBsYXllcnMuTG9jYWxQbGF5ZXIpCiAgICAgICAgZW5kKQogICAgZW5kCn0pCgoKLS0g8J+SmSA4LiBTVUtLQVJTIC8gRVZFTlQgRVNQICh2My4yOiBjaOG6oW0gdmnhu4FuIHPhur0g4bqpbiBFU1ApCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgpsb2NhbCBhbGxvd2VkTW9kZWxzID0gewogICAgWyJkdW1zZWsiXSA9IHRydWUsCiAgICBbInRvb24gZHVzZWsiXSA9IHRydWUsCiAgICBbImR1c2VrIl0gPSB0cnVlLAogICAgWyJ1bWR1bSJdID0gdHJ1ZSwKICAgIFsiZG9vdGhzZWsiXSA9IHRydWUsCn0KCmxvY2FsIGJsb2NrZWRDZW50ZXIgPSBWZWN0b3IzLm5ldygtMzQ4NS4wMiwgNC40OCwgMjE3Ljc3KQpsb2NhbCBibG9ja2VkUmFkaXVzID0gNTAwCgpfRy5FU1BN" ..
    "YW5hZ2VyOlJlZ2lzdGVyVHlwZSgiU3Vra2FycyIsIENvbG9yMy5mcm9tUkdCKDAsIDg1LCAyNTUpLCBmdW5jdGlvbihvYmopCiAgICBpZiBub3Qgb2JqOklzQSgiTW9kZWwiKSB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIGlmIG5vdCBhbGxvd2VkTW9kZWxzW3N0cmluZy5sb3dlcihvYmouTmFtZSldIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKICAgIGxvY2FsIHBhcnQgPSBvYmo6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBvciBvYmo6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiQmFzZVBhcnQiKQogICAgaWYgbm90IHBhcnQgdGhlbiByZXR1cm4gZmFsc2UgZW5kCgogICAgbG9jYWwgZGlzdCA9IChwYXJ0LlBvc2l0aW9uIC0gYmxvY2tlZENlbnRlcikuTWFnbml0dWRlCiAgICBpZiBkaXN0IDw9IGJsb2NrZWRSYWRpdXMgdGhlbiByZXR1cm4gZmFsc2UgZW5kCgogICAgcmV0dXJuIHRydWUKZW5kLCBmYWxzZSkKCi0tIOKaoSBH4bqvbiAuVG91Y2hlZCAxIGzhuqduIGR1eSBuaOG6pXQKbG9jYWwgb2xkQ3JlYXRlID0gX0cuRVNQTWFuYWdlci5DcmVhdGUKX0cuRVNQTWFuYWdlci5DcmVhdGUgPSBmdW5jdGlvbihzZWxmLCBtb2RlbCwgdHlwZU5hbWUpCiAgICBvbGRDcmVhdGUoc2VsZiwgbW9kZWwsIHR5cGVOYW1lKQoKICAgIGlmIHR5cGVOYW1lID09ICJTdWtrYXJzIiB0aGVuCiAgICAgICAgbG9jYWwgaHJwID0gbW9kZWw6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBvciBtb2RlbDpG" ..
    "aW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJCYXNlUGFydCIpCiAgICAgICAgaWYgaHJwIGFuZCBub3QgaHJwOkZpbmRGaXJzdENoaWxkKCJfVG91Y2hlZEZsYWciKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGZsYWcgPSBJbnN0YW5jZS5uZXcoIkJvb2xWYWx1ZSIpCiAgICAgICAgICAgIGZsYWcuTmFtZSA9ICJfVG91Y2hlZEZsYWciCiAgICAgICAgICAgIGZsYWcuUGFyZW50ID0gaHJwCgogICAgICAgICAgICBocnAuVG91Y2hlZDpDb25uZWN0KGZ1bmN0aW9uKGhpdCkKICAgICAgICAgICAgICAgIGxvY2FsIGNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGlmIGNoYXIgYW5kIGhpdDpJc0Rlc2NlbmRhbnRPZihjaGFyKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgX0cuRVNQTWFuYWdlcjpSZW1vdmUobW9kZWwpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKLS0g8J+SqyDhuqhuIEVTUCBraGkg4oCcY2jhuqFtIHZp4buBbuKAnSAoY+G7sSBseSBj4buxYyBn4bqnbikKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0YXNrLndhaXQoMC4xNSkgZG8KICAgICAgICBsb2NhbCBjaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgbG9jYWwgaHJwID0gY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaWYgbm90IGhycCB0aGVuIGNvbnRpbnVlIGVuZAoKICAg" ..
    "ICAgICBmb3IgbW9kZWwsIGRhdGEgaW4gcGFpcnMoX0cuRVNQTWFuYWdlci5PYmplY3RzKSBkbwogICAgICAgICAgICBpZiBkYXRhLnR5cGUgPT0gIlN1a2thcnMiIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHBhcnQgPSBtb2RlbDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIG9yIG1vZGVsOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJhc2VQYXJ0IikKICAgICAgICAgICAgICAgIGlmIHBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAoaHJwLlBvc2l0aW9uIC0gcGFydC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICAgICAgaWYgZGlzdCA8PSA1IHRoZW4gLS0g8J+RiCBraG/huqNuZyBjw6FjaCDigJxjaOG6oW0gdmnhu4Fu4oCdCiAgICAgICAgICAgICAgICAgICAgICAgIF9HLkVTUE1hbmFnZXI6UmVtb3ZlKG1vZGVsKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBkaXN0ID4gMTIwMCB0aGVuIC0tIHhhIHF1w6EgdGjDrCBk4buNbiBFU1AKICAgICAgICAgICAgICAgICAgICAgICAgX0cuRVNQTWFuYWdlcjpSZW1vdmUobW9kZWwpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgX0cuRVNQTWFuYWdlcjpSZW1vdmUobW9kZWwpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKVGFicy5FdmVudDpBZGRUb2dnbGUoIkVT" ..
    "UFN1a2thcnNUb2dnbGUiLCB7CiAgICBUaXRsZSA9ICJFU1AgU3Vra2FycyIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgIF9HLkVTUE1hbmFnZXI6U2V0RW5hYmxlZCgiU3Vra2FycyIsIHN0YXRlKQplbmQpCgoKCi0tIPCfp60gRGFuaCBzw6FjaCBtb2RlbCBj4bqnbiB0ZWxlcG9ydCB04bubaQpsb2NhbCBUYXJnZXROYW1lcyA9IHsKICAgICJkdW1zZWsiLAogICAgInRvb24gZHVzZWsiLAogICAgInVtZHVtIiwKICAgICJkdXNlayIsCiAgICAiZG9vdGhzZWsiLAp9CgotLSDimpnvuI8gQ8OgaSDEkeG6t3QKbG9jYWwgU2NhbkludGVydmFsID0gMC41CmxvY2FsIFRlbGVwb3J0RGVsYXkgPSAwLjI1CmxvY2FsIEhlaWdodFNhZmUgPSA1CmxvY2FsIElnbm9yZUNlbnRlciA9IFZlY3RvcjMubmV3KC0zNDg1LjAyLCA0LjQ4LCAyMTcuNzcpCmxvY2FsIElnbm9yZVJhZGl1cyA9IDUwMAoKLS0g4pqhIEJp4bq/biDEkWnhu4F1IGtoaeG7g24KbG9jYWwgYXV0b1RlbGVwb3J0ID0gZmFsc2UKbG9jYWwgdmlzaXRlZE1vZGVscyA9IHt9CmxvY2FsIGN1cnJlbnRUYXJnZXQgPSBuaWwKCi0tID09PSBTRVJWSUNFUyA9PT0KbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKLS0gPT09IEjDgE0gSOG7liBUUuG7oiA9PT0KbG9jYWwgZnVuY3Rpb24gZ2V0SHVtYW5vaWQoKQoJbG9jYWwg" ..
    "Y2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBvciBMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKCXJldHVybiBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSwgY2hhcgplbmQKCmxvY2FsIGZ1bmN0aW9uIGdldE1vZGVsQ0ZyYW1lKG1vZGVsKQoJaWYgbm90IG1vZGVsIG9yIG5vdCBtb2RlbDpJc0Rlc2NlbmRhbnRPZih3b3Jrc3BhY2UpIHRoZW4gcmV0dXJuIGVuZAoJbG9jYWwgcGFydCA9IG1vZGVsOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0Iikgb3IgbW9kZWwuUHJpbWFyeVBhcnQgb3IgbW9kZWw6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiQmFzZVBhcnQiKQoJaWYgcGFydCB0aGVuCgkJcmV0dXJuIHBhcnQuQ0ZyYW1lCgllbHNlaWYgbW9kZWwuR2V0UGl2b3QgdGhlbgoJCWxvY2FsIG9rLCBwaXZvdCA9IHBjYWxsKGZ1bmN0aW9uKCkKCQkJcmV0dXJuIG1vZGVsOkdldFBpdm90KCkKCQllbmQpCgkJaWYgb2sgdGhlbiByZXR1cm4gcGl2b3QgZW5kCgllbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBpc1ZhbGlkTW9kZWwobW9kZWwpCglpZiBub3QgbW9kZWwgb3Igbm90IG1vZGVsOklzRGVzY2VuZGFudE9mKHdvcmtzcGFjZSkgdGhlbgoJCXJldHVybiBmYWxzZQoJZW5kCglmb3IgXywgbmFtZSBpbiBpcGFpcnMoVGFyZ2V0TmFtZXMpIGRvCgkJaWYgbW9kZWwuTmFtZTpsb3dlcigpID09IG5hbWU6bG93ZXIoKSB0aGVuCgkJCWxvY2FsIGNmID0gZ2V0TW9kZWxDRnJhbWUo" ..
    "bW9kZWwpCgkJCWlmIGNmIHRoZW4KCQkJCWxvY2FsIHBvcyA9IGNmLlBvc2l0aW9uCgkJCQlpZiAocG9zIC0gSWdub3JlQ2VudGVyKS5NYWduaXR1ZGUgPiBJZ25vcmVSYWRpdXMgdGhlbgoJCQkJCXJldHVybiB0cnVlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgllbmQKCXJldHVybiBmYWxzZQplbmQKCi0tID09PSBUw4xNIEPDgUMgTU9ERUwgSOG7olAgTOG7hiA9PT0KbG9jYWwgZnVuY3Rpb24gZmluZFRhcmdldHMoKQoJbG9jYWwgbGlzdCA9IHt9Cglmb3IgXywgb2JqIGluIGlwYWlycyh3b3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KCQlpZiBvYmo6SXNBKCJNb2RlbCIpIGFuZCBpc1ZhbGlkTW9kZWwob2JqKSB0aGVuCgkJCXRhYmxlLmluc2VydChsaXN0LCBvYmopCgkJZW5kCgllbmQKCXJldHVybiBsaXN0CmVuZAoKLS0gPT09IEtJ4buCTSBUUkEgTkjDgk4gVuG6rFQgxJBBTkcgQ0jhuqBNIE1PREVMIEhJ4buGTiBU4bqgSSA9PT0KbG9jYWwgZnVuY3Rpb24gaXNUb3VjaGluZ1RhcmdldCh0YXJnZXQpCglpZiBub3QgdGFyZ2V0IG9yIG5vdCB0YXJnZXQ6SXNEZXNjZW5kYW50T2Yod29ya3NwYWNlKSB0aGVuCgkJcmV0dXJuIGZhbHNlCgllbmQKCWxvY2FsIGNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKCWlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKCWxvY2FsIGhycCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoJaWYgbm90IGhycCB0aGVuIHJldHVybiBmYWxz" ..
    "ZSBlbmQKCglsb2NhbCB0YXJnZXRQYXJ0ID0gdGFyZ2V0OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0Iikgb3IgdGFyZ2V0LlByaW1hcnlQYXJ0IG9yIHRhcmdldDpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJCYXNlUGFydCIpCglpZiBub3QgdGFyZ2V0UGFydCB0aGVuIHJldHVybiBmYWxzZSBlbmQKCglsb2NhbCBkaXN0ID0gKGhycC5Qb3NpdGlvbiAtIHRhcmdldFBhcnQuUG9zaXRpb24pLk1hZ25pdHVkZQoJcmV0dXJuIGRpc3QgPD0gNgplbmQKCi0tID09PSBURUxFUE9SVCBTQU5HIE1PREVMIFRJ4bq+UCBUSEVPID09PQpsb2NhbCBmdW5jdGlvbiB0ZWxlcG9ydFRvTmV4dCgpCglsb2NhbCBodW1hbm9pZCwgY2hhciA9IGdldEh1bWFub2lkKCkKCWxvY2FsIGhycCA9IGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoJaWYgbm90IGhycCB0aGVuIHJldHVybiBlbmQKCgktLSBE4buNbiBk4bq5cCBtb2RlbCDEkcOjIGJp4bq/biBt4bqldCBraOG7j2kgZGFuaCBzw6FjaAoJZm9yIG0gaW4gcGFpcnModmlzaXRlZE1vZGVscykgZG8KCQlpZiBub3QgbTpJc0Rlc2NlbmRhbnRPZih3b3Jrc3BhY2UpIHRoZW4KCQkJdmlzaXRlZE1vZGVsc1ttXSA9IG5pbAoJCWVuZAoJZW5kCgoJLS0gTOG6pXkgZGFuaCBzw6FjaCBo4bujcCBs4buHCglsb2NhbCBhbGxUYXJnZXRzID0gZmluZFRhcmdldHMoKQoJbG9jYWwgYXZhaWxhYmxlID0ge30KCWZvciBfLCBtIGluIGlwYWlycyhhbGxU" ..
    "YXJnZXRzKSBkbwoJCWlmIG5vdCB2aXNpdGVkTW9kZWxzW21dIGFuZCBtOklzRGVzY2VuZGFudE9mKHdvcmtzcGFjZSkgdGhlbgoJCQl0YWJsZS5pbnNlcnQoYXZhaWxhYmxlLCBtKQoJCWVuZAoJZW5kCgoJLS0gTuG6v3UgaOG6v3QgbeG7pWMgdGnDqnUgdGjDrCByZXNldCB2aXNpdGVkIMSR4buDIHF1w6l0IGzhuqFpCglpZiAjYXZhaWxhYmxlID09IDAgdGhlbgoJCXRhYmxlLmNsZWFyKHZpc2l0ZWRNb2RlbHMpCgkJcmV0dXJuCgllbmQKCgktLSBDaOG7jW4gbW9kZWwgZ+G6p24gbmjhuqV0Cgl0YWJsZS5zb3J0KGF2YWlsYWJsZSwgZnVuY3Rpb24oYSwgYikKCQlsb2NhbCBwYSA9IGdldE1vZGVsQ0ZyYW1lKGEpLlBvc2l0aW9uCgkJbG9jYWwgcGIgPSBnZXRNb2RlbENGcmFtZShiKS5Qb3NpdGlvbgoJCXJldHVybiAoaHJwLlBvc2l0aW9uIC0gcGEpLk1hZ25pdHVkZSA8IChocnAuUG9zaXRpb24gLSBwYikuTWFnbml0dWRlCgllbmQpCgoJbG9jYWwgbmV4dFRhcmdldCA9IGF2YWlsYWJsZVsxXQoJaWYgbmV4dFRhcmdldCB0aGVuCgkJbG9jYWwgY2YgPSBnZXRNb2RlbENGcmFtZShuZXh0VGFyZ2V0KQoJCWlmIGNmIHRoZW4KCQkJbG9jYWwgcG9zID0gY2YuUG9zaXRpb24KCQkJaWYgcG9zLlkgPCAtMTAgdGhlbgoJCQkJcG9zID0gVmVjdG9yMy5uZXcocG9zLlgsIEhlaWdodFNhZmUsIHBvcy5aKQoJCQllbmQKCQkJaHJwLkNGcmFtZSA9IENGcmFtZS5uZXcocG9zICsgVmVjdG9yMy5uZXcoMCwgMywgMCkpCgkJCWN1cnJl" ..
    "bnRUYXJnZXQgPSBuZXh0VGFyZ2V0CgkJZW5kCgllbmQKZW5kCgotLSA9PT0gVsOSTkcgQ0jDjU5IID09PQp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKCXdoaWxlIHRhc2sud2FpdChTY2FuSW50ZXJ2YWwpIGRvCgkJaWYgYXV0b1RlbGVwb3J0IGFuZCBMb2NhbFBsYXllci5DaGFyYWN0ZXIgdGhlbgoJCQktLSBu4bq/dSB0YXJnZXQgaGnhu4duIHThuqFpIGJp4bq/biBt4bqldCwgYuG7jyBxdWEgdsOgIGNodXnhu4NuIG1vZGVsIGtow6FjCgkJCWlmIGN1cnJlbnRUYXJnZXQgYW5kIG5vdCBjdXJyZW50VGFyZ2V0OklzRGVzY2VuZGFudE9mKHdvcmtzcGFjZSkgdGhlbgoJCQkJY3VycmVudFRhcmdldCA9IG5pbAoJCQkJdGFzay53YWl0KFRlbGVwb3J0RGVsYXkpCgkJCQl0ZWxlcG9ydFRvTmV4dCgpCgkJCWVsc2VpZiBjdXJyZW50VGFyZ2V0IGFuZCBpc1RvdWNoaW5nVGFyZ2V0KGN1cnJlbnRUYXJnZXQpIHRoZW4KCQkJCXZpc2l0ZWRNb2RlbHNbY3VycmVudFRhcmdldF0gPSB0cnVlCgkJCQl0YXNrLndhaXQoVGVsZXBvcnREZWxheSkKCQkJCXRlbGVwb3J0VG9OZXh0KCkKCQkJZWxzZWlmIG5vdCBjdXJyZW50VGFyZ2V0IHRoZW4KCQkJCXRlbGVwb3J0VG9OZXh0KCkKCQkJZW5kCgkJZW5kCgllbmQKZW5kKQoKLS0gPT09IFRPR0dMRSBHVUkgPT09ClRhYnMuRXZlbnQ6QWRkVG9nZ2xlKCJBdXRvRmFybVN1a2thcnMiLCB7CglUaXRsZSA9ICJBdXRvIEZhcm0gU3Vra2FycyIsCglEZWZhdWx0ID0gZmFsc2UsCglDYWxsYmFjayA9" ..
    "IGZ1bmN0aW9uKHN0YXRlKQoJCWF1dG9UZWxlcG9ydCA9IHN0YXRlCgkJaWYgbm90IHN0YXRlIHRoZW4KCQkJY3VycmVudFRhcmdldCA9IG5pbAoJCQl0YWJsZS5jbGVhcih2aXNpdGVkTW9kZWxzKQoJCWVuZAoJZW5kLAp9KQoKCi0tIFRhYnMuQ3VzdG9tCgotLS8vIPCfjIwgSOG7hyBUaOG7kW5nIFR1IFRpw6puIChGbHVlbnQgVUkgUGFyYWdyYXBoIHYzKQotLSBN4buXaSBj4bqlcCAzaCwgOSB04bqnbmcgKE5o4bqldCDihpIgQ+G7rXUgR2lhaSksIGPDsyB0aeG6v24gdHLDrG5oIMSQ4buZdCBQaMOhICUKCmxvY2FsIEh0dHBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJIdHRwU2VydmljZSIpCmxvY2FsIFNhdmVGaWxlID0gIlR1VGllbkRhdGEuanNvbiIKCi0tIERhbmggc8OhY2ggY+G6o25oIGdp4bubaSAobeG7l2kgY+G6pXAgPSAzaCA9IDEwODAwcykKLS0gUGjDoG0gTmjDom4ga2jDtG5nIGPDsyB04bqnbmcKbG9jYWwgTGV2ZWxzID0gewogICAge25hbWUgPSAiUGjDoG0gTmjDom4iLCB0aW1lID0gMCwgaGFzU3RhZ2UgPSBmYWxzZX0sCiAgICB7bmFtZSA9ICJL4bq/dCDEkGFuIiwgdGltZSA9IDEwODAwLCBoYXNTdGFnZSA9IHRydWV9LAogICAge25hbWUgPSAiTHV54buHbiBLaMOtIiwgdGltZSA9IDIxNjAwLCBoYXNTdGFnZSA9IHRydWV9LAogICAge25hbWUgPSAiVHLDumMgQ8ahIiwgdGltZSA9IDMyNDAwLCBoYXNTdGFnZSA9IHRydWV9LAogICAge25hbWUgPSAiS2ltIMSQYW4iLCB0aW1lID0gNDMyMDAs" ..
    "IGhhc1N0YWdlID0gdHJ1ZX0sCiAgICB7bmFtZSA9ICJOZ3V5w6puIEFuaCIsIHRpbWUgPSA1NDAwMCwgaGFzU3RhZ2UgPSB0cnVlfSwKICAgIHtuYW1lID0gIkjDs2EgVGjhuqduIiwgdGltZSA9IDY0ODAwLCBoYXNTdGFnZSA9IHRydWV9LAogICAge25hbWUgPSAiTHV54buHbiBIxrAiLCB0aW1lID0gNzU2MDAsIGhhc1N0YWdlID0gdHJ1ZX0sCiAgICB7bmFtZSA9ICJI4bujcCBUaOG7gyIsIHRpbWUgPSA4NjQwMCwgaGFzU3RhZ2UgPSB0cnVlfSwKICAgIHtuYW1lID0gIsSQ4bqhaSBUaOG7q2EiLCB0aW1lID0gOTcyMDAsIGhhc1N0YWdlID0gdHJ1ZX0sCiAgICB7bmFtZSA9ICLEkOG7mSBLaeG6v3AiLCB0aW1lID0gMTA4MDAwLCBoYXNTdGFnZSA9IHRydWV9LAogICAge25hbWUgPSAiVGjDoW5oIEPhuqNuaCIsIHRpbWUgPSAxMTg4MDAsIGhhc1N0YWdlID0gdHJ1ZX0sCiAgICB7bmFtZSA9ICJUaMOhbmggVsawxqFuZyIsIHRpbWUgPSAxMjk2MDAsIGhhc1N0YWdlID0gdHJ1ZX0sCiAgICB7bmFtZSA9ICJDaMOtIFTDtG4iLCB0aW1lID0gMTQwNDAwLCBoYXNTdGFnZSA9IHRydWV9LAogICAge25hbWUgPSAiQ2h14bqpbiDEkOG6vyIsIHRpbWUgPSAxNTEyMDAsIGhhc1N0YWdlID0gdHJ1ZX0sCiAgICB7bmFtZSA9ICLEkOG6oWkgxJDhur8iLCB0aW1lID0gMTYyMDAwLCBoYXNTdGFnZSA9IHRydWV9LAp9CgotLSBDw6FjIHThuqduZyAobeG7l2kgdOG6p25nID0gMjAgcGjDunQgPSAxMjAwcykKbG9jYWwgU3RhZ2VzID0g" ..
    "ewogICAgIk5o4bqldCBHaWFpIiwKICAgICJOaOG7iyBHaWFpIiwKICAgICJUYW0gR2lhaSIsCiAgICAiVOG7qSBHaWFpIiwKICAgICJOZ8WpIEdpYWkiLAogICAgIkzhu6VjIEdpYWkiLAogICAgIlRo4bqldCBHaWFpIiwKICAgICJCw6F0IEdpYWkiLAogICAgIkPhu611IEdpYWkiCn0KCi0tIMSQ4buNYyBk4buvIGxp4buHdQpsb2NhbCBmdW5jdGlvbiBMb2FkRGF0YSgpCiAgICBpZiBpc2ZpbGUgYW5kIGlzZmlsZShTYXZlRmlsZSkgdGhlbgogICAgICAgIGxvY2FsIHN1Y2Nlc3MsIGRlY29kZWQgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIHJldHVybiBIdHRwU2VydmljZTpKU09ORGVjb2RlKHJlYWRmaWxlKFNhdmVGaWxlKSkKICAgICAgICBlbmQpCiAgICAgICAgaWYgc3VjY2VzcyBhbmQgZGVjb2RlZCB0aGVuIHJldHVybiBkZWNvZGVkIGVuZAogICAgZW5kCiAgICByZXR1cm4ge3RvdGFsVGltZSA9IDB9CmVuZAoKLS0gTMawdSBk4buvIGxp4buHdQpsb2NhbCBmdW5jdGlvbiBTYXZlRGF0YShkYXRhKQogICAgaWYgd3JpdGVmaWxlIHRoZW4KICAgICAgICB3cml0ZWZpbGUoU2F2ZUZpbGUsIEh0dHBTZXJ2aWNlOkpTT05FbmNvZGUoZGF0YSkpCiAgICBlbmQKZW5kCgotLSBUw61uaCBUdSBWaSwgVOG6p25nLCBMaW5oIEtow60gJSwgxJDhu5l0IFBow6EgJQpsb2NhbCBmdW5jdGlvbiBHZXRQcm9ncmVzcyh0b3RhbFRpbWUpCiAgICBmb3IgaSA9ICNMZXZlbHMsIDEsIC0xIGRvCiAgICAgICAgaWYgdG90YWxU" ..
    "aW1lID49IExldmVsc1tpXS50aW1lIHRoZW4KICAgICAgICAgICAgbG9jYWwgY3VycmVudCA9IExldmVsc1tpXQogICAgICAgICAgICBsb2NhbCBuZXh0TGV2ZWwgPSBMZXZlbHNbaSArIDFdCgogICAgICAgICAgICBpZiBub3QgbmV4dExldmVsIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50Lm5hbWUsIChjdXJyZW50Lmhhc1N0YWdlIGFuZCAiQ+G7rXUgR2lhaSIgb3IgbmlsKSwgMSwgMQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxvY2FsIGxldmVsRHVyYXRpb24gPSAxMDgwMCAtLSAzaAogICAgICAgICAgICBsb2NhbCBlbGFwc2VkSW5MZXZlbCA9IHRvdGFsVGltZSAtIGN1cnJlbnQudGltZQogICAgICAgICAgICBsb2NhbCBwZXJjZW50ID0gbWF0aC5jbGFtcChlbGFwc2VkSW5MZXZlbCAvIGxldmVsRHVyYXRpb24sIDAsIDEpCgogICAgICAgICAgICBsb2NhbCBzdGFnZU5hbWUsIGJyZWFrdGhyb3VnaFBlcmNlbnQKICAgICAgICAgICAgaWYgY3VycmVudC5oYXNTdGFnZSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBlbGFwc2VkSW5TdGFnZSA9IGVsYXBzZWRJbkxldmVsICUgMTIwMAogICAgICAgICAgICAgICAgbG9jYWwgc3RhZ2VJbmRleCA9IG1hdGguY2xhbXAobWF0aC5mbG9vcihlbGFwc2VkSW5MZXZlbCAvIDEyMDApICsgMSwgMSwgI1N0YWdlcykKICAgICAgICAgICAgICAgIHN0YWdlTmFtZSA9IFN0YWdlc1tzdGFnZUluZGV4XQogICAgICAgICAgICAgICAgYnJlYWt0aHJvdWdo" ..
    "UGVyY2VudCA9IG1hdGguY2xhbXAoZWxhcHNlZEluU3RhZ2UgLyAxMjAwLCAwLCAxKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBicmVha3Rocm91Z2hQZXJjZW50ID0gMAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHJldHVybiBjdXJyZW50Lm5hbWUsIHN0YWdlTmFtZSwgcGVyY2VudCwgYnJlYWt0aHJvdWdoUGVyY2VudAogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gIlBow6BtIE5ow6JuIiwgbmlsLCAwLCAwCmVuZAoKLS0gROG7ryBsaeG7h3UgaGnhu4duIHThuqFpCmxvY2FsIERhdGEgPSBMb2FkRGF0YSgpCgotLSBVSSBoaeG7g24gdGjhu4sKbG9jYWwgUGFyYWdyYXBoID0gVGFicy5DdXN0b206QWRkUGFyYWdyYXBoKHsKICAgIFRpdGxlID0gIlRow7RuZyBUaW4iLAogICAgQ29udGVudCA9ICLEkGFuZyBraOG7n2kgxJHhu5luZy4uLiIKfSkKCi0tIFbDsm5nIGPhuq1wIG5o4bqtdAp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRhc2sud2FpdCgxKSBkbwogICAgICAgIERhdGEudG90YWxUaW1lICs9IDEKICAgICAgICBsb2NhbCBsZXZlbCwgc3RhZ2UsIHBlcmNlbnQsIGJyZWFrUCA9IEdldFByb2dyZXNzKERhdGEudG90YWxUaW1lKQoKICAgICAgICBsb2NhbCBjb250ZW50ID0gc3RyaW5nLmZvcm1hdCgiVHUgVmk6ICVzXG4iLCBsZXZlbCkKICAgICAgICBpZiBzdGFnZSB0aGVuCiAgICAgICAgICAgIGNvbnRlbnQgLi49IHN0cmluZy5mb3JtYXQoIlThuqduZzogJXNc" ..
    "biIsIHN0YWdlKQogICAgICAgIGVuZAogICAgICAgIGNvbnRlbnQgLi49IHN0cmluZy5mb3JtYXQoIkxpbmggS2jDrTogJS4xZiUlXG4iLCBwZXJjZW50ICogMTAwKQoKICAgICAgICAtLSBO4bq/dSBjw7MgdOG6p25nIHRow6wgaGnhu4duIHRow6ptIMSQ4buZdCBQaMOhICUKICAgICAgICBpZiBzdGFnZSB0aGVuCiAgICAgICAgICAgIGNvbnRlbnQgLi49IHN0cmluZy5mb3JtYXQoIsSQ4buZdCBQaMOhOiAlLjFmJSUiLCBicmVha1AgKiAxMDApCiAgICAgICAgZW5kCgogICAgICAgIFBhcmFncmFwaDpTZXREZXNjKGNvbnRlbnQpCgogICAgICAgIC0tIEzGsHUgxJHhu4tuaCBr4buzCiAgICAgICAgaWYgRGF0YS50b3RhbFRpbWUgJSAxMCA9PSAwIHRoZW4KICAgICAgICAgICAgU2F2ZURhdGEoRGF0YSkKICAgICAgICBlbmQKCiAgICAgICAgLS0gS2hpIMSR4bqhdCDEkOG6oWkgxJDhur8gZnVsbAogICAgICAgIGlmIGxldmVsID09ICLEkOG6oWkgxJDhur8iIGFuZCBwZXJjZW50ID49IDEgdGhlbgogICAgICAgICAgICBQYXJhZ3JhcGg6U2V0RGVzYygiVHUgVmk6IMSQ4bqhaSDEkOG6v1xuVOG6p25nOiBD4butdSBHaWFpXG5MaW5oIEtow606IDEwMCVcbsSQ4buZdCBQaMOhOiAxMDAlIikKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgoKICAgIFRhYnMuQ3VzdG9tOkFkZFNlY3Rpb24oIuKGsyBBbmltYXRpb24iKQoKLS0vLyBGYWtlIEtpbGxlcnMgQW5pbSBTeXN0ZW0gKGhhcmRlbmVkKQpk" ..
    "bwogICAgbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCiAgICBsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKICAgIGxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQogICAgbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKCiAgICBsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgogICAgLS0gdGjhu60gcmVxdWlyZSBzcHJpbnQgbW9kdWxlIChu4bq/dSBjw7MpCiAgICBsb2NhbCBzcHJpbnRNb2R1bGUKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBzcHJpbnRNb2R1bGUgPSByZXF1aXJlKFJlcGxpY2F0ZWRTdG9yYWdlOldhaXRGb3JDaGlsZCgiU3lzdGVtcyIpLkNoYXJhY3Rlci5HYW1lLlNwcmludGluZykKICAgIGVuZCkKCiAgICAtLSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC0tIPCfn6IgROG7riBMSeG7hlUgS0lMTEVSUyArIFNLSU5TIChjaOG7iSBz4butYSDhu58gxJHDonkpCiAgICAtLSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGxvY2FsIEtpbGxlcnNEYXRhID0gewogICAgICAgIFsiU3Vydml2b3JzIl0gPSB7CiAgICAgICAgICAgIFsiRGVmYXVsdCJdID0gewogICAgICAgICAgICAgICAgSWRsZSA9ICJyYnhhc3NldGlkOi8vMTM0NjI0MjcwMjQ3MTIwIiwK" ..
    "ICAgICAgICAgICAgICAgIFdhbGsgPSAicmJ4YXNzZXRpZDovLzEzMjM3NzAzODYxNzc2NiIsCiAgICAgICAgICAgICAgICBSdW4gID0gInJieGFzc2V0aWQ6Ly8xMTU5NDY0NzQ5Nzc0MDkiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIlNoYXNoZXIiXSA9IHsKICAgICAgICAgICAgWyJEZWZhdWx0Il0gPSB7CiAgICAgICAgICAgICAgICBJZGxlID0gInJieGFzc2V0aWQ6Ly8xMTYwNTA5OTQ5MDU0MjEiLAogICAgICAgICAgICAgICAgV2FsayA9ICJyYnhhc3NldGlkOi8vOTM2MjIwMjI1OTYxMDgiLAogICAgICAgICAgICAgICAgUnVuICA9ICJyYnhhc3NldGlkOi8vOTMwNTQ3ODcxNDU1MDUiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBbIlB1cnN1ZXIiXSA9IHsKICAgICAgICAgICAgICAgIElkbGUgPSAicmJ4YXNzZXRpZDovLzk0ODk1NDY0OTYwOTcyIiwKICAgICAgICAgICAgICAgIFdhbGsgPSAicmJ4YXNzZXRpZDovLzEwMDIwNjA3OTQzOTMwNSIsCiAgICAgICAgICAgICAgICBSdW4gID0gInJieGFzc2V0aWQ6Ly8xMzg2NjA0MzM5ODIxNDAiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBbInN1YmplY3RfMCJdID0gewogICAgICAgICAgICAgICAgSWRsZSA9ICJyYnhhc3NldGlkOi8vMTQzMDEwNTY0NTgiLAogICAgICAgICAgICAgICAgV2FsayA9ICJyYnhhc3NldGlkOi8vMTIyMzI1ODgzODAwNjEyIiwKICAgICAgICAgICAgICAgIFJ1biAgPSAicmJ4YXNzZXRpZDovLzk3MjQ4" ..
    "MTc1MjUyODA1IiwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWyJDb29sa2lkZCJdID0gewogICAgICAgICAgICBbIkRlZmF1bHQiXSA9IHsKICAgICAgICAgICAgICAgIElkbGUgPSAicmJ4YXNzZXRpZDovLzE4ODg1OTAzNjY3IiwKICAgICAgICAgICAgICAgIFdhbGsgPSAicmJ4YXNzZXRpZDovLzE4ODg1OTA2MTQzIiwKICAgICAgICAgICAgICAgIFJ1biAgPSAicmJ4YXNzZXRpZDovLzk2NTcxMDc3ODkzODEzIiwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWyJKb2huIERvZSJdID0gewogICAgICAgICAgICBbIkRlZmF1bHQiXSA9IHsKICAgICAgICAgICAgICAgIElkbGUgPSAicmJ4YXNzZXRpZDovLzEwNTg4MDA4NzcxMTcyMiIsCiAgICAgICAgICAgICAgICBXYWxrID0gInJieGFzc2V0aWQ6Ly84MTE5MzgxNzQyNDMyOCIsCiAgICAgICAgICAgICAgICBSdW4gID0gInJieGFzc2V0aWQ6Ly8xMzI2NTM2NTU1MjA2ODIiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBbIlNoYWRvdyJdID0gewogICAgICAgICAgICAgICAgSWRsZSA9ICJyYnhhc3NldGlkOi8vMDAwMDAwMDAwMDEiLAogICAgICAgICAgICAgICAgV2FsayA9ICJyYnhhc3NldGlkOi8vMDAwMDAwMDAwMDIiLAogICAgICAgICAgICAgICAgUnVuICA9ICJyYnhhc3NldGlkOi8vMDAwMDAwMDAwMDMiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIk5vbGkiXSA9IHsKICAgICAgICAgICAgWyJEZWZhdWx0" ..
    "Il0gPSB7CiAgICAgICAgICAgICAgICBJZGxlID0gInJieGFzc2V0aWQ6Ly85Mzg0MTEyMDUzMzMxOCIsCiAgICAgICAgICAgICAgICBXYWxrID0gInJieGFzc2V0aWQ6Ly8xMDk3MDA0NzYwMDc0MzUiLAogICAgICAgICAgICAgICAgUnVuICA9ICJyYnhhc3NldGlkOi8vMTE3NDUxMzQxNjgyNDUyIiwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWyIxeDF4MXgxIl0gPSB7CiAgICAgICAgICAgIFsiRGVmYXVsdCJdID0gewogICAgICAgICAgICAgICAgSWRsZSA9ICJyYnhhc3NldGlkOi8vMTM4NzU0MjIxNTM3MTQ2IiwKICAgICAgICAgICAgICAgIFdhbGsgPSAicmJ4YXNzZXRpZDovLzEzMTIzNTUyODg3NTA5MSIsCiAgICAgICAgICAgICAgICBSdW4gID0gInJieGFzc2V0aWQ6Ly8xMDY0ODU1MTg0MTMzMzEiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBbIkhhY2tsb3JkIFtPbGRdIl0gPSB7CiAgICAgICAgICAgICAgICBJZGxlID0gInJieGFzc2V0aWQ6Ly84MjI0MTY1Mjc4NDgyNiIsCiAgICAgICAgICAgICAgICBXYWxrID0gInJieGFzc2V0aWQ6Ly8xMTkyNDIxNjQ0OTAzMTQiLAogICAgICAgICAgICAgICAgUnVuICA9ICJyYnhhc3NldGlkOi8vOTI0MzAxMDExMjk2ODIiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBbIkhhY2tsb3JkIFtOZXddIl0gPSB7CiAgICAgICAgICAgICAgICBJZGxlID0gInJieGFzc2V0aWQ6Ly8xMDYxMzEyMTE3NzMwNjkiLAogICAgICAgICAgICAgICAgV2Fs" ..
    "ayA9ICJyYnhhc3NldGlkOi8vMTE5MTEyMzM4MjYzNDc0IiwKICAgICAgICAgICAgICAgIFJ1biAgPSAicmJ4YXNzZXRpZDovLzg1MzM5MDAyNjM0OTc5IiwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWyJIZXJvYnJpbmUiXSA9IHsKICAgICAgICAgICAgWyJEZWZhdWx0Il0gPSB7CiAgICAgICAgICAgICAgICBJZGxlID0gInJieGFzc2V0aWQ6Ly8xMDc3OTkyNDA1NTk4MDYiLAogICAgICAgICAgICAgICAgV2FsayA9ICJyYnhhc3NldGlkOi8vODkzODAxMDc0ODUwMDYiLAogICAgICAgICAgICAgICAgUnVuICA9ICJyYnhhc3NldGlkOi8vMTM0MTU3MzYzODU0MDIyIiwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWyJHdWJieSJdID0gewogICAgICAgICAgICBbIkRlZmF1bHQiXSA9IHsKICAgICAgICAgICAgICAgIElkbGUgPSAicmJ4YXNzZXRpZDovLzg4MzMzNzAyMjM5MjU5IiwKICAgICAgICAgICAgICAgIFdhbGsgPSAicmJ4YXNzZXRpZDovLzExNTI0NDU4NDI5MTU4MSIsCiAgICAgICAgICAgICAgICBSdW4gID0gInJieGFzc2V0aWQ6Ly8xMTUyNDQ1ODQyOTE1ODEiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIlNhbmNobyJdID0gewogICAgICAgICAgICBbIkRlZmF1bHQiXSA9IHsKICAgICAgICAgICAgICAgIElkbGUgPSAicmJ4YXNzZXRpZDovLzExNTA3MzU4MTg2NDE4OCIsCiAgICAgICAgICAgICAgICBXYWxrID0gInJieGFzc2V0aWQ6Ly85NTIxMzc0ODE3" ..
    "MDg4OSIsCiAgICAgICAgICAgICAgICBSdW4gID0gInJieGFzc2V0aWQ6Ly83NTQwOTgxNDA5ODk5MyIsCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIFsiRXJsa2luZyJdID0gewogICAgICAgICAgICBbIkRlZmF1bHQiXSA9IHsKICAgICAgICAgICAgICAgIElkbGUgPSAicmJ4YXNzZXRpZDovLzkzNzI3NjYyNjY1MDc5IiwKICAgICAgICAgICAgICAgIFdhbGsgPSAicmJ4YXNzZXRpZDovLzk3NjI1NjQzMjYxNzkwIiwKICAgICAgICAgICAgICAgIFJ1biAgPSAicmJ4YXNzZXRpZDovLzExOTM1NzkzODIwODQ1NCIsCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIFsiU3VrdW5hIl0gPSB7CiAgICAgICAgICAgIFsiRGVmYXVsdCJdID0gewogICAgICAgICAgICAgICAgSWRsZSA9ICJyYnhhc3NldGlkOi8vMTE1MjY4OTI5MzYyOTM4IiwKICAgICAgICAgICAgICAgIFdhbGsgPSAicmJ4YXNzZXRpZDovLzEyMzY3ODg5MDIzNzY2OSIsCiAgICAgICAgICAgICAgICBSdW4gID0gInJieGFzc2V0aWQ6Ly8xMzIwODYzODk4NDk4ODkiLAogICAgICAgICAgICAgICAgTXVzaWMgPSAicmJ4YXNzZXRpZDovLzczNTk1ODE4MDczNjA2IiAtLSDwn4aVIG5o4bqhYyDEkeG6t2MgYmnhu4d0CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAtLSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICAtLSBzdGF0ZQogICAgbG9jYWwgZW5hYmxlZCA9IGZhbHNlCiAgICBsb2NhbCBzZWxlY3Rl" ..
    "ZEtpbGxlciA9ICJTaGFzaGVyIgogICAgbG9jYWwgc2VsZWN0ZWRTa2luID0gIkRlZmF1bHQiCiAgICBsb2NhbCBjaGFyYWN0ZXIsIGh1bWFub2lkLCBhbmltYXRvcgogICAgbG9jYWwgaWRsZUFuaW0sIHdhbGtBbmltLCBydW5BbmltCiAgICBsb2NhbCBpZGxlVHJhY2ssIHdhbGtUcmFjaywgcnVuVHJhY2sKICAgIGxvY2FsIF9pc1NwcmludGluZyA9IGZhbHNlCiAgICBsb2NhbCBtdXNpY1NvdW5kIC0tIPCfhpUgYmnhur9uIGdp4buvIFNvdW5kIG9iamVjdAoKICAgIC0tIGNvbm4KICAgIGxvY2FsIHJ1bm5pbmdDb25uLCBoZWFydGJlYXRDb25uLCBjaGFyYWN0ZXJSZW1vdmluZ0Nvbm4sIGlucHV0QmVnYW5Db25uLCBpbnB1dEVuZGVkQ29ubiA9IG5pbCwgbmlsLCBuaWwsIG5pbCwgbmlsCiAgICBsb2NhbCBoZWFydGJlYXRBY2N1bXVsYXRvciA9IDAKICAgIGxvY2FsIEhFQVJUQkVBVF9DSEVDS19JTlRFUlZBTCA9IDAuMTIKCiAgICAtLSB1dGlsaXR5CiAgICBsb2NhbCBmdW5jdGlvbiBzdG9wQW5kQ2xlYXJUcmFja3MoKQogICAgICAgIGZvciBfLCB0cmFjayBpbiBpcGFpcnMoe2lkbGVUcmFjaywgd2Fsa1RyYWNrLCBydW5UcmFja30pIGRvCiAgICAgICAgICAgIGlmIHRyYWNrIHRoZW4gcGNhbGwoZnVuY3Rpb24oKSB0cmFjazpTdG9wKCkgZW5kKSBlbmQKICAgICAgICBlbmQKICAgICAgICBpZGxlVHJhY2ssIHdhbGtUcmFjaywgcnVuVHJhY2sgPSBuaWwsIG5pbCwgbmlsCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlv" ..
    "biBzdG9wTXVzaWMoKQogICAgICAgIGlmIG11c2ljU291bmQgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBtdXNpY1NvdW5kOlN0b3AoKQogICAgICAgICAgICAgICAgbXVzaWNTb3VuZDpEZXN0cm95KCkKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBtdXNpY1NvdW5kID0gbmlsCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBwbGF5TXVzaWNJZlN1a3VuYShzZXQpCiAgICAgICAgc3RvcE11c2ljKCkKICAgICAgICBpZiBzZWxlY3RlZEtpbGxlciA9PSAiU3VrdW5hIiBhbmQgc2V0IGFuZCBzZXQuTXVzaWMgdGhlbgogICAgICAgICAgICBsb2NhbCBzb3VuZCA9IEluc3RhbmNlLm5ldygiU291bmQiKQogICAgICAgICAgICBzb3VuZC5Tb3VuZElkID0gc2V0Lk11c2ljCiAgICAgICAgICAgIHNvdW5kLkxvb3BlZCA9IHRydWUKICAgICAgICAgICAgc291bmQuVm9sdW1lID0gMgogICAgICAgICAgICBzb3VuZC5QYXJlbnQgPSB3b3Jrc3BhY2UKICAgICAgICAgICAgc291bmQ6UGxheSgpCiAgICAgICAgICAgIG11c2ljU291bmQgPSBzb3VuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gZGlzY29ubmVjdExpc3RlbmVycygpCiAgICAgICAgZm9yIF8sIGMgaW4gaXBhaXJzKHtydW5uaW5nQ29ubiwgaGVhcnRiZWF0Q29ubiwgY2hhcmFjdGVyUmVtb3ZpbmdDb25uLCBpbnB1dEJlZ2FuQ29ubiwgaW5wdXRFbmRlZENvbm59KSBk" ..
    "bwogICAgICAgICAgICBpZiBjIHRoZW4gcGNhbGwoZnVuY3Rpb24oKSBjOkRpc2Nvbm5lY3QoKSBlbmQpIGVuZAogICAgICAgIGVuZAogICAgICAgIHJ1bm5pbmdDb25uLCBoZWFydGJlYXRDb25uLCBjaGFyYWN0ZXJSZW1vdmluZ0Nvbm4sIGlucHV0QmVnYW5Db25uLCBpbnB1dEVuZGVkQ29ubiA9IG5pbCwgbmlsLCBuaWwsIG5pbCwgbmlsCiAgICBlbmQKCiAgICBsb2NhbCBmdW5jdGlvbiBjbGVhbnVwQ3VycmVudENoYXJhY3RlcigpCiAgICAgICAgc3RvcEFuZENsZWFyVHJhY2tzKCkKICAgICAgICBzdG9wTXVzaWMoKQogICAgICAgIGRpc2Nvbm5lY3RMaXN0ZW5lcnMoKQogICAgICAgIGFuaW1hdG9yLCBodW1hbm9pZCwgY2hhcmFjdGVyID0gbmlsLCBuaWwsIG5pbAogICAgZW5kCgogICAgLS0gbG9hZCBhbmltIG9iamVjdHMgdGhlbyBraWxsZXIgKyBza2luCiAgICBsb2NhbCBmdW5jdGlvbiBsb2FkQW5pbU9iamVjdHMoa2lsbGVyLCBza2luKQogICAgICAgIGxvY2FsIGtpbGxlclRhYmxlID0gS2lsbGVyc0RhdGFba2lsbGVyXQogICAgICAgIGlmIG5vdCBraWxsZXJUYWJsZSB0aGVuCiAgICAgICAgICAgIHdhcm4oImxvYWRBbmltT2JqZWN0czoga2lsbGVyIGtow7RuZyB04buTbiB04bqhaToiLCB0b3N0cmluZyhraWxsZXIpKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICBsb2NhbCBzZXQgPSBraWxsZXJUYWJsZVtza2luIG9yICJEZWZhdWx0Il0gb3Iga2lsbGVyVGFibGVbIkRlZmF1bHQi" ..
    "XQogICAgICAgIGlmIG5vdCBzZXQgdGhlbiByZXR1cm4gZW5kCgogICAgICAgIGlkbGVBbmltLCB3YWxrQW5pbSwgcnVuQW5pbSA9IEluc3RhbmNlLm5ldygiQW5pbWF0aW9uIiksIEluc3RhbmNlLm5ldygiQW5pbWF0aW9uIiksIEluc3RhbmNlLm5ldygiQW5pbWF0aW9uIikKICAgICAgICBpZGxlQW5pbS5OYW1lLCB3YWxrQW5pbS5OYW1lLCBydW5BbmltLk5hbWUgPSAiSWRsZUFuaW0iLCAiV2Fsa0FuaW0iLCAiUnVuQW5pbSIKICAgICAgICBpZGxlQW5pbS5BbmltYXRpb25JZCwgd2Fsa0FuaW0uQW5pbWF0aW9uSWQsIHJ1bkFuaW0uQW5pbWF0aW9uSWQgPSBzZXQuSWRsZSwgc2V0LldhbGssIHNldC5SdW4KCiAgICAgICAgcGxheU11c2ljSWZTdWt1bmEoc2V0KSAtLSDwn4aVIGNoZWNrIHBow6F0IG5o4bqhYyBu4bq/dSBsw6AgU3VrdW5hCiAgICBlbmQKCiAgICAtLSBwbGF5IGFuaW0KICAgIGxvY2FsIGZ1bmN0aW9uIHBsYXlBbmltKGFuaW1PYmosIHRyYWNrVHlwZSkKICAgICAgICBpZiBub3QgYW5pbWF0b3IgdGhlbiByZXR1cm4gZW5kCgogICAgICAgIGlmIHRyYWNrVHlwZSB+PSAiSWRsZSIgYW5kIGlkbGVUcmFjayB0aGVuIHBjYWxsKGZ1bmN0aW9uKCkgaWRsZVRyYWNrOlN0b3AoKSBlbmQpIGlkbGVUcmFjaz1uaWwgZW5kCiAgICAgICAgaWYgdHJhY2tUeXBlIH49ICJXYWxrIiBhbmQgd2Fsa1RyYWNrIHRoZW4gcGNhbGwoZnVuY3Rpb24oKSB3YWxrVHJhY2s6U3RvcCgpIGVuZCkgd2Fsa1RyYWNrPW5pbCBlbmQK" ..
    "ICAgICAgICBpZiB0cmFja1R5cGUgfj0gIlJ1biIgYW5kIHJ1blRyYWNrIHRoZW4gcGNhbGwoZnVuY3Rpb24oKSBydW5UcmFjazpTdG9wKCkgZW5kKSBydW5UcmFjaz1uaWwgZW5kCgogICAgICAgIGxvY2FsIHRyYWNrCiAgICAgICAgaWYgdHJhY2tUeXBlPT0iSWRsZSIgYW5kIG5vdCBpZGxlVHJhY2sgdGhlbiBpZGxlVHJhY2sgPSBhbmltYXRvcjpMb2FkQW5pbWF0aW9uKGlkbGVBbmltKSB0cmFjaz1pZGxlVHJhY2sKICAgICAgICBlbHNlaWYgdHJhY2tUeXBlPT0iV2FsayIgYW5kIG5vdCB3YWxrVHJhY2sgdGhlbiB3YWxrVHJhY2sgPSBhbmltYXRvcjpMb2FkQW5pbWF0aW9uKHdhbGtBbmltKSB0cmFjaz13YWxrVHJhY2sKICAgICAgICBlbHNlaWYgdHJhY2tUeXBlPT0iUnVuIiBhbmQgbm90IHJ1blRyYWNrIHRoZW4gcnVuVHJhY2sgPSBhbmltYXRvcjpMb2FkQW5pbWF0aW9uKHJ1bkFuaW0pIHRyYWNrPXJ1blRyYWNrCiAgICAgICAgZWxzZSB0cmFjayA9ICh0cmFja1R5cGU9PSJJZGxlIiBhbmQgaWRsZVRyYWNrKSBvciAodHJhY2tUeXBlPT0iV2FsayIgYW5kIHdhbGtUcmFjaykgb3IgcnVuVHJhY2sgZW5kCgogICAgICAgIGlmIHRyYWNrIGFuZCBub3QgdHJhY2suSXNQbGF5aW5nIHRoZW4gcGNhbGwoZnVuY3Rpb24oKSB0cmFjazpQbGF5KCkgZW5kKSBlbmQKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIHBsYXlJZGxlKCkgcGxheUFuaW0oaWRsZUFuaW0sIklkbGUiKSBlbmQKICAgIGxvY2FsIGZ1bmN0aW9uIHBs" ..
    "YXlXYWxrKCkgcGxheUFuaW0od2Fsa0FuaW0sIldhbGsiKSBlbmQKICAgIGxvY2FsIGZ1bmN0aW9uIHBsYXlSdW4oKSBwbGF5QW5pbShydW5BbmltLCJSdW4iKSBlbmQKCiAgICAtLSB1cGRhdGUgc3RhdGUKICAgIGxvY2FsIGZ1bmN0aW9uIHVwZGF0ZU1vdmVtZW50U3RhdGUoKQogICAgICAgIGlmIG5vdCBlbmFibGVkIG9yIG5vdCBjaGFyYWN0ZXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgbW92aW5nPWZhbHNlCiAgICAgICAgaWYgaHVtYW5vaWQgYW5kIGh1bWFub2lkLk1vdmVEaXJlY3Rpb24gdGhlbgogICAgICAgICAgICBtb3ZpbmcgPSBodW1hbm9pZC5Nb3ZlRGlyZWN0aW9uLk1hZ25pdHVkZT4wCiAgICAgICAgICAgIGlmIG5vdCBtb3ZpbmcgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgcm9vdCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIG9yIGNoYXJhY3Rlci5QcmltYXJ5UGFydAogICAgICAgICAgICAgICAgaWYgcm9vdCBhbmQgcm9vdC5WZWxvY2l0eS5NYWduaXR1ZGU+MSB0aGVuIG1vdmluZz10cnVlIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBpZiBtb3ZpbmcgdGhlbgogICAgICAgICAgICBsb2NhbCBzcHJpbnRpbmdOb3cgPSAoc3ByaW50TW9kdWxlIGFuZCBzcHJpbnRNb2R1bGUuSXNTcHJpbnRpbmcpIG9yIF9pc1NwcmludGluZwogICAgICAgICAgICBpZiBzcHJpbnRpbmdOb3cgdGhlbiBwbGF5UnVuKCkgZWxzZSBwbGF5" ..
    "V2FsaygpIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgcGxheUlkbGUoKQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gbGlzdGVuZXJzCiAgICBsb2NhbCBmdW5jdGlvbiBzZXR1cE1vdmVtZW50TGlzdGVuZXJzKCkKICAgICAgICBkaXNjb25uZWN0TGlzdGVuZXJzKCkKICAgICAgICBpbnB1dEJlZ2FuQ29ubiA9IFVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0LGdwKSBpZiBncCB0aGVuIHJldHVybiBlbmQgaWYgaW5wdXQuS2V5Q29kZT09RW51bS5LZXlDb2RlLkxlZnRTaGlmdCB0aGVuIF9pc1NwcmludGluZz10cnVlIGVuZCBlbmQpCiAgICAgICAgaW5wdXRFbmRlZENvbm4gPSBVc2VySW5wdXRTZXJ2aWNlLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCxncCkgaWYgZ3AgdGhlbiByZXR1cm4gZW5kIGlmIGlucHV0LktleUNvZGU9PUVudW0uS2V5Q29kZS5MZWZ0U2hpZnQgdGhlbiBfaXNTcHJpbnRpbmc9ZmFsc2UgZW5kIGVuZCkKCiAgICAgICAgaWYgaHVtYW5vaWQgYW5kIGh1bWFub2lkLlJ1bm5pbmcgdGhlbgogICAgICAgICAgICBydW5uaW5nQ29ubiA9IGh1bWFub2lkLlJ1bm5pbmc6Q29ubmVjdChmdW5jdGlvbihzcGVlZCkgaWYgbm90IGVuYWJsZWQgdGhlbiByZXR1cm4gZW5kIGlmIHNwZWVkPjAgdGhlbiB1cGRhdGVNb3ZlbWVudFN0YXRlKCkgZWxzZSBwbGF5SWRsZSgpIGVuZCBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBoZWFydGJl" ..
    "YXRBY2N1bXVsYXRvcj0wCiAgICAgICAgICAgIGhlYXJ0YmVhdENvbm4gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKGR0KQogICAgICAgICAgICAgICAgaWYgbm90IGVuYWJsZWQgb3Igbm90IGNoYXJhY3RlciB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgIGhlYXJ0YmVhdEFjY3VtdWxhdG9yKz1kdAogICAgICAgICAgICAgICAgaWYgaGVhcnRiZWF0QWNjdW11bGF0b3I+PUhFQVJUQkVBVF9DSEVDS19JTlRFUlZBTCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaGVhcnRiZWF0QWNjdW11bGF0b3I9MAogICAgICAgICAgICAgICAgICAgIHVwZGF0ZU1vdmVtZW50U3RhdGUoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIGJpbmQgY2hhcmFjdGVyCiAgICBsb2NhbCBmdW5jdGlvbiBvbkNoYXJhY3RlckJvdW5kKGNoYXIpCiAgICAgICAgY2xlYW51cEN1cnJlbnRDaGFyYWN0ZXIoKQogICAgICAgIGNoYXJhY3Rlcj1jaGFyCiAgICAgICAgaHVtYW5vaWQ9Y2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikgb3IgY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkFuaW1hdGlvbkNvbnRyb2xsZXIiKQogICAgICAgIGlmIGh1bWFub2lkIHRoZW4KICAgICAgICAgICAgYW5pbWF0b3IgPSBodW1hbm9pZDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkFuaW1hdG9yIikgb3IgSW5zdGFuY2UubmV3KCJBbmltYXRv" ..
    "ciIsIGh1bWFub2lkKQogICAgICAgIGVuZAogICAgICAgIGNoYXJhY3RlclJlbW92aW5nQ29ubiA9IGNoYXIuQW5jZXN0cnlDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oXyxwYXJlbnQpIGlmIG5vdCBwYXJlbnQgdGhlbiBjbGVhbnVwQ3VycmVudENoYXJhY3RlcigpIGVuZCBlbmQpCiAgICAgICAgaWYgZW5hYmxlZCB0aGVuCiAgICAgICAgICAgIGxvYWRBbmltT2JqZWN0cyhzZWxlY3RlZEtpbGxlciwgc2VsZWN0ZWRTa2luKQogICAgICAgICAgICBzZXR1cE1vdmVtZW50TGlzdGVuZXJzKCkKICAgICAgICAgICAgdXBkYXRlTW92ZW1lbnRTdGF0ZSgpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChvbkNoYXJhY3RlckJvdW5kKQogICAgaWYgcGxheWVyLkNoYXJhY3RlciB0aGVuIG9uQ2hhcmFjdGVyQm91bmQocGxheWVyLkNoYXJhY3RlcikgZW5kCgogICAgLS0gPT09PT0gVUkgPT09PT0KICAgIGxvY2FsIGtpbGxlck5hbWVzID0ge30KICAgIGZvciBuYW1lLF8gaW4gcGFpcnMoS2lsbGVyc0RhdGEpIGRvIHRhYmxlLmluc2VydChraWxsZXJOYW1lcywgbmFtZSkgZW5kCiAgICB0YWJsZS5zb3J0KGtpbGxlck5hbWVzKQoKICAgIGxvY2FsIFNraW5Ecm9wZG93biAtLSBraGFpIGLDoW8gdHLGsOG7m2MKCiAgICAtLSBkcm9wZG93biBjaMOtbmggKEtpbGxlcnMpCiAgICBsb2NhbCBraWxsZXJEcm9wZG93biA9IFRhYnMuQ3VzdG9tOkFkZERyb3Bkb3duKCJDaG9vc2VLaWxs" ..
    "ZXJzRHJvcGRvd24iLCB7CiAgICAgICAgVGl0bGUgPSAiQ2hvb3NlIEtpbGxlcnMiLAogICAgICAgIFZhbHVlcyA9IGtpbGxlck5hbWVzLAogICAgICAgIERlZmF1bHQgPSBzZWxlY3RlZEtpbGxlciwKICAgICAgICBNdWx0aSA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgICAgIGxvY2FsIG9rLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBzZWxlY3RlZEtpbGxlciA9IHZhbHVlCiAgICAgICAgICAgICAgICBzZWxlY3RlZFNraW4gPSAiRGVmYXVsdCIKCiAgICAgICAgICAgICAgICBsb2NhbCBza2lucyA9IHt9CiAgICAgICAgICAgICAgICBsb2NhbCB0ID0gS2lsbGVyc0RhdGFbc2VsZWN0ZWRLaWxsZXJdIG9yIHt9CiAgICAgICAgICAgICAgICBmb3Igc05hbWUsXyBpbiBwYWlycyh0KSBkbyB0YWJsZS5pbnNlcnQoc2tpbnMsIHNOYW1lKSBlbmQKICAgICAgICAgICAgICAgIGlmICNza2lucyA9PSAwIHRoZW4gc2tpbnMgPSB7IkRlZmF1bHQifSBlbmQKICAgICAgICAgICAgICAgIHRhYmxlLnNvcnQoc2tpbnMpCgogICAgICAgICAgICAgICAgaWYgU2tpbkRyb3Bkb3duIGFuZCB0eXBlKFNraW5Ecm9wZG93bi5TZXRWYWx1ZXMpPT0iZnVuY3Rpb24iIGFuZCB0eXBlKFNraW5Ecm9wZG93bi5TZXRWYWx1ZSk9PSJmdW5jdGlvbiIgdGhlbgogICAgICAgICAgICAgICAgICAgIFNraW5Ecm9wZG93bjpTZXRWYWx1ZXMoc2tpbnMpCiAgICAgICAgICAgICAg" ..
    "ICAgICAgcGNhbGwoZnVuY3Rpb24oKSBTa2luRHJvcGRvd246U2V0VmFsdWUoc2tpbnNbMV0gb3IgIkRlZmF1bHQiKSBlbmQpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBlbmFibGVkIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2FkQW5pbU9iamVjdHMoc2VsZWN0ZWRLaWxsZXIsIHNlbGVjdGVkU2tpbikKICAgICAgICAgICAgICAgICAgICBzdG9wQW5kQ2xlYXJUcmFja3MoKQogICAgICAgICAgICAgICAgICAgIHVwZGF0ZU1vdmVtZW50U3RhdGUoKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHN0b3BNdXNpYygpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBpZiBub3Qgb2sgdGhlbiB3YXJuKCJDaG9vc2VLaWxsZXJzRHJvcGRvd24gY2FsbGJhY2sgZXJyb3I6IiwgZXJyKSBlbmQKICAgICAgICBlbmQKICAgIH0pCgogICAgLS0gZHJvcGRvd24gU2tpbiAobuG6sW0gZMaw4bubaSBLaWxsZXIpCiAgICBTa2luRHJvcGRvd24gPSBUYWJzLkN1c3RvbTpBZGREcm9wZG93bigiQ2hvb3NlU2tpbkRyb3Bkb3duIiwgewogICAgICAgIFRpdGxlID0gIkNob29zZSBTa2luIiwKICAgICAgICBWYWx1ZXMgPSB7IkRlZmF1bHQifSwKICAgICAgICBEZWZhdWx0ID0gIkRlZmF1bHQiLAogICAgICAgIE11bHRpID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAg" ..
    "ICAgICAgICAgbG9jYWwgb2ssIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHNlbGVjdGVkU2tpbiA9IHZhbHVlCiAgICAgICAgICAgICAgICBpZiBlbmFibGVkIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2FkQW5pbU9iamVjdHMoc2VsZWN0ZWRLaWxsZXIsIHNlbGVjdGVkU2tpbikKICAgICAgICAgICAgICAgICAgICBzdG9wQW5kQ2xlYXJUcmFja3MoKQogICAgICAgICAgICAgICAgICAgIHVwZGF0ZU1vdmVtZW50U3RhdGUoKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHN0b3BNdXNpYygpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBpZiBub3Qgb2sgdGhlbiB3YXJuKCJTa2luRHJvcGRvd24gY2FsbGJhY2sgZXJyb3I6IiwgZXJyKSBlbmQKICAgICAgICBlbmQKICAgIH0pCgogICAgLS0gdG9nZ2xlIGZha2Uga2lsbGVycwogICAgVGFicy5DdXN0b206QWRkVG9nZ2xlKCJGYWtlS2lsbGVyc1RvZ2dsZSIsIHsKICAgICAgICBUaXRsZSA9ICJGYWtlIEtpbGxlcnMiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgICAgICBsb2NhbCBvaywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgZW5hYmxlZCA9IHN0YXRlCiAgICAgICAgICAgICAgICBpZiBlbmFibGVkIHRoZW4KICAgICAgICAg" ..
    "ICAgICAgICAgICBpZiBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEFuaW1PYmplY3RzKHNlbGVjdGVkS2lsbGVyLCBzZWxlY3RlZFNraW4pCiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhcmFjdGVyQm91bmQocGxheWVyLkNoYXJhY3RlcikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBzdG9wQW5kQ2xlYXJUcmFja3MoKQogICAgICAgICAgICAgICAgICAgIGRpc2Nvbm5lY3RMaXN0ZW5lcnMoKQogICAgICAgICAgICAgICAgICAgIHN0b3BNdXNpYygpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBpZiBub3Qgb2sgdGhlbiB3YXJuKCJGYWtlS2lsbGVyc1RvZ2dsZSBjYWxsYmFjayBlcnJvcjoiLCBlcnIpIGVuZAogICAgICAgIGVuZAogICAgfSkKZW5kCgoKCiAgICBUYWJzLkN1c3RvbTpBZGRTZWN0aW9uKCLihrMgU2tpbGwiKQoKCmRvCi0tIExvY2FsU2NyaXB0IChTdGFydGVyUGxheWVyU2NyaXB0cykKCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIikKbG9jYWwgcGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBwbGF5ZXJHdWkgPSBwbGF5ZXI6V2FpdEZvckNoaWxkKCJQbGF5ZXJHdWkiKQoKLS0g4pqhIENv" ..
    "bmZpZwpsb2NhbCBCVVRUT05fU0laRSA9IDQ4CmxvY2FsIEZyYW1lc0xvY2tlZCA9IHRydWUKbG9jYWwgc2NyZWVuR3VpCmxvY2FsIGNyZWF0ZWRGcmFtZXMgPSB7fQoKLS0gZOG7ryBsaeG7h3UgY8OhYyBuw7p0CmxvY2FsIGJ1dHRvbnNEYXRhID0gewogICAge05hbWUgPSAiQnRuMSIsIEFuaW1hdGlvbklkID0gIjEzNTg1MzA4NzIyNzQ1MyIsIFBsYXlNdXNpYyA9IHRydWUsIE11c2ljSWQgPSAiODEzNjEyNTk3NTYwODkiLCBJbWFnZUlkID0gIjEzNDIxMDM3ODM4Mjc2NyJ9LAogICAge05hbWUgPSAiQnRuMiIsIEFuaW1hdGlvbklkID0gIjk5Nzg0NTg2MjAxOTk3IiwgUGxheU11c2ljID0gZmFsc2UsIEltYWdlSWQgPSAiMTM0MjEwMzc4MzgyNzY3In0sCiAgICB7TmFtZSA9ICJCdG4zIiwgQW5pbWF0aW9uSWQgPSAiMTIxMTYyNDc3NDAyMjI0IiwgUGxheU11c2ljID0gdHJ1ZSwgTXVzaWNJZCA9ICIxMjAxODU4MTc3NDg4NTgiLCBJbWFnZUlkID0gIjg1Nzg1ODI2OTg1MDUyIn0sCiAgICB7TmFtZSA9ICJCdG40IiwgQW5pbWF0aW9uSWQgPSAiMTAxODE2OTI0ODQ0ODA1IiwgUGxheU11c2ljID0gdHJ1ZSwgTXVzaWNJZCA9ICI4ODQwNjAyNzUzNjQ5NCIsIEltYWdlSWQgPSAiODU3ODU4MjY5ODUwNTIifSwKfQoKLS0gduG7iyB0csOtIGJhbiDEkeG6p3UKbG9jYWwgc3RhcnRQb3NpdGlvbnMgPSB7CiAgICBVRGltMi5uZXcoMCwgODAsIDAsIDIwMCksCiAgICBVRGltMi5uZXcoMCwgMTQwLCAwLCAyMDApLAogICAgVURp" ..
    "bTIubmV3KDAsIDIwMCwgMCwgMjAwKSwKICAgIFVEaW0yLm5ldygwLCAyNjAsIDAsIDIwMCksCn0KCi0tIPCfjJ8gRHJhZyBNb2R1bGUKbG9jYWwgZnVuY3Rpb24gbWFrZURyYWdnYWJsZShmcmFtZSkKICAgIGxvY2FsIGRyYWdnaW5nLCBkcmFnU3RhcnQsIHN0YXJ0UG9zCgogICAgZnJhbWUuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIG5vdCBGcmFtZXNMb2NrZWQgYW5kIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgCiAgICAgICAgICAgIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSB0aGVuCiAgICAgICAgICAgIGRyYWdnaW5nID0gdHJ1ZQogICAgICAgICAgICBkcmFnU3RhcnQgPSBpbnB1dC5Qb3NpdGlvbgogICAgICAgICAgICBzdGFydFBvcyA9IGZyYW1lLlBvc2l0aW9uCgogICAgICAgICAgICBpbnB1dC5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0U3RhdGUgPT0gRW51bS5Vc2VySW5wdXRTdGF0ZS5FbmQgdGhlbgogICAgICAgICAgICAgICAgICAgIGRyYWdnaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgVXNlcklucHV0U2VydmljZS5JbnB1dENoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBub3Qg" ..
    "RnJhbWVzTG9ja2VkIGFuZCBkcmFnZ2luZyBhbmQgCiAgICAgICAgICAgIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IAogICAgICAgICAgICBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCkgdGhlbgogICAgICAgICAgICBsb2NhbCBkZWx0YSA9IGlucHV0LlBvc2l0aW9uIC0gZHJhZ1N0YXJ0CiAgICAgICAgICAgIGZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KAogICAgICAgICAgICAgICAgc3RhcnRQb3MuWC5TY2FsZSwKICAgICAgICAgICAgICAgIHN0YXJ0UG9zLlguT2Zmc2V0ICsgZGVsdGEuWCwKICAgICAgICAgICAgICAgIHN0YXJ0UG9zLlkuU2NhbGUsCiAgICAgICAgICAgICAgICBzdGFydFBvcy5ZLk9mZnNldCArIGRlbHRhLlkKICAgICAgICAgICAgKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tIPCflLkgR1VJIGNvbnRhaW5lcgpzY3JlZW5HdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCnNjcmVlbkd1aS5OYW1lID0gIkNpcmNsZUJ1dHRvbnNHVUkiCnNjcmVlbkd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQpzY3JlZW5HdWkuSWdub3JlR3VpSW5zZXQgPSB0cnVlCnNjcmVlbkd1aS5FbmFibGVkID0gZmFsc2UKc2NyZWVuR3VpLlBhcmVudCA9IHBsYXllckd1aQoKLS0g8J+UuSBIw6BtIHThuqFvIGZyYW1lICsgYnV0dG9uCmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZUZyYW1lV2l0aEJ1dHRvbihkYXRh" ..
    "LCBwb3MpCiAgICBsb2NhbCBmcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQogICAgZnJhbWUuTmFtZSA9IGRhdGEuTmFtZSAuLiAiX0ZyYW1lIgogICAgZnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLCBCVVRUT05fU0laRSwgMCwgQlVUVE9OX1NJWkUpCiAgICBmcmFtZS5Qb3NpdGlvbiA9IHBvcwogICAgZnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIGZyYW1lLlpJbmRleCA9IDEKICAgIGZyYW1lLlBhcmVudCA9IHNjcmVlbkd1aQogICAgZnJhbWUuQWN0aXZlID0gdHJ1ZQoKICAgIC0tIGJvIHRyw7JuIGZyYW1lCiAgICBsb2NhbCBmcmFtZUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQogICAgZnJhbWVDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMSwgMCkKICAgIGZyYW1lQ29ybmVyLlBhcmVudCA9IGZyYW1lCgogICAgbG9jYWwgYnRuID0gSW5zdGFuY2UubmV3KCJJbWFnZUJ1dHRvbiIpCiAgICBidG4uTmFtZSA9IGRhdGEuTmFtZQogICAgYnRuLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCkKICAgIGJ0bi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgYnRuLkltYWdlID0gInJieGFzc2V0aWQ6Ly8iIC4uIGRhdGEuSW1hZ2VJZAogICAgYnRuLlpJbmRleCA9IDIKICAgIGJ0bi5QYXJlbnQgPSBmcmFtZQogICAgYnRuLlNjYWxlVHlwZSA9IEVudW0uU2NhbGVUeXBlLkZpdCAtLSBnaeG7ryB04buJIGzhu4cg4bqjbmgKCiAgICAtLSBibyB0csOybiBuw7p0CiAg" ..
    "ICBsb2NhbCBjb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKICAgIGNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKQogICAgY29ybmVyLlBhcmVudCA9IGJ0bgoKICAgIC0tIGNsaWNrIGNo4bqheSBhbmltYXRpb24vbmjhuqFjCiAgICBidG4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgRnJhbWVzTG9ja2VkIHRoZW4KICAgICAgICAgICAgbG9jYWwgY2hhciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgIGlmIG5vdCBodW1hbm9pZCB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgIGxvY2FsIGFuaW1hdG9yID0gaHVtYW5vaWQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJBbmltYXRvciIpIG9yIEluc3RhbmNlLm5ldygiQW5pbWF0b3IiLCBodW1hbm9pZCkKICAgICAgICAgICAgbG9jYWwgYW5pbSA9IEluc3RhbmNlLm5ldygiQW5pbWF0aW9uIikKICAgICAgICAgICAgYW5pbS5BbmltYXRpb25JZCA9ICJyYnhhc3NldGlkOi8vIiAuLiBkYXRhLkFuaW1hdGlvbklkCiAgICAgICAgICAgIGxvY2FsIHRyYWNrID0gYW5pbWF0b3I6TG9hZEFuaW1hdGlvbihhbmltKQogICAgICAgICAgICB0cmFjazpQbGF5KCkKCiAgICAgICAgICAgIGlmIGRhdGEuUGxheU11c2ljIGFuZCBk" ..
    "YXRhLk11c2ljSWQgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgc291bmQgPSBJbnN0YW5jZS5uZXcoIlNvdW5kIikKICAgICAgICAgICAgICAgIHNvdW5kLlNvdW5kSWQgPSAicmJ4YXNzZXRpZDovLyIgLi4gZGF0YS5NdXNpY0lkCiAgICAgICAgICAgICAgICBzb3VuZC5Wb2x1bWUgPSAxCiAgICAgICAgICAgICAgICBzb3VuZC5QYXJlbnQgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikgb3IgcGxheWVyR3VpCiAgICAgICAgICAgICAgICBzb3VuZDpQbGF5KCkKICAgICAgICAgICAgICAgIHNvdW5kLkVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oKSBzb3VuZDpEZXN0cm95KCkgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICBtYWtlRHJhZ2dhYmxlKGZyYW1lKQoKICAgIGJ0bi5WaXNpYmxlID0gRnJhbWVzTG9ja2VkCiAgICBmcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gRnJhbWVzTG9ja2VkIGFuZCAxIG9yIDAuMwoKICAgIHRhYmxlLmluc2VydChjcmVhdGVkRnJhbWVzLCBmcmFtZSkKZW5kCgotLSB04bqhbyBuw7p0CmZvciBpLCBkIGluIGlwYWlycyhidXR0b25zRGF0YSkgZG8KICAgIGNyZWF0ZUZyYW1lV2l0aEJ1dHRvbihkLCBzdGFydFBvc2l0aW9uc1tpXSkKZW5kCgotLSDwn4yfIFTDrWNoIGjhu6NwIFRvZ2dsZSArIElucHV0ClRhYnMuQ3VzdG9tOkFkZFRvZ2dsZSgiU3VrdW5hU2tpbGwiLCB7CiAgICBUaXRsZSA9ICJTdWt1bmEgU2tpbGwiLAogICAgRGVmYXVs" ..
    "dCA9IGZhbHNlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgIHNjcmVlbkd1aS5FbmFibGVkID0gc3RhdGUKZW5kKQoKVGFicy5DdXN0b206QWRkVG9nZ2xlKCJTdWt1bmFMb2NrQnV0dG9uIiwgewogICAgVGl0bGUgPSAiTG9jayBCdXR0b25zIiwKICAgIERlZmF1bHQgPSB0cnVlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgIEZyYW1lc0xvY2tlZCA9IHN0YXRlCiAgICBmb3IgXywgZnJhbWUgaW4gaXBhaXJzKGNyZWF0ZWRGcmFtZXMpIGRvCiAgICAgICAgbG9jYWwgYnRuID0gZnJhbWU6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJJbWFnZUJ1dHRvbiIpCiAgICAgICAgaWYgYnRuIHRoZW4KICAgICAgICAgICAgYnRuLlZpc2libGUgPSBGcmFtZXNMb2NrZWQKICAgICAgICBlbmQKICAgICAgICBmcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gRnJhbWVzTG9ja2VkIGFuZCAxIG9yIDAuMwogICAgZW5kCmVuZCkKClRhYnMuQ3VzdG9tOkFkZElucHV0KCJTa3VuYUJ1dHRvblNraWxsIiwgewogICAgVGl0bGUgPSAiQnV0dG9uIFNpemUiLAogICAgRGVmYXVsdCA9IHRvc3RyaW5nKEJVVFRPTl9TSVpFKSwKICAgIFBsYWNlaG9sZGVyID0gIk5o4bqtcCBz4buRIHB4IiwKICAgIE51bWVyaWMgPSB0cnVlLAogICAgRmluaXNoZWQgPSB0cnVlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbih2YWx1ZSkKICAgIGxvY2FsIG51bSA9IHRvbnVtYmVyKHZhbHVlKQogICAgaWYgbnVtIGFuZCBudW0gPiAwIHRoZW4K" ..
    "ICAgICAgICBCVVRUT05fU0laRSA9IG51bQogICAgICAgIGZvciBfLCBmcmFtZSBpbiBpcGFpcnMoY3JlYXRlZEZyYW1lcykgZG8KICAgICAgICAgICAgZnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLCBCVVRUT05fU0laRSwgMCwgQlVUVE9OX1NJWkUpCiAgICAgICAgICAgIGxvY2FsIGJ0biA9IGZyYW1lOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSW1hZ2VCdXR0b24iKQogICAgICAgICAgICBpZiBidG4gdGhlbgogICAgICAgICAgICAgICAgYnRuLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQplbmQKCgoKZG8KLS0gTG9jYWxTY3JpcHQgKFN0YXJ0ZXJQbGF5ZXJTY3JpcHRzKQoKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQpsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIHBsYXllckd1aSA9IHBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpCgotLSDimqEgQ29uZmlnCmxvY2FsIEJVVFRPTl9TSVpFID0gNDgKbG9jYWwgRnJhbWVzTG9ja2VkID0gdHJ1ZQpsb2NhbCBzY3JlZW5HdWkKbG9jYWwgY3JlYXRlZEZyYW1lcyA9IHt9CgotLSBk4buvIGxp4buHdSBjw6FjIG7DunQKbG9jYWwgYnV0dG9uc0RhdGEgPSB7CiAgICB7TmFtZSA9ICJCdG4xIiwgQW5pbWF0aW9uSWQgPSAi" ..
    "NzI3MjIyNDQ1MDg3NDkiLCBQbGF5TXVzaWMgPSBmYWxzZSwgSW1hZ2VJZCA9ICI4NzI5Mzg2MTE4MzA4MCJ9LAogICAge05hbWUgPSAiQnRuMiIsIEFuaW1hdGlvbklkID0gIjk2OTU5MTIzMDc3NDk4IiwgUGxheU11c2ljID0gZmFsc2UsIEltYWdlSWQgPSAiODcyOTM4NjExODMwODAifSwKfQoKLS0gduG7iyB0csOtIGJhbiDEkeG6p3UKbG9jYWwgc3RhcnRQb3NpdGlvbnMgPSB7CiAgICBVRGltMi5uZXcoMCwgODAsIDAsIDIwMCksCiAgICBVRGltMi5uZXcoMCwgMTQwLCAwLCAyMDApLAp9CgotLSDwn4yfIERyYWcgTW9kdWxlCmxvY2FsIGZ1bmN0aW9uIG1ha2VEcmFnZ2FibGUoZnJhbWUpCiAgICBsb2NhbCBkcmFnZ2luZywgZHJhZ1N0YXJ0LCBzdGFydFBvcwoKICAgIGZyYW1lLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBub3QgRnJhbWVzTG9ja2VkIGFuZCAoaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIAogICAgICAgICAgICBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCkgdGhlbgogICAgICAgICAgICBkcmFnZ2luZyA9IHRydWUKICAgICAgICAgICAgZHJhZ1N0YXJ0ID0gaW5wdXQuUG9zaXRpb24KICAgICAgICAgICAgc3RhcnRQb3MgPSBmcmFtZS5Qb3NpdGlvbgoKICAgICAgICAgICAgaW5wdXQuQ2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGlm" ..
    "IGlucHV0LlVzZXJJbnB1dFN0YXRlID09IEVudW0uVXNlcklucHV0U3RhdGUuRW5kIHRoZW4KICAgICAgICAgICAgICAgICAgICBkcmFnZ2luZyA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIFVzZXJJbnB1dFNlcnZpY2UuSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgbm90IEZyYW1lc0xvY2tlZCBhbmQgZHJhZ2dpbmcgYW5kIAogICAgICAgICAgICAoaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCAKICAgICAgICAgICAgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIHRoZW4KICAgICAgICAgICAgbG9jYWwgZGVsdGEgPSBpbnB1dC5Qb3NpdGlvbiAtIGRyYWdTdGFydAogICAgICAgICAgICBmcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygKICAgICAgICAgICAgICAgIHN0YXJ0UG9zLlguU2NhbGUsCiAgICAgICAgICAgICAgICBzdGFydFBvcy5YLk9mZnNldCArIGRlbHRhLlgsCiAgICAgICAgICAgICAgICBzdGFydFBvcy5ZLlNjYWxlLAogICAgICAgICAgICAgICAgc3RhcnRQb3MuWS5PZmZzZXQgKyBkZWx0YS5ZCiAgICAgICAgICAgICkKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgotLSDwn5S5IEdVSSBjb250YWluZXIKc2NyZWVuR3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQpzY3JlZW5H" ..
    "dWkuTmFtZSA9ICJDaXJjbGVCdXR0b25zR1VJIgpzY3JlZW5HdWkuUmVzZXRPblNwYXduID0gZmFsc2UKc2NyZWVuR3VpLklnbm9yZUd1aUluc2V0ID0gdHJ1ZQpzY3JlZW5HdWkuRW5hYmxlZCA9IGZhbHNlCnNjcmVlbkd1aS5QYXJlbnQgPSBwbGF5ZXJHdWkKCi0tIPCflLkgSMOgbSB04bqhbyBmcmFtZSArIGJ1dHRvbgpsb2NhbCBmdW5jdGlvbiBjcmVhdGVGcmFtZVdpdGhCdXR0b24oZGF0YSwgcG9zKQogICAgbG9jYWwgZnJhbWUgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgIGZyYW1lLk5hbWUgPSBkYXRhLk5hbWUgLi4gIl9GcmFtZSIKICAgIGZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwgQlVUVE9OX1NJWkUsIDAsIEJVVFRPTl9TSVpFKQogICAgZnJhbWUuUG9zaXRpb24gPSBwb3MKICAgIGZyYW1lLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICBmcmFtZS5aSW5kZXggPSAxCiAgICBmcmFtZS5QYXJlbnQgPSBzY3JlZW5HdWkKICAgIGZyYW1lLkFjdGl2ZSA9IHRydWUKCiAgICAtLSBibyB0csOybiBmcmFtZQogICAgbG9jYWwgZnJhbWVDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKICAgIGZyYW1lQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApCiAgICBmcmFtZUNvcm5lci5QYXJlbnQgPSBmcmFtZQoKICAgIGxvY2FsIGJ0biA9IEluc3RhbmNlLm5ldygiSW1hZ2VCdXR0b24iKQogICAgYnRuLk5hbWUgPSBkYXRhLk5hbWUKICAgIGJ0bi5TaXplID0gVURpbTIubmV3KDEs" ..
    "IDAsIDEsIDApCiAgICBidG4uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIGJ0bi5JbWFnZSA9ICJyYnhhc3NldGlkOi8vIiAuLiBkYXRhLkltYWdlSWQKICAgIGJ0bi5aSW5kZXggPSAyCiAgICBidG4uUGFyZW50ID0gZnJhbWUKICAgIGJ0bi5TY2FsZVR5cGUgPSBFbnVtLlNjYWxlVHlwZS5GaXQgLS0gZ2nhu68gdOG7iSBs4buHIOG6o25oCgogICAgLS0gYm8gdHLDsm4gbsO6dAogICAgbG9jYWwgY29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCiAgICBjb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMSwgMCkKICAgIGNvcm5lci5QYXJlbnQgPSBidG4KCiAgICAtLSBjbGljayBjaOG6oXkgYW5pbWF0aW9uL25o4bqhYwogICAgYnRuLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIEZyYW1lc0xvY2tlZCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgICAgICBpZiBub3QgaHVtYW5vaWQgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICBsb2NhbCBhbmltYXRvciA9IGh1bWFub2lkOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQW5pbWF0b3IiKSBvciBJbnN0YW5jZS5uZXcoIkFuaW1hdG9yIiwgaHVtYW5vaWQpCiAgICAgICAgICAg" ..
    "IGxvY2FsIGFuaW0gPSBJbnN0YW5jZS5uZXcoIkFuaW1hdGlvbiIpCiAgICAgICAgICAgIGFuaW0uQW5pbWF0aW9uSWQgPSAicmJ4YXNzZXRpZDovLyIgLi4gZGF0YS5BbmltYXRpb25JZAogICAgICAgICAgICBsb2NhbCB0cmFjayA9IGFuaW1hdG9yOkxvYWRBbmltYXRpb24oYW5pbSkKICAgICAgICAgICAgdHJhY2s6UGxheSgpCgogICAgICAgICAgICBpZiBkYXRhLlBsYXlNdXNpYyBhbmQgZGF0YS5NdXNpY0lkIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHNvdW5kID0gSW5zdGFuY2UubmV3KCJTb3VuZCIpCiAgICAgICAgICAgICAgICBzb3VuZC5Tb3VuZElkID0gInJieGFzc2V0aWQ6Ly8iIC4uIGRhdGEuTXVzaWNJZAogICAgICAgICAgICAgICAgc291bmQuVm9sdW1lID0gMQogICAgICAgICAgICAgICAgc291bmQuUGFyZW50ID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiSGVhZCIpIG9yIHBsYXllckd1aQogICAgICAgICAgICAgICAgc291bmQ6UGxheSgpCiAgICAgICAgICAgICAgICBzb3VuZC5FbmRlZDpDb25uZWN0KGZ1bmN0aW9uKCkgc291bmQ6RGVzdHJveSgpIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgbWFrZURyYWdnYWJsZShmcmFtZSkKCiAgICBidG4uVmlzaWJsZSA9IEZyYW1lc0xvY2tlZAogICAgZnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IEZyYW1lc0xvY2tlZCBhbmQgMSBvciAwLjMKCiAgICB0YWJsZS5pbnNlcnQoY3JlYXRlZEZyYW1lcywgZnJh" ..
    "bWUpCmVuZAoKLS0gdOG6oW8gbsO6dApmb3IgaSwgZCBpbiBpcGFpcnMoYnV0dG9uc0RhdGEpIGRvCiAgICBjcmVhdGVGcmFtZVdpdGhCdXR0b24oZCwgc3RhcnRQb3NpdGlvbnNbaV0pCmVuZAoKLS0g8J+MnyBUw61jaCBo4bujcCBUb2dnbGUgKyBJbnB1dApUYWJzLkN1c3RvbTpBZGRUb2dnbGUoIkd1ZXN0MTMzN1NraWxsIiwgewogICAgVGl0bGUgPSAiR3Vlc3QxMzM3IFNraWxsIiwKICAgIERlZmF1bHQgPSBmYWxzZQp9KTpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICBzY3JlZW5HdWkuRW5hYmxlZCA9IHN0YXRlCmVuZCkKClRhYnMuQ3VzdG9tOkFkZFRvZ2dsZSgiR3Vlc3QxMzM3TG9ja0J1dHRvbiIsIHsKICAgIFRpdGxlID0gIkxvY2sgQnV0dG9ucyIsCiAgICBEZWZhdWx0ID0gdHJ1ZQp9KTpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICBGcmFtZXNMb2NrZWQgPSBzdGF0ZQogICAgZm9yIF8sIGZyYW1lIGluIGlwYWlycyhjcmVhdGVkRnJhbWVzKSBkbwogICAgICAgIGxvY2FsIGJ0biA9IGZyYW1lOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSW1hZ2VCdXR0b24iKQogICAgICAgIGlmIGJ0biB0aGVuCiAgICAgICAgICAgIGJ0bi5WaXNpYmxlID0gRnJhbWVzTG9ja2VkCiAgICAgICAgZW5kCiAgICAgICAgZnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IEZyYW1lc0xvY2tlZCBhbmQgMSBvciAwLjMKICAgIGVuZAplbmQpCgpUYWJzLkN1c3RvbTpBZGRJbnB1dCgiUXVlc3QxMzM3U2tpbGxTaXpl" ..
    "IiwgewogICAgVGl0bGUgPSAiQnV0dG9uIFNpemUiLAogICAgRGVmYXVsdCA9IHRvc3RyaW5nKEJVVFRPTl9TSVpFKSwKICAgIFBsYWNlaG9sZGVyID0gIk5o4bqtcCBz4buRIHB4IiwKICAgIE51bWVyaWMgPSB0cnVlLAogICAgRmluaXNoZWQgPSB0cnVlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbih2YWx1ZSkKICAgIGxvY2FsIG51bSA9IHRvbnVtYmVyKHZhbHVlKQogICAgaWYgbnVtIGFuZCBudW0gPiAwIHRoZW4KICAgICAgICBCVVRUT05fU0laRSA9IG51bQogICAgICAgIGZvciBfLCBmcmFtZSBpbiBpcGFpcnMoY3JlYXRlZEZyYW1lcykgZG8KICAgICAgICAgICAgZnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLCBCVVRUT05fU0laRSwgMCwgQlVUVE9OX1NJWkUpCiAgICAgICAgICAgIGxvY2FsIGJ0biA9IGZyYW1lOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSW1hZ2VCdXR0b24iKQogICAgICAgICAgICBpZiBidG4gdGhlbgogICAgICAgICAgICAgICAgYnRuLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQplbmQKCgoKLS0g8J+noCBTZXJ2aWNlcwpnZXRnZW52KCkuU291bmRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJTb3VuZFNlcnZpY2UiKQpnZXRnZW52KCkuUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCgotLSDwn5OBIEVuc3VyZSBmb2xkZXJzIGV4aXN0CmxvY2FsIGZvbGRlclBhdGggPSAiSHV0YW9IdWIv" ..
    "QXNzZXRzIgppZiBub3QgaXNmb2xkZXIoIkh1dGFvSHViIikgdGhlbiBtYWtlZm9sZGVyKCJIdXRhb0h1YiIpIGVuZAppZiBub3QgaXNmb2xkZXIoZm9sZGVyUGF0aCkgdGhlbiBtYWtlZm9sZGVyKGZvbGRlclBhdGgpIGVuZAoKLS0g8J+OtSBUcmFjayBsaXN0IChGVUxMKQpnZXRnZW52KCkudHJhY2tzID0gewogICAgWyJOb25lIl0gPSAiIiwKICAgIFsiLS0tLS0tLS0tLS0gVVNUIC0tLS0tLS0tLS0tIl0gPSBuaWwsCiAgICBbIkEgQlJBVkUgU09VTCAoTVMgNCBLaWxsZXIgVlMgTVMgNCBTdXJ2aXZvcikiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL0ElMjBCUkFWRSUyMFNPVUwlMjAoTVMlMjA0JTIwS2lsbGVyJTIwVlMlMjBNUyUyMDQlMjBTdXJ2aXZvcikubXAzIiwKICAgIFsiQkVHR0VEIChNUyA0IENvb2xraWRkIHZzIE1TIDQgMDA3bjcpIl0gPSAiaHR0cHM6Ly9naXRodWIuY29tL055YW5zYWtlbkh1Yi9OeWFuc2FrZW5IdWIvcmF3L3JlZnMvaGVhZHMvbWFpbi9CRUdHRUQlMjAoTVMlMjA0JTIwQ29vbGtpZGQlMjB2cyUyME1TJTIwNCUyMDAwN243KS5tcDMiLAogICAgWyJET09NU1BJUkUgKEhhaXJ5VHdpbmtsZSBWUyBQZWRyby5FWEUpIl0gPSAiaHR0cHM6Ly9naXRodWIuY29tL055YW5zYWtlbkh1Yi9OeWFuc2FrZW5IdWIvcmF3L3JlZnMvaGVhZHMvbWFpbi9ET09NU1BJUkUlMjAtJTIwKEhhaXJ5VHdpbmtsZSUyMFZTJTIwUGVk" ..
    "cm8uRVhFKS5tcDMiLAogICAgWyJFQ0xJUFNFICh4WDRjZTBmU3BhZGVzWHggdnMgZHJhZ29uZHVkZXMzKSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vRUNMSVBTRSUyMCh4WDRjZTBmU3BhZGVzWHglMjB2cyUyMGRyYWdvbmR1ZGVzMykubXAzIiwKICAgIFsiRVJST1IgMjY0IChOb29iIENvc3BsYXkgVlMgWW91cnNlbGYpIl0gPSAiaHR0cHM6Ly9naXRodWIuY29tL055YW5zYWtlbkh1Yi9OeWFuc2FrZW5IdWIvcmF3L3JlZnMvaGVhZHMvbWFpbi9FUlJPUiUyMDI2NCUyMC0lMjAoTm9vYiUyMENvc3BsYXklMjBWUyUyMFlvdXJzZWxmKS5tcDMiLAogICAgWyJHT0RTIFNFQ09ORCBDT01JTkcgKE5PTEkgVlMuIDAwN243KSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vR09EUyUyMFNFQ09ORCUyMENPTUlORyUyMChOT0xJJTIwVlMuJTIwMDA3bjcpLm1wMyIsCiAgICBbIkVudHJlYXQgKEJsdXVkdWRlIFZzIDExOG84KSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vRW50cmVhdCUyMChCbHV1ZHVkZSUyMFZzJTIwMTE4bzgpLm1wMyIsCiAgICBbIkltcGxvcmUgKENvbWljIHZzIFNhdmlvcikiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcv" ..
    "cmVmcy9oZWFkcy9tYWluL0ltcGxvcmUlMjAoQ29taWMlMjB2cyUyMFNhdmlvciklMjAtJTIwWW91VHViZS5tcDMiLAogICAgWyJMZWZ0b3ZlcnMgKFJlbWl4IFZhbml0eSBKYXNvbiBWcyBBbGwpIl0gPSAiaHR0cHM6Ly9naXRodWIuY29tL055YW5zYWtlbkh1Yi9OeWFuc2FrZW5IdWIvcmF3L3JlZnMvaGVhZHMvbWFpbi9MZWZ0b3ZlcnMlMjAoUmVtaXglMjBWYW5pdHklMjBKYXNvbiUyMFZzJTIwQWxsKS5tcDMiLAogICAgWyJPUkRFUiBVUCAoRWxsaW90IFZTIGMwMGxraWRkKSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vT1JERVIlMjBVUCUyMC0lMjAoRWxsaW90JTIwVlMlMjBjMDBsa2lkZCkubXAzIiwKICAgIFsiUEFSQURPWCAoR3Vlc3QgNjY2IFZzIEd1ZXN0IDEzMzcpIl0gPSAiaHR0cHM6Ly9naXRodWIuY29tL055YW5zYWtlbkh1Yi9OeWFuc2FrZW5IdWIvcmF3L3JlZnMvaGVhZHMvbWFpbi9QQVJBRE9YJTIwKEd1ZXN0JTIwNjY2JTIwVnMlMjBHdWVzdCUyMDEzMzcpLm1wMyIsCiAgICBbIlRSVUUgQkVBVVRZIChQUkVUVFlQUklOQ0VTUyB2cyAyMjZ3NikiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL1RSVUUlMjBCRUFVVFklMjAoUFJFVFRZUFJJTkNFU1MlMjB2cyUyMDIyNnc2KS5tcDMiLAogICAgWyJGYWxsIG9mIGEgSGVybyAoU0xBU0hFUiB2cyBH" ..
    "VUVTVCAxMzM3KSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vJTVCU0xBU0hFUiUyMHZzJTIwR1VFU1QlMjAxMzM3JTIwLSUyMExBU1QlMjBNQU4lMjBTVEFORElORyU1RCUyMEZhbGwlMjBvZiUyMGElMjBIZXJvJTIwLSUyMEZvcnNha2VuJTIwVVNULm1wMyIsCiAgICBbIjIxU1QgQ0VOVFVSWSBIVU1PUiAoTUxHIENoYW5jZSB2cyBIb29kIElyb255IFdoaXN0bGUgT2NjdXJyZW5jZSkiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluLzIxU1QlMjBDRU5UVVJZJTIwSFVNT1IlMjAtJTIwTGFzdCUyME1hbiUyMFN0YW5kaW5nJTIwKE1MRyUyMENoYW5jZSUyMHZzJTIwSG9vZCUyMElyb255JTIwV2hpc3RsZSUyME9jY3VycmVuY2UpJTIwJTIwRm9yc2FrZW4lMjBVU1QubXAzIiwKICAgIFsiU0hBVFRFUkVEIEdSQUNFIChHUjFNWCAxeDF4MXgxIHZzLiBBTkdFTCBTSEVETEVUU0tZKSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vU0hBVFRFUkVEJTIwR1JBQ0UlMjAlNUJHUjFNWCUyMDF4MXgxeDElMjB2cy4lMjBBTkdFTCUyMFNIRURMRVRTS1klMjBMQVNUJTIwTUFOJTIwU1RBTkRJTkclNUQlMjAoUm9ibG94JTIwRm9yc2FrZW4lMjBVU1QpLm1wMyIsCiAgICBbIi0tLS0tLS0tLS0tIFNjcmFw" ..
    "cGVkIExNUyAtLS0tLS0tLS0tLSJdID0gbmlsLAogICAgWyJUSEUgREFSS05FU1MgSU4gWU9VUiBIRUFSVCAoT2xkIDF4NCBWcyBTaGVkbGV0c2t5KSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vVEhFJTIwREFSS05FU1MlMjBJTiUyMFlPVVIlMjBIRUFSVCUyMChPbGQlMjAxeDQlMjBWcyUyMFNoZWRsZXRza3kpLm1wMyIsCiAgICBbIk1FRVQgWU9VUiBNQUtJTkcgKGMwMGxraWRkIH4gMXg0IFZzIDAwN243IH4gU2hlZGxldHNreSkiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL01FRVQlMjBZT1VSJTIwTUFLSU5HJTIwKGMwMGxraWRkJTIwfiUyMDF4NCUyMFZzJTIwMDA3bjclMjB+JTIwU2hlZGxldHNreSkubXAzIiwKICAgIFsiQSBDcmVhdGlvbiBPZiBTb3Jyb3cgKEhhY2tsb3JkIHZzIFRoZSBIZWFydGJyb2tlbikiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL0ElMjBDcmVhdGlvbiUyME9mJTIwU29ycm93JTIwKEhhY2tsb3JkJTIwdnMlMjBUaGUlMjBIZWFydGJyb2tlbikubXAzIiwKICAgIFsiRGVidGggKE5hdHJhc2hhIFZzIE1hZmlvc28pIl0gPSAiaHR0cHM6Ly9naXRodWIuY29tL055YW5zYWtlbkh1Yi9OeWFuc2FrZW5IdWIvcmF3L3JlZnMvaGVhZHMvbWFpbi9EZWJ0aCUy" ..
    "MChOYXRyYXNoYSUyMFZzJTIwTWFmaW9zbykubXAzIiwKICAgIFsiRVRFUk5BTCBIT1BFLCBFVEVSTkFMIEZJR0hUIChPbGQgTE1TKSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vRVRFUk5BTCUyMEhPUEUsJTIwRVRFUk5BTCUyMEZJR0hUJTIwKE9sZCUyMExNUykubXAzIiwKICAgIFsiUmVjZWFkaW5nIExpZmVzcGFuIChCYXJiZXIgSmFzb24gVnMgQmFsZCBUd28gVGltZSkiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL1JlY2VhZGluZyUyMExpZmVzcGFuJTIwKEJhcmJlciUyMEphc29uJTIwVnMlMjBCYWxkJTIwVHdvJTIwVGltZSkubXAzIiwKICAgIFsiVklQIEphc29uIExNUyAoVklQIEphc29uIFZzIEFsbCkiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL1ZJUCUyMEphc29uJTIwTE1TJTIwKFZJUCUyMEphc29uJTIwVnMlMjBBbGwpLm1wMyIsCiAgICBbIkphc29uIEhhdGUgVGhpcyBTb25nIl0gPSAiaHR0cHM6Ly9naXRodWIuY29tL055YW5zYWtlbkh1Yi9OeWFuc2FrZW5IdWIvcmF3L3JlZnMvaGVhZHMvbWFpbi9DYWxpZm9ybmlhJTIwR3VybHMlMjAlMjBBdWRpbyUyMEVkaXQlMjAtJTIwTmVvbmljay5tcDMiLAogICAgWyItLS0tLS0tLS0tLSBPZmZpY2lhbCBMTVMgLS0tLS0t" ..
    "LS0tLS0iXSA9IG5pbCwKICAgIFsiQSBHUkFWRSBTT1VMIChOT1csIFJVTikgW0FsbCBLaWxsZXJzIFZzIEFsbCBTdXJ2aXZvcnNdIl0gPSAiaHR0cHM6Ly9naXRodWIuY29tL055YW5zYWtlbkh1Yi9OeWFuc2FrZW5IdWIvcmF3L3JlZnMvaGVhZHMvbWFpbi9BJTIwR1JBVkUlMjBTT1VMJTIwKE5PVywlMjBSVU4pJTIwJTVCQWxsJTIwS2lsbGVycyUyMFZzJTIwQWxsJTIwU3Vydml2b3JzJTVELm1wMyIsCiAgICBbIlBsZWFkIChjMDBsa2lkZCBWcyAwMDduNykiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL1BsZWFkJTIwKGMwMGxraWRkJTIwVnMlMjAwMDduNykubXAzIiwKICAgIFsiU01JTEUgKEN1cGNha2VzIFZzIEFsbCkiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL1NNSUxFJTIwKEN1cGNha2VzJTIwVnMlMjBBbGwpJTIwLm1wMyIsCiAgICBbIlZhbml0eSAoVmFuaXR5IEphc29uIFZzIEFsbCkiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL1Zhbml0eSUyMChWYW5pdHklMjBKYXNvbiUyMFZzJTIwQWxsKS5tcDMiLAogICAgWyJPYnNlc3Npb24gKEdhc2hhcnBvb24gVnMgQWxsKSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZz" ..
    "L2hlYWRzL21haW4vT2JzZXNzaW9uJTIwKEdhc2hhcnBvb24lMjBWcyUyMEFsbCkuTVAzIiwKICAgIFsiQnVybm91dCAoRGl2YSBWcyBHaG91bCkiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL0J1cm5vdXQlMjAoRGl2YSUyMFZzJTIwR2hvdWwpLm1wMyIsCiAgICBbIkNsb3NlIFRvIE1lIChBbm5paGlsYXRpb24gVnMgRnJpZW5kKSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vQ2xvc2UlMjBUbyUyME1lJTIwKEFubmloaWxhdGlvbiUyMFZzJTIwRnJpZW5kKS5tcDMiLAogICAgWyJDcmVhdGlvbiBPZiBIYXRyZWQgKDFYNCBWcyBTaGVkbGV0c2t5KSJdID0gImh0dHBzOi8vZ2l0aHViLmNvbS9OeWFuc2FrZW5IdWIvTnlhbnNha2VuSHViL3Jhdy9yZWZzL2hlYWRzL21haW4vQ3JlYXRpb24lMjBPZiUyMEhhdHJlZCUyMCgxWDQlMjBWcyUyMFNoZWRsZXRza3kpLm1wMyIsCiAgICBbIlRocm91Z2ggUGF0Y2hlcyBvZiBWaW9sZXQgKEhhY2tsb3JkIHZzIFRoZSBIZWFydGJyb2tlbikiXSA9ICJodHRwczovL2dpdGh1Yi5jb20vTnlhbnNha2VuSHViL055YW5zYWtlbkh1Yi9yYXcvcmVmcy9oZWFkcy9tYWluL1Rocm91Z2glMjBQYXRjaGVzJTIwb2YlMjBWaW9sZXQlMjAoSGFja2xvcmQlMjB2cyUyMFRoZSUyMEhlYXJ0YnJva2VuKS5tcDMiCn0KCi0tIPCflL0gRHJvcGRv" ..
    "d24gb3B0aW9ucwpsb2NhbCBvcHRpb25zID0ge30KZm9yIGssIF8gaW4gcGFpcnMoZ2V0Z2VudigpLnRyYWNrcykgZG8KICAgIHRhYmxlLmluc2VydChvcHRpb25zLCBrKQplbmQKCi0tIPCfjJAgR2xvYmFscwpnZXRnZW52KCkuc2VsZWN0ZWRTb25nID0gIk5vbmUiCmdldGdlbnYoKS5jdXN0b21Tb25nVXJsID0gbmlsCmdldGdlbnYoKS5vcmlnaW5hbFNvbmdJZCA9IG5pbApnZXRnZW52KCkuaXNQbGF5aW5nID0gZmFsc2UKZ2V0Z2VudigpLmlzVG9nZ2xlT24gPSBmYWxzZQoKLS0g8J+SviBEb3dubG9hZCBzb25nIChvbmx5IG9uZSBhdCBhIHRpbWUpCmxvY2FsIGZ1bmN0aW9uIGRvd25sb2FkVHJhY2sobmFtZSwgdXJsKQogICAgaWYgbm90IHVybCBvciB1cmwgPT0gIiIgdGhlbiByZXR1cm4gbmlsIGVuZAogICAgbG9jYWwgcGF0aCA9IGZvbGRlclBhdGggLi4gIi8iIC4uIG5hbWU6Z3N1YigiW14ld10iLCAiXyIpIC4uICIubXAzIgogICAgaWYgbm90IGlzZmlsZShwYXRoKSB0aGVuCiAgICAgICAgbG9jYWwgcmVxID0gaHR0cF9yZXF1ZXN0IG9yIHN5bi5yZXF1ZXN0IG9yIHJlcXVlc3QKICAgICAgICBsb2NhbCByZXMgPSByZXEoe1VybCA9IHVybCwgTWV0aG9kID0gIkdFVCJ9KQogICAgICAgIGxvY2FsIGRhdGEgPSByZXMuQm9keSBvciByZXMuQm9keVJhdwogICAgICAgIGlmIGRhdGEgYW5kICNkYXRhID4gMCB0aGVuIHdyaXRlZmlsZShwYXRoLCBkYXRhKSBlbmQKICAgIGVuZAogICAgcmV0dXJuIHBhdGgKZW5kCgot" ..
    "LSDwn5SNIEZpbmQgTGFzdFN1cnZpdm9yCmxvY2FsIGZ1bmN0aW9uIGdldExhc3RTdXJ2aXZvcigpCiAgICBsb2NhbCB0ID0gd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJUaGVtZXMiKQogICAgaWYgdCB0aGVuIHJldHVybiB0OkZpbmRGaXJzdENoaWxkKCJMYXN0U3Vydml2b3IiKSBlbmQKICAgIHJldHVybiBuaWwKZW5kCgotLSDilrbvuI8gU2V0ICYgcGxheSB0cmFjawpsb2NhbCBmdW5jdGlvbiBzZXRMYXN0U3Vydml2b3JTb25nKHNvbmdOYW1lKQogICAgbG9jYWwgbHMgPSBnZXRMYXN0U3Vydml2b3IoKQogICAgaWYgbm90IGxzIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgdXJsID0gZ2V0Z2VudigpLnRyYWNrc1tzb25nTmFtZV0KICAgIGlmIG5vdCB1cmwgb3IgdXJsID09ICIiIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgcGF0aCA9IGRvd25sb2FkVHJhY2soc29uZ05hbWUsIHVybCkKICAgIGlmIG5vdCBwYXRoIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgc291bmQgPSBnZXRjdXN0b21hc3NldChwYXRoKQogICAgaWYgbm90IGdldGdlbnYoKS5vcmlnaW5hbFNvbmdJZCB0aGVuCiAgICAgICAgZ2V0Z2VudigpLm9yaWdpbmFsU29uZ0lkID0gbHMuU291bmRJZAogICAgZW5kCiAgICBscy5Tb3VuZElkID0gc291bmQKICAgIGxzOlBsYXkoKQogICAgZ2V0Z2VudigpLmlzUGxheWluZyA9IHRydWUKZW5kCgotLSDwn46b77iPIEdVSSBTZWN0aW9uClRhYnMuQ3VzdG9tOkFkZFNlY3Rpb24oIuKGsyBMYXN0IE1h" ..
    "biBTdGFuZGluZyIpCgpUYWJzLkN1c3RvbTpBZGRUb2dnbGUoIkxNU1JlcGxhY2VyU29uZyIsIHsKICAgIFRpdGxlID0gIkxNUyBSZXBsYWNlciBTb25nIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLmlzVG9nZ2xlT24gPSBWYWx1ZQogICAgICAgIGxvY2FsIGxzID0gZ2V0TGFzdFN1cnZpdm9yKCkKICAgICAgICBpZiBub3QgVmFsdWUgdGhlbgogICAgICAgICAgICBpZiBscyBhbmQgZ2V0Z2VudigpLm9yaWdpbmFsU29uZ0lkIHRoZW4KICAgICAgICAgICAgICAgIGxzLlNvdW5kSWQgPSBnZXRnZW52KCkub3JpZ2luYWxTb25nSWQKICAgICAgICAgICAgICAgIGxzOlBsYXkoKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgZ2V0Z2VudigpLmlzUGxheWluZyA9IGZhbHNlCiAgICAgICAgICAgIGdldGdlbnYoKS5vcmlnaW5hbFNvbmdJZCA9IG5pbAogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgZ2V0Z2VudigpLnNlbGVjdGVkU29uZyB+PSAiTm9uZSIgdGhlbgogICAgICAgICAgICAgICAgc2V0TGFzdFN1cnZpdm9yU29uZyhnZXRnZW52KCkuc2VsZWN0ZWRTb25nKQogICAgICAgICAgICBlbHNlaWYgZ2V0Z2VudigpLmN1c3RvbVNvbmdVcmwgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgcGF0aCA9IGRvd25sb2FkVHJhY2soIkN1c3RvbV9MTVNfU29uZyIsIGdldGdlbnYoKS5jdXN0b21Tb25nVXJsKQogICAgICAgICAgICAgICAg" ..
    "aWYgcGF0aCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc291bmQgPSBnZXRjdXN0b21hc3NldChwYXRoKQogICAgICAgICAgICAgICAgICAgIGlmIGxzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Z2VudigpLm9yaWdpbmFsU29uZ0lkID0gbHMuU291bmRJZAogICAgICAgICAgICAgICAgICAgICAgICBscy5Tb3VuZElkID0gc291bmQKICAgICAgICAgICAgICAgICAgICAgICAgbHM6UGxheSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCmxvY2FsIGRyb3Bkb3duID0gVGFicy5DdXN0b206QWRkRHJvcGRvd24oIkN1c3RvbUxNU1NvbmciLCB7CiAgICBUaXRsZSA9ICJTZWNsZWN0IExNUyBTb25nIiwKICAgIFZhbHVlcyA9IG9wdGlvbnMsCiAgICBNdWx0aSA9IGZhbHNlLAogICAgRGVmYXVsdCA9ICJOb25lIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLnNlbGVjdGVkU29uZyA9IFZhbHVlCiAgICAgICAgLS0g4p2MIEfhu6EgYuG7jyBkw7JuZyBnw6J5IGzhu5dpCiAgICAgICAgLS0gZHJvcGRvd246U2V0VmFsdWUoVmFsdWUpCiAgICBlbmQKfSkKClRhYnMuQ3VzdG9tOkFkZElucHV0KCJDdXN0b21MTVNTb25nVVJMIiwgewogICAgVGl0bGUgPSAiQ3VzdG9tIExNUyIsCiAgICBEZWZhdWx0ID0gIiIsCiAgICBQbGFjZWhvbGRlciA9ICJFbnRlciBy" ..
    "YXcgTVAzIFVSTCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGlucHV0IGFuZCBpbnB1dCB+PSAiIiB0aGVuCiAgICAgICAgICAgIGdldGdlbnYoKS5jdXN0b21Tb25nVXJsID0gaW5wdXQKICAgICAgICAgICAgaWYgZ2V0Z2VudigpLmlzVG9nZ2xlT24gdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgbHMgPSBnZXRMYXN0U3Vydml2b3IoKQogICAgICAgICAgICAgICAgaWYgbHMgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHBhdGggPSBkb3dubG9hZFRyYWNrKCJDdXN0b21fTE1TX1NvbmciLCBpbnB1dCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBzb3VuZCA9IGdldGN1c3RvbWFzc2V0KHBhdGgpCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGdldGdlbnYoKS5vcmlnaW5hbFNvbmdJZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5vcmlnaW5hbFNvbmdJZCA9IGxzLlNvdW5kSWQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBscy5Tb3VuZElkID0gc291bmQKICAgICAgICAgICAgICAgICAgICBsczpQbGF5KCkKICAgICAgICAgICAgICAgICAgICBnZXRnZW52KCkuaXNQbGF5aW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSDimbvvuI8gTWFpbnRhaW4gcGxheWJhY2sKUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlv" ..
    "bigpCiAgICBsb2NhbCBscyA9IGdldExhc3RTdXJ2aXZvcigpCiAgICBpZiBnZXRnZW52KCkuaXNUb2dnbGVPbiBhbmQgbHMgdGhlbgogICAgICAgIC0tIGNo4buJIHBow6F0IGzhuqFpIG7hur91IGNoxrBhIHBow6F0IGhv4bq3YyDEkcOjIGThu6tuZwogICAgICAgIGlmIG5vdCBscy5Jc1BsYXlpbmcgdGhlbgogICAgICAgICAgICBzZXRMYXN0U3Vydml2b3JTb25nKGdldGdlbnYoKS5zZWxlY3RlZFNvbmcpCiAgICAgICAgZW5kCiAgICBlbHNlaWYgbm90IGdldGdlbnYoKS5pc1RvZ2dsZU9uIGFuZCBscyBhbmQgZ2V0Z2VudigpLm9yaWdpbmFsU29uZ0lkIGFuZCBscy5Tb3VuZElkIH49IGdldGdlbnYoKS5vcmlnaW5hbFNvbmdJZCB0aGVuCiAgICAgICAgLS0ga2hpIHThuq90IHRvZ2dsZSwga2jDtGkgcGjhu6VjIG5o4bqhYyBn4buRYwogICAgICAgIGxzLlNvdW5kSWQgPSBnZXRnZW52KCkub3JpZ2luYWxTb25nSWQKICAgICAgICBsczpQbGF5KCkKICAgICAgICBnZXRnZW52KCkuaXNQbGF5aW5nID0gZmFsc2UKICAgIGVuZAplbmQpCgoKClRhYnMuQ3VzdG9tOkFkZFNlY3Rpb24oIuKGsyBWaWN0aW0iKQoKLS0gSGFja2VyVmliZV9Ub2dnbGUubHVhCi0tIEhp4buHdSDhu6luZyBoYWNrZXIgdGjhuq10IDNELCBjw7MgbsO6dCBi4bqtdC904bqvdCAoRmFrZSBINENLM1IpCi0tIELhuqNvIHRvw6BuIHNhdSBraGkgY2jhur90LCDEkeG7lWkgY2hhcmFjdGVyLCBraMO0bmcgcnVuZyBnaeG6rXQKLS0gSGnhu4d1IOG7qW5n" ..
    "IGhhY2tlciAzRCArIGFuaW1hdGlvbiB04buxIGLhuq10L3Thuq90Cgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgVHdlZW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKQpsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQoKLS0g4pqZ77iPIENPTkZJRwpsb2NhbCBvdXRsaW5lQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDI1NSkKbG9jYWwgYmluYXJ5U3Bhd25JbnRlcnZhbCA9IDAuMTIKbG9jYWwgYmluYXJ5TGlmZXRpbWUgPSAxLjgKbG9jYWwgYmluYXJ5UmlzZURpc3RhbmNlID0gNQpsb2NhbCBiaW5hcnlNaW5TY2FsZSA9IDAuNgpsb2NhbCBiaW5hcnlNYXhTY2FsZSA9IDEuMQpsb2NhbCBtYXhTaW11bHRhbmVvdXMgPSA0MApsb2NhbCBzcGF3blJhZGl1cyA9IDMKbG9jYWwgYW5pbWF0aW9uSWQgPSAicmJ4YXNzZXRpZDovLzg2NTU5MjExMTg0NjAxIiAtLSDwn6egIEFuaW1hdGlvbiBIYWNrZXIKCm1hdGgucmFuZG9tc2VlZCh0aWNrKCkgKyBwbGF5ZXIuVXNlcklkKQoKLS0gPT09IEJp4bq/biA9PT0KbG9jYWwgYWN0aXZlID0gMApsb2NhbCBydW5uaW5nID0gZmFsc2UKbG9jYWwgZm9sZGVyTmFtZSA9ICJIYWNrZXJGWDNEIgpsb2NhbCBmb2xkZXIgPSBuaWwKbG9jYWwgYW5pbVRyYWNrID0gbmlsCgotLSA9" ..
    "PT0gRGFuaCBzw6FjaCBwYXJ0IMSR4buDIHNwYXduIGNo4buvID09PQpsb2NhbCBwYXJ0TmFtZXMgPSB7CgkiSGVhZCIsIkh1bWFub2lkUm9vdFBhcnQiLAoJIlVwcGVyVG9yc28iLCJMb3dlclRvcnNvIiwiVG9yc28iLAoJIkxlZnRVcHBlckFybSIsIlJpZ2h0VXBwZXJBcm0iLCJMZWZ0TG93ZXJBcm0iLCJSaWdodExvd2VyQXJtIiwKCSJMZWZ0VXBwZXJMZWciLCJSaWdodFVwcGVyTGVnIiwiTGVmdExvd2VyTGVnIiwiUmlnaHRMb3dlckxlZyIsCgkiTGVmdEhhbmQiLCJSaWdodEhhbmQiLCJMZWZ0Rm9vdCIsIlJpZ2h0Rm9vdCIKfQoKbG9jYWwgZnVuY3Rpb24gZ2V0UGFydHMoKQoJY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCglsb2NhbCBsaXN0ID0ge30KCWZvciBfLCBuYW1lIGluIGlwYWlycyhwYXJ0TmFtZXMpIGRvCgkJbG9jYWwgcGFydCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZChuYW1lKQoJCWlmIHBhcnQgYW5kIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KCQkJdGFibGUuaW5zZXJ0KGxpc3QsIHBhcnQpCgkJZW5kCgllbmQKCXJldHVybiBsaXN0CmVuZAoKLS0gPT09IEhpZ2hsaWdodCBIYWNrZXIgPT09CmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZUhpZ2hsaWdodCgpCglsb2NhbCBvbGQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkhhY2tlckhpZ2hsaWdodCIpCglpZiBvbGQgdGhlbiBvbGQ6RGVzdHJveSgpIGVuZAoJbG9jYWwgaCA9IElu" ..
    "c3RhbmNlLm5ldygiSGlnaGxpZ2h0IikKCWguTmFtZSA9ICJIYWNrZXJIaWdobGlnaHQiCgloLkFkb3JuZWUgPSBjaGFyYWN0ZXIKCWguT3V0bGluZUNvbG9yID0gb3V0bGluZUNvbG9yCgloLkZpbGxUcmFuc3BhcmVuY3kgPSAxCgloLk91dGxpbmVUcmFuc3BhcmVuY3kgPSAwCgloLlBhcmVudCA9IGNoYXJhY3RlcgplbmQKCi0tID09PSBGb2xkZXIgaGnhu4d1IOG7qW5nID09PQpsb2NhbCBmdW5jdGlvbiBlbnN1cmVGb2xkZXIoKQoJZm9sZGVyID0gcGxheWVyOldhaXRGb3JDaGlsZCgiUGxheWVyR3VpIik6RmluZEZpcnN0Q2hpbGQoZm9sZGVyTmFtZSkKCWlmIG5vdCBmb2xkZXIgdGhlbgoJCWZvbGRlciA9IEluc3RhbmNlLm5ldygiRm9sZGVyIikKCQlmb2xkZXIuTmFtZSA9IGZvbGRlck5hbWUKCQlmb2xkZXIuUGFyZW50ID0gcGxheWVyOldhaXRGb3JDaGlsZCgiUGxheWVyR3VpIikKCWVuZAoJcmV0dXJuIGZvbGRlcgplbmQKCi0tID09PSBIaeG7h3Ug4bupbmcgc+G7kSBiYXkgPT09CmxvY2FsIGZ1bmN0aW9uIHNwYXduQmluYXJ5KCkKCWlmIG5vdCBydW5uaW5nIHRoZW4gcmV0dXJuIGVuZAoJaWYgYWN0aXZlID49IG1heFNpbXVsdGFuZW91cyB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBwYXJ0cyA9IGdldFBhcnRzKCkKCWlmICNwYXJ0cyA9PSAwIHRoZW4gcmV0dXJuIGVuZAoJbG9jYWwgb3JpZ2luID0gcGFydHNbbWF0aC5yYW5kb20oMSwgI3BhcnRzKV0KCWlmIG5vdCBvcmlnaW4gdGhlbiByZXR1cm4gZW5kCgoJ" ..
    "YWN0aXZlICs9IDEKCWxvY2FsIHMgPSAiIgoJZm9yIGkgPSAxLCBtYXRoLnJhbmRvbSgxLCAzKSBkbwoJCXMgLi49IHRvc3RyaW5nKG1hdGgucmFuZG9tKDAsIDEpKQoJZW5kCgoJbG9jYWwgYXR0YWNoID0gSW5zdGFuY2UubmV3KCJQYXJ0IikKCWF0dGFjaC5BbmNob3JlZCA9IGZhbHNlCglhdHRhY2guQ2FuQ29sbGlkZSA9IGZhbHNlCglhdHRhY2guVHJhbnNwYXJlbmN5ID0gMQoJYXR0YWNoLlNpemUgPSBWZWN0b3IzLm5ldygwLjIsIDAuMiwgMC4yKQoJYXR0YWNoLlBhcmVudCA9IGVuc3VyZUZvbGRlcigpCgoJbG9jYWwgd2VsZCA9IEluc3RhbmNlLm5ldygiV2VsZENvbnN0cmFpbnQiKQoJd2VsZC5QYXJ0MCA9IGF0dGFjaAoJd2VsZC5QYXJ0MSA9IG9yaWdpbgoJd2VsZC5QYXJlbnQgPSBhdHRhY2gKCglsb2NhbCB4T2ZmID0gKG1hdGgucmFuZG9tKCkgLSAwLjUpICogc3Bhd25SYWRpdXMKCWxvY2FsIHlPZmYgPSAobWF0aC5yYW5kb20oKSAtIDAuNSkgKiBzcGF3blJhZGl1cwoJbG9jYWwgek9mZiA9IChtYXRoLnJhbmRvbSgpIC0gMC41KSAqIHNwYXduUmFkaXVzCglhdHRhY2guQ0ZyYW1lID0gb3JpZ2luLkNGcmFtZSAqIENGcmFtZS5uZXcoeE9mZiwgeU9mZiwgek9mZikKCglsb2NhbCBiYiA9IEluc3RhbmNlLm5ldygiQmlsbGJvYXJkR3VpIikKCWJiLlNpemUgPSBVRGltMi5uZXcoMCwgODAsIDAsIDMwKQoJYmIuQWx3YXlzT25Ub3AgPSB0cnVlCgliYi5BZG9ybmVlID0gYXR0YWNoCgliYi5QYXJlbnQgPSBmb2xk" ..
    "ZXIKCglsb2NhbCB0eHQgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCgl0eHQuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKCXR4dC5Cb3JkZXJTaXplUGl4ZWwgPSAwCgl0eHQuU2l6ZSA9IFVEaW0yLmZyb21TY2FsZSgxLCAxKQoJdHh0LkZvbnQgPSBFbnVtLkZvbnQuQ29kZQoJdHh0LlRleHQgPSBzCgl0eHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMjAwKQoJdHh0LlRleHRTY2FsZWQgPSB0cnVlCgl0eHQuVGV4dFRyYW5zcGFyZW5jeSA9IDAKCXR4dC5QYXJlbnQgPSBiYgoJdHh0LlRleHRTaXplID0gMjAgKiAobWF0aC5yYW5kb20oKSAqIChiaW5hcnlNYXhTY2FsZSAtIGJpbmFyeU1pblNjYWxlKSArIGJpbmFyeU1pblNjYWxlKQoKCWxvY2FsIGdvYWwgPSBhdHRhY2guUG9zaXRpb24gKyBWZWN0b3IzLm5ldygwLCBiaW5hcnlSaXNlRGlzdGFuY2UsIDApCglsb2NhbCBtb3ZlVHdlZW4gPSBUd2VlblNlcnZpY2U6Q3JlYXRlKGF0dGFjaCwgVHdlZW5JbmZvLm5ldyhiaW5hcnlMaWZldGltZSwgRW51bS5FYXNpbmdTdHlsZS5MaW5lYXIpLCB7UG9zaXRpb24gPSBnb2FsfSkKCWxvY2FsIGZhZGVUd2VlbiA9IFR3ZWVuU2VydmljZTpDcmVhdGUodHh0LCBUd2VlbkluZm8ubmV3KGJpbmFyeUxpZmV0aW1lLCBFbnVtLkVhc2luZ1N0eWxlLkxpbmVhciksIHtUZXh0VHJhbnNwYXJlbmN5ID0gMX0pCgltb3ZlVHdlZW46UGxheSgpCglmYWRlVHdlZW46UGxheSgpCgoJdGFzay5kZWxheShiaW5hcnlM" ..
    "aWZldGltZSArIDAuMDUsIGZ1bmN0aW9uKCkKCQlwY2FsbChmdW5jdGlvbigpCgkJCWJiOkRlc3Ryb3koKQoJCQlhdHRhY2g6RGVzdHJveSgpCgkJZW5kKQoJCWFjdGl2ZSA9IG1hdGgubWF4KDAsIGFjdGl2ZSAtIDEpCgllbmQpCmVuZAoKLS0gPT09IExvb3Agc3Bhd24gY2jhu68gPT09CnRhc2suc3Bhd24oZnVuY3Rpb24oKQoJd2hpbGUgdHJ1ZSBkbwoJCWlmIHJ1bm5pbmcgdGhlbgoJCQlzcGF3bkJpbmFyeSgpCgkJZW5kCgkJdGFzay53YWl0KGJpbmFyeVNwYXduSW50ZXJ2YWwpCgllbmQKZW5kKQoKLS0gPT09IEtoaSByZXNwYXduIC8gxJHhu5VpIG5ow6JuIHbhuq10ID09PQpwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihjaGFyKQoJY2hhcmFjdGVyID0gY2hhcgoJdGFzay53YWl0KDAuMjUpCglpZiBydW5uaW5nIHRoZW4KCQljcmVhdGVIaWdobGlnaHQoKQoKCQktLSDwn5SEIFBow6F0IGzhuqFpIGFuaW1hdGlvbiBu4bq/dSDEkWFuZyBi4bqtdAoJCWxvY2FsIGh1bSA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKCQlpZiBodW0gdGhlbgoJCQlsb2NhbCBhbmltID0gSW5zdGFuY2UubmV3KCJBbmltYXRpb24iKQoJCQlhbmltLkFuaW1hdGlvbklkID0gYW5pbWF0aW9uSWQKCQkJYW5pbVRyYWNrID0gaHVtOkxvYWRBbmltYXRpb24oYW5pbSkKCQkJYW5pbVRyYWNrOlBsYXkoKQoJCQlhbmltVHJhY2suTG9vcGVkID0gdHJ1ZQoJCWVuZAoJZW5kCmVuZCkKCi0t" ..
    "ID09PSBIw4BNIENIw41OSCBC4bqsVCAvIFThuq5UID09PQpsb2NhbCBmdW5jdGlvbiBUb2dnbGVGYWtlSGFja2VyKHN0YXRlKQoJcnVubmluZyA9IHN0YXRlCgoJbG9jYWwgaGlnaGxpZ2h0ID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIYWNrZXJIaWdobGlnaHQiKQoJaWYgbm90IGhpZ2hsaWdodCBhbmQgc3RhdGUgdGhlbgoJCWNyZWF0ZUhpZ2hsaWdodCgpCgllbmQKCglpZiBoaWdobGlnaHQgdGhlbgoJCWhpZ2hsaWdodC5PdXRsaW5lVHJhbnNwYXJlbmN5ID0gc3RhdGUgYW5kIDAgb3IgMQoJZW5kCgoJaWYgc3RhdGUgdGhlbgoJCWVuc3VyZUZvbGRlcigpLlBhcmVudCA9IHBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpCgoJCS0tIPCfjqwgQuG6r3QgxJHhuqd1IGFuaW1hdGlvbgoJCWxvY2FsIGh1bSA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKCQlpZiBodW0gdGhlbgoJCQlsb2NhbCBhbmltID0gSW5zdGFuY2UubmV3KCJBbmltYXRpb24iKQoJCQlhbmltLkFuaW1hdGlvbklkID0gYW5pbWF0aW9uSWQKCQkJYW5pbVRyYWNrID0gaHVtOkxvYWRBbmltYXRpb24oYW5pbSkKCQkJYW5pbVRyYWNrLkxvb3BlZCA9IHRydWUKCQkJYW5pbVRyYWNrOlBsYXkoKQoJCWVuZAoJZWxzZQoJCS0tIPCfm5EgROG7q25nIGFuaW1hdGlvbgoJCWlmIGFuaW1UcmFjayB0aGVuCgkJCWFuaW1UcmFjazpTdG9wKCkKCQkJYW5pbVRyYWNrOkRlc3Ryb3koKQoJCQlhbmltVHJhY2sgPSBu" ..
    "aWwKCQllbmQKCgkJLS0g8J+nuSBYw7NhIGhp4buHdSDhu6luZyBjaOG7rwoJCWxvY2FsIGYgPSBwbGF5ZXIuUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKGZvbGRlck5hbWUpCgkJaWYgZiB0aGVuCgkJCWZvciBfLCB2IGluIGlwYWlycyhmOkdldENoaWxkcmVuKCkpIGRvCgkJCQl2OkRlc3Ryb3koKQoJCQllbmQKCQllbmQKCWVuZAplbmQKCi0tID09PSBH4bquTiBWw4BPIFVJICh2w60gZOG7pSBGbHVlbnQpID09PQpUYWJzLkN1c3RvbTpBZGRUb2dnbGUoIkZha2VINENLM1IiLCB7CglUaXRsZSA9ICJGYWtlIEg0Q0szUiIsCglEZWZhdWx0ID0gZmFsc2UsCglDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQoJCVRvZ2dsZUZha2VIYWNrZXIoVmFsdWUpCgllbmQKfSkKCgotLSBUYWJzLlBsYXllcgoKCgotLSA9PT09PT09IEThu4pDSCBW4bukID09PT09PT0KbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCi0tID09PT09PT0gV0hJVEVMSVNUID09PT09PT0KbG9jYWwgQWxsb3dlZFBsYXllcnMgPSB7CiAgICBbIk5vb2IiXSA9IHRydWUsIFsiR3Vlc3QxMzM3Il0gPSB0cnVlLCBbIkVsbGlvdCJdID0gdHJ1ZSwKICAgIFsiU2hlZGxldHNreSJdID0gdHJ1ZSwgWyJUd29UaW1lIl0gPSB0cnVlLCBbIjAwN243Il0gPSB0cnVlLAogICAgWyJD" ..
    "aGFuY2UiXSA9IHRydWUsIFsiQnVpbGRlcm1hbiJdID0gdHJ1ZSwgWyJUYXBoIl0gPSB0cnVlLAogICAgWyJEdXNla2thciJdID0gdHJ1ZSwgWyJWZWVyb25pY2EiXSA9IHRydWUsCn0KCmxvY2FsIEFsbG93ZWRLaWxsZXJzID0gewogICAgWyJTbGFzaGVyIl0gPSB0cnVlLCBbIjF4MXgxeDEiXSA9IHRydWUsIFsiYzAwbGtpZGQiXSA9IHRydWUsCiAgICBbIk5vbGkiXSA9IHRydWUsIFsiSm9obkRvZSJdID0gdHJ1ZSwgWyJHdWVzdCA2NjYiXSA9IHRydWUsCiAgICBbIlNpeGVyIl0gPSB0cnVlLAp9CgotLSA9PT09PT09IEJJ4bq+TiBUUuG6oE5HIFRIw4FJID09PT09PT0KbG9jYWwgQWltbG9ja1BsYXllckVuYWJsZWQgPSBmYWxzZQpsb2NhbCBBaW1sb2NrS2lsbGVyRW5hYmxlZCA9IGZhbHNlCmxvY2FsIEN1cnJlbnRUYXJnZXQgPSBuaWwKbG9jYWwgbGFzdEh1bWFub2lkQXV0b1JvdGF0ZSA9IG5pbAoKLS0gPT09PT09PSBIw4BNIEjhu5YgVFLhu6IgPT09PT09PQpsb2NhbCBmdW5jdGlvbiBJc0FsbG93ZWQobW9kZWwsIGxpc3QpCiAgICByZXR1cm4gbGlzdFttb2RlbC5OYW1lXSA9PSB0cnVlCmVuZAoKbG9jYWwgZnVuY3Rpb24gR2V0TW9kZWxGcm9tUGxheWVyKHBsciwgbGlzdCkKICAgIGlmIG5vdCBwbHIuQ2hhcmFjdGVyIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgIGlmIElzQWxsb3dlZChwbHIuQ2hhcmFjdGVyLCBsaXN0KSBhbmQgcGxyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJIdW1hbm9pZCIp" ..
    "IHRoZW4KICAgICAgICByZXR1cm4gcGxyLkNoYXJhY3RlcgogICAgZW5kCiAgICBmb3IgXywgbW9kZWwgaW4gaXBhaXJzKHdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIG1vZGVsOklzQSgiTW9kZWwiKSBhbmQgbW9kZWw6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgIGlmIG1vZGVsOkZpbmRGaXJzdENoaWxkKCJPd25lciIpIGFuZCBtb2RlbC5Pd25lci5WYWx1ZSA9PSBwbHIgdGhlbgogICAgICAgICAgICAgICAgaWYgSXNBbGxvd2VkKG1vZGVsLCBsaXN0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZGVsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBuaWwKZW5kCgpsb2NhbCBmdW5jdGlvbiBHZXRDbG9zZXN0VGFyZ2V0KGxpc3QpCiAgICBsb2NhbCBteVJvb3QgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBub3QgbXlSb290IHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgIGxvY2FsIGNsb3Nlc3QsIGRpc3QgPSBuaWwsIG1hdGguaHVnZQoKICAgIGZvciBfLCBwbHIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgIGlmIHBsciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgICAgIGxvY2FsIG1vZGVsID0gR2V0TW9k" ..
    "ZWxGcm9tUGxheWVyKHBsciwgbGlzdCkKICAgICAgICAgICAgaWYgbW9kZWwgYW5kIG1vZGVsLlByaW1hcnlQYXJ0IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gbW9kZWw6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgaWYgaHVtYW5vaWQgYW5kIGh1bWFub2lkLkhlYWx0aCA+IDAgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3RhbmNlID0gKG1vZGVsLlByaW1hcnlQYXJ0LlBvc2l0aW9uIC0gbXlSb290LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICBpZiBkaXN0YW5jZSA8IGRpc3QgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBkaXN0ID0gZGlzdGFuY2UKICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VzdCA9IG1vZGVsCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBjbG9zZXN0CmVuZAoKbG9jYWwgZnVuY3Rpb24gVmFsaWRhdGVUYXJnZXQodGFyZ2V0KQogICAgaWYgbm90IHRhcmdldCB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIGxvY2FsIGh1bWFub2lkID0gdGFyZ2V0OkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkh1bWFub2lkIikKICAgIHJldHVybiBodW1hbm9pZCBhbmQgaHVtYW5vaWQuSGVhbHRoID4gMCBhbmQgdGFyZ2V0LlByaW1hcnlQYXJ0IH49IG5pbAplbmQKCi0tIHJl" ..
    "c2V0IGtoaSByZXNwYXduCkxvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcikKICAgIEN1cnJlbnRUYXJnZXQgPSBuaWwKICAgIGlmIGxhc3RIdW1hbm9pZEF1dG9Sb3RhdGUgfj0gbmlsIHRoZW4KICAgICAgICBsb2NhbCBodW0gPSBjaGFyOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkh1bWFub2lkIikKICAgICAgICBpZiBodW0gdGhlbgogICAgICAgICAgICBodW0uQXV0b1JvdGF0ZSA9IGxhc3RIdW1hbm9pZEF1dG9Sb3RhdGUKICAgICAgICBlbmQKICAgICAgICBsYXN0SHVtYW5vaWRBdXRvUm90YXRlID0gbmlsCiAgICBlbmQKZW5kKQoKLS0gPT09PT09PSBBSU1CT1QgTE9PUCAoZml4OiBoxrDhu5tuZyDEkcO6bmcsIGtow7RuZyBi4buLIMSRZW4gbcOgbiBow6xuaCkgPT09PT09PQpSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICBsb2NhbCBteUNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIG15Um9vdCA9IG15Q2hhciBhbmQgbXlDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGxvY2FsIGh1bWFub2lkID0gbXlDaGFyIGFuZCBteUNoYXI6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQiKQoKICAgIGlmIG5vdCBteVJvb3QgdGhlbiByZXR1cm4gZW5kCgogICAgLS0gdG9nZ2xlIEF1dG9Sb3RhdGUKICAgIGlmIChBaW1sb2NrUGxheWVyRW5hYmxlZCBvciBBaW1sb2NrS2lsbGVyRW5h" ..
    "YmxlZCkgYW5kIGh1bWFub2lkIHRoZW4KICAgICAgICBpZiBsYXN0SHVtYW5vaWRBdXRvUm90YXRlID09IG5pbCB0aGVuCiAgICAgICAgICAgIGxhc3RIdW1hbm9pZEF1dG9Sb3RhdGUgPSBodW1hbm9pZC5BdXRvUm90YXRlCiAgICAgICAgZW5kCiAgICAgICAgaHVtYW5vaWQuQXV0b1JvdGF0ZSA9IGZhbHNlCiAgICBlbHNlaWYgaHVtYW5vaWQgYW5kIGxhc3RIdW1hbm9pZEF1dG9Sb3RhdGUgfj0gbmlsIHRoZW4KICAgICAgICBodW1hbm9pZC5BdXRvUm90YXRlID0gbGFzdEh1bWFub2lkQXV0b1JvdGF0ZQogICAgICAgIGxhc3RIdW1hbm9pZEF1dG9Sb3RhdGUgPSBuaWwKICAgIGVuZAoKICAgIC0tIGjDoG0geG9heSBuaMOsbiB0YXJnZXQgKGZpeDogZMO5bmcgbG9va1ZlY3RvcjpDcm9zcyh1cCkgxJHhu4MgcmlnaHRWZWN0b3IgxJHDum5nKQogICAgbG9jYWwgZnVuY3Rpb24gZmFjZVRhcmdldCh0YXJnZXQpCiAgICAgICAgaWYgbm90IHRhcmdldCBvciBub3QgdGFyZ2V0LlByaW1hcnlQYXJ0IHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIHBvcyA9IG15Um9vdC5Qb3NpdGlvbgogICAgICAgIGxvY2FsIHRhcmdldFBvcyA9IHRhcmdldC5QcmltYXJ5UGFydC5Qb3NpdGlvbgogICAgICAgIGxvY2FsIGRpciA9IFZlY3RvcjMubmV3KHRhcmdldFBvcy5YLCBwb3MuWSwgdGFyZ2V0UG9zLlopIC0gcG9zCiAgICAgICAgaWYgZGlyLk1hZ25pdHVkZSA9PSAwIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBsb2NhbCBsb29r" ..
    "VmVjdG9yID0gZGlyLlVuaXQKICAgICAgICBsb2NhbCB1cCA9IFZlY3RvcjMueUF4aXMKICAgICAgICBsb2NhbCByaWdodFZlY3RvciA9IGxvb2tWZWN0b3I6Q3Jvc3ModXApIC0tIENI4buITkg6IHJpZ2h0ID0gbG9vayB4IHVwIChraMO0bmcgbmfGsOG7o2MpCiAgICAgICAgaWYgcmlnaHRWZWN0b3IuTWFnbml0dWRlID09IDAgdGhlbgogICAgICAgICAgICByaWdodFZlY3RvciA9IFZlY3RvcjMubmV3KDEsIDAsIDApCiAgICAgICAgZWxzZQogICAgICAgICAgICByaWdodFZlY3RvciA9IHJpZ2h0VmVjdG9yLlVuaXQKICAgICAgICBlbmQKCiAgICAgICAgLS0gZnJvbU1hdHJpeChwb3NpdGlvbiwgcmlnaHRWZWN0b3IsIHVwKSDigJQgY2jhu4kgdGhheSBvcmllbnRhdGlvbiwgZ2nhu68gbmd1ecOqbiB24buLIHRyw60KICAgICAgICBteVJvb3QuQ0ZyYW1lID0gQ0ZyYW1lLmZyb21NYXRyaXgocG9zLCByaWdodFZlY3RvciwgdXApCiAgICBlbmQKCiAgICBpZiBBaW1sb2NrUGxheWVyRW5hYmxlZCB0aGVuCiAgICAgICAgaWYgbm90IFZhbGlkYXRlVGFyZ2V0KEN1cnJlbnRUYXJnZXQpIHRoZW4KICAgICAgICAgICAgQ3VycmVudFRhcmdldCA9IEdldENsb3Nlc3RUYXJnZXQoQWxsb3dlZFBsYXllcnMpCiAgICAgICAgZW5kCiAgICAgICAgaWYgVmFsaWRhdGVUYXJnZXQoQ3VycmVudFRhcmdldCkgdGhlbgogICAgICAgICAgICBmYWNlVGFyZ2V0KEN1cnJlbnRUYXJnZXQpCiAgICAgICAgZW5kCiAgICBlbHNlaWYgQWltbG9j" ..
    "a0tpbGxlckVuYWJsZWQgdGhlbgogICAgICAgIGlmIG5vdCBWYWxpZGF0ZVRhcmdldChDdXJyZW50VGFyZ2V0KSB0aGVuCiAgICAgICAgICAgIEN1cnJlbnRUYXJnZXQgPSBHZXRDbG9zZXN0VGFyZ2V0KEFsbG93ZWRLaWxsZXJzKQogICAgICAgIGVuZAogICAgICAgIGlmIFZhbGlkYXRlVGFyZ2V0KEN1cnJlbnRUYXJnZXQpIHRoZW4KICAgICAgICAgICAgZmFjZVRhcmdldChDdXJyZW50VGFyZ2V0KQogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIEN1cnJlbnRUYXJnZXQgPSBuaWwKICAgIGVuZAplbmQpCgotLSA9PT09PT09IEZMVUVOVCBUT0dHTEVTID09PT09PT0KVGFicy5QbGF5ZXI6QWRkVG9nZ2xlKCJGb3JzYWtlbkFpbWJvdCIsIHsKICAgIFRpdGxlID0gIkFpbWJvdCBQbGF5ZXIiLAogICAgRGVmYXVsdCA9IGZhbHNlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbih2KQogICAgQWltbG9ja1BsYXllckVuYWJsZWQgPSB2CiAgICBpZiB2IHRoZW4gCiAgICAgICAgQWltbG9ja0tpbGxlckVuYWJsZWQgPSBmYWxzZQogICAgICAgIEN1cnJlbnRUYXJnZXQgPSBuaWwKICAgIGVuZAplbmQpCgpUYWJzLlBsYXllcjpBZGRUb2dnbGUoIkZvcnNha2VuQWltYm90MSIsIHsKICAgIFRpdGxlID0gIkFpbWJvdCBLaWxsZXIiLAogICAgRGVmYXVsdCA9IGZhbHNlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbih2KQogICAgQWltbG9ja0tpbGxlckVuYWJsZWQgPSB2CiAgICBpZiB2IHRoZW4gCiAgICAgICAgQWltbG9ja1BsYXllckVuYWJs" ..
    "ZWQgPSBmYWxzZQogICAgICAgIEN1cnJlbnRUYXJnZXQgPSBuaWwKICAgIGVuZAplbmQpCgoKCgoKCiAgICBUYWJzLlBsYXllcjpBZGRTZWN0aW9uKCLihrMgQ2hlYXRzIikKCmxvY2FsIEFjdGl2ZU5vU3R1biA9IGZhbHNlCmxvY2FsIG5vU3R1bkxvb3AKClRhYnMuUGxheWVyOkFkZFRvZ2dsZSgiTm9TdHVuVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiTm8gU3R1biIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCn0pOk9uQ2hhbmdlZChmdW5jdGlvbih2YWx1ZSkKICAgIEFjdGl2ZU5vU3R1biA9IHZhbHVlCgogICAgaWYgdmFsdWUgdGhlbgogICAgICAgIC0tIE7hur91IGPDsyBsb29wIGPFqSB0aMOsIGThu6tuZwogICAgICAgIGlmIG5vU3R1bkxvb3AgdGhlbgogICAgICAgICAgICB0YXNrLmNhbmNlbChub1N0dW5Mb29wKQogICAgICAgICAgICBub1N0dW5Mb29wID0gbmlsCiAgICAgICAgZW5kCgogICAgICAgIC0tIFThuqFvIGxvb3AgbeG7m2kgbGnDqm4gdOG7pWMgxJHhuqNtIGLhuqNvIEh1bWFub2lkUm9vdFBhcnQga2jDtG5nIGLhu4sgYW5jaG9yZQogICAgICAgIG5vU3R1bkxvb3AgPSB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgQWN0aXZlTm9TdHVuIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCBocnAgPSBjaGFyYWN0ZXIgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGls" ..
    "ZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICBpZiBocnAgdGhlbgogICAgICAgICAgICAgICAgICAgIGhycC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpIC0tIEtow7RuZyBj4bqnbiBxdcOhIG5oYW5oLCB0csOhbmggbGFnCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVsc2UKICAgICAgICAtLSBU4bqvdCBsb29wIGtoaSB0b2dnbGUgb2ZmCiAgICAgICAgaWYgbm9TdHVuTG9vcCB0aGVuCiAgICAgICAgICAgIHRhc2suY2FuY2VsKG5vU3R1bkxvb3ApCiAgICAgICAgICAgIG5vU3R1bkxvb3AgPSBuaWwKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgoKCgoKCmxvY2FsIEluZlN0YW1pbmFFbmFibGVkID0gZmFsc2UgIApsb2NhbCBzdGFtaW5hTG9vcCAgCmxvY2FsIFN0YW1pbmFNb2R1bGUgIAogIAotLSBUaOG7rSBs4bqleSBtb2R1bGUgYW4gdG/DoG4gIApwY2FsbChmdW5jdGlvbigpICAKICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpICAKICAgIGxvY2FsIHBhdGggPSBSZXBsaWNhdGVkU3RvcmFnZTpGaW5kRmlyc3RDaGlsZCgiU3lzdGVtcyIpICAKICAgICAgICBhbmQgUmVwbGljYXRlZFN0b3JhZ2UuU3lzdGVtczpGaW5kRmlyc3RDaGlsZCgiQ2hhcmFjdGVyIikgIAogICAgICAgIGFuZCBSZXBsaWNhdGVkU3RvcmFnZS5TeXN0ZW1zLkNo" ..
    "YXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiR2FtZSIpICAKICAgICAgICBhbmQgUmVwbGljYXRlZFN0b3JhZ2UuU3lzdGVtcy5DaGFyYWN0ZXIuR2FtZTpGaW5kRmlyc3RDaGlsZCgiU3ByaW50aW5nIikgIAogIAogICAgaWYgcGF0aCB0aGVuICAKICAgICAgICBTdGFtaW5hTW9kdWxlID0gcmVxdWlyZShwYXRoKSAgCiAgICBlbmQgIAplbmQpICAKICAKLS0gSMOgbSBo4buTaSBzdGFtaW5hIGFuIHRvw6BuICAKbG9jYWwgZnVuY3Rpb24gcmVzdG9yZVN0YW1pbmEoKSAgCiAgICBpZiBub3QgU3RhbWluYU1vZHVsZSB0aGVuIHJldHVybiBlbmQgIAoKICAgIGxvY2FsIG1heFN0YW1pbmEgPSBTdGFtaW5hTW9kdWxlLk1heFN0YW1pbmEgb3IgMTAwICAKICAgIGlmIFN0YW1pbmFNb2R1bGUuU3RhbWluYSB0aGVuICAKICAgICAgICAtLSBO4bq/dSBtb2R1bGUgY8OzIGjDoG0gIlNldFN0YW1pbmEiIHRow6wgZMO5bmcgIAogICAgICAgIGlmIHR5cGVvZihTdGFtaW5hTW9kdWxlLlNldFN0YW1pbmEpID09ICJmdW5jdGlvbiIgdGhlbiAgCiAgICAgICAgICAgIFN0YW1pbmFNb2R1bGU6U2V0U3RhbWluYShtYXhTdGFtaW5hKSAgCgogICAgICAgIC0tIE7hur91IGPDsyBow6BtICJVcGRhdGVTdGFtaW5hIiB0aMOsIGTDuW5nICAKICAgICAgICBlbHNlaWYgdHlwZW9mKFN0YW1pbmFNb2R1bGUuVXBkYXRlU3RhbWluYSkgPT0gImZ1bmN0aW9uIiB0aGVuICAKICAgICAgICAgICAgU3RhbWluYU1vZHVsZTpVcGRhdGVTdGFtaW5hKG1heFN0" ..
    "YW1pbmEpICAKCiAgICAgICAgLS0gTuG6v3Uga2jDtG5nIGPDsyB0aMOsIHNldCB0cuG7sWMgdGnhur9wICAKICAgICAgICBlbHNlICAKICAgICAgICAgICAgU3RhbWluYU1vZHVsZS5TdGFtaW5hID0gbWF4U3RhbWluYSAgCiAgICAgICAgZW5kICAKICAgIGVuZCAgCmVuZCAgCiAgCi0tIENo4buJIHThuqFvIHRvZ2dsZSBu4bq/dSBtb2R1bGUgdOG7k24gdOG6oWkgIAppZiBTdGFtaW5hTW9kdWxlIHRoZW4gIAogICAgVGFicy5QbGF5ZXI6QWRkVG9nZ2xlKCJJbmZTdGFtaW5hIiwgeyAgCiAgICAgICAgVGl0bGUgPSAiSW5maW5pdGUgU3RhbWluYSIsICAKICAgICAgICBEZWZhdWx0ID0gZmFsc2UgIAogICAgfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKSAgCiAgICAgICAgLS0gbHXDtG4gYuG7jWMgdHJvbmcgcGNhbGwgxJHhu4MgRmx1ZW50IGtow7RuZyBiw6FvICJDYWxsYmFjayBlcnJvciIgIAogICAgICAgIGxvY2FsIG9rID0gcGNhbGwoZnVuY3Rpb24oKSAgCiAgICAgICAgICAgIEluZlN0YW1pbmFFbmFibGVkID0gdmFsdWUgIAogICAgICAgICAgICBpZiBTdGFtaW5hTW9kdWxlLlN0YW1pbmFMb3NzRGlzYWJsZWQgfj0gbmlsIHRoZW4gIAogICAgICAgICAgICAgICAgU3RhbWluYU1vZHVsZS5TdGFtaW5hTG9zc0Rpc2FibGVkID0gdmFsdWUgIAogICAgICAgICAgICBlbmQgIAogIAogICAgICAgICAgICBpZiB2YWx1ZSB0aGVuICAKICAgICAgICAgICAgICAgIHJlc3RvcmVTdGFtaW5hKCkgIAogICAgICAgICAg" ..
    "ICAgICAgaWYgbm90IHN0YW1pbmFMb29wIHRoZW4gIAogICAgICAgICAgICAgICAgICAgIHN0YW1pbmFMb29wID0gdGFzay5zcGF3bihmdW5jdGlvbigpICAKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgSW5mU3RhbWluYUVuYWJsZWQgZG8gIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3RvcmVTdGFtaW5hKCkgIAogICAgICAgICAgICAgICAgICAgICAgICBlbmQgIAogICAgICAgICAgICAgICAgICAgICAgICBzdGFtaW5hTG9vcCA9IG5pbCAgCiAgICAgICAgICAgICAgICAgICAgZW5kKSAgCiAgICAgICAgICAgICAgICBlbmQgIAogICAgICAgICAgICBlbmQgIAogICAgICAgIGVuZCkgIAogICAgZW5kKSAgCmVsc2UgIAogICAgd2FybigiW0luZlN0YW1pbmFdIFNwcmludGluZyBtb2R1bGUgbm90IGZvdW5kLCB0b2dnbGUgZGlzYWJsZWQuIikgIAplbmQKCgoKClRhYnMuUGxheWVyOkFkZFRvZ2dsZSgiSW5maW5pdGVab29tIiwgewogICAgVGl0bGUgPSAiSW5maW5pdGUgWm9vbSIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNhbWVyYSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCgogICAgICAgIGlmIFZhbHVlIHRoZW4KICAgICAgICAgICAgLS0gQuG6rXQg" ..
    "em9vbSB2w7QgaOG6oW4KICAgICAgICAgICAgcGxheWVyLkNhbWVyYU1heFpvb21EaXN0YW5jZSA9IG1hdGguaHVnZQogICAgICAgICAgICBwbGF5ZXIuQ2FtZXJhTWluWm9vbURpc3RhbmNlID0gMC41CiAgICAgICAgICAgIHByaW50KCJbWm9vbUNhbV0gSW5maW5pdGUgWm9vbSBFbmFibGVkIOKchSIpCiAgICAgICAgZWxzZQogICAgICAgICAgICAtLSBU4bqvdCB6b29tIHbDtCBo4bqhbiwgdHLhu58gbOG6oWkgYsOsbmggdGjGsOG7nW5nCiAgICAgICAgICAgIHBsYXllci5DYW1lcmFNYXhab29tRGlzdGFuY2UgPSAxMjgKICAgICAgICAgICAgcGxheWVyLkNhbWVyYU1pblpvb21EaXN0YW5jZSA9IDAuNQogICAgICAgICAgICBwcmludCgiW1pvb21DYW1dIEluZmluaXRlIFpvb20gRGlzYWJsZWQg4p2MIikKICAgICAgICBlbmQKICAgIGVuZAp9KQoKCgogICAgVGFicy5QbGF5ZXI6QWRkU2VjdGlvbigi4oazIFRyb2xsZXIiKQoKCgoKVGFicy5QbGF5ZXI6QWRkQnV0dG9uKHsKICAgIFRpdGxlID0gIkZha2UgQmxvY2siLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgLS0gVOG6oW8gQW5pbWF0aW9uIG9iamVjdAogICAgICAgIGxvY2FsIGFuaW1hdGlvbiA9IEluc3RhbmNlLm5ldygiQW5pbWF0aW9uIikKICAgICAgICBhbmltYXRpb24uQW5pbWF0aW9uSWQgPSAicmJ4YXNzZXRpZDovLzcyNzIyMjQ0NTA4NzQ5IgoKICAgICAgICAtLSBM4bqleSBIdW1hbm9pZCBj4bunYSBuaMOibiB24bqtdAogICAgICAg" ..
    "IGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQoKICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFuaW1hdG9yID0gaHVtYW5vaWQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJBbmltYXRvciIpCiAgICAgICAgICAgIGlmIG5vdCBhbmltYXRvciB0aGVuCiAgICAgICAgICAgICAgICBhbmltYXRvciA9IEluc3RhbmNlLm5ldygiQW5pbWF0b3IiKQogICAgICAgICAgICAgICAgYW5pbWF0b3IuUGFyZW50ID0gaHVtYW5vaWQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAtLSBMb2FkIHbDoCBQbGF5IGFuaW1hdGlvbgogICAgICAgICAgICBsb2NhbCBhbmltVHJhY2sgPSBhbmltYXRvcjpMb2FkQW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgYW5pbVRyYWNrOlBsYXkoKQogICAgICAgIGVuZAogICAgZW5kCn0pCgoKClRhYnMuUGxheWVyOkFkZEJ1dHRvbih7CiAgICBUaXRsZSA9ICJGYWtlIFB1bmNoIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIC0tIFThuqFvIEFuaW1hdGlvbiBvYmplY3QKICAgICAgICBsb2NhbCBhbmltYXRpb24gPSBJbnN0YW5jZS5uZXcoIkFuaW1hdGlvbiIpCiAg" ..
    "ICAgICAgYW5pbWF0aW9uLkFuaW1hdGlvbklkID0gInJieGFzc2V0aWQ6Ly84NzI1OTM5MTkyNjMyMSIKCiAgICAgICAgLS0gTOG6pXkgSHVtYW5vaWQgY+G7p2EgbmjDom4gduG6rXQKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKCiAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICBsb2NhbCBhbmltYXRvciA9IGh1bWFub2lkOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQW5pbWF0b3IiKQogICAgICAgICAgICBpZiBub3QgYW5pbWF0b3IgdGhlbgogICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBJbnN0YW5jZS5uZXcoIkFuaW1hdG9yIikKICAgICAgICAgICAgICAgIGFuaW1hdG9yLlBhcmVudCA9IGh1bWFub2lkCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgLS0gTG9hZCB2w6AgUGxheSBhbmltYXRpb24KICAgICAgICAgICAgbG9jYWwgYW5pbVRyYWNrID0gYW5pbWF0b3I6TG9hZEFuaW1hdGlvbihhbmltYXRpb24pCiAgICAgICAgICAgIGFuaW1UcmFjazpQbGF5KCkKICAgICAgICBlbmQKCiAgICAgICAgLS0gw4JtIHRoYW5oIMSR4bqndSB0acOqbgogICAgICAgIGxvY2FsIHNvdW5kMSA9IEluc3RhbmNl" ..
    "Lm5ldygiU291bmQiKQogICAgICAgIHNvdW5kMS5Tb3VuZElkID0gInJieGFzc2V0aWQ6Ly84MTk3NjM5NjcyOTM0MyIKICAgICAgICBzb3VuZDEuUGFyZW50ID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBzb3VuZDE6UGxheSgpCgogICAgICAgIC0tIFNhdSAwLjc1IGdpw6J5IHRow6wgdOG6r3Qgc291bmQxIHbDoCBwaMOhdCBzb3VuZDIKICAgICAgICB0YXNrLmRlbGF5KDAuNzUsIGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgc291bmQxLklzUGxheWluZyB0aGVuCiAgICAgICAgICAgICAgICBzb3VuZDE6U3RvcCgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBzb3VuZDIgPSBJbnN0YW5jZS5uZXcoIlNvdW5kIikKICAgICAgICAgICAgc291bmQyLlNvdW5kSWQgPSAicmJ4YXNzZXRpZDovLzEyMjU2MDYzMTcxODYxMiIKICAgICAgICAgICAgc291bmQyLlBhcmVudCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSGVhZCIpIG9yIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgIHNvdW5kMjpQbGF5KCkKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCgoKClRhYnMuUGxheWVyOkFkZEJ1dHRvbih7CiAgICBUaXRsZSA9ICJGYWtlIFB1bmNoIHYyIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIC0tIFThuqFvIEFuaW1h" ..
    "dGlvbiBvYmplY3QKICAgICAgICBsb2NhbCBhbmltYXRpb24gPSBJbnN0YW5jZS5uZXcoIkFuaW1hdGlvbiIpCiAgICAgICAgYW5pbWF0aW9uLkFuaW1hdGlvbklkID0gInJieGFzc2V0aWQ6Ly84NjcwOTc3NDI4MzY3MiIKCiAgICAgICAgLS0gTOG6pXkgSHVtYW5vaWQgY+G7p2EgbmjDom4gduG6rXQKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKCiAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICBsb2NhbCBhbmltYXRvciA9IGh1bWFub2lkOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQW5pbWF0b3IiKQogICAgICAgICAgICBpZiBub3QgYW5pbWF0b3IgdGhlbgogICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBJbnN0YW5jZS5uZXcoIkFuaW1hdG9yIikKICAgICAgICAgICAgICAgIGFuaW1hdG9yLlBhcmVudCA9IGh1bWFub2lkCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgLS0gTG9hZCB2w6AgUGxheSBhbmltYXRpb24KICAgICAgICAgICAgbG9jYWwgYW5pbVRyYWNrID0gYW5pbWF0b3I6TG9hZEFuaW1hdGlvbihhbmltYXRpb24pCiAgICAgICAgICAgIGFuaW1UcmFjazpQbGF5KCkKICAgICAgICBlbmQK" ..
    "CiAgICAgICAgLS0gw4JtIHRoYW5oIMSR4bqndSB0acOqbgogICAgICAgIGxvY2FsIHNvdW5kMSA9IEluc3RhbmNlLm5ldygiU291bmQiKQogICAgICAgIHNvdW5kMS5Tb3VuZElkID0gInJieGFzc2V0aWQ6Ly84MTk3NjM5NjcyOTM0MyIKICAgICAgICBzb3VuZDEuUGFyZW50ID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBzb3VuZDE6UGxheSgpCgogICAgICAgIC0tIFNhdSAwLjUgZ2nDonkgdGjDrCB04bqvdCBzb3VuZDEgdsOgIHBow6F0IHNvdW5kMgogICAgICAgIHRhc2suZGVsYXkoMC41LCBmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIHNvdW5kMS5Jc1BsYXlpbmcgdGhlbgogICAgICAgICAgICAgICAgc291bmQxOlN0b3AoKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgbG9jYWwgc291bmQyID0gSW5zdGFuY2UubmV3KCJTb3VuZCIpCiAgICAgICAgICAgIHNvdW5kMi5Tb3VuZElkID0gInJieGFzc2V0aWQ6Ly8xMjI1NjA2MzE3MTg2MTIiCiAgICAgICAgICAgIHNvdW5kMi5QYXJlbnQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkhlYWQiKSBvciBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICBzb3VuZDI6UGxheSgpCiAgICAgICAgZW5kKQogICAgZW5kCn0pCgoKCmRvCi0tIEzGsHUgY2FsbGJhY2sgQmFja2ZsaXAgxJHhu4MgdG9n" ..
    "Z2xlIGfhu41pIGzhuqFpCmxvY2FsIGZ1bmN0aW9uIGRvQmFja2ZsaXAoKQogICAgbG9jYWwgcGxyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICBsb2NhbCBjaGFyID0gcGxyIGFuZCBwbHIuQ2hhcmFjdGVyCiAgICBpZiBub3QgY2hhciB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBodW0gPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGxvY2FsIGFuaW1hdG9yID0gaHVtIGFuZCBodW06RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJBbmltYXRvciIpCiAgICBpZiBub3QgKGh1bSBhbmQgaHJwKSB0aGVuIHJldHVybiBlbmQKCiAgICBpZiBjaGFyOkZpbmRGaXJzdENoaWxkKCJBbmltYXRlIikgdGhlbgogICAgICAgIGNoYXIuQW5pbWF0ZS5EaXNhYmxlZCA9IHRydWUKICAgIGVuZAoKICAgIGlmIGFuaW1hdG9yIHRoZW4KICAgICAgICBmb3IgXywgdiBpbiBpcGFpcnMoYW5pbWF0b3I6R2V0UGxheWluZ0FuaW1hdGlvblRyYWNrcygpKSBkbwogICAgICAgICAgICB2OlN0b3AoKQogICAgICAgIGVuZAogICAgZW5kCgogICAgZm9yIF8sIHMgaW4gaXBhaXJzKHsKICAgICAgICBFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkZhbGxpbmdEb3duLAogICAgICAgIEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuRnJlZWZhbGwsCiAgICAgICAgRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5SdW5uaW5nLAogICAgICAgIEVu" ..
    "dW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkLAogICAgICAgIEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuQ2xpbWJpbmcKICAgIH0pIGRvCiAgICAgICAgaHVtOlNldFN0YXRlRW5hYmxlZChzLCBmYWxzZSkKICAgIGVuZAogICAgaHVtOkNoYW5nZVN0YXRlKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuUGh5c2ljcykKCiAgICBsb2NhbCBkLCBzID0gMC40NSwgMTIwCiAgICBsb2NhbCBjZiA9IGhycC5DRnJhbWUKICAgIGxvY2FsIGRpciA9IGNmLkxvb2tWZWN0b3IgLS0g4pyFIGJheSB0aGVvIGjGsOG7m25nIG5ow6xuCiAgICBsb2NhbCB1cCA9IFZlY3RvcjMueUF4aXMKCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCB0MCA9IHRpY2soKQogICAgICAgIGZvciBpID0gMSwgcyBkbwogICAgICAgICAgICBsb2NhbCB0ID0gaSAvIHMKICAgICAgICAgICAgbG9jYWwgeSA9IDQgKiAodCAtIHQgXiAyKSAqIDEwCiAgICAgICAgICAgIGxvY2FsIHRhcmdldFBvcyA9IGNmLlBvc2l0aW9uICsgZGlyICogKDM1ICogdCkgKyB1cCAqIHkKICAgICAgICAgICAgbG9jYWwgciA9IENGcmFtZS5BbmdsZXMobWF0aC5yYWQoMzYwICogdCksIDAsIDApCgogICAgICAgICAgICAtLSDinIUgUmF5Y2FzdCBjaGVjayB0csaw4bubYyBraGkgUGl2b3RUbwogICAgICAgICAgICBsb2NhbCByYXlQYXJhbXMgPSBSYXljYXN0UGFyYW1zLm5ldygpCiAgICAgICAgICAgIHJheVBhcmFtcy5GaWx0ZXJEZXNjZW5kYW50c0luc3RhbmNl" ..
    "cyA9IHtjaGFyfQogICAgICAgICAgICByYXlQYXJhbXMuRmlsdGVyVHlwZSA9IEVudW0uUmF5Y2FzdEZpbHRlclR5cGUuQmxhY2tsaXN0CgogICAgICAgICAgICBsb2NhbCByZXN1bHQgPSB3b3Jrc3BhY2U6UmF5Y2FzdChocnAuUG9zaXRpb24sICh0YXJnZXRQb3MgLSBocnAuUG9zaXRpb24pLCByYXlQYXJhbXMpCgogICAgICAgICAgICBpZiByZXN1bHQgdGhlbgogICAgICAgICAgICAgICAgLS0gTuG6v3UgY8OzIHTGsOG7nW5nIGNo4bq3biDihpIgZOG7q25nIHThuqFpIHbhu4sgdHLDrSB2YSBjaOG6oW0KICAgICAgICAgICAgICAgIHRhcmdldFBvcyA9IHJlc3VsdC5Qb3NpdGlvbiArIHJlc3VsdC5Ob3JtYWwgKiAyCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgY2hhcjpQaXZvdFRvKENGcmFtZS5uZXcodGFyZ2V0UG9zKSAqIGNmLlJvdGF0aW9uICogcikKCiAgICAgICAgICAgIGxvY2FsIHd0ID0gKGQgLyBzKSAqIGkgLSAodGljaygpIC0gdDApCiAgICAgICAgICAgIGlmIHd0ID4gMCB0aGVuIHRhc2sud2FpdCh3dCkgZW5kCiAgICAgICAgZW5kCgogICAgICAgIC0tIEtp4buDbSB0cmEgdmEgY2jhuqFtIHThuqFpIMSRaeG7g20ga+G6v3QgdGjDumMKICAgICAgICBsb2NhbCBmaW5hbFRhcmdldCA9IGNmLlBvc2l0aW9uICsgZGlyICogMzUKICAgICAgICBsb2NhbCByYXlQYXJhbXMgPSBSYXljYXN0UGFyYW1zLm5ldygpCiAgICAgICAgcmF5UGFyYW1zLkZpbHRlckRlc2NlbmRhbnRzSW5zdGFuY2VzID0ge2No" ..
    "YXJ9CiAgICAgICAgcmF5UGFyYW1zLkZpbHRlclR5cGUgPSBFbnVtLlJheWNhc3RGaWx0ZXJUeXBlLkJsYWNrbGlzdAogICAgICAgIGxvY2FsIHJlc3VsdCA9IHdvcmtzcGFjZTpSYXljYXN0KGhycC5Qb3NpdGlvbiwgKGZpbmFsVGFyZ2V0IC0gaHJwLlBvc2l0aW9uKSwgcmF5UGFyYW1zKQogICAgICAgIGlmIHJlc3VsdCB0aGVuCiAgICAgICAgICAgIGZpbmFsVGFyZ2V0ID0gcmVzdWx0LlBvc2l0aW9uICsgcmVzdWx0Lk5vcm1hbCAqIDIKICAgICAgICBlbmQKCiAgICAgICAgY2hhcjpQaXZvdFRvKENGcmFtZS5uZXcoZmluYWxUYXJnZXQpICogY2YuUm90YXRpb24pCgogICAgICAgIGZvciBfLCBzIGluIGlwYWlycyh7CiAgICAgICAgICAgIEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuRmFsbGluZ0Rvd24sCiAgICAgICAgICAgIEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuRnJlZWZhbGwsCiAgICAgICAgICAgIEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuUnVubmluZywKICAgICAgICAgICAgRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsCiAgICAgICAgICAgIEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuQ2xpbWJpbmcKICAgICAgICB9KSBkbwogICAgICAgICAgICBodW06U2V0U3RhdGVFbmFibGVkKHMsIHRydWUpCiAgICAgICAgZW5kCiAgICAgICAgaHVtOkNoYW5nZVN0YXRlKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuUnVubmluZykKICAgICAgICBjaGFyLkFuaW1hdGUuRGlzYWJsZWQgPSBmYWxzZQogICAgZW5kKQplbmQK" ..
    "Ci0tIE7DunQgQmFja2ZsaXAKVGFicy5QbGF5ZXI6QWRkQnV0dG9uKHsKICAgIFRpdGxlID0gIkJhY2tmbGlwIiwKICAgIC0tIERlc2NyaXB0aW9uID0gIlBlcmZvcm0gYSBiYWNrZmxpcCIsCiAgICBDYWxsYmFjayA9IGRvQmFja2ZsaXAKfSkKCi0tIFRvZ2dsZSBBdXRvIEJhY2tmbGlwCmxvY2FsIGF1dG9GbGlwID0gZmFsc2UKVGFicy5QbGF5ZXI6QWRkVG9nZ2xlKCJBdXRvQmFja2ZsaXAiLCB7CiAgICBUaXRsZSA9ICJBdXRvIEJhY2tmbGlwIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgYXV0b0ZsaXAgPSBWYWx1ZQogICAgICAgIGlmIGF1dG9GbGlwIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBhdXRvRmxpcCBkbwogICAgICAgICAgICAgICAgICAgIGRvQmFja2ZsaXAoKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxLjI1KQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQplbmQKCgoKCgoKCgoKCmRvCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIHBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCiAgICAtLSBBbmltYXRpb24gb2JqZWN0CiAgICBsb2NhbCBmYWtlRml4QW5pbSA9IEluc3RhbmNlLm5ldygiQW5pbWF0aW9uIikKICAgIGZha2VGaXhBbmltLkFu" ..
    "aW1hdGlvbklkID0gInJieGFzc2V0aWQ6Ly84MjY5MTUzMzYwMjk0OSIKCiAgICBsb2NhbCBhbmltYXRvciwgZmFrZUZpeFRyYWNrCgogICAgLS0gSMOgbSB0w6xtIGFuaW1hdG9yIGPhu6dhIG5ow6JuIHbhuq10CiAgICBsb2NhbCBmdW5jdGlvbiBnZXRBbmltYXRvcigpCiAgICAgICAgbG9jYWwgY2hhciA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBub3QgY2hhciB0aGVuIHJldHVybiBuaWwgZW5kCiAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQW5pbWF0aW9uQ29udHJvbGxlciIpCiAgICAgICAgaWYgbm90IGh1bWFub2lkIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgICAgICBsb2NhbCBhbmltID0gaHVtYW5vaWQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJBbmltYXRvciIpCiAgICAgICAgaWYgbm90IGFuaW0gdGhlbgogICAgICAgICAgICBhbmltID0gSW5zdGFuY2UubmV3KCJBbmltYXRvciIpCiAgICAgICAgICAgIGFuaW0uUGFyZW50ID0gaHVtYW5vaWQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gYW5pbQogICAgZW5kCgogICAgLS0gVG9nZ2xlIFVJCiAgICBUYWJzLlBsYXllcjpBZGRUb2dnbGUoIkZha2VGaXhHZW4iLCB7CiAgICAgICAgVGl0bGUgPSAiRmFrZSBGaXggR2VuIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0" ..
    "ZSkKICAgICAgICAgICAgYW5pbWF0b3IgPSBnZXRBbmltYXRvcigpCiAgICAgICAgICAgIGlmIG5vdCBhbmltYXRvciB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgICAgIGlmIG5vdCBmYWtlRml4VHJhY2sgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIG9rLCB0cmFjayA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuaW1hdG9yOkxvYWRBbmltYXRpb24oZmFrZUZpeEFuaW0pCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIGlmIG9rIGFuZCB0cmFjayB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGZha2VGaXhUcmFjayA9IHRyYWNrCiAgICAgICAgICAgICAgICAgICAgICAgIGZha2VGaXhUcmFjay5Mb29wZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGZha2VGaXhUcmFjazpQbGF5KCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiBmYWtlRml4VHJhY2sgdGhlbgogICAgICAgICAgICAgICAgICAgIGZha2VGaXhUcmFjazpTdG9wKCkKICAgICAgICAgICAgICAgICAgICBmYWtlRml4VHJhY2sgPSBuaWwKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZAoKCgoKZG8KLS0gRmFrZSBEaWUgVG9nZ2xlIChzdGFydCBh" ..
    "dCA1MCUsIHN0b3AgYXQgOTAlKQpUYWJzLlBsYXllcjpBZGRUb2dnbGUoIkZha2VEaWVWMiIsIHsKICAgIFRpdGxlID0gIkZha2UgRGllIFYyIiwKICAgIERlZmF1bHQgPSBmYWxzZQp9KTpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQoKICAgIGxvY2FsIHBsciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIGNoYXIgPSBwbHIuQ2hhcmFjdGVyIG9yIHBsci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgIGxvY2FsIGh1bSA9IGNoYXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIpCgogICAgaWYgbm90IGdldGdlbnYoKS5GYWtlRGllRGF0YSB0aGVuCiAgICAgICAgZ2V0Z2VudigpLkZha2VEaWVEYXRhID0ge3RyYWNrPW5pbCwgY29ubj1uaWx9CiAgICBlbmQKCiAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgLS0gPT09IELhuqxUIEZha2UgRGllID09PQogICAgICAgIGxvY2FsIGFuaW0gPSBJbnN0YW5jZS5uZXcoIkFuaW1hdGlvbiIpCiAgICAgICAgYW5pbS5BbmltYXRpb25JZCA9ICJyYnhhc3NldGlkOi8vMTE4Nzk1NTk3MTM0MjY5IgoKICAgICAgICBsb2NhbCB0cmFjayA9IGh1bTpMb2FkQW5pbWF0aW9uKGFuaW0pCiAgICAgICAgdHJhY2s6UGxheSgpCgogICAgICAgIC0tIE5o4bqjeSB0aOG6s25nIMSR4bq/biA1MCUKICAgICAgICBp" ..
    "ZiB0cmFjay5MZW5ndGggPiAwIHRoZW4KICAgICAgICAgICAgdHJhY2suVGltZVBvc2l0aW9uID0gdHJhY2suTGVuZ3RoICogMC41CiAgICAgICAgZW5kCgogICAgICAgIGdldGdlbnYoKS5GYWtlRGllRGF0YS50cmFjayA9IHRyYWNrCgogICAgICAgIGxvY2FsIHN0b3BwZWQgPSBmYWxzZQogICAgICAgIGxvY2FsIGNvbm4gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgdHJhY2suSXNQbGF5aW5nIGFuZCBub3Qgc3RvcHBlZCBhbmQgdHJhY2suTGVuZ3RoID4gMCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBwZXJjZW50ID0gdHJhY2suVGltZVBvc2l0aW9uIC8gdHJhY2suTGVuZ3RoCiAgICAgICAgICAgICAgICBpZiBwZXJjZW50ID49IDAuOSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdHJhY2s6QWRqdXN0U3BlZWQoMCkgLS0gcGF1c2Ug4bufIDkwJQogICAgICAgICAgICAgICAgICAgIHN0b3BwZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIkZha2VEaWU6IEFuaW1hdGlvbiBwYXVzZWQgYXQgOTAlIikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCgogICAgICAgIGdldGdlbnYoKS5GYWtlRGllRGF0YS5jb25uID0gY29ubgoKICAgIGVsc2UKICAgICAgICAtLSA9PT0gVOG6rlQgRmFrZSBEaWUgPT09CiAgICAgICAgbG9jYWwgZGF0YSA9IGdldGdlbnYoKS5GYWtlRGllRGF0YQogICAgICAgIGlmIGRh" ..
    "dGEudHJhY2sgdGhlbgogICAgICAgICAgICBkYXRhLnRyYWNrOlN0b3AoKQogICAgICAgICAgICBkYXRhLnRyYWNrID0gbmlsCiAgICAgICAgZW5kCiAgICAgICAgaWYgZGF0YS5jb25uIHRoZW4KICAgICAgICAgICAgZGF0YS5jb25uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICBkYXRhLmNvbm4gPSBuaWwKICAgICAgICBlbmQKCiAgICAgICAgLS0gS2jDtGkgcGjhu6VjIGFuaW1hdGlvbiBt4bq3YyDEkeG7i25oIChpZGxlKQogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgaHVtOlBsYXlFbW90ZSgiaWRsZSIpCiAgICAgICAgZW5kKQogICAgZW5kCmVuZCkKZW5kCgoKCgoKICAgIFRhYnMuUGxheWVyOkFkZFNlY3Rpb24oIuKGsyBIaXRib3giKQoKCnJlcGVhdCB0YXNrLndhaXQoKSB1bnRpbCBnYW1lOklzTG9hZGVkKCkKCi0tIGJp4bq/biBj4bqldSBow6xuaApsb2NhbCBGb3JzYWtlblJlYWNoRW5hYmxlZCA9IGZhbHNlCmxvY2FsIE5lYXJlc3REaXN0ID0gMTIwCgotLSB0aMOqbSB0b2dnbGUgKyBzbGlkZXIgdsOgbyBGbHVlbnQgKFRhYnMuUGxheWVyIGLhuqFuIMSRw6MgY8OzIHPhurVuKQpUYWJzLlBsYXllcjpBZGRUb2dnbGUoIkZvcnNha2VuUmVhY2hUb2dnbGUiLCB7CiAgICBUaXRsZSA9ICJIaXRib3ggRGV2aWwiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQogICAgRm9yc2FrZW5SZWFjaEVuYWJsZWQgPSBWYWx1ZQpl" ..
    "bmQpCgpUYWJzLlBsYXllcjpBZGRTbGlkZXIoIkZvcnNha2VuUmVhY2hTbGlkZXIiLCB7CiAgICBUaXRsZSA9ICJEaXN0YW5jZSIsCiAgICBEZWZhdWx0ID0gMTIwLAogICAgTWluID0gMTAsCiAgICBNYXggPSAzMDAsCiAgICBSb3VuZGluZyA9IDAsCiAgICBTYXZlID0gdHJ1ZSwKICAgIFN1ZmZpeCA9ICIgc3R1ZHMiCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkKICAgIE5lYXJlc3REaXN0ID0gVmFsdWUKZW5kKQoKLS0gc2VydmljZXMgJiBwbGF5ZXIgc2V0dXAKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgnUGxheWVycycpCmxvY2FsIFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgQ2hhcmFjdGVyID0gUGxheWVyLkNoYXJhY3RlciBvciBQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCmxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiKQpsb2NhbCBIdW1hbm9pZFJvb3RQYXJ0ID0gQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgpQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihOZXdDaGFyYWN0ZXIpCiAgICBDaGFyYWN0ZXIgPSBOZXdDaGFyYWN0ZXIKICAgIEh1bWFub2lkID0gQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiKQogICAgSHVtYW5vaWRSb290UGFydCA9IENoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQplbmQpCgpsb2NhbCBSTkcgPSBS" ..
    "YW5kb20ubmV3KCkKCi0tIGZ1bGwgZGFuaCBzw6FjaCBhbmltYXRpb25zIGdp4buvIG5ndXnDqm4gdOG7qyBjb2RlIDEKbG9jYWwgQXR0YWNrQW5pbWF0aW9ucyA9IHsKICAgICdyYnhhc3NldGlkOi8vMTMxNDMwNDk3ODIxMTk4JywKICAgICdyYnhhc3NldGlkOi8vODM4Mjk3ODIzNTc4OTcnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMjY4MzAwMTQ4NDExOTgnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMjYzNTUzMjc5NTEyMTUnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMjEwODY3NDY1MzQyNTInLAogICAgJ3JieGFzc2V0aWQ6Ly8xMDU0NTgyNzA0NjMzNzQnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMjcxNzI0ODMxMzgwOTInLAogICAgJ3JieGFzc2V0aWQ6Ly8xODg4NTkxOTk0NycsCiAgICAncmJ4YXNzZXRpZDovLzE4ODg1OTA5NjQ1JywKICAgICdyYnhhc3NldGlkOi8vODcyNTkzOTE5MjYzMjEnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMDYwMTQ4OTg1MjgzMDAnLAogICAgJ3JieGFzc2V0aWQ6Ly84NzI1OTM5MTkyNjMyMScsCiAgICAncmJ4YXNzZXRpZDovLzg2NTQ1MTMzMjY5ODEzJywKICAgICdyYnhhc3NldGlkOi8vODk0NDgzNTQ2Mzc0NDInLAogICAgJ3JieGFzc2V0aWQ6Ly85MDQ5OTQ2OTUzMzUwMycsCiAgICAncmJ4YXNzZXRpZDovLzExNjYxODAwMzQ3NzAwMicsCiAgICAncmJ4YXNzZXRpZDovLzEwNjA4Njk1NTIxMjYxMScsCiAgICAncmJ4YXNzZXRpZDovLzEwNzY0MDA2NTk3NzY4NicsCiAgICAncmJ4YXNzZXRpZDovLzc3" ..
    "MTI0NTc4MTk3MzU3JywKICAgICdyYnhhc3NldGlkOi8vMTAxNzcxNjE3ODAzMTMzJywKICAgICdyYnhhc3NldGlkOi8vMTM0OTU4MTg3ODIyMTA3JywKICAgICdyYnhhc3NldGlkOi8vMTExMzEzMTY5NDQ3Nzg3JywKICAgICdyYnhhc3NldGlkOi8vNzE2ODU1NzM2OTAzMzgnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMjk4NDMzMTM2OTA5MjEnLAogICAgJ3JieGFzc2V0aWQ6Ly85NzYyMzE0MzY2NDQ4NScsCiAgICAncmJ4YXNzZXRpZDovLzEyOTg0MzMxMzY5MDkyMScsCiAgICAncmJ4YXNzZXRpZDovLzEzNjAwNzA2NTQwMDk3OCcsCiAgICAncmJ4YXNzZXRpZDovLzEzNjAwNzA2NTQwMDk3OCcsCiAgICAncmJ4YXNzZXRpZDovLzg2MDk2Mzg3MDAwNTU3JywKICAgICdyYnhhc3NldGlkOi8vMTA4ODA3NzMyMTUwMjUxJywKICAgICdyYnhhc3NldGlkOi8vMTM4MDQwMDAxOTY1NjU0JywKICAgICdyYnhhc3NldGlkOi8vNzM1MDIwNzMxNzY4MTknLAogICAgJ3JieGFzc2V0aWQ6Ly8xMjk4NDMzMTM2OTA5MjEnLAogICAgJ3JieGFzc2V0aWQ6Ly85NzYyMzE0MzY2NDQ4NScsCiAgICAncmJ4YXNzZXRpZDovLzEyOTg0MzMxMzY5MDkyMScsCiAgICAncmJ4YXNzZXRpZDovLzk3NjIzMTQzNjY0NDg1JywKICAgICdyYnhhc3NldGlkOi8vODY3MDk3NzQyODM2NzInLAogICAgJ3JieGFzc2V0aWQ6Ly8xMDYwMTQ4OTg1MjgzMDAnLAogICAgJ3JieGFzc2V0aWQ6Ly84NzI1OTM5MTkyNjMyMScsCiAgICAncmJ4YXNzZXRpZDovLzE0MDcw" ..
    "MzIxMDkyNzY0NScsCiAgICAncmJ4YXNzZXRpZDovLzk2MTczODU3ODY3MjI4JywKICAgICdyYnhhc3NldGlkOi8vMTIxMjU1ODk4NjEyNDc1JywKICAgICdyYnhhc3NldGlkOi8vOTgwMzEyODczNjQ4NjUnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMTk0NjIzODM2NTgwNDQnLAogICAgJ3JieGFzc2V0aWQ6Ly83NzQ0ODUyMTI3NzE0NicsCiAgICAncmJ4YXNzZXRpZDovLzc3NDQ4NTIxMjc3MTQ2JywKICAgICdyYnhhc3NldGlkOi8vMTAzNzQxMzUyMzc5ODE5JywKICAgICdyYnhhc3NldGlkOi8vMTE5NDYyMzgzNjU4MDQ0JywKICAgICdyYnhhc3NldGlkOi8vMTMxNjk2NjAzMDI1MjY1JywKICAgICdyYnhhc3NldGlkOi8vMTIyNTAzMzM4Mjc3MzUyJywKICAgICdyYnhhc3NldGlkOi8vOTc2NDg1NDgzMDM2NzgnLAogICAgJ3JieGFzc2V0aWQ6Ly85NDE2MjQ0NjUxMzU4NycsCiAgICAncmJ4YXNzZXRpZDovLzg0NDI2MTUwNDM1ODk4JywKICAgICdyYnhhc3NldGlkOi8vOTMwNjk3MjEyNzQxMTAnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMTQ2MjAwNDczMTA2ODgnLAogICAgJ3JieGFzc2V0aWQ6Ly85NzQzMzA2MDg2MTk1MicsCiAgICAncmJ4YXNzZXRpZDovLzgyMTgzMzU2MTQxNDAxJywKICAgICdyYnhhc3NldGlkOi8vMTAwNTkyOTEzMDMwMzUxJywKICAgICdyYnhhc3NldGlkOi8vMTIxMjkzODgzNTg1NzM4JywKICAgICdyYnhhc3NldGlkOi8vMTAwNTkyOTEzMDMwMzUxJywKICAgICdyYnhhc3NldGlkOi8vMTIxMjkzODgz" ..
    "NTg1NzM4JywKICAgICdyYnhhc3NldGlkOi8vMTAwNTkyOTEzMDMwMzUxJywKICAgICdyYnhhc3NldGlkOi8vMTIxMjkzODgzNTg1NzM4JywKICAgICdyYnhhc3NldGlkOi8vNzA0NDc2MzQ4NjI5MTEnLAogICAgJ3JieGFzc2V0aWQ6Ly85MjE3MzEzOTE4Nzk3MCcsCiAgICAncmJ4YXNzZXRpZDovLzEwNjg0NzY5NTI3MDc3MycsCiAgICAncmJ4YXNzZXRpZDovLzEyNTQwMzMxMzc4NjY0NScsCiAgICAncmJ4YXNzZXRpZDovLzgxNjM5NDM1ODU4OTAyJywKICAgICdyYnhhc3NldGlkOi8vMTM3MzE0NzM3NDkyNzE1JywKICAgICdyYnhhc3NldGlkOi8vMTIwMTEyODk3MDI2MDE1JywKICAgICdyYnhhc3NldGlkOi8vODIxMTM3NDQ0Nzg1NDYnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMTgyOTg0NzU2Njk5MzUnLAogICAgJ3JieGFzc2V0aWQ6Ly84MjExMzc0NDQ3ODU0NicsCiAgICAncmJ4YXNzZXRpZDovLzExODI5ODQ3NTY2OTkzNScsCiAgICAncmJ4YXNzZXRpZDovLzEyNjY4MTc3Njg1OTUzOCcsCiAgICAncmJ4YXNzZXRpZDovLzEyOTk3NjA4MDQwNTA3MicsCiAgICAncmJ4YXNzZXRpZDovLzEwOTY2Nzk1OTkzODYxNycsCiAgICAncmJ4YXNzZXRpZDovLzc0NzA3MzI4NTU0MzU4JywKICAgICdyYnhhc3NldGlkOi8vMTMzMzM2NTk0MzU3OTAzJywKICAgICdyYnhhc3NldGlkOi8vODYyMDQwMDExMjk5NzQnLAogICAgJ3JieGFzc2V0aWQ6Ly84MjExMzc0NDQ3ODU0NicsCiAgICAncmJ4YXNzZXRpZDovLzExODI5ODQ3NTY2" ..
    "OTkzNScsCiAgICAncmJ4YXNzZXRpZDovLzEyNDI0MzYzOTU3OTIyNCcsCiAgICAncmJ4YXNzZXRpZDovLzcwMzcxNjY3OTE5ODk4JywKICAgICdyYnhhc3NldGlkOi8vMTMxNTQzNDYxMzIxNzA5JywKICAgICdyYnhhc3NldGlkOi8vMTM2MzIzNzI4MzU1NjEzJywKICAgICdyYnhhc3NldGlkOi8vMTA5MjMwMjY3NDQ4Mzk0JywKICAgICdyYnhhc3NldGlkOi8vMTM5ODM1NTAxMDMzOTMyJywKICAgICdyYnhhc3NldGlkOi8vMTA2NTM4NDI3MTYyNzk2JywKICAgICdyYnhhc3NldGlkOi8vMTA5NjY3OTU5OTM4NjE3JywKICAgICdyYnhhc3NldGlkOi8vMTI2NjgxNzc2ODU5NTM4JywKICAgICdyYnhhc3NldGlkOi8vMTI5OTc2MDgwNDA1MDcyJywKICAgICdyYnhhc3NldGlkOi8vMTEwNDAwNDUzOTkwNzg2JywKICAgICdyYnhhc3NldGlkOi8vODM2ODUzMDU1NTMzNjQnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMjYxNzE0ODc0MDA2MTgnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMjI3MDk0MTYzOTE4OTEnLAogICAgJ3JieGFzc2V0aWQ6Ly84Nzk4OTUzMzA5NTI4NScsCiAgICAncmJ4YXNzZXRpZDovLzExOTMyNjM5NzI3NDkzNCcsCiAgICAncmJ4YXNzZXRpZDovLzE0MDM2NTAxNDMyNjEyNScsCiAgICAncmJ4YXNzZXRpZDovLzEzOTMwOTY0NzQ3MzU1NScsCiAgICAncmJ4YXNzZXRpZDovLzEzMzM2MzM0NTY2MTAzMicsCiAgICAncmJ4YXNzZXRpZDovLzEyODQxNDczNjk3NjUwMycsCiAgICAncmJ4YXNzZXRpZDovLzEyMTgwODM3" ..
    "MTA1MzQ4MycsCiAgICAncmJ4YXNzZXRpZDovLzc3Mzc1ODQ2NDkyNDM2JywKICAgICdyYnhhc3NldGlkOi8vOTI0NDU2MDgwMTQyNzYnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMDAzNTg1ODE5NDA0ODUnLAogICAgJ3JieGFzc2V0aWQ6Ly85MTc1ODc2MDYyMTk1NScsCiAgICAncmJ4YXNzZXRpZDovLzk0NjM0NTk0NTI5MzM0JywKICAgICdyYnhhc3NldGlkOi8vMTAxMTAxNDMzNjg0MDUxJywKICAgICdyYnhhc3NldGlkOi8vOTA2MjA1MzE0NjgyNDAnLAogICAgJ3JieGFzc2V0aWQ6Ly85NDk1ODA0MTYwMzM0NycsCiAgICAncmJ4YXNzZXRpZDovLzEzMTY0MjQ1NDIzODM3NScsCiAgICAncmJ4YXNzZXRpZDovLzExMDcwMjg4NDgzMDA2MCcsCiAgICAncmJ4YXNzZXRpZDovLzc2MzEyMDIwMjk5NjI0JywKICAgICdyYnhhc3NldGlkOi8vMTI2NjU0OTYxNTQwOTU2JywKICAgICdyYnhhc3NldGlkOi8vMTM5NjEzNjk5MTkzNDAwJywKICAgICdyYnhhc3NldGlkOi8vOTE1MDkyMzQ2Mzk3NjYnLAogICAgJ3JieGFzc2V0aWQ6Ly8xMDU0NTgyNzA0NjMzNzQnCn0KCi0tIGRhbmggc8OhY2ggbW9kZWwga2lsbGVycyB2w6Agc3Vydml2b3JzICh0aGVvIHnDqnUgY+G6p3UgY+G7p2EgYuG6oW4pCmxvY2FsIEtpbGxlcnMgPSB7CiAgICBbIlNsYXNoZXIiXSA9IHRydWUsIFsiMXgxeDF4MSJdID0gdHJ1ZSwgWyJjMDBsa2lkZCJdID0gdHJ1ZSwKICAgIFsiTm9saSJdID0gdHJ1ZSwgWyJKb2huRG9lIl0gPSB0cnVlLCBbIkd1ZXN0IDY2" ..
    "NiJdID0gdHJ1ZSwKICAgIFsiU2l4ZXIiXSA9IHRydWUKfQoKbG9jYWwgU3Vydml2b3JzID0gewogICAgWyJOb29iIl0gPSB0cnVlLCBbIkd1ZXN0MTMzNyJdID0gdHJ1ZSwgWyJFbGxpb3QiXSA9IHRydWUsCiAgICBbIlNoZWRsZXRza3kiXSA9IHRydWUsIFsiVHdvVGltZSJdID0gdHJ1ZSwgWyIwMDduNyJdID0gdHJ1ZSwKICAgIFsiQ2hhbmNlIl0gPSB0cnVlLCBbIkJ1aWxkZXJtYW4iXSA9IHRydWUsIFsiVGFwaCJdID0gdHJ1ZSwKICAgIFsiRHVzZWtrYXIiXSA9IHRydWUsIFsiVmVlcm9uaWNhIl0gPSB0cnVlCn0KCi0tIGdvbSByZWFjaCBsb2dpYyB0aMOgbmggaMOgbSAoxJHDoyBjaOG7iW5oIMSR4buDIMawdSB0acOqbiBuaOG6r20gcGhlIMSR4buRaSBuZ2jhu4tjaCBu4bq/dSBi4bqhbiDhu58gZOG6oW5nIG1vZGVsKQpsb2NhbCBmdW5jdGlvbiBGb3JzYWtlblJlYWNoTG9naWMoKQogICAgaWYgbm90IEZvcnNha2VuUmVhY2hFbmFibGVkIG9yIG5vdCBIdW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIC0tIGtp4buDbSB0cmEgYW5pbWF0aW9uIGF0dGFjayAoZ2nhu68gbmd1ecOqbikKICAgIGxvY2FsIFBsYXlpbmcgPSBmYWxzZQogICAgZm9yIF8sdiBpbiBIdW1hbm9pZDpHZXRQbGF5aW5nQW5pbWF0aW9uVHJhY2tzKCkgZG8KICAgICAgICBpZiB0YWJsZS5maW5kKEF0dGFja0FuaW1hdGlvbnMsIHYuQW5pbWF0aW9uLkFuaW1hdGlvbklkKSBhbmQgKHYuVGltZVBvc2l0aW9u" ..
    "IC8gdi5MZW5ndGggPCAwLjc1KSB0aGVuCiAgICAgICAgICAgIFBsYXlpbmcgPSB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBpZiBub3QgUGxheWluZyB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICAtLSB4w6FjIMSR4buLbmggYuG6oW4gxJFhbmcgbMOgIG1vZGVsIHRodeG7mWMgcGhlIG7DoG8gKG7hur91IGPDsykKICAgIGxvY2FsIFBsYXllclJvbGUgPSBuaWwgLS0gIktpbGxlciIgfCAiU3Vydml2b3IiIHwgbmlsCiAgICBsb2NhbCBteU1vZGVsTmFtZSA9IENoYXJhY3RlciBhbmQgQ2hhcmFjdGVyLk5hbWUKICAgIGlmIG15TW9kZWxOYW1lIGFuZCBLaWxsZXJzW215TW9kZWxOYW1lXSB0aGVuCiAgICAgICAgUGxheWVyUm9sZSA9ICJLaWxsZXIiCiAgICBlbHNlaWYgbXlNb2RlbE5hbWUgYW5kIFN1cnZpdm9yc1tteU1vZGVsTmFtZV0gdGhlbgogICAgICAgIFBsYXllclJvbGUgPSAiU3Vydml2b3IiCiAgICBlbmQKCiAgICBsb2NhbCBPcHBvc2l0ZVRhYmxlID0gbmlsCiAgICBpZiBQbGF5ZXJSb2xlID09ICJLaWxsZXIiIHRoZW4KICAgICAgICBPcHBvc2l0ZVRhYmxlID0gU3Vydml2b3JzCiAgICBlbHNlaWYgUGxheWVyUm9sZSA9PSAiU3Vydml2b3IiIHRoZW4KICAgICAgICBPcHBvc2l0ZVRhYmxlID0gS2lsbGVycwogICAgZW5kCgogICAgbG9jYWwgVGFyZ2V0ID0gbmlsCiAgICBsb2NhbCBDdXJyZW50TmVhcmVzdERpc3QgPSBOZWFyZXN0RGlzdAoKICAgIC0tIDEpIE7hur91IGLhuqFuIMSR" ..
    "YW5nIGzDoCBtb2RlbCAoY8OzIE9wcG9zaXRlVGFibGUpLCDGsHUgdGnDqm4gdMOsbSBt4bulYyB0acOqdSB0aHXhu5ljIHBoZSDEkeG7kWkgbmdo4buLY2ggdHLGsOG7m2MKICAgIGxvY2FsIE9wcFRhcmdldCA9IG5pbAogICAgbG9jYWwgT3BwTmVhcmVzdERpc3QgPSBOZWFyZXN0RGlzdAoKICAgIGxvY2FsIGZ1bmN0aW9uIGxvb3BGb3JPcHAodCkKICAgICAgICBmb3IgXyx2IGluIHBhaXJzKHQpIGRvCiAgICAgICAgICAgIGlmIHYgPT0gQ2hhcmFjdGVyIG9yIG5vdCB2OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0Iikgb3Igbm90IHY6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGxvY2FsIG1vZGVsTmFtZSA9IHYuTmFtZQogICAgICAgICAgICBpZiBPcHBvc2l0ZVRhYmxlIGFuZCBPcHBvc2l0ZVRhYmxlW21vZGVsTmFtZV0gdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgRGlzdCA9ICh2Lkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gLSBIdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgIGlmIERpc3QgPCBPcHBOZWFyZXN0RGlzdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgT3BwTmVhcmVzdERpc3QgPSBEaXN0CiAgICAgICAgICAgICAgICAgICAgT3BwVGFyZ2V0ID0gdgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVu" ..
    "ZAogICAgZW5kCgogICAgaWYgT3Bwb3NpdGVUYWJsZSB0aGVuCiAgICAgICAgbG9vcEZvck9wcCh3b3Jrc3BhY2UuUGxheWVyczpHZXREZXNjZW5kYW50cygpKQogICAgICAgIGxvY2FsIG5wY3NGb2xkZXIgPSB3b3Jrc3BhY2UuTWFwOkZpbmRGaXJzdENoaWxkKCJOUENzIiwgdHJ1ZSkKICAgICAgICBpZiBucGNzRm9sZGVyIHRoZW4KICAgICAgICAgICAgbG9vcEZvck9wcChucGNzRm9sZGVyOkdldENoaWxkcmVuKCkpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSAyKSBO4bq/dSBraMO0bmcgdMOsbSDEkcaw4bujYyBwaGUgxJHhu5FpIG5naOG7i2NoIHRow6wgZmFsbGJhY2sgduG7gSBsb2dpYyBn4buRYyBuaMawbmcgduG6q24gYuG7jyBxdWEgbW9kZWwgY8O5bmcgcGhlIHbhu5tpIGLhuqFuCiAgICBsb2NhbCBmdW5jdGlvbiBsb29wQWxsKHQpCiAgICAgICAgZm9yIF8sdiBpbiBwYWlycyh0KSBkbwogICAgICAgICAgICBpZiB2ID09IENoYXJhY3RlciBvciBub3QgdjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIG9yIG5vdCB2OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIHRoZW4KICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBtb2RlbE5hbWUgPSB2Lk5hbWUKICAgICAgICAgICAgLS0gYuG7jyBxdWEgY8O5bmcgcGhlIG7hur91IGLhuqFuIMSRYW5nIOG7nyBk4bqhbmcgbW9kZWwKICAgICAgICAgICAgaWYgUGxheWVyUm9sZSA9PSAi" ..
    "S2lsbGVyIiBhbmQgS2lsbGVyc1ttb2RlbE5hbWVdIHRoZW4KICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiBQbGF5ZXJSb2xlID09ICJTdXJ2aXZvciIgYW5kIFN1cnZpdm9yc1ttb2RlbE5hbWVdIHRoZW4KICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBEaXN0ID0gKHYuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbiAtIEh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICBpZiBEaXN0IDwgQ3VycmVudE5lYXJlc3REaXN0IHRoZW4KICAgICAgICAgICAgICAgIEN1cnJlbnROZWFyZXN0RGlzdCA9IERpc3QKICAgICAgICAgICAgICAgIFRhcmdldCA9IHYKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBu4bq/dSB0w6xtIHRo4bqleSBPcHBUYXJnZXQgdGjDrCBkw7luZyBsdcO0biwga2jDtG5nIGPhuqduIHTDrG0gdGnhur9wCiAgICBsb2NhbCBGaW5hbFRhcmdldCA9IG5pbAogICAgaWYgT3BwVGFyZ2V0IHRoZW4KICAgICAgICBGaW5hbFRhcmdldCA9IE9wcFRhcmdldAogICAgZWxzZQogICAgICAgIC0tIGZhbGxiYWNrOiBxdcOpdCBwbGF5ZXJzICsgbnBjcyBnaeG7kW5nIHRyxrDhu5tjIG5oxrBuZyDEkcOjIGxv4bqhaSBjw7luZyBwaGUKICAgICAgICBsb29wQWxsKHdvcmtzcGFjZS5QbGF5ZXJzOkdldERlc2NlbmRhbnRzKCkpCiAgICAgICAg" ..
    "bG9jYWwgbnBjc0ZvbGRlcjIgPSB3b3Jrc3BhY2UuTWFwOkZpbmRGaXJzdENoaWxkKCJOUENzIiwgdHJ1ZSkKICAgICAgICBpZiBucGNzRm9sZGVyMiB0aGVuCiAgICAgICAgICAgIGxvb3BBbGwobnBjc0ZvbGRlcjI6R2V0Q2hpbGRyZW4oKSkKICAgICAgICBlbmQKICAgICAgICBGaW5hbFRhcmdldCA9IFRhcmdldAogICAgZW5kCgogICAgaWYgbm90IEZpbmFsVGFyZ2V0IHRoZW4KICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIC0tIGdp4buvIG5ndXnDqm4gcGjhuqduIHTDrW5oIHZlbG9jaXR5ICsgw6FwIGThu6VuZyBoaXQKICAgIGxvY2FsIE9sZFZlbG9jaXR5ID0gSHVtYW5vaWRSb290UGFydC5WZWxvY2l0eQogICAgbG9jYWwgTmVlZGVkVmVsb2NpdHkgPQogICAgICAgIChGaW5hbFRhcmdldC5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uICsgVmVjdG9yMy5uZXcoCiAgICAgICAgICAgIFJORzpOZXh0TnVtYmVyKC0xLjUsIDEuNSksCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIFJORzpOZXh0TnVtYmVyKC0xLjUsIDEuNSkKICAgICAgICApICsgKEZpbmFsVGFyZ2V0Lkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkgKiAoUGxheWVyOkdldE5ldHdvcmtQaW5nKCkgKiAxLjI1KSkKICAgICAgICAgICAgLSBIdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uCiAgICAgICAgKSAvIChQbGF5ZXI6R2V0TmV0d29ya1BpbmcoKSAqIDIpCgogICAgSHVtYW5vaWRSb290UGFydC5WZWxvY2l0eSA9IE5lZWRlZFZlbG9jaXR5CiAg" ..
    "ICBnYW1lOkdldFNlcnZpY2UoJ1J1blNlcnZpY2UnKS5SZW5kZXJTdGVwcGVkOldhaXQoKQogICAgSHVtYW5vaWRSb290UGFydC5WZWxvY2l0eSA9IE9sZFZlbG9jaXR5CmVuZAoKLS0gdsOybmcgbOG6t3AgYXV0byBn4buNaSBs4bqhaSBt4buXaSAwcyAoZ2nhu68gbmd1ecOqbikKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgdGFzay53YWl0KDApCiAgICAgICAgcGNhbGwoRm9yc2FrZW5SZWFjaExvZ2ljKQogICAgZW5kCmVuZCkKCgoKCiAgICBUYWJzLlBsYXllcjpBZGRTZWN0aW9uKCLihrMgV2FsayBTcGVlZCIpCgoKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKbG9jYWwgVmFsdWVTcGVlZCA9IDE2CmxvY2FsIEFjdGl2ZVNwZWVkQm9vc3QgPSBmYWxzZQpsb2NhbCBzcGVlZExvb3AKCmxvY2FsIGZ1bmN0aW9uIHNldFNwZWVkKHNwZWVkKQogICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgaHVtYW5vaWQuV2Fsa1NwZWVkID0gc3BlZWQKICAgICAgICBodW1hbm9pZDpTZXRBdHRyaWJ1dGUoIkJhc2VTcGVlZCIsIHNw" ..
    "ZWVkKQogICAgZW5kCmVuZAoKLS0gS2hpIHJlc3Bhd24gw6FwIGThu6VuZyBs4bqhaSB04buRYyDEkeG7mSBu4bq/dSBi4bqtdApMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIHRhc2sud2FpdCgwLjEpCiAgICBpZiBBY3RpdmVTcGVlZEJvb3N0IHRoZW4KICAgICAgICBzZXRTcGVlZChWYWx1ZVNwZWVkKQogICAgZW5kCmVuZCkKCi0tIFNsaWRlciBjaOG7iW5oIHThu5FjIMSR4buZClRhYnMuUGxheWVyOkFkZFNsaWRlcigiUGxheWVyU3BlZWRTbGlkZXIiLCB7CiAgICBUaXRsZSA9ICJTZXQgU3BlZWQiLAogICAgTWluID0gMCwKICAgIE1heCA9IDQwLAogICAgRGVmYXVsdCA9IFZhbHVlU3BlZWQsCiAgICBSb3VuZGluZyA9IDEsCn0pOk9uQ2hhbmdlZChmdW5jdGlvbih2YWx1ZSkKICAgIFZhbHVlU3BlZWQgPSB2YWx1ZQogICAgaWYgQWN0aXZlU3BlZWRCb29zdCB0aGVuCiAgICAgICAgc2V0U3BlZWQoVmFsdWVTcGVlZCkKICAgIGVuZAplbmQpCgotLSBUb2dnbGUgYuG6rXQvdOG6r3QgdOG7kWMgxJHhu5kgdsOgIGxvb3AgdMSDbmcgdOG7kWMgbGnDqm4gdOG7pWMKVGFicy5QbGF5ZXI6QWRkVG9nZ2xlKCJQbGF5ZXJTcGVlZFRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIldhbGsgU3BlZWQiLAogICAgRGVmYXVsdCA9IGZhbHNlLAp9KTpPbkNoYW5nZWQoZnVuY3Rpb24odmFsdWUpCiAgICBBY3RpdmVTcGVlZEJvb3N0ID0gdmFsdWUKICAgIGlmIHZhbHVlIHRoZW4KICAgICAgICBz" ..
    "ZXRTcGVlZChWYWx1ZVNwZWVkKQogICAgICAgIC0tIELhuq90IMSR4bqndSB2w7JuZyBs4bq3cCBsacOqbiB04bulYyBzZXQgdOG7kWMgxJHhu5kgbeG7l2kgMC41IGdpw6J5CiAgICAgICAgc3BlZWRMb29wID0gdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIEFjdGl2ZVNwZWVkQm9vc3QgZG8KICAgICAgICAgICAgICAgIHNldFNwZWVkKFZhbHVlU3BlZWQpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbHNlCiAgICAgICAgLS0gVOG6r3QgdsOybmcgbOG6t3AgdsOgIHJlc2V0IHThu5FjIMSR4buZIHbhu4EgbeG6t2MgxJHhu4tuaCAxNgogICAgICAgIGlmIHNwZWVkTG9vcCB0aGVuCiAgICAgICAgICAgIHNwZWVkTG9vcCA9IG5pbAogICAgICAgIGVuZAogICAgICAgIHNldFNwZWVkKDE2KQogICAgZW5kCmVuZCkKCgoKICAgIFRhYnMuUGxheWVyOkFkZFNlY3Rpb24oIuKGsyBUZWxlcG9ydCBTcGVlZCIpCgoKLS0gPT09IFRlbGVwb3J0IFNwZWVkIFNldHVwID09PQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCgpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgQ2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldh" ..
    "aXQoKQpsb2NhbCBIdW1hbm9pZCA9IENoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIikKbG9jYWwgSFJQID0gQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgpsb2NhbCBkZWZhdWx0U3BlZWQgPSA1MApsb2NhbCBtYXhTcGVlZCA9IDMwMApsb2NhbCBjdXJyZW50U3BlZWQgPSBkZWZhdWx0U3BlZWQKbG9jYWwgdGVsZXBvcnRTcGVlZEVuYWJsZWQgPSBmYWxzZQoKLS0gQ+G6rXAgbmjhuq10IGzhuqFpIGtoaSByZXNwYXduCkxvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcikKICAgIENoYXJhY3RlciA9IGNoYXIKICAgIEh1bWFub2lkID0gQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiKQogICAgSFJQID0gQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCmVuZCkKCi0tIExvb3AgxJHhu4MgZOG7i2NoIGNodXnhu4NuICh0ZWxlcG9ydCBzcGVlZCkKUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbihkdCkKICAgIGlmIHRlbGVwb3J0U3BlZWRFbmFibGVkIGFuZCBIdW1hbm9pZCBhbmQgSFJQIHRoZW4KICAgICAgICBpZiBIdW1hbm9pZC5Nb3ZlRGlyZWN0aW9uLk1hZ25pdHVkZSA+IDAgdGhlbgogICAgICAgICAgICBsb2NhbCBtb3ZlRGlyID0gSHVtYW5vaWQuTW92ZURpcmVjdGlvbi5Vbml0CiAgICAgICAgICAgIEhSUC5DRnJhbWUgPSBIUlAuQ0ZyYW1lICsgKG1vdmVEaXIgKiAoY3VycmVu" ..
    "dFNwZWVkICogZHQpKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCi0tID09PSBHVUkgQmluZGluZ3MgPT09Ci0tIFNsaWRlciBUZWxlcG9ydCBTcGVlZApUYWJzLlBsYXllcjpBZGRTbGlkZXIoIlRlbGVwb3J0U3BlZWRTbGlkZXIiLCB7CiAgICBUaXRsZSA9ICJTZXQgU3BlZWQiLAogICAgTWluID0gMSwKICAgIE1heCA9IG1heFNwZWVkLAogICAgRGVmYXVsdCA9IGRlZmF1bHRTcGVlZCwKICAgIFJvdW5kaW5nID0gMSwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKQogICAgY3VycmVudFNwZWVkID0gdmFsdWUKZW5kKQoKLS0gVG9nZ2xlIGLhuq10L3Thuq90IFRlbGVwb3J0IFNwZWVkClRhYnMuUGxheWVyOkFkZFRvZ2dsZSgiVGVsZXBvcnRTcGVlZFRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIlRlbGVwb3J0IFNwZWVkIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKGVuYWJsZWQpCiAgICB0ZWxlcG9ydFNwZWVkRW5hYmxlZCA9IGVuYWJsZWQKZW5kKQoKICAgICAKCi0tIFRhYnMuVmlzdWFsCgotLS8vIOKame+4jyBFU1AgTG/huqFpOiBDbG9uZSwgUGxheWVyLCBTdXJ2aXZvcnMsIEtpbGxlcnMsIEdlbmVyYXRvciwgSXRlbXMsIEJ1aWxkbWFuCi0tLy8gVOG6pXQgY+G6oyDEkeG7gXUgZMO5bmcgY2h1bmcgRVNQTWFuYWdlciAoxJHDoyDEkeG7i25oIG5naMSpYSDhu58gdHLDqm4pCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgTG9jYWxQ" ..
    "bGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSDwn5+iIDEuIENMT05FIEVTUAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpsb2NhbCBhbGxvd2VkTW9kZWxzQ2xvbmUgPSB7CiAgICBbIjF4MXgxeDFab21iaWUiXSA9IHRydWUsCiAgICBbIlBpenphRGVsaXZlcnlSaWciXSA9IHRydWUsCiAgICBbIk1hZmlhMSJdID0gdHJ1ZSwKICAgIFsiTWFmaWEyIl0gPSB0cnVlLAogICAgWyJNYWZpYTMiXSA9IHRydWUsCiAgICBbIk1hZmlhNCJdID0gdHJ1ZSwKfQoKX0cuRVNQTWFuYWdlcjpSZWdpc3RlclR5cGUoIkNsb25lIiwgQ29sb3IzLmZyb21SR0IoMCwgMjU1LCAwKSwgZnVuY3Rpb24ob2JqKQogICAgcmV0dXJuIG9iajpJc0EoIk1vZGVsIikgYW5kIGFsbG93ZWRNb2RlbHNDbG9uZVtvYmouTmFtZV0KZW5kLCBmYWxzZSkKClRhYnMuVmlzdWFsOkFkZFRvZ2dsZSgiRVNQQ2xvbmVUb2dnbGUiLCB7CiAgICBUaXRsZSA9ICJFU1AgQ2xvbmUiLAogICAgRGVmYXVsdCA9IGZhbHNlLAp9KTpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICBfRy5FU1BNYW5hZ2VyOlNldEVuYWJsZWQoIkNsb25lIiwgc3RhdGUpCmVuZCkKCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSDwn5S1IDIuIFBMQVlFUiBFU1AKLS0tLS0tLS0t" ..
    "LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBUYWJzLlZpc3VhbDpBZGRTZWN0aW9uKCLihrMgUGxheWVyIikKCl9HLkVTUE1hbmFnZXI6UmVnaXN0ZXJUeXBlKCJQbGF5ZXIiLCBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDI1NSksIGZ1bmN0aW9uKG9iaikKICAgIGxvY2FsIHBsciA9IFBsYXllcnM6R2V0UGxheWVyRnJvbUNoYXJhY3RlcihvYmopCiAgICByZXR1cm4gcGxyIGFuZCBwbHIgfj0gTG9jYWxQbGF5ZXIKZW5kLCBmYWxzZSkKClRhYnMuVmlzdWFsOkFkZFRvZ2dsZSgiRVNQUGxheWVyVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiRVNQIFBsYXllciIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgIF9HLkVTUE1hbmFnZXI6U2V0RW5hYmxlZCgiUGxheWVyIiwgc3RhdGUpCmVuZCkKCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSDimqogMy4gU1VSVklWT1JTIEVTUCAoY8OzIEhQKQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpsb2NhbCBzdXJ2aXZvcnNGb2xkZXIgPSB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJQbGF5ZXJzIik6V2FpdEZvckNoaWxkKCJTdXJ2aXZvcnMiKQpfRy5FU1BNYW5hZ2VyOlJlZ2lzdGVyVHlwZSgiU3Vydml2b3IiLCBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KSwgZnVuY3Rpb24ob2Jq" ..
    "KQogICAgcmV0dXJuIG9iajpJc0EoIk1vZGVsIikgYW5kIG9iai5QYXJlbnQgPT0gc3Vydml2b3JzRm9sZGVyIGFuZCBvYmo6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCmVuZCwgdHJ1ZSkKClRhYnMuVmlzdWFsOkFkZFRvZ2dsZSgiRVNQTW9kZWxXaGl0ZVRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIkVTUCBTdXJ2aXZvcnMiLAogICAgRGVmYXVsdCA9IGZhbHNlLAp9KTpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICBfRy5FU1BNYW5hZ2VyOlNldEVuYWJsZWQoIlN1cnZpdm9yIiwgc3RhdGUpCmVuZCkKCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSDwn5S0IDQuIEtJTExFUlMgRVNQIChjw7MgSFApCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmxvY2FsIGtpbGxlcnNGb2xkZXIgPSB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJQbGF5ZXJzIik6V2FpdEZvckNoaWxkKCJLaWxsZXJzIikKX0cuRVNQTWFuYWdlcjpSZWdpc3RlclR5cGUoIktpbGxlciIsIENvbG9yMy5mcm9tUkdCKDI1NSwgMCwgMCksIGZ1bmN0aW9uKG9iaikKICAgIHJldHVybiBvYmo6SXNBKCJNb2RlbCIpIGFuZCBvYmouUGFyZW50ID09IGtpbGxlcnNGb2xkZXIgYW5kIG9iajpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKZW5kLCB0cnVlKQoKVGFicy5WaXN1YWw6QWRkVG9nZ2xlKCJFU1BNb2RlbFJlZFRvZ2ds" ..
    "ZSIsIHsKICAgIFRpdGxlID0gIkVTUCBLaWxsZXJzIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHN0YXRlKQogICAgX0cuRVNQTWFuYWdlcjpTZXRFbmFibGVkKCJLaWxsZXIiLCBzdGF0ZSkKZW5kKQoKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tIOKame+4jyA1LiBHRU5FUkFUT1IgRVNQCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgVGFicy5WaXN1YWw6QWRkU2VjdGlvbigi4oazIE90aGVyIikKCl9HLkVTUE1hbmFnZXI6UmVnaXN0ZXJUeXBlKCJHZW5lcmF0b3IiLCBDb2xvcjMuZnJvbVJHQigyNTUsMjU1LDI1NSksIGZ1bmN0aW9uKG9iaikKICAgIGlmIG5vdCAob2JqIGFuZCBvYmo6SXNBKCJNb2RlbCIpIGFuZCBvYmouTmFtZSA9PSAiR2VuZXJhdG9yIikgdGhlbgogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgbG9jYWwgcHJvZ3Jlc3MgPSBvYmo6RmluZEZpcnN0Q2hpbGQoIlByb2dyZXNzIiwgdHJ1ZSkKICAgIGlmIG5vdCBwcm9ncmVzcyBvciBub3QgcHJvZ3Jlc3M6SXNBKCJOdW1iZXJWYWx1ZSIpIHRoZW4KICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAoKICAgIC0tIEfhuq9uIGvhur90IG3hu5l0IGzhuqduIMSR4buDIHRoZW8gZMO1aSBraGkgUHJvZ3Jlc3MuVmFsdWUgdGhheSDEkeG7lWkKICAgIGlmIG5vdCBwcm9ncmVzczpHZXRBdHRy" ..
    "aWJ1dGUoIkVTUF9XYXRjaCIpIHRoZW4KICAgICAgICBwcm9ncmVzczpTZXRBdHRyaWJ1dGUoIkVTUF9XYXRjaCIsIHRydWUpCiAgICAgICAgcHJvZ3Jlc3M6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJWYWx1ZSIpOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAtLSBO4bq/dSDEkeG6oXQgMTAwJSB0aMOsIHJlbW92ZSBFU1AgbmdheQogICAgICAgICAgICBpZiBwcm9ncmVzcy5WYWx1ZSA+PSAxMDAgdGhlbgogICAgICAgICAgICAgICAgX0cuRVNQTWFuYWdlcjpSZW1vdmUob2JqKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAtLSBO4bq/dSBFU1AgY2jGsGEgY8OzLCB04bqhbyBs4bqhaQogICAgICAgICAgICAgICAgaWYgbm90IF9HLkVTUE1hbmFnZXIuT2JqZWN0c1tvYmpdIHRoZW4KICAgICAgICAgICAgICAgICAgICBfRy5FU1BNYW5hZ2VyOl9TY2hlZHVsZUNyZWF0ZShvYmosICJHZW5lcmF0b3IiKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIC0tIENo4buJIGhp4buDbiB0aOG7iyBraGkgY2jGsGEgaG/DoG4gdGjDoG5oCiAgICByZXR1cm4gcHJvZ3Jlc3MuVmFsdWUgPCAxMDAKZW5kLCBmYWxzZSkKClRhYnMuVmlzdWFsOkFkZFRvZ2dsZSgiRVNQR2VuZXJhdG9yVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiRVNQIEdlbmVyYXRvciIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkK" ..
    "ICAgIF9HLkVTUE1hbmFnZXI6U2V0RW5hYmxlZCgiR2VuZXJhdG9yIiwgc3RhdGUpCmVuZCkKCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSDwn5+hIDYuIElURU1TIEVTUAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpfRy5FU1BNYW5hZ2VyOlJlZ2lzdGVyVHlwZSgiSXRlbSIsIENvbG9yMy5mcm9tUkdCKDI1NSwyMTUsMCksIGZ1bmN0aW9uKG9iaikKICAgIHJldHVybiBvYmo6SXNBKCJUb29sIikgYW5kIG9iai5QYXJlbnQgYW5kIG9iajpJc0Rlc2NlbmRhbnRPZih3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIk1hcCIpKQplbmQsIGZhbHNlKQoKVGFicy5WaXN1YWw6QWRkVG9nZ2xlKCJFU1BJdGVtc1RvZ2dsZSIsIHsKICAgIFRpdGxlID0gIkVTUCBJdGVtcyIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgIF9HLkVTUE1hbmFnZXI6U2V0RW5hYmxlZCgiSXRlbSIsIHN0YXRlKQplbmQpCgoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0g8J+foyA3LiBCVUlMRE1BTiBFU1AKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KX0cuRVNQTWFuYWdlcjpSZWdpc3RlclR5cGUoIkRpc3BlbnNlciIsIENvbG9yMy5mcm9tUkdCKDAsIDE2MiwgMjU1KSwgZnVuY3Rpb24o" ..
    "b2JqKQogICAgcmV0dXJuIG9iajpJc0EoIk1vZGVsIikgYW5kIG9iai5OYW1lOmxvd2VyKCk6ZmluZCgiZGlzcGVuc2VyIikKZW5kLCBmYWxzZSkKCl9HLkVTUE1hbmFnZXI6UmVnaXN0ZXJUeXBlKCJTZW50cnkiLCBDb2xvcjMuZnJvbVJHQigxMjgsIDEyOCwgMTI4KSwgZnVuY3Rpb24ob2JqKQogICAgcmV0dXJuIG9iajpJc0EoIk1vZGVsIikgYW5kIG9iai5OYW1lOmxvd2VyKCk6ZmluZCgic2VudHJ5IikKZW5kLCBmYWxzZSkKCl9HLkVTUE1hbmFnZXI6UmVnaXN0ZXJUeXBlKCJUcmlwd2lyZSIsIENvbG9yMy5mcm9tUkdCKDI1NSwgODUsIDApLCBmdW5jdGlvbihvYmopCiAgICByZXR1cm4gb2JqOklzQSgiTW9kZWwiKSBhbmQgb2JqLk5hbWU6ZmluZCgiVGFwaFRyaXB3aXJlIikKZW5kLCBmYWxzZSkKCl9HLkVTUE1hbmFnZXI6UmVnaXN0ZXJUeXBlKCJTdWJzcGFjZSIsIENvbG9yMy5mcm9tUkdCKDE2MCwgMzIsIDI0MCksIGZ1bmN0aW9uKG9iaikKICAgIHJldHVybiBvYmo6SXNBKCJNb2RlbCIpIGFuZCBvYmouTmFtZSA9PSAiU3Vic3BhY2VUcmlwbWluZSIKZW5kLCBmYWxzZSkKClRhYnMuVmlzdWFsOkFkZFNlY3Rpb24oIuKGsyBCdWlsZG1hbiIpCgpUYWJzLlZpc3VhbDpBZGRUb2dnbGUoIkRpc3BlbnNlckVTUF9Ub2dnbGUiLCB7CiAgICBUaXRsZSA9ICJFU1AgRGlzcGVuc2VyIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHN0YXRlKQogICAgX0cuRVNQTWFuYWdlcjpTZXRFbmFi" ..
    "bGVkKCJEaXNwZW5zZXIiLCBzdGF0ZSkKZW5kKQoKVGFicy5WaXN1YWw6QWRkVG9nZ2xlKCJTZW50cnlFU1BfVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiRVNQIFNlbnRyeSIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgIF9HLkVTUE1hbmFnZXI6U2V0RW5hYmxlZCgiU2VudHJ5Iiwgc3RhdGUpCmVuZCkKClRhYnMuVmlzdWFsOkFkZFNlY3Rpb24oIuKGsyBUYXB0L1RyYXAiKQoKVGFicy5WaXN1YWw6QWRkVG9nZ2xlKCJUcmlwd2lyZUVTUF9Ub2dnbGUiLCB7CiAgICBUaXRsZSA9ICJFU1AgVHJpcCBXaXJlIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHN0YXRlKQogICAgX0cuRVNQTWFuYWdlcjpTZXRFbmFibGVkKCJUcmlwd2lyZSIsIHN0YXRlKQplbmQpCgpUYWJzLlZpc3VhbDpBZGRUb2dnbGUoIlN1YnNwYWNlRVNQX1RvZ2dsZSIsIHsKICAgIFRpdGxlID0gIkVTUCBCb21iIFRyYXAiLAogICAgRGVmYXVsdCA9IGZhbHNlLAp9KTpPbkNoYW5nZWQoZnVuY3Rpb24oc3RhdGUpCiAgICBfRy5FU1BNYW5hZ2VyOlNldEVuYWJsZWQoIlN1YnNwYWNlIiwgc3RhdGUpCmVuZCkKCi0tIFRhYnMuTWlzYwoKCgoKbG9jYWwgTGlnaHRpbmcgPSBnYW1lOkdldFNlcnZpY2UoIkxpZ2h0aW5nIikKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCgotLSDinIUgRnVsbEJyaWdodCBTZXR0aW5ncwpsb2NhbCBmdWxs" ..
    "QnJpZ2h0RW5hYmxlZCA9IGZhbHNlCmxvY2FsIGZ1bGxCcmlnaHRMb29wCgpsb2NhbCBmdW5jdGlvbiBhcHBseUZ1bGxCcmlnaHQoKQogICAgaWYgbm90IGZ1bGxCcmlnaHRFbmFibGVkIHRoZW4gcmV0dXJuIGVuZAoKICAgIExpZ2h0aW5nLkFtYmllbnQgPSBDb2xvcjMuZnJvbVJHQigyMDAsIDIwMCwgMjAwKSAtLSBzw6FuZyBuaOG6uQogICAgTGlnaHRpbmcuQnJpZ2h0bmVzcyA9IDQgLS0gZ2nhuqNtIMSR4buZIHPDoW5nIHThu6sgMTAg4oaSIDQKICAgIExpZ2h0aW5nLkdsb2JhbFNoYWRvd3MgPSBmYWxzZQplbmQKCmxvY2FsIGZ1bmN0aW9uIGVuYWJsZUZ1bGxCcmlnaHQoKQogICAgaWYgZnVsbEJyaWdodExvb3AgdGhlbiBmdWxsQnJpZ2h0TG9vcDpEaXNjb25uZWN0KCkgZW5kCiAgICBhcHBseUZ1bGxCcmlnaHQoKQogICAgZnVsbEJyaWdodExvb3AgPSBMaWdodGluZzpHZXRQcm9wZXJ0eUNoYW5nZWRTaWduYWwoIkNsb2NrVGltZSIpOkNvbm5lY3QoYXBwbHlGdWxsQnJpZ2h0KQplbmQKCmxvY2FsIGZ1bmN0aW9uIGRpc2FibGVGdWxsQnJpZ2h0KCkKICAgIGlmIGZ1bGxCcmlnaHRMb29wIHRoZW4KICAgICAgICBmdWxsQnJpZ2h0TG9vcDpEaXNjb25uZWN0KCkKICAgICAgICBmdWxsQnJpZ2h0TG9vcCA9IG5pbAogICAgZW5kCgogICAgTGlnaHRpbmcuQW1iaWVudCA9IENvbG9yMy5mcm9tUkdCKDEyOCwgMTI4LCAxMjgpCiAgICBMaWdodGluZy5CcmlnaHRuZXNzID0gMQogICAgTGlnaHRpbmcuR2xvYmFsU2hhZG93" ..
    "cyA9IHRydWUKZW5kCgotLSDinIUgVG9nZ2xlOiBGdWxsQnJpZ2h0CmxvY2FsIEZiVG9nZ2xlID0gVGFicy5NaXNjOkFkZFRvZ2dsZSgiRmJUb2dnbGUiLCB7CiAgICBUaXRsZSA9ICJBdXRvIEZ1bGwgQnJpZ2h0IiwKICAgIERlZmF1bHQgPSBmYWxzZQp9KQpGYlRvZ2dsZTpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpCiAgICBmdWxsQnJpZ2h0RW5hYmxlZCA9IFZhbHVlCiAgICBpZiBmdWxsQnJpZ2h0RW5hYmxlZCB0aGVuCiAgICAgICAgZW5hYmxlRnVsbEJyaWdodCgpCiAgICBlbHNlCiAgICAgICAgZGlzYWJsZUZ1bGxCcmlnaHQoKQogICAgZW5kCmVuZCkKCi0tIOKchSBSZW1vdmUgRm9nIFNldHRpbmdzCmxvY2FsIGZvZ0VuYWJsZWQgPSBmYWxzZQpsb2NhbCBmb2dMb29wCgpsb2NhbCBmdW5jdGlvbiByZW1vdmVGb2coKQogICAgTGlnaHRpbmcuRm9nU3RhcnQgPSAwCiAgICBMaWdodGluZy5Gb2dFbmQgPSAxMDAwMDAwCgogICAgbG9jYWwgYXRtb3NwaGVyZSA9IExpZ2h0aW5nOkZpbmRGaXJzdENoaWxkKCJBdG1vc3BoZXJlIikKICAgIGlmIGF0bW9zcGhlcmUgdGhlbgogICAgICAgIGF0bW9zcGhlcmUuRGVuc2l0eSA9IDAKICAgICAgICBhdG1vc3BoZXJlLk9mZnNldCA9IDAKICAgICAgICBhdG1vc3BoZXJlLkhhemUgPSAwCiAgICAgICAgYXRtb3NwaGVyZS5Db2xvciA9IENvbG9yMy5uZXcoMSwgMSwgMSkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHJlc3RvcmVGb2coKQogICAgTGlnaHRpbmcuRm9nU3Rh" ..
    "cnQgPSAyMDAKICAgIExpZ2h0aW5nLkZvZ0VuZCA9IDEwMDAKCiAgICBsb2NhbCBhdG1vc3BoZXJlID0gTGlnaHRpbmc6RmluZEZpcnN0Q2hpbGQoIkF0bW9zcGhlcmUiKQogICAgaWYgYXRtb3NwaGVyZSB0aGVuCiAgICAgICAgYXRtb3NwaGVyZS5EZW5zaXR5ID0gMC4zCiAgICAgICAgYXRtb3NwaGVyZS5PZmZzZXQgPSAwCiAgICAgICAgYXRtb3NwaGVyZS5IYXplID0gMC41CiAgICAgICAgYXRtb3NwaGVyZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMjAwLCAyMDApCiAgICBlbmQKZW5kCgotLSDinIUgVG9nZ2xlOiBSZW1vdmUgRm9nCmxvY2FsIEZvZ1RvZ2dsZSA9IFRhYnMuTWlzYzpBZGRUb2dnbGUoIkZvZ1RvZ2dsZSIsIHsKICAgIFRpdGxlID0gIlJlbW92ZSBGb2ciLAogICAgRGVmYXVsdCA9IGZhbHNlCn0pCkZvZ1RvZ2dsZTpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpCiAgICBmb2dFbmFibGVkID0gVmFsdWUKICAgIGlmIGZvZ0VuYWJsZWQgdGhlbgogICAgICAgIHJlbW92ZUZvZygpCiAgICAgICAgZm9nTG9vcCA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QocmVtb3ZlRm9nKQogICAgZWxzZQogICAgICAgIGlmIGZvZ0xvb3AgdGhlbiBmb2dMb29wOkRpc2Nvbm5lY3QoKSBmb2dMb29wID0gbmlsIGVuZAogICAgICAgIHJlc3RvcmVGb2coKQogICAgZW5kCmVuZCkKCgoKbG9jYWwgTGlnaHRpbmcgPSBnYW1lOkdldFNlcnZpY2UoIkxpZ2h0aW5nIikKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0" ..
    "U2VydmljZSgiUGxheWVycyIpCmxvY2FsIExQID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBQbGF5ZXJHdWkgPSBMUDpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpCgotLSBGbGFnIGLhuq10L3Thuq90CmxvY2FsIEFjdGl2ZVJlbW92ZUFsbCA9IGZhbHNlCgotLSBEYW5oIHPDoWNoIHTDqm4gaGnhu4d1IOG7qW5nIHRoxrDhu51uZyBn4bq3cApsb2NhbCBlZmZlY3ROYW1lcyA9IHsKICAgICJCbHVyRWZmZWN0IiwgIkNvbG9yQ29ycmVjdGlvbkVmZmVjdCIsICJCbG9vbUVmZmVjdCIsICJTdW5SYXlzRWZmZWN0IiwgCiAgICAiRGVwdGhPZkZpZWxkRWZmZWN0IiwgIlNjcmVlbkZsYXNoIiwgIkhpdEVmZmVjdCIsICJEYW1hZ2VPdmVybGF5IiwgCiAgICAiQmxvb2RFZmZlY3QiLCAiVmlnbmV0dGUiLCAiQmxhY2tTY3JlZW4iLCAiV2hpdGVTY3JlZW4iLCAiU2hvY2tFZmZlY3QiLAogICAgIkRhcmtuZXNzIiwgIkp1bXBTY2FyZSIsICJMb3dIZWFsdGhPdmVybGF5IiwgIkZsYXNoYmFuZyIsICJGYWRlRWZmZWN0Igp9CgotLSBEYW5oIHPDoWNoIGNsYXNzIGhp4buHdSDhu6luZyB0cm9uZyBMaWdodGluZwpsb2NhbCBlZmZlY3RDbGFzc2VzID0gewogICAgIkJsdXJFZmZlY3QiLAogICAgIkJsb29tRWZmZWN0IiwKICAgICJTdW5SYXlzRWZmZWN0IiwKICAgICJEZXB0aE9mRmllbGRFZmZlY3QiLAogICAgIkNvbG9yQ29ycmVjdGlvbkVmZmVjdCIKfQoKLS0g8J+MnyBIw6BtIHhvw6EgdOG6pXQgY+G6oyAoZWZmZWN0cyArIHBv" ..
    "cHVwcykKbG9jYWwgZnVuY3Rpb24gcmVtb3ZlQWxsKCkKICAgIC0tIFhvw6EgaGnhu4d1IOG7qW5nIHRyb25nIExpZ2h0aW5nCiAgICBmb3IgXywgb2JqIGluIHBhaXJzKExpZ2h0aW5nOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgaWYgdGFibGUuZmluZChlZmZlY3ROYW1lcywgb2JqLk5hbWUpIG9yIHRhYmxlLmZpbmQoZWZmZWN0Q2xhc3Nlcywgb2JqLkNsYXNzTmFtZSkgdGhlbgogICAgICAgICAgICBvYmo6RGVzdHJveSgpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBYb8OhIEdVSSBvdmVybGF5CiAgICBmb3IgXywgb2JqIGluIHBhaXJzKFBsYXllckd1aTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgIGlmIHRhYmxlLmZpbmQoZWZmZWN0TmFtZXMsIG9iai5OYW1lKSB0aGVuCiAgICAgICAgICAgIG9iajpEZXN0cm95KCkKICAgICAgICBlbHNlaWYgb2JqOklzQSgiU2NyZWVuR3VpIikgb3Igb2JqOklzQSgiQmlsbGJvYXJkR3VpIikgb3Igb2JqOklzQSgiU3VyZmFjZUd1aSIpIHRoZW4KICAgICAgICAgICAgaWYgb2JqOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkltYWdlTGFiZWwiKSBvciBvYmo6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiRnJhbWUiKSB0aGVuCiAgICAgICAgICAgICAgICBpZiB0YWJsZS5maW5kKGVmZmVjdE5hbWVzLCBvYmouTmFtZSkgb3Igb2JqLk5hbWU6bG93ZXIoKTpmaW5kKCJvdmVybGF5Iikgb3Igb2JqLk5hbWU6bG93ZXIoKTpmaW5kKCJlZmZlY3QiKSB0aGVuCiAgICAg" ..
    "ICAgICAgICAgICAgICAgb2JqOkRlc3Ryb3koKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gWG/DoSBwb3B1cCAxeDF4MXgxCiAgICBsb2NhbCB0ZW1wID0gUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJUZW1wb3JhcnlVSSIpCiAgICBpZiB0ZW1wIHRoZW4KICAgICAgICBsb2NhbCBwb3B1cCA9IHRlbXA6RmluZEZpcnN0Q2hpbGQoIjF4MXgxeDFQb3B1cCIpCiAgICAgICAgaWYgcG9wdXAgdGhlbgogICAgICAgICAgICBwb3B1cDpEZXN0cm95KCkKICAgICAgICAgICAgd2FybigiW1JlbW92ZXJdIDF4MXgxeDFQb3B1cCByZW1vdmVkIikKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tIFRvZ2dsZSBGbHVlbnQgLSBjaOG7iSAxIGPDoWkKVGFicy5NaXNjOkFkZFRvZ2dsZSgiUmVtb3ZlQWxsQmFkU3R1ZmYiLCB7CiAgICBUaXRsZSA9ICJSZW1vdmUgRWZmZWN0cyBWMiIsCiAgICBEZWZhdWx0ID0gdHJ1ZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgQWN0aXZlUmVtb3ZlQWxsID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgQWN0aXZlUmVtb3ZlQWxsIGRvCiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQWxsKCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgZW5kCiAgICAg" ..
    "ICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKCgogICAgVGFicy5NaXNjOkFkZFNlY3Rpb24oIuKGsyBTZXJ2ZXIiKQoKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSDimqEgU0VSVkVSIEhPUCAoTW9iaWxlLWZyaWVuZGx5ICsgRmx1ZW50IEJ1dHRvbikKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpsb2NhbCBUZWxlcG9ydFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlRlbGVwb3J0U2VydmljZSIpCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCi0tIPCfjIAgSMOgbSB0aOG7sWMgaGnhu4duIHRlbGVwb3J0IHNhbmcgc2VydmVyIG3hu5tpCmxvY2FsIGZ1bmN0aW9uIFNlcnZlckhvcCgpCiAgICBsb2NhbCBwbGFjZUlkID0gZ2FtZS5QbGFjZUlkCiAgICBsb2NhbCBqb2JJZCA9IGdhbWUuSm9iSWQKICAgIHByaW50KCJbU2VydmVySG9wXSDEkGFuZyBy4budaSBzZXJ2ZXIgaGnhu4duIHThuqFpLi4uIikKCiAgICAtLSBwY2FsbCDEkeG7gyB0csOhbmggbOG7l2kgVGVsZXBvcnQgY3Jhc2gKICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBUZWxlcG9ydFNlcnZpY2U6VGVsZXBvcnQocGxhY2VJZCwgTG9jYWxQbGF5ZXIpCiAgICBl" ..
    "bmQpCgogICAgaWYgc3VjY2VzcyB0aGVuCiAgICAgICAgaWYgRmx1ZW50IGFuZCBGbHVlbnQuTm90aWZ5IHRoZW4KICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJSZWpvaW4gU3RhcnRpbmciLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJC4bqvdCDEkOG6p3UgVsOgbyBNw6F5IENo4bunIMSQw6MgRml4IExhZyIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDMKICAgICAgICAgICAgfSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHByaW50KCJbU2VydmVySG9wXSDEkGFuZyBjaHV54buDbiBzZXJ2ZXIuLi4iKQogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIHdhcm4oIltTZXJ2ZXJIb3BdIEzhu5dpIGtoaSBUZWxlcG9ydDoiLCBlcnIpCiAgICAgICAgaWYgRmx1ZW50IGFuZCBGbHVlbnQuTm90aWZ5IHRoZW4KICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJM4buXaSBUZWxlcG9ydCIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gdG9zdHJpbmcoZXJyKSwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNAogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSDwn6epIFRIw4pNIE7DmlQgVFJPTkcgRkxVRU5UIFVJCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t" ..
    "LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKLS0gR2nhuqMgc+G7rSBi4bqhbiBjw7MgdGFiIERldiBz4bq1biwgdMawxqFuZyB04buxIHbDrSBk4bulIGPhu6dhIGLhuqFuOgotLSBUYWJzLkRldjpBZGRCdXR0b24oLi4uKQoKVGFicy5NaXNjOkFkZEJ1dHRvbih7CiAgICBUaXRsZSA9ICJSZWpvaW4gVG8gRml4IExhZyIsCiAgICBEZXNjcmlwdGlvbiA9ICJUaGFtIEdpYSBM4bqhaSBNw6F5IENo4bunIMSQ4buDIEdp4bqjbSBMYWciLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgLS0gSGnhu4duIHRow7RuZyBiw6FvIGNodeG6qW4gYuG7iwogICAgICAgIGlmIEZsdWVudCBhbmQgRmx1ZW50Lk5vdGlmeSB0aGVuCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiUmVqb2luIFNldHRpbmdzIiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAixJBhbmcgR2nhuqNtIExhZyBDaG8gQ8OhYyBNw6F5IENo4bunLi4uIiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgIGVuZAoKICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgIFNlcnZlckhvcCgpCiAgICBlbmQKfSkKCgoKLS0g8J+MkCBTZXJ2ZXIgSG9wIEJ1dHRvbgpUYWJzLk1pc2M6QWRkQnV0dG9uKHsKICAgIFRpdGxlID0gIlNlcnZlciBIb3AgVG8gTG93IFBsYXllciIsCiAgICBEZXNjcmlwdGlvbiA9ICJEw7luZyDEkOG7gyDEkOG7lWkgU2VydmVyIEPDsyBU" ..
    "aOG7gyBWw6BvIFNlcnZlciDDjXQgUGxheWVyIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIFBsYWNlSUQgPSBnYW1lLlBsYWNlSWQKICAgICAgICBsb2NhbCBBbGxJRHMgPSB7fQogICAgICAgIGxvY2FsIGZvdW5kQW55dGhpbmcgPSAiIgogICAgICAgIGxvY2FsIGFjdHVhbEhvdXIgPSBvcy5kYXRlKCIhKnQiKS5ob3VyCgogICAgICAgIC0tIMSQ4buNYyBmaWxlIG7hur91IGPDswogICAgICAgIGxvY2FsIEZpbGUgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIEFsbElEcyA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKTpKU09ORGVjb2RlKHJlYWRmaWxlKCJOb3RTYW1lU2VydmVycy5qc29uIikpCiAgICAgICAgZW5kKQoKICAgICAgICBpZiBub3QgRmlsZSB0aGVuCiAgICAgICAgICAgIHRhYmxlLmluc2VydChBbGxJRHMsIGFjdHVhbEhvdXIpCiAgICAgICAgICAgIHdyaXRlZmlsZSgiTm90U2FtZVNlcnZlcnMuanNvbiIsIGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKTpKU09ORW5jb2RlKEFsbElEcykpCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGZ1bmN0aW9uIFRQUmV0dXJuZXIoKQogICAgICAgICAgICBsb2NhbCBTaXRlCiAgICAgICAgICAgIGlmIGZvdW5kQW55dGhpbmcgPT0gIiIgdGhlbgogICAgICAgICAgICAgICAgU2l0ZSA9IGdhbWUuSHR0cFNlcnZpY2U6SlNPTkRlY29kZShnYW1lOkh0dHBHZXQoCiAgICAgICAgICAgICAgICAgICAgImh0dHBz" ..
    "Oi8vZ2FtZXMucm9ibG94LmNvbS92MS9nYW1lcy8iIC4uIFBsYWNlSUQgLi4gIi9zZXJ2ZXJzL1B1YmxpYz9zb3J0T3JkZXI9QXNjJmxpbWl0PTEwMCIKICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIFNpdGUgPSBnYW1lLkh0dHBTZXJ2aWNlOkpTT05EZWNvZGUoZ2FtZTpIdHRwR2V0KAogICAgICAgICAgICAgICAgICAgICJodHRwczovL2dhbWVzLnJvYmxveC5jb20vdjEvZ2FtZXMvIiAuLiBQbGFjZUlEIC4uICIvc2VydmVycy9QdWJsaWM/c29ydE9yZGVyPUFzYyZsaW1pdD0xMDAmY3Vyc29yPSIgLi4gZm91bmRBbnl0aGluZwogICAgICAgICAgICAgICAgKSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBTaXRlLm5leHRQYWdlQ3Vyc29yIGFuZCBTaXRlLm5leHRQYWdlQ3Vyc29yIH49ICJudWxsIiBhbmQgU2l0ZS5uZXh0UGFnZUN1cnNvciB+PSBuaWwgdGhlbgogICAgICAgICAgICAgICAgZm91bmRBbnl0aGluZyA9IFNpdGUubmV4dFBhZ2VDdXJzb3IKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBsb2NhbCBudW0gPSAwCiAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKFNpdGUuZGF0YSkgZG8KICAgICAgICAgICAgICAgIGxvY2FsIFBvc3NpYmxlLCBJRCA9IHRydWUsIHRvc3RyaW5nKHYuaWQpCiAgICAgICAgICAgICAgICBpZiB0b251bWJlcih2Lm1heFBsYXllcnMpID4gdG9udW1iZXIodi5wbGF5aW5nKSB0aGVuCiAgICAgICAgICAgICAgICAg" ..
    "ICAgZm9yIF8sIEV4aXN0aW5nIGluIHBhaXJzKEFsbElEcykgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbnVtIH49IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgSUQgPT0gdG9zdHJpbmcoRXhpc3RpbmcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3NzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9udW1iZXIoYWN0dWFsSG91cikgfj0gdG9udW1iZXIoRXhpc3RpbmcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGZpbGUoIk5vdFNhbWVTZXJ2ZXJzLmpzb24iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBbGxJRHMgPSB7fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoQWxsSURzLCBhY3R1YWxIb3VyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gbnVtICsgMQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIFBvc3Np" ..
    "YmxlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KEFsbElEcywgSUQpCiAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlZmlsZSgiTm90U2FtZVNlcnZlcnMuanNvbiIsIGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKTpKU09ORW5jb2RlKEFsbElEcykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlRlbGVwb3J0U2VydmljZSIpOlRlbGVwb3J0VG9QbGFjZUluc3RhbmNlKFBsYWNlSUQsIElELCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDQpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGZ1bmN0aW9uIFRlbGVwb3J0KCkKICAgICAgICAgICAgd2hpbGUgdGFzay53YWl0KCkgZG8KICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBUUFJldHVybmVyKCkKICAgICAgICAgICAgICAgICAgICBpZiBmb3VuZEFueXRoaW5nIH49ICIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgVFBSZXR1cm5lcigpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAg" ..
    "IGVuZAogICAgICAgIGVuZAoKICAgICAgICAtLSBH4buNaSDEkeG7gyBi4bqvdCDEkeG6p3UgU2VydmVyIEhvcAogICAgICAgIFRlbGVwb3J0KCkKICAgIGVuZAp9KQoKCgoKICAgIFRhYnMuTWlzYzpBZGRTZWN0aW9uKCLihrMgQnlwYXNzIikKCmxvY2FsIGFudGlBRktDb25zID0ge30KCi0tIENo4buJIHThuqFvIHRvZ2dsZSBu4bq/dSBleGVjdXRvciBjw7MgZ2V0Y29ubmVjdGlvbnMKaWYgZ2V0Y29ubmVjdGlvbnMgdGhlbgogICAgVGFicy5NaXNjOkFkZFRvZ2dsZSgiQW50aUFGSyIsIHsKICAgICAgICBUaXRsZSA9ICJBbnRpLUFGSyIsCiAgICAgICAgRGVmYXVsdCA9IHRydWUKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgICAgICBsb2NhbCBpZGxlQ29ucyA9IGdldGNvbm5lY3Rpb25zKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5JZGxlZCkKICAgICAgICAKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIC0tIEzGsHUgJiBkaXNhYmxlCiAgICAgICAgICAgIGZvciBfLCBjIGluIGlwYWlycyhpZGxlQ29ucykgZG8KICAgICAgICAgICAgICAgIGFudGlBRktDb25zW2NdID0gdHJ1ZQogICAgICAgICAgICAgICAgYzpEaXNhYmxlKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHByaW50KCJbQW50aUFGS10gxJDDoyBi4bqtdCwgYuG6oW4gc+G6vSBraMO0bmcgYuG7iyBraWNrIEFGSy4iKQogICAgICAgIGVsc2UKICAgICAgICAgICAgLS0gRW5hYmxlIGzhuqFpCiAgICAgICAgICAg" ..
    "IGZvciBjLF8gaW4gcGFpcnMoYW50aUFGS0NvbnMpIGRvCiAgICAgICAgICAgICAgICBpZiBjIGFuZCBjLkVuYWJsZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBjOkVuYWJsZSgpIGVuZCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgYW50aUFGS0NvbnMgPSB7fQogICAgICAgICAgICBwcmludCgiW0FudGlBRktdIMSQw6MgdOG6r3QsIFJvYmxveCBz4bq9IHjhu60gbMO9IEFGSyBiw6xuaCB0aMaw4budbmcuIikKICAgICAgICBlbmQKICAgIGVuZCkKZWxzZQogICAgd2FybigiW0FudGlBRktdIEV4ZWN1dG9yIGtow7RuZyBo4buXIHRy4bujIGdldGNvbm5lY3Rpb25zLCB0b2dnbGUgYuG7iyB2w7QgaGnhu4d1LiIpCmVuZAoKCgoKCgpkbwogICAgbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCiAgICBsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIExvY2FsaXphdGlvblNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIkxvY2FsaXphdGlvblNlcnZpY2UiKQoKICAgIHNoYXJlZC5BbnRpQmFuU2FmZSA9IHNoYXJlZC5BbnRpQmFuU2FmZSBvciB7cnVubmluZyA9IGZhbHNlLCBob29rcyA9IHt9fQogICAgbG9jYWwgZGF0YSA9IHNoYXJlZC5BbnRpQmFuU2FmZQoKICAgIGxvY2FsIG9sZE5hbWVjYWxsLCBvbGRJbmRleAogICAgbG9jYWwgcHJvdGVjdGlvblRocmVhZAoKICAgIGxvY2Fs" ..
    "IGZ1bmN0aW9uIHNhZmUoZnVuYywgLi4uKQogICAgICAgIGxvY2FsIG9rLCByZXMgPSBwY2FsbChmdW5jLCAuLi4pCiAgICAgICAgaWYgb2sgdGhlbiByZXR1cm4gcmVzIGVuZAogICAgZW5kCgogICAgLS0gRGlzYWJsZSBzY3JlZW5zaG90L3ZpZGVvIGZsYWdzIGtoaSBi4bqtdCBwcm90ZWN0aW9uCiAgICBsb2NhbCBmdW5jdGlvbiBkaXNhYmxlUmVwb3J0RmxhZ3MoKQogICAgICAgIGlmIHR5cGVvZihzZXRmZmxhZykgPT0gImZ1bmN0aW9uIiB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHNldGZmbGFnKCJBYnVzZVJlcG9ydFNjcmVlbnNob3QiLCAiRmFsc2UiKQogICAgICAgICAgICAgICAgc2V0ZmZsYWcoIkFidXNlUmVwb3J0U2NyZWVuc2hvdFBlcmNlbnRhZ2UiLCAiMCIpIC0tIGNo4buJbmggduG7gSAwCiAgICAgICAgICAgICAgICBzZXRmZmxhZygiQWJ1c2VSZXBvcnRFbmFibGVkIiwgIkZhbHNlIikKICAgICAgICAgICAgICAgIHNldGZmbGFnKCJSZXBvcnRBYnVzZU1lbnUiLCAiRmFsc2UiKQogICAgICAgICAgICAgICAgc2V0ZmZsYWcoIkVuYWJsZUFidXNlUmVwb3J0U2NyZWVuc2hvdCIsICJGYWxzZSIpCiAgICAgICAgICAgICAgICBzZXRmZmxhZygiQWJ1c2VSZXBvcnRWaWRlbyIsICJGYWxzZSIpCiAgICAgICAgICAgICAgICBzZXRmZmxhZygiQWJ1c2VSZXBvcnRWaWRlb1BlcmNlbnRhZ2UiLCAiMCIpCiAgICAgICAgICAgICAgICBzZXRmZmxhZygiVmlkZW9DYXB0" ..
    "dXJlRW5hYmxlZCIsICJGYWxzZSIpCiAgICAgICAgICAgICAgICBzZXRmZmxhZygiUmVjb3JkVmlkZW8iLCAiRmFsc2UiKQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBSZXN0b3JlIGZsYWcgduG7gSBiw6xuaCB0aMaw4budbmcga2hpIHThuq90IHByb3RlY3Rpb24KICAgIGxvY2FsIGZ1bmN0aW9uIHNldEZsYWdzT24oKQogICAgICAgIGlmIHR5cGVvZihzZXRmZmxhZykgPT0gImZ1bmN0aW9uIiB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHNldGZmbGFnKCJBYnVzZVJlcG9ydFNjcmVlbnNob3QiLCAiVHJ1ZSIpCiAgICAgICAgICAgICAgICBzZXRmZmxhZygiQWJ1c2VSZXBvcnRTY3JlZW5zaG90UGVyY2VudGFnZSIsICIxMDAiKQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBIb29rIHJlcXVlc3RzIChibG9jayByZXBvcnQpCiAgICBsb2NhbCBmdW5jdGlvbiBob29rUmVxdWVzdHMoKQogICAgICAgIGlmIGRhdGEuaG9va3MucmVxdWVzdEhvb2tlZCB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBvbGRSZXF1ZXN0ID0gKHN5biBhbmQgc3luLnJlcXVlc3QpIG9yIHJlcXVlc3Qgb3IgaHR0cF9yZXF1ZXN0CiAgICAgICAgaWYgdHlwZW9mKG9sZFJlcXVlc3QpID09ICJmdW5jdGlvbiIgYW5kIHR5cGVvZihob29rZnVuY3Rpb24pID09ICJmdW5jdGlvbiIgdGhlbgogICAgICAgICAgICBob29rZnVuY3Rp" ..
    "b24ob2xkUmVxdWVzdCwgZnVuY3Rpb24ocmVxKQogICAgICAgICAgICAgICAgaWYgcmVxIGFuZCByZXEuVXJsIGFuZCB0b3N0cmluZyhyZXEuVXJsKTpsb3dlcigpOmZpbmQoImFidXNlIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHJldHVybiB7U3RhdHVzQ29kZSA9IDIwMCwgQm9keSA9ICJCbG9ja2VkIn0KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgcmV0dXJuIG9sZFJlcXVlc3QocmVxKQogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGRhdGEuaG9va3MucmVxdWVzdEhvb2tlZCA9IHRydWUKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIEhvb2sgRmluZEZpcnN0Q2hpbGQgKGJsb2NrIEdVSSB2aWRlby9zY3JlZW5zaG90KQogICAgbG9jYWwgZnVuY3Rpb24gaG9va0ZpbmRGaXJzdENoaWxkKCkKICAgICAgICBpZiBkYXRhLmhvb2tzLmZpbmRIb29rZWQgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgb2xkRmluZCA9IHdvcmtzcGFjZS5GaW5kRmlyc3RDaGlsZAogICAgICAgIGlmIHR5cGVvZihvbGRGaW5kKSA9PSAiZnVuY3Rpb24iIGFuZCB0eXBlb2YoaG9va2Z1bmN0aW9uKSA9PSAiZnVuY3Rpb24iIHRoZW4KICAgICAgICAgICAgaG9va2Z1bmN0aW9uKG9sZEZpbmQsIGZ1bmN0aW9uKHNlbGYsIG5hbWUsIC4uLikKICAgICAgICAgICAgICAgIGlmIG5hbWUgYW5kIHRvc3RyaW5nKG5hbWUpOmxvd2VyKCk6ZmluZCgic2NyZWVuc2hvdCIpIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAg" ..
    "ICAgICAgICAgICAgIGlmIG5hbWUgYW5kIHRvc3RyaW5nKG5hbWUpOmxvd2VyKCk6ZmluZCgidmlkZW8iKSB0aGVuIHJldHVybiBuaWwgZW5kCiAgICAgICAgICAgICAgICByZXR1cm4gb2xkRmluZChzZWxmLCBuYW1lLCAuLi4pCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZGF0YS5ob29rcy5maW5kSG9va2VkID0gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gU2FmZSBieXBhc3MgKF9fbmFtZWNhbGwpCiAgICBsb2NhbCBmdW5jdGlvbiBzYWZlQnlwYXNzKCkKICAgICAgICBpZiBnZXRyYXdtZXRhdGFibGUgYW5kIGhvb2ttZXRhbWV0aG9kIGFuZCBuZXdjY2xvc3VyZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIG10ID0gZ2V0cmF3bWV0YXRhYmxlKGdhbWUpCiAgICAgICAgICAgIHNldHJlYWRvbmx5KG10LCBmYWxzZSkKICAgICAgICAgICAgb2xkTmFtZWNhbGwgPSBvbGROYW1lY2FsbCBvciBtdC5fX25hbWVjYWxsCiAgICAgICAgICAgIG9sZEluZGV4ID0gb2xkSW5kZXggb3IgbXQuX19pbmRleAoKICAgICAgICAgICAgbXQuX19uYW1lY2FsbCA9IG5ld2NjbG9zdXJlKGZ1bmN0aW9uKHNlbGYsIC4uLikKICAgICAgICAgICAgICAgIGxvY2FsIG1ldGhvZCA9IGdldG5hbWVjYWxsbWV0aG9kKCkKICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7Li4ufQoKICAgICAgICAgICAgICAgIC0tIEJsb2NrIExvY2FsUGxheWVyIGtpY2svYmFuCiAgICAgICAgICAgICAgICBpZiAobWV0aG9kID09ICJLaWNr" ..
    "IiBvciBtZXRob2QgPT0gIkJhbiIpIGFuZCBzZWxmID09IExvY2FsUGxheWVyIHRoZW4gcmV0dXJuIG5pbCBlbmQKCiAgICAgICAgICAgICAgICAtLSBCbG9jayByZW1vdGUga2ljay9iYW4KICAgICAgICAgICAgICAgIGlmIChtZXRob2QgPT0gIkZpcmVTZXJ2ZXIiIG9yIG1ldGhvZCA9PSAiSW52b2tlU2VydmVyIikgYW5kIGFyZ3NbMV0gdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIG1zZyA9IHRvc3RyaW5nKGFyZ3NbMV0pOmxvd2VyKCkKICAgICAgICAgICAgICAgICAgICBpZiBtc2c6ZmluZCgia2ljayIpIG9yIG1zZzpmaW5kKCJiYW4iKSB0aGVuIHJldHVybiBuaWwgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAtLSBCbG9jayBMb2NhbGl6YXRpb25TZXJ2aWNlCiAgICAgICAgICAgICAgICBpZiBzZWxmID09IExvY2FsaXphdGlvblNlcnZpY2UgYW5kIG1ldGhvZCA9PSAiR2V0Q291bnRyeVJlZ2lvbkZvclBsYXllckFzeW5jIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3VjY2VzcywgcmVzdWx0ID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTG9jYWxpemF0aW9uU2VydmljZTpHZXRDb3VudHJ5UmVnaW9uRm9yUGxheWVyQXN5bmMoTG9jYWxQbGF5ZXIpCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIGlmIHN1Y2Nlc3MgdGhlbiByZXR1cm4gcmVzdWx0IGVsc2UgcmV0dXJuICJVUyIgZW5k" ..
    "CiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICByZXR1cm4gb2xkTmFtZWNhbGwoc2VsZiwgLi4uKQogICAgICAgICAgICBlbmQpCgogICAgICAgICAgICBtdC5fX2luZGV4ID0gbmV3Y2Nsb3N1cmUoZnVuY3Rpb24odCwgaykKICAgICAgICAgICAgICAgIGxvY2FsIGtleSA9IHRvc3RyaW5nKGspOmxvd2VyKCkKICAgICAgICAgICAgICAgIGlmIGtleTpmaW5kKCJraWNrIikgb3Iga2V5OmZpbmQoImJhbiIpIHRoZW4gcmV0dXJuIGZ1bmN0aW9uKCkgcmV0dXJuIG5pbCBlbmQgZW5kCiAgICAgICAgICAgICAgICByZXR1cm4gb2xkSW5kZXgodCwgaykKICAgICAgICAgICAgZW5kKQoKICAgICAgICAgICAgc2V0cmVhZG9ubHkobXQsIHRydWUpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBSZXN0b3JlIGhvb2tzCiAgICBsb2NhbCBmdW5jdGlvbiByZXN0b3JlSG9va3MoKQogICAgICAgIGlmIGdldHJhd21ldGF0YWJsZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIG10ID0gZ2V0cmF3bWV0YXRhYmxlKGdhbWUpCiAgICAgICAgICAgIHNldHJlYWRvbmx5KG10LCBmYWxzZSkKICAgICAgICAgICAgaWYgb2xkTmFtZWNhbGwgdGhlbiBtdC5fX25hbWVjYWxsID0gb2xkTmFtZWNhbGwgZW5kCiAgICAgICAgICAgIGlmIG9sZEluZGV4IHRoZW4gbXQuX19pbmRleCA9IG9sZEluZGV4IGVuZAogICAgICAgICAgICBzZXRyZWFkb25seShtdCwgdHJ1ZSkKICAgICAgICAgICAgb2xkTmFtZWNhbGwsIG9sZEluZGV4ID0g" ..
    "bmlsLCBuaWwKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIFN0YXJ0IHByb3RlY3Rpb24KICAgIGxvY2FsIGZ1bmN0aW9uIHN0YXJ0QW50aUJhblNhZmUoKQogICAgICAgIGlmIGRhdGEucnVubmluZyB0aGVuIHJldHVybiBlbmQKICAgICAgICBkYXRhLnJ1bm5pbmcgPSB0cnVlCgogICAgICAgIHNhZmUoaG9va1JlcXVlc3RzKQogICAgICAgIHNhZmUoaG9va0ZpbmRGaXJzdENoaWxkKQogICAgICAgIHNhZmUoc2FmZUJ5cGFzcykKCiAgICAgICAgLS0gRGlzYWJsZSBzY3JlZW5zaG90L3ZpZGVvCiAgICAgICAgcHJvdGVjdGlvblRocmVhZCA9IHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBkYXRhLnJ1bm5pbmcgZG8KICAgICAgICAgICAgICAgIHNhZmUoZGlzYWJsZVJlcG9ydEZsYWdzKQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQoKICAgICAgICBwcmludCgiW0FudGktQmFuIFNhZmVdIPCfm6HvuI8gRU5BQkxFRCEiKQogICAgZW5kCgogICAgLS0gU3RvcCBwcm90ZWN0aW9uCiAgICBsb2NhbCBmdW5jdGlvbiBzdG9wQW50aUJhblNhZmUoKQogICAgICAgIGRhdGEucnVubmluZyA9IGZhbHNlCiAgICAgICAgcHJvdGVjdGlvblRocmVhZCA9IG5pbAogICAgICAgIHJlc3RvcmVIb29rcygpCiAgICAgICAgc2V0RmxhZ3NPbigpIC0tIHBo4bulYyBo4buTaSBmbGFnIHbhu4EgYsOsbmggdGjGsOG7nW5nCiAgICAgICAgcHJpbnQoIltB" ..
    "bnRpLUJhbiBTYWZlXSDimqDvuI8gRElTQUJMRUQhIikKICAgIGVuZAoKICAgIC0tIFRvZ2dsZQogICAgVGFicy5NaXNjOkFkZFRvZ2dsZSgiQW50aUJhblYzIiwgewogICAgICAgIFRpdGxlID0gIkFudGkgQmFuIFYzLjUiLAogICAgICAgIERlZmF1bHQgPSB0cnVlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgICAgIHN0YXJ0QW50aUJhblNhZmUoKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBzdG9wQW50aUJhblNhZmUoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZAoKCgoKCgpkbwotLSA9PT0gU2FmZUdlblRlbGVwb3J0IChBbnRpOiBBTEwgTW92aW5nIE1vZGVscy9QYXJ0cy9FZmZlY3RzKSA9PT0KbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIExQID0gUGxheWVycy5Mb2NhbFBsYXllcgoKbG9jYWwgU2FmZUdlblJ1bm5pbmcgPSBmYWxzZQpsb2NhbCBTYWZlR2VuVGhyZWFkCmxvY2FsIERldGVjdFJhZGl1cyA9IDIwIC0tIG3hurdjIMSR4buLbmggMjAsIGPDsyB0aOG7gyBjaOG7iW5oIGLhurFuZyDDtCBpbnB1dAoKLS0gRGFuaCBzw6FjaCBhY2NvdW50IHRo4bqtdCBkw7luZyBWMgpsb2NhbCBBbGxvd2VkUGxheWVycyA9IHsKICAgIFsiSHUxYTBfSHU5Il0gPSB0cnVlLAogICAgWyJoZGtzYWtzdCJdID0gdHJ1ZQp9CgotLSBEYW5oIHPDoWNoIEtp" ..
    "bGxlcnMKbG9jYWwgRGFuZ2Vyb3VzS2lsbGVycyA9IHsKICAgIFNsYXNoZXIgPSB0cnVlLCBbIjF4MXgxeDEiXSA9IHRydWUsIGMwMGxraWRkID0gdHJ1ZSwKICAgIE5vbGkgPSB0cnVlLCBKb2huRG9lID0gdHJ1ZSwgWyJHdWVzdCA2NjYiXSA9IHRydWUsCiAgICBQaXp6YURlbGl2ZXJ5UmlnID0gdHJ1ZSwgTWFmaWExID0gdHJ1ZSwgTWFmaWEyID0gdHJ1ZSwKICAgIFsiMXgxeDF4MVpvbWJpZSJdID0gdHJ1ZSwgWyJTaXhlciJdID0gdHJ1ZQp9CgotLSBEYW5oIHPDoWNoIENsb25lcyAoY29pIG5oxrAgS2lsbGVycykKbG9jYWwgRGFuZ2Vyb3VzQ2xvbmVzID0gewogICAgUGl6emFEZWxpdmVyeVJpZyA9IHRydWUsIE1hZmlhMSA9IHRydWUsIE1hZmlhMiA9IHRydWUsCiAgICBbIjF4MXgxeDFab21iaWUiXSA9IHRydWUKfQoKLS0gRGFuaCBzw6FjaCBTdXJ2aXZvcnMgKGLhuqFuIGPDsyB0aOG7gyBiaeG6v24gdGjDoG5oKQpsb2NhbCBTdXJ2aXZvcnMgPSB7CiAgICBOb29iID0gdHJ1ZSwgR3Vlc3QxMzM3ID0gdHJ1ZSwgRWxsaW90ID0gdHJ1ZSwgU2hlZGxldHNreSA9IHRydWUsCiAgICBUd29UaW1lID0gdHJ1ZSwgWyIwMDduNyJdID0gdHJ1ZSwgQ2hhbmNlID0gdHJ1ZSwKICAgIEJ1aWxkZXJtYW4gPSB0cnVlLCBUYXBoID0gdHJ1ZSwgRHVzZWtrYXIgPSB0cnVlCn0KCi0tIFdoaXRlbGlzdApsb2NhbCBTYWZlT2JqZWN0cyA9IHtQZXQ9dHJ1ZSwgRGVjb3JhdGlvbj10cnVlLCBUZXJyYWluPXRydWUsIE1hcD10cnVlfQoK" ..
    "LS0gQ+G6pXUgaMOsbmggZGV0ZWN0CmxvY2FsIE1PVkVfVEhSRVNIT0xEID0gMC41CmxvY2FsIFZFTF9USFJFU0hPTEQgID0gMQpsb2NhbCBTQ0FOX0RFTEFZICAgICA9IDAuMTIKCmxvY2FsIGxhc3RQb3NpdGlvbnMgPSB7fQoKbG9jYWwgZnVuY3Rpb24gZmluZE93bmluZ0NoYXJhY3RlcihpbnN0KQogICAgbG9jYWwgY3VyID0gaW5zdAogICAgd2hpbGUgY3VyIGFuZCBjdXIgfj0gd29ya3NwYWNlIGFuZCBjdXIuUGFyZW50IGRvCiAgICAgICAgaWYgY3VyOklzQSgiTW9kZWwiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHAgPSBQbGF5ZXJzOkdldFBsYXllckZyb21DaGFyYWN0ZXIoY3VyKQogICAgICAgICAgICBpZiBwIHRoZW4gcmV0dXJuIGN1ciwgcCBlbmQKICAgICAgICBlbmQKICAgICAgICBjdXIgPSBjdXIuUGFyZW50CiAgICBlbmQKICAgIHJldHVybiBuaWwsIG5pbAplbmQKCmxvY2FsIGZ1bmN0aW9uIGhhc0ZvcmNlT25QYXJ0KHBhcnQpCiAgICBpZiBub3QgcGFydCB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIGlmIHBhcnQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJCb2R5VmVsb2NpdHkiKQogICAgb3IgcGFydDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkJvZHlQb3NpdGlvbiIpCiAgICBvciBwYXJ0OkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQm9keUZvcmNlIikKICAgIG9yIHBhcnQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJCb2R5R3lybyIpCiAgICBvciBwYXJ0OkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiTGlu" ..
    "ZWFyVmVsb2NpdHkiKQogICAgb3IgcGFydDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIlZlY3RvckZvcmNlIikKICAgIG9yIHBhcnQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJBbGlnblBvc2l0aW9uIikKICAgIG9yIHBhcnQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJBbGlnbk9yaWVudGF0aW9uIikgdGhlbgogICAgICAgIHJldHVybiB0cnVlCiAgICBlbmQKICAgIHJldHVybiBmYWxzZQplbmQKCmxvY2FsIGZ1bmN0aW9uIGlzUGFydE1vdmluZyhwYXJ0KQogICAgaWYgbm90IHBhcnQgb3Igbm90IHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgbG9jYWwgb2ssIGFzbVZlbCA9IHBjYWxsKGZ1bmN0aW9uKCkgcmV0dXJuIHBhcnQuQXNzZW1ibHlMaW5lYXJWZWxvY2l0eSBlbmQpCiAgICBsb2NhbCB2ZWxNYWcgPSAob2sgYW5kIGFzbVZlbCkgYW5kIGFzbVZlbC5NYWduaXR1ZGUgb3IgMAogICAgaWYgdmVsTWFnID09IDAgdGhlbgogICAgICAgIGxvY2FsIG9rMiwgdjIgPSBwY2FsbChmdW5jdGlvbigpIHJldHVybiBwYXJ0LlZlbG9jaXR5IGVuZCkKICAgICAgICBpZiBvazIgYW5kIHYyIHRoZW4gdmVsTWFnID0gdjIuTWFnbml0dWRlIGVuZAogICAgZW5kCiAgICBsb2NhbCBsYXN0ID0gbGFzdFBvc2l0aW9uc1twYXJ0XQogICAgbG9jYWwgcG9zID0gcGFydC5Qb3NpdGlvbgogICAgbG9jYWwgbW92ZWQgPSBmYWxzZQogICAgaWYgbGFzdCB0aGVuCiAgICAgICAgaWYgKHBvcyAtIGxhc3QpLk1h" ..
    "Z25pdHVkZSA+PSBNT1ZFX1RIUkVTSE9MRCB0aGVuIG1vdmVkID0gdHJ1ZSBlbmQKICAgIGVsc2UKICAgICAgICBpZiB2ZWxNYWcgPj0gVkVMX1RIUkVTSE9MRCBvciBoYXNGb3JjZU9uUGFydChwYXJ0KSB0aGVuIG1vdmVkID0gdHJ1ZSBlbmQKICAgIGVuZAogICAgbGFzdFBvc2l0aW9uc1twYXJ0XSA9IHBvcwogICAgaWYgdmVsTWFnID49IFZFTF9USFJFU0hPTEQgb3IgaGFzRm9yY2VPblBhcnQocGFydCkgdGhlbiBtb3ZlZCA9IHRydWUgZW5kCiAgICByZXR1cm4gbW92ZWQKZW5kCgpsb2NhbCBmdW5jdGlvbiBwcnVuZUxhc3RQb3NpdGlvbnMoKQogICAgZm9yIGluc3QsXyBpbiBwYWlycyhsYXN0UG9zaXRpb25zKSBkbwogICAgICAgIGlmIG5vdCBpbnN0IG9yIG5vdCBpbnN0LlBhcmVudCB0aGVuIGxhc3RQb3NpdGlvbnNbaW5zdF0gPSBuaWwgZW5kCiAgICBlbmQKZW5kCgotLSDwn5SOIFBow6F0IGhp4buHbiBuZ3V5IGhp4buDbSBn4bqnbgpsb2NhbCBmdW5jdGlvbiBpc0Rhbmdlck5lYXIocG9zaXRpb24sIHJhZGl1cykKICAgIGxvY2FsIGtpbGxlcnNGb2xkZXIgPSB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIlBsYXllcnMiKSBhbmQgd29ya3NwYWNlLlBsYXllcnM6RmluZEZpcnN0Q2hpbGQoIktpbGxlcnMiKQogICAgaWYga2lsbGVyc0ZvbGRlciB0aGVuCiAgICAgICAgZm9yIF8sIGtpbGxlciBpbiBpcGFpcnMoa2lsbGVyc0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBsb2NhbCBocnAgPSBr" ..
    "aWxsZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICBpZiBocnAgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChocnAuUG9zaXRpb24gLSBwb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICBpZiAoRGFuZ2Vyb3VzS2lsbGVyc1traWxsZXIuTmFtZV0gb3IgRGFuZ2Vyb3VzQ2xvbmVzW2tpbGxlci5OYW1lXSkgYW5kIGRpc3QgPD0gcmFkaXVzIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZSwgaHJwLlBvc2l0aW9uCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGZvciBfLCBpbnN0IGluIGlwYWlycyh3b3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICBpZiBpbnN0OklzQSgiQmFzZVBhcnQiKSBhbmQgbm90IFNhZmVPYmplY3RzW2luc3QuTmFtZV0gdGhlbgogICAgICAgICAgICBsb2NhbCBkaXN0ID0gKGluc3QuUG9zaXRpb24gLSBwb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgIGlmIGRpc3QgPD0gcmFkaXVzIGFuZCBpc1BhcnRNb3ZpbmcoaW5zdCkgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgY2hhck1vZGVsLCBwbGF5ZXJPd25lciA9IGZpbmRPd25pbmdDaGFyYWN0ZXIoaW5zdCkKICAgICAgICAgICAgICAgIGlmIHBsYXllck93bmVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaGFyTmFtZSA9IGNoYXJNb2RlbCBhbmQgY2hhck1v" ..
    "ZGVsLk5hbWUgb3IgIiIKICAgICAgICAgICAgICAgICAgICBpZiBEYW5nZXJvdXNLaWxsZXJzW2NoYXJOYW1lXSBvciBEYW5nZXJvdXNDbG9uZXNbY2hhck5hbWVdIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWUsIGluc3QuUG9zaXRpb24KICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZSwgaW5zdC5Qb3NpdGlvbgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICBwcnVuZUxhc3RQb3NpdGlvbnMoKQogICAgcmV0dXJuIGZhbHNlLCBuaWwKZW5kCgotLSDwn5OMIFTDrG0gduG7iyB0csOtIGFuIHRvw6BuIGPDoWNoIHhhIGRhbmdlciA3IHN0dWQKbG9jYWwgZnVuY3Rpb24gZ2V0U2FmZVBvc0Zyb21EYW5nZXIobXlQb3MsIGRhbmdlclBvcywgc2FmZURpc3QpCiAgICBsb2NhbCBkaXIgPSAobXlQb3MgLSBkYW5nZXJQb3MpLlVuaXQKICAgIGxvY2FsIHRhcmdldCA9IG15UG9zICsgZGlyICogc2FmZURpc3QKICAgIGxvY2FsIHJheVBhcmFtcyA9IFJheWNhc3RQYXJhbXMubmV3KCkKICAgIHJheVBhcmFtcy5GaWx0ZXJEZXNjZW5kYW50c0luc3RhbmNlcyA9IHtMUC5DaGFyYWN0ZXJ9CiAgICByYXlQYXJhbXMuRmlsdGVyVHlwZSA9IEVudW0uUmF5Y2FzdEZpbHRlclR5cGUuQmxhY2tsaXN0CiAgICBsb2NhbCByYXlSZXN1bHQgPSB3b3Jrc3BhY2U6UmF5Y2Fz" ..
    "dChteVBvcyArIFZlY3RvcjMubmV3KDAsMywwKSwgZGlyKnNhZmVEaXN0LCByYXlQYXJhbXMpCiAgICBpZiByYXlSZXN1bHQgdGhlbgogICAgICAgIGxvY2FsIHBlcnAxID0gVmVjdG9yMy5uZXcoLWRpci5aLDAsZGlyLlgpLlVuaXQKICAgICAgICBsb2NhbCBwZXJwMiA9IC1wZXJwMQogICAgICAgIGlmIG5vdCB3b3Jrc3BhY2U6UmF5Y2FzdChteVBvcytWZWN0b3IzLm5ldygwLDMsMCksIHBlcnAxKnNhZmVEaXN0LCByYXlQYXJhbXMpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIG15UG9zICsgcGVycDEqc2FmZURpc3QKICAgICAgICBlbHNlaWYgbm90IHdvcmtzcGFjZTpSYXljYXN0KG15UG9zK1ZlY3RvcjMubmV3KDAsMywwKSwgcGVycDIqc2FmZURpc3QsIHJheVBhcmFtcykgdGhlbgogICAgICAgICAgICByZXR1cm4gbXlQb3MgKyBwZXJwMipzYWZlRGlzdAogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIG15UG9zICsgVmVjdG9yMy5uZXcoMCwwLHNhZmVEaXN0KQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gdGFyZ2V0CmVuZAoKLS0g8J+agCBMw7lpIHJhIHhhIDcgc3R1ZCBraOG7j2kgbmd1eSBoaeG7g20gKGdp4buvIGjGsOG7m25nIG5ow6xuLCBixrDhu5tjIG5o4buPIHNpw6p1IG5oYW5oKQpsb2NhbCBmdW5jdGlvbiB0ZWxlcG9ydEF3YXlGcm9tRGFuZ2VyKCkKICAgIGxvY2FsIGNoYXJhY3RlciA9IExQLkNoYXJhY3RlcgogICAgbG9jYWwgaHJwID0gY2hhcmFjdGVyIGFuZCBjaGFyYWN0ZXI6" ..
    "RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgaWYgbm90IGhycCB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBteVBvcyA9IGhycC5Qb3NpdGlvbgogICAgbG9jYWwgaXNOZWFyLCBkYW5nZXJQb3MgPSBpc0Rhbmdlck5lYXIobXlQb3MsIERldGVjdFJhZGl1cykKICAgIGlmIGlzTmVhciBhbmQgZGFuZ2VyUG9zIHRoZW4KICAgICAgICBsb2NhbCBzYWZlUG9zID0gZ2V0U2FmZVBvc0Zyb21EYW5nZXIobXlQb3MsIGRhbmdlclBvcywgNykKCiAgICAgICAgbG9jYWwgZGlyID0gKHNhZmVQb3MgLSBteVBvcykuVW5pdAogICAgICAgIGxvY2FsIHRvdGFsRGlzdCA9IChzYWZlUG9zIC0gbXlQb3MpLk1hZ25pdHVkZQogICAgICAgIGxvY2FsIHN0ZXBTaXplID0gMS4yCiAgICAgICAgbG9jYWwgc3RlcERlbGF5ID0gMC4wMQogICAgICAgIGxvY2FsIHN0ZXBzID0gbWF0aC5jZWlsKHRvdGFsRGlzdCAvIHN0ZXBTaXplKQoKICAgICAgICBmb3IgaSA9IDEsIHN0ZXBzIGRvCiAgICAgICAgICAgIGxvY2FsIHN0ZXBQb3MgPSBteVBvcyArIGRpciAqIChpICogc3RlcFNpemUpCiAgICAgICAgICAgIGhycC5DRnJhbWUgPSBDRnJhbWUubmV3KHN0ZXBQb3MsIHN0ZXBQb3MgKyBocnAuQ0ZyYW1lLkxvb2tWZWN0b3IpCiAgICAgICAgICAgIHRhc2sud2FpdChzdGVwRGVsYXkpCiAgICAgICAgZW5kCgogICAgICAgIHByaW50KCLimqDvuI8gTsOpIG5ndXkgaGnhu4NtIGLhurFuZyBuaGnhu4F1IGLGsOG7m2Mgbmjhu48g" ..
    "KGdp4buvIGjGsOG7m25nIG5ow6xuKSEiKQogICAgZW5kCmVuZAoKLS0gPT09IEdVSSBDb250cm9sID09PQpUYWJzLk1pc2M6QWRkVG9nZ2xlKCJTYWZlR2VuVGVsZXBvcnQiLCB7CiAgICBUaXRsZSA9ICJBbnRpIEtpbGxlcnMgVjciLAogICAgRGVmYXVsdCA9IGZhbHNlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbihzdGF0ZSkKICAgIFNhZmVHZW5SdW5uaW5nID0gc3RhdGUKICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICBTYWZlR2VuVGhyZWFkID0gdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIGRlbGF5VGltZSA9IFNDQU5fREVMQVkKICAgICAgICAgICAgaWYgQWxsb3dlZFBsYXllcnNbTFAuTmFtZV0gdGhlbgogICAgICAgICAgICAgICAgcHJpbnQoIvCfmoAgVjIgTW9kZSBlbmFibGVkIGZvcjoiLCBMUC5OYW1lKQogICAgICAgICAgICAgICAgZGVsYXlUaW1lID0gMC4wMDAwMDAwMDAwMDEKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcHJpbnQoIvCfkKIgVjEgTW9kZSBlbmFibGVkIGZvcjoiLCBMUC5OYW1lKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgd2hpbGUgU2FmZUdlblJ1bm5pbmcgZG8KICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IExQLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgbG9jYWwgaHJwID0gY2hhcmFjdGVyIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgaWYgaHJwIHRo" ..
    "ZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaGFyTmFtZSA9IGNoYXJhY3Rlci5OYW1lCiAgICAgICAgICAgICAgICAgICAgaWYgRGFuZ2Vyb3VzS2lsbGVyc1tjaGFyTmFtZV0gb3IgRGFuZ2Vyb3VzQ2xvbmVzW2NoYXJOYW1lXSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIGLhuqFuIGzDoCBraWxsZXIg4oaSIGtow7RuZyBuw6kKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgU3Vydml2b3JzW2NoYXJOYW1lXSBvciBjaGFyTmFtZSA9PSBMUC5OYW1lIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdGVsZXBvcnRBd2F5RnJvbURhbmdlcigpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHRhc2sud2FpdChkZWxheVRpbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVsc2UKICAgICAgICBTYWZlR2VuUnVubmluZyA9IGZhbHNlCiAgICAgICAgU2FmZUdlblRocmVhZCA9IG5pbAogICAgICAgIHByaW50KCJbU2FmZUdlblRlbGVwb3J0XSDEkMOjIHThuq90LiIpCiAgICBlbmQKZW5kKQoKLS0g8J+TnSBJbnB1dCBib3ggY2jhu4luaCBraG/huqNuZyBjw6FjaCBEZXRlY3RSYWRpdXMgKDEgLSAxMDAsIG3hurdjIMSR4buLbmggMjApClRhYnMuTWlzYzpBZGRJbnB1dCgiRGV0ZWN0UmFkaXVzSW5wdXQiLCB7CiAgICBUaXRsZSA9ICJEZXRlY3QgUmFkaXVzIiwKICAgIERlZmF1bHQgPSAiMjAiLAogICAgUGxhY2Vob2xkZXIg" ..
    "PSAiMSAtIDEwMCIKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKQogICAgbG9jYWwgbnVtID0gdG9udW1iZXIodmFsdWUpCiAgICBpZiBudW0gdGhlbgogICAgICAgIG51bSA9IG1hdGguY2xhbXAobnVtLCAxLCAxMDApCiAgICAgICAgRGV0ZWN0UmFkaXVzID0gbnVtCiAgICAgICAgcHJpbnQoIvCflKcgRGV0ZWN0UmFkaXVzIHNldCB0bzoiLCBEZXRlY3RSYWRpdXMpCiAgICBlbmQKZW5kKQoKZW5kCgoKCiAgICBUYWJzLk1pc2M6QWRkU2VjdGlvbigi4oazIEdhbWUgUGxheSIpCgoKCmRvCiAgICAtLT09IOKame+4jyBTZXR1cCA9PS0tCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQogICAgbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCiAgICBsb2NhbCBTdXJ2aXZvcnMgPSB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJQbGF5ZXJzIik6V2FpdEZvckNoaWxkKCJTdXJ2aXZvcnMiKQoKICAgIC0tPT0g8J+SoSBD4bqldSBow6xuaCBjw6FjIGxv4bqhaSBBbnRpLVNsb3cgPT0tLQogICAgbG9jYWwgQW50aVNsb3dDb25maWdzID0gewogICAgICAgIFNsb3duZXNzID0ge1ZhbHVlcyA9IHsiU2xvd2VkU3RhdHVzIn0sIENvbm5lY3Rpb24gPSBuaWwsIEVuYWJsZWQgPSBmYWxzZX0sCiAgICAgICAgU2tpbGxzID0gewogICAgICAgICAgICBWYWx1ZXMgPSB7CiAgICAgICAg" ..
    "ICAgICAgICAiU3R1bm5pbmdLaWxsZXIiLCAiRWF0RnJpZWRDaGlja2VuIiwgIkd1ZXN0QmxvY2tpbmciLCAiUHVuY2hBYmlsaXR5IiwgIlN1YnNwYWNlVHJpcG1pbmUiLAogICAgICAgICAgICAgICAgIlRhcGhUcmlwd2lyZSIsICJQbGFzbWFCZWFtIiwgIlNwYXduUHJvdGVjdGlvbiIsICJjMDBsZ3VpIiwgIlNob290aW5nR3VuIiwgCiAgICAgICAgICAgICAgICAiVHdvVGltZVN0YWIiLCAiVHdvVGltZUNyb3VjaGluZyIsICJEcmlua2luZ0NvbGEiLCAiRHJpbmtpbmdTbGF0ZXNraW4iLCAKICAgICAgICAgICAgICAgICJTbGF0ZXNraW5TdGF0dXMiLCAiRWF0aW5nR2hvc3RidXJnZXIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIENvbm5lY3Rpb24gPSBuaWwsIEVuYWJsZWQgPSBmYWxzZQogICAgICAgIH0sCiAgICAgICAgSXRlbXMgPSB7VmFsdWVzID0geyJCbG94eUNvbGFJdGVtIiwgIk1lZGtpdCJ9LCBDb25uZWN0aW9uID0gbmlsLCBFbmFibGVkID0gZmFsc2V9LAogICAgICAgIEVtb3RlcyA9IHtWYWx1ZXMgPSB7IkVtb3RpbmcifSwgQ29ubmVjdGlvbiA9IG5pbCwgRW5hYmxlZCA9IGZhbHNlfSwKICAgICAgICBCdWlsZGVybWFuID0ge1ZhbHVlcyA9IHsiRGlzcGVuc2VyQ29uc3RydWN0aW9uIiwgIlNlbnRyeUNvbnN0cnVjdGlvbiJ9LCBDb25uZWN0aW9uID0gbmlsLCBFbmFibGVkID0gZmFsc2V9CiAgICB9CgogICAgLS09PSDwn6epIEjDoG0g4bqpbiBVSSBiw6FvIHNsb3cgPT0tLQogICAgbG9jYWwgZnVu" ..
    "Y3Rpb24gaGlkZVNsb3duZXNzVUkoKQogICAgICAgIGxvY2FsIG1haW5VSSA9IExvY2FsUGxheWVyOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJHdWkiKSBhbmQgTG9jYWxQbGF5ZXIuUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJNYWluVUkiKQogICAgICAgIGlmIG5vdCBtYWluVUkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgc3RhdHVzQ29udGFpbmVyID0gbWFpblVJOkZpbmRGaXJzdENoaWxkKCJTdGF0dXNDb250YWluZXIiKQogICAgICAgIGlmIG5vdCBzdGF0dXNDb250YWluZXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgc2xvd25lc3NVSSA9IHN0YXR1c0NvbnRhaW5lcjpGaW5kRmlyc3RDaGlsZCgiU2xvd25lc3MiKQogICAgICAgIGlmIHNsb3duZXNzVUkgdGhlbgogICAgICAgICAgICBzbG93bmVzc1VJLlZpc2libGUgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS09PSDwn5SnIEjDoG0geOG7rSBsw70gQW50aS1TbG93ID09LS0KICAgIGxvY2FsIGZ1bmN0aW9uIGhhbmRsZUFudGlTbG93KHN1cnZpdm9yLCBjb25maWcpCiAgICAgICAgaWYgc3Vydml2b3I6R2V0QXR0cmlidXRlKCJVc2VybmFtZSIpIH49IExvY2FsUGxheWVyLk5hbWUgdGhlbiByZXR1cm4gZW5kCgogICAgICAgIGxvY2FsIGZ1bmN0aW9uIG9uUmVuZGVyU3RlcCgpCiAgICAgICAgICAgIGlmIG5vdCBzdXJ2aXZvci5QYXJlbnQgb3Igbm90IGNvbmZpZy5FbmFibGVkIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAg" ..
    "ICBsb2NhbCBzcGVlZE11bHRpcGxpZXJzID0gc3Vydml2b3I6RmluZEZpcnN0Q2hpbGQoIlNwZWVkTXVsdGlwbGllcnMiKQogICAgICAgICAgICBpZiBzcGVlZE11bHRpcGxpZXJzIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCB2YWxOYW1lIGluIGlwYWlycyhjb25maWcuVmFsdWVzKSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhbCA9IHNwZWVkTXVsdGlwbGllcnM6RmluZEZpcnN0Q2hpbGQodmFsTmFtZSkKICAgICAgICAgICAgICAgICAgICBpZiB2YWwgYW5kIHZhbDpJc0EoIk51bWJlclZhbHVlIikgYW5kIHZhbC5WYWx1ZSB+PSAxIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdmFsLlZhbHVlID0gMQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBoaWRlU2xvd25lc3NVSSgpCiAgICAgICAgZW5kCgogICAgICAgIGNvbmZpZy5Db25uZWN0aW9uID0gUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3Qob25SZW5kZXJTdGVwKQogICAgZW5kCgogICAgLS09PSDilrbvuI8gQuG6rXQgdOG6pXQgY+G6oyBBbnRpLVNsb3cgPT0tLQogICAgbG9jYWwgZnVuY3Rpb24gc3RhcnRBbGxBbnRpU2xvdygpCiAgICAgICAgZm9yIF8sIGNvbmZpZyBpbiBwYWlycyhBbnRpU2xvd0NvbmZpZ3MpIGRvCiAgICAgICAgICAgIGNvbmZpZy5FbmFibGVkID0gdHJ1ZQogICAgICAgICAgICBmb3IgXywgc3Vydml2b3IgaW4gcGFpcnMo" ..
    "U3Vydml2b3JzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICBoYW5kbGVBbnRpU2xvdyhzdXJ2aXZvciwgY29uZmlnKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgU3Vydml2b3JzLkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihjaGlsZCkKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICBoYW5kbGVBbnRpU2xvdyhjaGlsZCwgY29uZmlnKQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLT09IOKPue+4jyBU4bqvdCB04bqldCBj4bqjIEFudGktU2xvdyA9PS0tCiAgICBsb2NhbCBmdW5jdGlvbiBzdG9wQWxsQW50aVNsb3coKQogICAgICAgIGZvciBfLCBjb25maWcgaW4gcGFpcnMoQW50aVNsb3dDb25maWdzKSBkbwogICAgICAgICAgICBjb25maWcuRW5hYmxlZCA9IGZhbHNlCiAgICAgICAgICAgIGlmIGNvbmZpZy5Db25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgICAgIGNvbmZpZy5Db25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgY29uZmlnLkNvbm5lY3Rpb24gPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLT09IPCfp6kgVOG6oW8gVG9nZ2xlIEZsdWVudCBVSSAoY2jhu4kgMSBuw7p0IHThu5VuZykgPT0tLQogICAgVGFicy5NaXNjOkFkZFRvZ2dsZSgiQW50aVNsb3dfQWxsIiwgewogICAgICAgIFRpdGxlID0gIkFudGktU2xvdyIsCiAgICAgICAgRGVmYXVsdCA9" ..
    "IGZhbHNlCiAgICB9KTpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgaWYgVmFsdWUgdGhlbgogICAgICAgICAgICBzdGFydEFsbEFudGlTbG93KCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0b3BBbGxBbnRpU2xvdygpCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKCgoKZG8KICAgIC0tPT0g4pqZ77iPIEF1dG8gQ2xvc2UgMXgxeDF4MSBQb3B1cHMgKyBBbnRpIFNsb3cvRk9WID09LS0KICAgIGxvY2FsIERvTG9vcCA9IGZhbHNlCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgV29ya3NwYWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKQoKICAgIFRhYnMuTWlzYzpBZGRUb2dnbGUoIkF1dG9DbG9zZVBvcHVwVjIiLCB7CiAgICAgICAgVGl0bGUgPSAiRGV0ZWxlIDF4IFBvcHVwcyIsCiAgICAgICAgRGVmYXVsdCA9IHRydWUKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkKICAgICAgICBEb0xvb3AgPSBWYWx1ZQoKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgU3Vydml2b3JzID0gV29ya3NwYWNlOldhaXRGb3JDaGlsZCgiUGxheWVycyIpOldhaXRGb3JDaGlsZCgiU3Vydml2b3JzIikKCiAgICAgICAgICAgIHdoaWxlIERvTG9vcCBhbmQgdGFzay53YWl0KCkgZG8KICAgICAgICAgICAgICAgIC0tIPCflLkg" ..
    "QXV0byBDbG9zZSAxeDF4MXgxIFBvcHVwcwogICAgICAgICAgICAgICAgbG9jYWwgdGVtcCA9IExvY2FsUGxheWVyOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJHdWkiKSBhbmQgTG9jYWxQbGF5ZXIuUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJUZW1wb3JhcnlVSSIpCiAgICAgICAgICAgICAgICBpZiB0ZW1wIGFuZCB0ZW1wOkZpbmRGaXJzdENoaWxkKCIxeDF4MXgxUG9wdXAiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdGVtcFsiMXgxeDF4MVBvcHVwIl06RGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAtLSDwn5S5IEFudGkgU2xvdyArIEFudGkgRk9WIFNsb3cKICAgICAgICAgICAgICAgIGZvciBfLCBzdXJ2aXZvciBpbiBwYWlycyhTdXJ2aXZvcnM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBzdXJ2aXZvcjpHZXRBdHRyaWJ1dGUoIlVzZXJuYW1lIikgPT0gTG9jYWxQbGF5ZXIuTmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIFNwZWVkTXVsdGlwbGllcnMKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3BlZWRNdWx0aXBsaWVycyA9IHN1cnZpdm9yOkZpbmRGaXJzdENoaWxkKCJTcGVlZE11bHRpcGxpZXJzIikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgc3BlZWRNdWx0aXBsaWVycyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YWwgPSBzcGVlZE11bHRpcGxpZXJzOkZpbmRGaXJzdENoaWxk" ..
    "KCJTbG93ZWRTdGF0dXMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdmFsIGFuZCB2YWw6SXNBKCJOdW1iZXJWYWx1ZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwuVmFsdWUgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAtLSBGT1ZNdWx0aXBsaWVycwogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmb3ZNdWx0aXBsaWVycyA9IHN1cnZpdm9yOkZpbmRGaXJzdENoaWxkKCJGT1ZNdWx0aXBsaWVycyIpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZvdk11bHRpcGxpZXJzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhbCA9IGZvdk11bHRpcGxpZXJzOkZpbmRGaXJzdENoaWxkKCJTbG93ZWRTdGF0dXMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdmFsIGFuZCB2YWw6SXNBKCJOdW1iZXJWYWx1ZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwuVmFsdWUgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kKQplbmQKCgoKICAgIFRhYnMuTWlzYzpBZGRTZWN0aW9uKCLihrMgRml4" ..
    "IExhZyIpCgotLSBTQ1JJUFQgR0nhuqJNIMSQ4buSIEjhu4xBIFThu7AgxJDhu5hORyBN4buWSSAxMCBHScOCWSAoQ8OTIFRPR0dMRSArIFJFU1RPUkUpCi0tIETDoW4gdsOgbyBMb2NhbFNjcmlwdCAoU3RhcnRlclBsYXllclNjcmlwdHMgaG/hurdjIGV4ZWN1dG9yKQotLSBTacOqdSBGaXggTGFnIGPhu7FjIG3huqFuaCBnacO6cCBtw6F5IGLhuqFuIG3GsOG7o3QgaMahbiAyNSUga2hpIGLhuq10CgotLSBMxrB1IGThu68gbGnhu4d1IGfhu5FjCmxvY2FsIG9yaWdpbmFsTGlnaHRpbmcgPSB7fQpsb2NhbCBvcmlnaW5hbFBhcnRzID0ge30KCi0tIEjDoG0gbMawdSBMaWdodGluZyBn4buRYwpsb2NhbCBmdW5jdGlvbiBzYXZlTGlnaHRpbmcoKQogICAgb3JpZ2luYWxMaWdodGluZy5RdWFsaXR5TGV2ZWwgPSBzZXR0aW5ncygpLlJlbmRlcmluZy5RdWFsaXR5TGV2ZWwKICAgIG9yaWdpbmFsTGlnaHRpbmcuR2xvYmFsU2hhZG93cyA9IGdhbWUuTGlnaHRpbmcuR2xvYmFsU2hhZG93cwogICAgb3JpZ2luYWxMaWdodGluZy5Gb2dFbmQgPSBnYW1lLkxpZ2h0aW5nLkZvZ0VuZAogICAgb3JpZ2luYWxMaWdodGluZy5CcmlnaHRuZXNzID0gZ2FtZS5MaWdodGluZy5CcmlnaHRuZXNzCiAgICBvcmlnaW5hbExpZ2h0aW5nLlBvc3RFZmZlY3RzID0ge30KICAgIGZvciBfLCB2IGluIGlwYWlycyhnYW1lLkxpZ2h0aW5nOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdjpJc0EoIlBvc3RFZmZlY3QiKSB0aGVuCiAgICAgICAgICAg" ..
    "IG9yaWdpbmFsTGlnaHRpbmcuUG9zdEVmZmVjdHNbdl0gPSB2LkVuYWJsZWQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tIEjDoG0ga2jDtGkgcGjhu6VjIExpZ2h0aW5nCmxvY2FsIGZ1bmN0aW9uIHJlc3RvcmVMaWdodGluZygpCiAgICBpZiBub3Qgb3JpZ2luYWxMaWdodGluZy5RdWFsaXR5TGV2ZWwgdGhlbiByZXR1cm4gZW5kCiAgICBzZXR0aW5ncygpLlJlbmRlcmluZy5RdWFsaXR5TGV2ZWwgPSBvcmlnaW5hbExpZ2h0aW5nLlF1YWxpdHlMZXZlbAogICAgZ2FtZS5MaWdodGluZy5HbG9iYWxTaGFkb3dzID0gb3JpZ2luYWxMaWdodGluZy5HbG9iYWxTaGFkb3dzCiAgICBnYW1lLkxpZ2h0aW5nLkZvZ0VuZCA9IG9yaWdpbmFsTGlnaHRpbmcuRm9nRW5kCiAgICBnYW1lLkxpZ2h0aW5nLkJyaWdodG5lc3MgPSBvcmlnaW5hbExpZ2h0aW5nLkJyaWdodG5lc3MKICAgIGZvciBlZmZlY3QsIHN0YXRlIGluIHBhaXJzKG9yaWdpbmFsTGlnaHRpbmcuUG9zdEVmZmVjdHMpIGRvCiAgICAgICAgaWYgZWZmZWN0IGFuZCBlZmZlY3QuUGFyZW50ID09IGdhbWUuTGlnaHRpbmcgdGhlbgogICAgICAgICAgICBlZmZlY3QuRW5hYmxlZCA9IHN0YXRlCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSBIw6BtIGdp4bqjbSDEkeG7kyBo4buNYSB0cmnhu4d0IMSR4buDCmxvY2FsIGZ1bmN0aW9uIHNpbXBsaWZ5TW9kZWwob2JqKQogICAgaWYgb2JqOklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgaWYgbm90IG9yaWdpbmFsUGFy" ..
    "dHNbb2JqXSB0aGVuCiAgICAgICAgICAgIG9yaWdpbmFsUGFydHNbb2JqXSA9IHsKICAgICAgICAgICAgICAgIE1hdGVyaWFsID0gb2JqLk1hdGVyaWFsLAogICAgICAgICAgICAgICAgQ29sb3IgPSBvYmouQ29sb3IsCiAgICAgICAgICAgICAgICBSZWZsZWN0YW5jZSA9IG9iai5SZWZsZWN0YW5jZSwKICAgICAgICAgICAgICAgIENhc3RTaGFkb3cgPSBvYmouQ2FzdFNoYWRvdwogICAgICAgICAgICB9CiAgICAgICAgZW5kCiAgICAgICAgb2JqLk1hdGVyaWFsID0gRW51bS5NYXRlcmlhbC5TbW9vdGhQbGFzdGljCiAgICAgICAgb2JqLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMTYzLCAxNjIsIDE2NSkKICAgICAgICBvYmouUmVmbGVjdGFuY2UgPSAwCiAgICAgICAgb2JqLkNhc3RTaGFkb3cgPSBmYWxzZQogICAgZWxzZWlmIG9iajpJc0EoIkRlY2FsIikgb3Igb2JqOklzQSgiVGV4dHVyZSIpIG9yIG9iajpJc0EoIlN1cmZhY2VBcHBlYXJhbmNlIikgdGhlbgogICAgICAgIG9iajpEZXN0cm95KCkKICAgIGVsc2VpZiBvYmo6SXNBKCJQYXJ0aWNsZUVtaXR0ZXIiKSBvciBvYmo6SXNBKCJUcmFpbCIpIG9yIG9iajpJc0EoIkJlYW0iKSBvciBvYmo6SXNBKCJGaXJlIikgb3Igb2JqOklzQSgiU21va2UiKSBvciBvYmo6SXNBKCJTcGFya2xlcyIpIHRoZW4KICAgICAgICBvYmouRW5hYmxlZCA9IGZhbHNlCiAgICBlbmQKZW5kCgotLSBIw6BtIGtow7RpIHBo4bulYyBCYXNlUGFydApsb2NhbCBmdW5jdGlvbiByZXN0b3JlUGFy" ..
    "dHMoKQogICAgZm9yIHBhcnQsIGRhdGEgaW4gcGFpcnMob3JpZ2luYWxQYXJ0cykgZG8KICAgICAgICBpZiBwYXJ0IGFuZCBwYXJ0LlBhcmVudCB0aGVuCiAgICAgICAgICAgIHBhcnQuTWF0ZXJpYWwgPSBkYXRhLk1hdGVyaWFsCiAgICAgICAgICAgIHBhcnQuQ29sb3IgPSBkYXRhLkNvbG9yCiAgICAgICAgICAgIHBhcnQuUmVmbGVjdGFuY2UgPSBkYXRhLlJlZmxlY3RhbmNlCiAgICAgICAgICAgIHBhcnQuQ2FzdFNoYWRvdyA9IGRhdGEuQ2FzdFNoYWRvdwogICAgICAgIGVuZAogICAgZW5kCiAgICBvcmlnaW5hbFBhcnRzID0ge30gLS0gcmVzZXQKZW5kCgotLSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0gVG9nZ2xlIEF1dG8gUmVkdWNlICgxMHMpCi0tID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBhdXRvVGhyZWFkCmxvY2FsIGNvbm5lY3Rpb24KCmxvY2FsIEF1dG9SZWR1Y2VUb2dnbGUgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJBdXRvUmVkdWNlIiwgewogICAgVGl0bGUgPSAiRlBTIEJvb3N0IiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBwcmludCgi8J+UhCBBdXRvIFJlZHVjZSBPTiIpCgogICAgICAgICAgICAtLSBMxrB1IGxpZ2h0aW5nIGfhu5FjCiAgICAgICAgICAgIHNhdmVMaWdodGluZygpCgogICAgICAgICAgICAtLSBHaeG6o20gxJHhu5MgaOG7jWEgbGln" ..
    "aHRpbmcga2hpIGLhuq10CiAgICAgICAgICAgIHNldHRpbmdzKCkuUmVuZGVyaW5nLlF1YWxpdHlMZXZlbCA9IEVudW0uUXVhbGl0eUxldmVsLkxldmVsMDEKICAgICAgICAgICAgZ2FtZS5MaWdodGluZy5HbG9iYWxTaGFkb3dzID0gZmFsc2UKICAgICAgICAgICAgZ2FtZS5MaWdodGluZy5Gb2dFbmQgPSA5ZTkKICAgICAgICAgICAgZ2FtZS5MaWdodGluZy5CcmlnaHRuZXNzID0gMQogICAgICAgICAgICBmb3IgXywgdiBpbiBpcGFpcnMoZ2FtZS5MaWdodGluZzpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgdjpJc0EoIlBvc3RFZmZlY3QiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdi5FbmFibGVkID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIC0tIPCflKUgR2nhuqNtIG5nYXkgMSBs4bqnbiDEkeG6p3UgdGnDqm4KICAgICAgICAgICAgZm9yIF8sIG9iaiBpbiBpcGFpcnMod29ya3NwYWNlOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBzaW1wbGlmeU1vZGVsKG9iaikKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAtLSBO4bq/dSBjw7Mgb2JqZWN0IHNwYXduIHRow6ptIHRow6wgY8WpbmcgeOG7rSBsw70KICAgICAgICAgICAgY29ubmVjdGlvbiA9IHdvcmtzcGFjZS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChzaW1wbGlmeU1vZGVsKQoKICAgICAgICAgICAgLS0gU2F1IMSRw7MgYXV0byBs4bq3cCBt4buXaSAx" ..
    "MHMKICAgICAgICAgICAgYXV0b1RocmVhZCA9IHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgQXV0b1JlZHVjZVRvZ2dsZS5WYWx1ZSBkbwogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxMCkKICAgICAgICAgICAgICAgICAgICBmb3IgXywgb2JqIGluIGlwYWlycyh3b3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgc2ltcGxpZnlNb2RlbChvYmopCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQoKICAgICAgICBlbHNlCiAgICAgICAgICAgIHByaW50KCLij7kgQXV0byBSZWR1Y2UgT0ZGIikKICAgICAgICAgICAgaWYgY29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgICAgICBjb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgY29ubmVjdGlvbiA9IG5pbAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIC0tIEtow7RpIHBo4bulYyDEkeG7kyBo4buNYSBn4buRYwogICAgICAgICAgICByZXN0b3JlTGlnaHRpbmcoKQogICAgICAgICAgICByZXN0b3JlUGFydHMoKQogICAgICAgICAgICBwcmludCgi4pyFIMSQw6Mga2jDtGkgcGjhu6VjIMSR4buTIGjhu41hIGfhu5FjIikKICAgICAgICBlbmQKICAgIGVuZAp9KQoKCgotLSDwn6egIEFudGktRlBTIFNwaWtlIChDxrDhu6FuZyBjaOG6vyA2MEZQUyArIFThu7EgY2jhu5FuZyB0xINuZyBi4bqldCB0aMaw" ..
    "4budbmcpCi0tIEdp4buvIEZQUyBsdcO0biDhu5VuIMSR4buLbmgg4bufIDYwLCBuZ8SDbiB24buNdCBGUFMgZ8OieSDEkcahIC8gZ2nhuq10IGdhbWUKCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQoKVGFicy5NaXNjOkFkZFRvZ2dsZSgiQW50aUZQU1NwaWtlIiwgewogICAgVGl0bGUgPSAiVW5sb2NrIEZQUyBWMiIsCiAgICBEZWZhdWx0ID0gZmFsc2UKfSk6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQogICAgX0cuQW50aUZQU1NwaWtlID0gVmFsdWUKCiAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgd2FybigiW0FudGktRlBTIFNwaWtlXSDinIUgSOG7hyB0aOG7kW5nIGPGsOG7oW5nIGNo4bq/IEZQUyA9IDYwIMSRw6MgYuG6rXQuIikKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIEZPUkNFX0ZQUyA9IDYwICAgICAgICAgIC0tIEx1w7RuIGdp4buvIDYwIEZQUwogICAgICAgICAgICBsb2NhbCBTUElLRV9USFJFU0hPTEQgPSAxMjAgICAtLSBO4bq/dSBGUFMgdsaw4bujdCBuZ8aw4buhbmcgbsOgeSB0aMOsIGNo4buRbmcgc3Bpa2UKICAgICAgICAgICAgbG9jYWwgTU9OSVRPUl9JTlRFUlZBTCA9IDEgICAgLS0gS2nhu4NtIHRyYSBt4buXaSAxIGdpw6J5CgogICAgICAgICAgICBsb2NhbCBmcmFtZUNvdW50ID0gMAogICAgICAgICAgICBsb2NhbCBmcHMgPSA2MAoKICAgICAgICAgICAgLS0gSMOgbSBjxrDhu6FuZyBjaOG6vyBGUFMK" ..
    "ICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gZm9yY2VDYXAoKQogICAgICAgICAgICAgICAgaWYgdHlwZW9mKHNldGZwc2NhcCkgPT0gImZ1bmN0aW9uIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgc2V0ZnBzY2FwKEZPUkNFX0ZQUykKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIC0tIEtow7NhIGJhbiDEkeG6p3UKICAgICAgICAgICAgZm9yY2VDYXAoKQoKICAgICAgICAgICAgLS0gxJDhur9tIEZQUyB0aOG7sWMgdOG6vwogICAgICAgICAgICBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBub3QgX0cuQW50aUZQU1NwaWtlIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgZnJhbWVDb3VudCArPSAxCiAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgIHdoaWxlIF9HLkFudGlGUFNTcGlrZSBhbmQgdGFzay53YWl0KE1PTklUT1JfSU5URVJWQUwpIGRvCiAgICAgICAgICAgICAgICBmcHMgPSBmcmFtZUNvdW50IC8gTU9OSVRPUl9JTlRFUlZBTAogICAgICAgICAgICAgICAgZnJhbWVDb3VudCA9IDAKCiAgICAgICAgICAgICAgICAtLSBQaMOhdCBoaeG7h24gRlBTIHTEg25nIGLhuqV0IHRoxrDhu51uZwogICAgICAgICAgICAgICAgaWYgZnBzID4gU1BJS0VfVEhSRVNIT0xEIHRoZW4KICAgICAgICAgICAgICAgICAgICB3YXJuKHN0cmluZy5mb3JtYXQoIlvimqDvuI8gQW50aS1GUFMgU3Bpa2VdOiBG" ..
    "UFMgdMSDbmcgYuG6pXQgdGjGsOG7nW5nICglZCkg4oaSIOG7lW4gxJHhu4tuaCBs4bqhaSEiLCBtYXRoLmZsb29yKGZwcykpKQogICAgICAgICAgICAgICAgICAgIGZvcmNlQ2FwKCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgLS0gQuG6o28gduG7hyB0csOhbmggc2NyaXB0IGtow6FjIMSR4buVaSBjYXAKICAgICAgICAgICAgICAgIGlmIHR5cGVvZihnZXRmcHNjYXApID09ICJmdW5jdGlvbiIgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGN1cnJlbnRDYXAgPSBnZXRmcHNjYXAoKQogICAgICAgICAgICAgICAgICAgIGlmIGN1cnJlbnRDYXAgfj0gRk9SQ0VfRlBTIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgd2FybigiW0FudGktRlBTIFNwaWtlXTogUGjDoXQgaGnhu4duIHRoYXkgxJHhu5VpIEZQUyBjYXAgbmdvw6BpIMO9IG114buRbiDihpIgw6lwIGzhuqFpIDYwRlBTLiIpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQ2FwKCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHdhcm4oIltBbnRpLUZQUyBTcGlrZV0g4puUIEjhu4cgdGjhu5FuZyBjxrDhu6FuZyBjaOG6vyBGUFMgxJHDoyB04bqvdC4iKQogICAgICAgIGVuZCkKICAgIGVsc2UKICAgICAgICB3YXJuKCJbQW50aS1GUFMgU3Bpa2VdIOKdjCDEkMOjIHThuq90" ..
    "LiIpCiAgICBlbmQKZW5kKQoKCgotLSA9PT09PT09IEThu4pDSCBW4bukID09PT09PT0KbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKLS0gPT09PT09PSBEQU5IIFPDgUNIIEJMT0NLIEFOSU1BVElPTiA9PT09PT09CmxvY2FsIGJsb2NrZWRBbmltYXRpb25zID0gewogICAgWyIxMjc4MDIxNDYzODM1NjUiXSA9IHRydWUsCiAgICBbIjgyNjkxNTMzNjAyOTQ5Il0gPSB0cnVlLAogICAgWyIxMjM3NjQxNjkwNzE5OTUiXSA9IHRydWUsCn0KCi0tID09PT09PT0gQknhur5OIFRS4bqgTkcgVEjDgUkgPT09PT09PQpsb2NhbCBCbG9ja0FuaW1FbmFibGVkID0gZmFsc2UKbG9jYWwgYmxvY2tDb25uZWN0aW9ucyA9IHt9CgotLSA9PT09PT09IEjDgE0gPT09PT09PQpsb2NhbCBmdW5jdGlvbiBob29rSHVtYW5vaWQoaHVtYW5vaWQpCiAgICBpZiBub3QgaHVtYW5vaWQgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBjb25uID0gaHVtYW5vaWQuQW5pbWF0aW9uUGxheWVkOkNvbm5lY3QoZnVuY3Rpb24odHJhY2spCiAgICAgICAgbG9jYWwgaWQgPSB0cmFjay5BbmltYXRpb24uQW5pbWF0aW9uSWQ6bWF0Y2goIiVkKyIpCiAgICAgICAgaWYgQmxvY2tBbmltRW5hYmxlZCBhbmQgYmxvY2tlZEFuaW1hdGlvbnNbaWRdIHRoZW4KICAgICAgICAgICAgdHJhY2s6U3RvcCgpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICB0YWJsZS5pbnNl" ..
    "cnQoYmxvY2tDb25uZWN0aW9ucywgY29ubikKZW5kCgpsb2NhbCBmdW5jdGlvbiBzZXRCbG9ja0FuaW1hdGlvbnMoZW5hYmxlZCkKICAgIEJsb2NrQW5pbUVuYWJsZWQgPSBlbmFibGVkCgogICAgLS0gY2xlYXIgY8WpCiAgICBmb3IgXywgY29ubiBpbiBwYWlycyhibG9ja0Nvbm5lY3Rpb25zKSBkbwogICAgICAgIGNvbm46RGlzY29ubmVjdCgpCiAgICBlbmQKICAgIHRhYmxlLmNsZWFyKGJsb2NrQ29ubmVjdGlvbnMpCgogICAgaWYgZW5hYmxlZCB0aGVuCiAgICAgICAgLS0gbmjDom4gduG6rXQgaGnhu4duIHThuqFpCiAgICAgICAgaWYgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgaG9va0h1bWFub2lkKExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJIdW1hbm9pZCIpKQogICAgICAgIGVuZAogICAgICAgIC0tIHJlc3Bhd24KICAgICAgICBsb2NhbCBjb25uQ2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcikKICAgICAgICAgICAgY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIikKICAgICAgICAgICAgaG9va0h1bWFub2lkKGNoYXI6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQiKSkKICAgICAgICBlbmQpCiAgICAgICAgdGFibGUuaW5zZXJ0KGJsb2NrQ29ubmVjdGlvbnMsIGNvbm5DaGFyKQogICAgZW5kCmVuZAoKLS0gPT09PT09PSBUT0dHTEUgRkxVRU5UID09PT09PT0KVGFicy5NaXNjOkFk" ..
    "ZFRvZ2dsZSgiQmxvY2tCYWRBbmltcyIsIHsKICAgIFRpdGxlID0gIkJsb2NrIEFuaW1hdGlvbnMiLAogICAgRGVmYXVsdCA9IGZhbHNlCn0pOk9uQ2hhbmdlZChmdW5jdGlvbih2KQogICAgc2V0QmxvY2tBbmltYXRpb25zKHYpCmVuZCkKCgoKICAgIFRhYnMuTWlzYzpBZGRTZWN0aW9uKCLihrMgU2hvdyIpCgoKCi0tLy8gRlBTICsgUGluZyBEaXNwbGF5IChTYWZlIEJpbGxib2FyZEd1aSBWZXJzaW9uKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKbG9jYWwgU3RhdHMgPSBnYW1lOkdldFNlcnZpY2UoIlN0YXRzIikKbG9jYWwgQ2FtZXJhID0gd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEKCi0tLy8gVUkgQ29udGFpbmVyCmxvY2FsIHVpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQp1aS5OYW1lID0gIkZQU19QaW5nX0Rpc3BsYXkiCnVpLlJlc2V0T25TcGF3biA9IGZhbHNlCnVpLklnbm9yZUd1aUluc2V0ID0gdHJ1ZQp1aS5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuU2libGluZwp1aS5QYXJlbnQgPSBnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKQoKLS0vLyBGUFMgTGFiZWwKbG9jYWwgZnBzTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCmZwc0xhYmVsLlNpemUgPSBVRGltMi5uZXcoMCwgMTIwLCAwLCAyMCkKZnBzTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgLTEzMCwgMCwgNSkKZnBzTGFiZWwuQmFja2dyb3VuZFRyYW5zcGFy" ..
    "ZW5jeSA9IDEKZnBzTGFiZWwuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMCkKZnBzTGFiZWwuVGV4dFN0cm9rZVRyYW5zcGFyZW5jeSA9IDAKZnBzTGFiZWwuVGV4dFNpemUgPSAxNgpmcHNMYWJlbC5Gb250ID0gRW51bS5Gb250LkNvZGUKZnBzTGFiZWwuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkxlZnQKZnBzTGFiZWwuVGV4dCA9ICJGUFM6IC4uLiIKZnBzTGFiZWwuUGFyZW50ID0gdWkKCi0tLy8gUGluZyBMYWJlbApsb2NhbCBwaW5nTGFiZWwgPSBmcHNMYWJlbDpDbG9uZSgpCnBpbmdMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAtMTMwLCAwLCAyNSkKcGluZ0xhYmVsLlRleHQgPSAiUGluZzogLi4uIgpwaW5nTGFiZWwuUGFyZW50ID0gdWkKCi0tLy8gVmFyaWFibGVzCmxvY2FsIHNob3dGUFMgPSB0cnVlCmxvY2FsIHNob3dQaW5nID0gdHJ1ZQpsb2NhbCBmcHNDb3VudGVyLCBsYXN0VXBkYXRlID0gMCwgdGljaygpCgotLS8vIFVwZGF0ZSBMb29wClJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGZwc0NvdW50ZXIgKz0gMQogICAgaWYgdGljaygpIC0gbGFzdFVwZGF0ZSA+PSAxIHRoZW4KICAgICAgICBpZiBzaG93RlBTIHRoZW4KICAgICAgICAgICAgZnBzTGFiZWwuVmlzaWJsZSA9IHRydWUKICAgICAgICAgICAgZnBzTGFiZWwuVGV4dCA9ICJGUFM6ICIgLi4gdG9zdHJpbmcoZnBzQ291bnRlcikKICAgICAgICBlbHNlCiAg" ..
    "ICAgICAgICAgIGZwc0xhYmVsLlZpc2libGUgPSBmYWxzZQogICAgICAgIGVuZAoKICAgICAgICBpZiBzaG93UGluZyB0aGVuCiAgICAgICAgICAgIGxvY2FsIHBpbmdTdGF0ID0gU3RhdHMuTmV0d29yay5TZXJ2ZXJTdGF0c0l0ZW1bIkRhdGEgUGluZyJdCiAgICAgICAgICAgIGxvY2FsIHBpbmcgPSBwaW5nU3RhdCBhbmQgbWF0aC5mbG9vcihwaW5nU3RhdDpHZXRWYWx1ZSgpKSBvciAwCiAgICAgICAgICAgIHBpbmdMYWJlbC5UZXh0ID0gIlBpbmc6ICIgLi4gcGluZyAuLiAiIG1zIgogICAgICAgICAgICBpZiBwaW5nIDw9IDYwIHRoZW4KICAgICAgICAgICAgICAgIHBpbmdMYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMjU1LCAwKQogICAgICAgICAgICBlbHNlaWYgcGluZyA8PSAxMjAgdGhlbgogICAgICAgICAgICAgICAgcGluZ0xhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDE2NSwgMCkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcGluZ0xhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDApCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBwaW5nTGFiZWwuVmlzaWJsZSA9IHRydWUKICAgICAgICBlbHNlCiAgICAgICAgICAgIHBpbmdMYWJlbC5WaXNpYmxlID0gZmFsc2UKICAgICAgICBlbmQKCiAgICAgICAgZnBzQ291bnRlciA9IDAKICAgICAgICBsYXN0VXBkYXRlID0gdGljaygpCiAgICBlbmQKZW5kKQoKLS0vLyBGbHVlbnQg" ..
    "VUkgVG9nZ2xlcwpsb2NhbCBmcHNUb2dnbGUgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJTaG93RlBTVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiU2hvdyBGUFMiLAogICAgRGVmYXVsdCA9IHRydWUKfSkKZnBzVG9nZ2xlOk9uQ2hhbmdlZChmdW5jdGlvbih2YWwpCiAgICBzaG93RlBTID0gdmFsCiAgICBmcHNMYWJlbC5WaXNpYmxlID0gdmFsCmVuZCkKCmxvY2FsIHBpbmdUb2dnbGUgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJTaG93UGluZ1RvZ2dsZSIsIHsKICAgIFRpdGxlID0gIlNob3cgUGluZyIsCiAgICBEZWZhdWx0ID0gdHJ1ZQp9KQpwaW5nVG9nZ2xlOk9uQ2hhbmdlZChmdW5jdGlvbih2YWwpCiAgICBzaG93UGluZyA9IHZhbAogICAgcGluZ0xhYmVsLlZpc2libGUgPSB2YWwKZW5kKQoKCgoKZG8KICAgIC0tPT0g8J+SrCBDaGF0IFZpc2liaWxpdHkgQ29udHJvbGxlciA9PS0tCiAgICBnZXRnZW52KCkuY2hhdFdpbmRvdyA9IGdhbWU6R2V0U2VydmljZSgiVGV4dENoYXRTZXJ2aWNlIik6V2FpdEZvckNoaWxkKCJDaGF0V2luZG93Q29uZmlndXJhdGlvbiIpCiAgICBnZXRnZW52KCkuY2hhdEVuYWJsZWQgPSBmYWxzZQogICAgZ2V0Z2VudigpLmNoYXRDb25uZWN0aW9uID0gbmlsCgogICAgVGFicy5NaXNjOkFkZFRvZ2dsZSgiQ2hhdFZpc2liaWxpdHlUb2dnbGUiLCB7CiAgICAgICAgVGl0bGUgPSAiU2hvdyBDaGF0IiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UKICAgIH0pOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1" ..
    "ZSkKICAgICAgICBnZXRnZW52KCkuY2hhdEVuYWJsZWQgPSBWYWx1ZQoKICAgICAgICAtLSBO4bq/dSBi4bqtdCDihpIgYuG6rXQgY2hhdCB2w6Aga+G6v3QgbuG7kWkgSGVhcnRiZWF0CiAgICAgICAgaWYgVmFsdWUgdGhlbgogICAgICAgICAgICBpZiBub3QgZ2V0Z2VudigpLmNoYXRDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgICAgIGdldGdlbnYoKS5jaGF0Q29ubmVjdGlvbiA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuY2hhdFdpbmRvdyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5jaGF0V2luZG93LkVuYWJsZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgLS0gTuG6v3UgdOG6r3Qg4oaSIG5n4bqvdCBr4bq/dCBu4buRaSB2w6Ag4bqpbiBjaGF0CiAgICAgICAgICAgIGlmIGdldGdlbnYoKS5jaGF0Q29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgICAgICBnZXRnZW52KCkuY2hhdENvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBnZXRnZW52KCkuY2hhdENvbm5lY3Rpb24gPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIGdldGdlbnYoKS5jaGF0V2luZG93IHRoZW4KICAgICAgICAgICAgICAgIGdldGdl" ..
    "bnYoKS5jaGF0V2luZG93LkVuYWJsZWQgPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgoKCgotLSBUYWJzLlNldHRpbmdzCgoKbG9jYWwgQWV4ZWNUb2dnbGUgPSBUYWJzLlNldHRpbmdzOkFkZFRvZ2dsZSgiQWV4ZWNUb2dnbGUiLCB7VGl0bGUgPSAiQXV0byBFeGVjdXRlIiwgRGVmYXVsdCA9IGZhbHNlIH0pCkFleGVjVG9nZ2xlOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkKICAgIGlmIFZhbHVlIHRoZW4KICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgaWYgcXVldWVfb25fdGVsZXBvcnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIEh1dGFvSHViU2NyaXB0MSA9IFtbCnRhc2sud2FpdCgzKQpsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2hka3Nha3N0LXNoaXAtaXQvSHV0YW8tSHViLU9tZWdhLVgvcmVmcy9oZWFkcy9tYWluL0ZvcnNha2VuLXYzLnR4dCIpKSgpCl1dCiAgICAgICAgICAgICAgICAgICAgcXVldWVfb25fdGVsZXBvcnQoSHV0YW9IdWJTY3JpcHQxKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQpCiAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIkh1dGFvIEhVQiIsCiAgICAgICAgICAgIENvbnRlbnQgPSAiQXV0byBleGVjdXRlIGlz" ..
    "IGVuYWJsZWQhIiwKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgIGVsc2UKICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiSHV0YW8gSFVCIiwKICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIGV4ZWN1dGUgaXMgZGlzYWJsZWQhIiwKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgIGVuZAplbmQpCgpTYXZlTWFuYWdlcjpTZXRMaWJyYXJ5KEZsdWVudCkKSW50ZXJmYWNlTWFuYWdlcjpTZXRMaWJyYXJ5KEZsdWVudCkKCi0tIElnbm9yZSBrZXlzIHRoYXQgYXJlIHVzZWQgYnkgVGhlbWVNYW5hZ2VyLgotLSAod2UgZG9udCB3YW50IGNvbmZpZ3MgdG8gc2F2ZSB0aGVtZXMsIGRvIHdlPykKU2F2ZU1hbmFnZXI6SWdub3JlVGhlbWVTZXR0aW5ncygpCgotLSBZb3UgY2FuIGFkZCBpbmRleGVzIG9mIGVsZW1lbnRzIHRoZSBzYXZlIG1hbmFnZXIgc2hvdWxkIGlnbm9yZQpTYXZlTWFuYWdlcjpTZXRJZ25vcmVJbmRleGVzKHt9KQoKLS0gdXNlIGNhc2UgZm9yIGRvaW5nIGl0IHRoaXMgd2F5OgotLSBhIHNjcmlwdCBodWIgY291bGQgaGF2ZSB0aGVtZXMgaW4gYSBnbG9iYWwgZm9sZGVyCi0tIGFuZCBnYW1lIGNvbmZpZ3MgaW4gYSBzZXBhcmF0ZSBmb2xkZXIgcGVyIGdhbWUKSW50ZXJmYWNlTWFuYWdlcjpTZXRGb2xkZXIoIkh1dGFvIEhVQiIpClNhdmVNYW5hZ2VyOlNldEZvbGRlcigiSHV0YW8gSFVCL0ZvcnNha2VuIikKCkludGVyZmFjZU1hbmFn" ..
    "ZXI6QnVpbGRJbnRlcmZhY2VTZWN0aW9uKFRhYnMuU2V0dGluZ3MpClNhdmVNYW5hZ2VyOkJ1aWxkQ29uZmlnU2VjdGlvbihUYWJzLlNldHRpbmdzKQoKLS0gU2VsZWN0IEZpcnN0IFRhYiBCeSBEZWZhdWx0CldpbmRvdzpTZWxlY3RUYWIoMSkKCkZsdWVudDpOb3RpZnkoeyBUaXRsZSA9ICJIdXRhbyBIVUIiLCBDb250ZW50ID0gImZvcnNha2VuIHNjcmlwdCBsb2FkZWQgc3VjY2Vzc2Z1bGx5ISIsIER1cmF0aW9uID0gNSB9KQpTYXZlTWFuYWdlcjpMb2FkQXV0b2xvYWRDb25maWcoKQ=="

local ok, payload = pcall(function()
    return decodeBase64(payload_b64)
end)

if not ok or type(payload) ~= "string" then
    error("Failed to decode payload.")
end

-- Simple checksum function (sum of bytes modulo 2^32)
local function checksum_str(s)
    local sum = 0
    for i = 1, #s do
        sum = (sum + string.byte(s, i)) % 4294967296
    end
    return sum
end

-- Anti-tamper check
if checksum_str(payload) ~= 22684096 then
    -- Tamper detected: run fake damage + obfuscation
    for i=1,10 do
        pcall(function()
            local name = "junk_"..tostring(i)
            _G[name] = function() return nil end
        end)
    end
    -- create misleading long loop
    local function troll()
        local s = ""
        for i=1,500 do
            s = s .. tostring(i%2)
            if i % 50 == 0 then task.wait(0) end
        end
        return s
    end
    pcall(troll)
    error("Tamper detected. Execution aborted.")
end

-- Execute original payload
local fn, err = loadstring(payload)
if not fn then
    error("Payload load failed: " .. tostring(err))
end

local success, res = pcall(fn)
if not success then
    error("Payload error: " .. tostring(res))
end

-- End of wrapper
